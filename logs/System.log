
================================================================================
[系统启动] 2025-06-28 10:54:11
================================================================================
[2025-06-28 10:54:11] 🚀 Agent Data Platform 启动中... (所有日志将统一记录到 logs/System.log)
2025-06-28 10:54:11,164 - asyncio - DEBUG - Using selector: KqueueSelector
[2025-06-28 10:54:11] 🧹 开始增强端口清理...
[2025-06-28 10:54:11] 🔍 搜索并清理相关Python进程...
[2025-06-28 10:54:11] ✅ 进程清理完成
[2025-06-28 10:54:13] ✅ 端口 8088 空闲
[2025-06-28 10:54:13] ✅ 端口 8089 空闲
[2025-06-28 10:54:13] ✅ 端口 8090 空闲
[2025-06-28 10:54:13] ✅ 端口 8091 空闲
[2025-06-28 10:54:13] ✅ 端口 8092 空闲
[2025-06-28 10:54:13] ✅ 端口 5555 空闲
[2025-06-28 10:54:13] 🔥 强制清理端口 8081 的进程 70732
[2025-06-28 10:54:13] ✅ 端口 8082 空闲
[2025-06-28 10:54:13] ✅ 端口 8080 空闲
[2025-06-28 10:54:13] 🔥 强制清理端口 8084 的进程 70782
[2025-06-28 10:54:13] ✅ 端口 8085 空闲
[2025-06-28 10:54:13] ✅ 端口 8086 空闲
[2025-06-28 10:54:13] ✅ 端口 8087 空闲
[2025-06-28 10:54:13] ✅ 端口 8000 空闲
[2025-06-28 10:54:14] ✅ 增强端口清理完成
2025-06-28 10:54:14,646 - __main__ - INFO - === Agent Data Platform 启动中 ===
2025-06-28 10:54:14,646 - __main__ - DEBUG - 🔧 开始系统初始化流程...
2025-06-28 10:54:14,647 - __main__ - DEBUG - 📝 命令行参数: {'config_dir': 'config', 'debug': False, 'start_services': False}
2025-06-28 10:54:14,647 - __main__ - DEBUG - 🔧 步骤1: 初始化ConfigManager...
2025-06-28 10:54:14,647 - __main__ - DEBUG - ✅ ConfigManager初始化完成，配置目录: config
2025-06-28 10:54:14,647 - __main__ - DEBUG - 🔧 步骤2: 加载系统配置...
2025-06-28 10:54:14,648 - __main__ - DEBUG - 📡 Redis URL: redis://localhost:6379
2025-06-28 10:54:14,648 - __main__ - DEBUG - 📋 任务文件路径: tasks.jsonl
2025-06-28 10:54:14,650 - core.config_manager - INFO - 路由配置加载成功
2025-06-28 10:54:14,650 - __main__ - DEBUG - 🚦 路由配置加载完成，任务类型映射: {'CODE': 'tasks:reasoning', 'WEB': 'tasks:reasoning', 'REASONING': 'tasks:reasoning', 'RESEARCH': 'tasks:reasoning'}
2025-06-28 10:54:14,650 - __main__ - DEBUG - 📋 队列映射: {<TaskType.CODE: 'code'>: 'tasks:reasoning', <TaskType.WEB: 'web'>: 'tasks:reasoning', <TaskType.REASONING: 'reasoning'>: 'tasks:reasoning', <TaskType.RESEARCH: 'research'>: 'tasks:reasoning'}
2025-06-28 10:54:14,650 - __main__ - DEBUG - 🔧 步骤3: 初始化核心组件...
2025-06-28 10:54:14,650 - __main__ - DEBUG - ✅ EnhancedMetrics初始化完成
2025-06-28 10:54:14,651 - __main__ - DEBUG - ✅ RedisManager初始化完成
2025-06-28 10:54:14,651 - core.toolscore.toolscore_client - INFO - ✅ 增强的ToolScoreClient初始化完成
2025-06-28 10:54:14,651 - core.llm_client - DEBUG - Enriched config with environment variables: ['default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 10:54:14,770 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 10:54:14,772 - core.config_manager - INFO - 路由配置加载成功
2025-06-28 10:54:14,772 - core.monitoring.queue_monitor - INFO - ✅ QueueMonitor 配置加载完成
2025-06-28 10:54:14,772 - core.system_monitor - INFO - ✅ SystemMonitor 配置加载完成
2025-06-28 10:54:14,773 - __main__ - DEBUG - 🔧 开始初始化所有服务...
2025-06-28 10:54:14,773 - services.service_manager - INFO - 正在初始化所有服务...
2025-06-28 10:54:14,773 - services.service_manager - INFO - 初始化服务: redis
2025-06-28 10:54:14,773 - services.redis_service - INFO - Redis服务初始化完成，使用注入的RedisManager实例
2025-06-28 10:54:14,773 - services.service_manager - INFO - 初始化服务: toolscore
2025-06-28 10:54:14,773 - services.toolscore_service - INFO - 正在初始化ToolScore服务...
2025-06-28 10:54:14,773 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 10:54:14,773 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 10:54:14,773 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 10:54:14,773 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 10:54:14,773 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 10:54:14,774 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 10:54:14,774 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 10:54:14,774 - services.toolscore_service - INFO - ToolScore服务初始化完成（异步初始化将在start()中进行）
2025-06-28 10:54:14,774 - services.service_manager - INFO - 初始化服务: task_processing_coordinator
2025-06-28 10:54:14,774 - services.service_manager - INFO - 初始化服务: mcp_servers
2025-06-28 10:54:14,774 - services.mcp_server_launcher - INFO - 正在初始化MCP服务器启动器...
2025-06-28 10:54:14,774 - services.mcp_server_launcher - INFO - MCP服务器启动器初始化完成，配置了 4 个服务器: ['microsandbox_server', 'search_tool_server', 'browser_use_server', 'deepsearch_server']
2025-06-28 10:54:14,774 - services.service_manager - INFO - 初始化服务: task_api
2025-06-28 10:54:14,774 - services.task_api_service - INFO - 正在初始化任务API服务...
2025-06-28 10:54:14,774 - services.task_api_service - INFO - 任务API服务初始化完成
2025-06-28 10:54:14,774 - services.service_manager - INFO - 初始化服务: runtime
2025-06-28 10:54:14,774 - services.runtime_service - INFO - 正在初始化推理运行时服务...
2025-06-28 10:54:14,774 - services.runtime_service - INFO - 创建运行时实例: enhanced-runtime-1
2025-06-28 10:54:14,774 - core.memory_manager - INFO - MemoryManager initialized: use_redis=True, max_entries=1000
2025-06-28 10:54:14,774 - core.step_planner - INFO - StepPlanner initialized with max_steps=10
2025-06-28 10:54:14,774 - runtimes.reasoning.enhanced_runtime - INFO - DEBUG: Loaded toolscore_http_port: 8082, toolscore_mcp_port: 8081
2025-06-28 10:54:14,774 - runtimes.reasoning.enhanced_runtime - INFO - DEBUG: Configured toolscore_websocket_endpoint (using mcp_port): ws://localhost:8081/websocket
2025-06-28 10:54:14,774 - core.toolscore.mcp_client - INFO - Enhanced MCPToolClient initialized for toolscore at ws://localhost:8081/websocket
2025-06-28 10:54:14,774 - core.llm.guardrails_middleware - INFO - 🔧 初始化输入验证Guard...
2025-06-28 10:54:14,775 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 10:54:14,776 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 10:54:14,776 - core.llm.guardrails_middleware - INFO - 🔧 初始化输出验证Guard...
2025-06-28 10:54:14,776 - core.llm.guardrails_middleware - WARNING - ⚠️ 未提供LLM客户端，Guard将无法执行基于LLM的修正。回退到无API的Guard。
2025-06-28 10:54:14,778 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 10:54:14,778 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 10:54:14,778 - core.llm.guardrails_middleware - INFO - ✅ Guardrails Guards初始化成功
2025-06-28 10:54:14,778 - core.llm.guardrails_middleware - INFO -    - 输入Guard: ✅
2025-06-28 10:54:14,778 - core.llm.guardrails_middleware - INFO -    - 输出Guard: ✅
2025-06-28 10:54:14,778 - core.agents.validation_critic - INFO - 🎯 ValidationCritic Agent初始化完成
2025-06-28 10:54:14,778 - services.runtime_service - INFO - 推理运行时服务初始化完成，创建了 1 个实例
2025-06-28 10:54:14,778 - services.service_manager - INFO - 初始化服务: synthesis
2025-06-28 10:54:14,778 - services.synthesis_service - INFO - 正在初始化合成服务...
2025-06-28 10:54:14,778 - core.llm_client - DEBUG - Enriched config with environment variables: ['redis_url', 'TRAJECTORIES_DIR', 'default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 10:54:14,814 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 10:54:14,814 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 10:54:14,814 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 10:54:14,815 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 10:54:14,815 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 10:54:14,815 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 10:54:14,815 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 10:54:14,815 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 10:54:14,815 - core.synthesiscore.synthesis - INFO - ✅ 初始化任务本质文件: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/output/task_essences.json
2025-06-28 10:54:14,815 - core.synthesiscore.synthesis - INFO - ✅ 初始化种子任务文件: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/output/seed_tasks.jsonl
2025-06-28 10:54:14,815 - core.synthesiscore.synthesis - INFO - ✅ 初始化已处理轨迹记录文件: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/output/processed_trajectories.json
2025-06-28 10:54:14,815 - core.synthesiscore.synthesis - INFO - ✅ JSON文件存储初始化完成
2025-06-28 10:54:14,815 - core.synthesiscore.synthesis - INFO - 📋 未发现已处理轨迹记录，从空白状态开始
2025-06-28 10:54:14,815 - core.llm_client - DEBUG - Enriched config with environment variables: ['redis_url', 'TRAJECTORIES_DIR', 'default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 10:54:14,850 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 10:54:14,850 - core.toolscore.mcp_client - INFO - Enhanced MCPToolClient initialized for toolscore at ws://localhost:8089/websocket
2025-06-28 10:54:14,853 - core.synthesiscore.config_loader - INFO - ✅ SynthesisCore配置加载成功: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/config/synthesiscore_config.yaml
2025-06-28 10:54:14,853 - core.synthesiscore.trajectory_monitor - INFO - 🔧 TrajectoryMonitor初始化完成
2025-06-28 10:54:14,853 - core.synthesiscore.trajectory_monitor - INFO - 📂 监控目录: output/trajectories
2025-06-28 10:54:14,853 - core.synthesiscore.trajectory_monitor - INFO - 📝 种子文件: output/trajectories/../seed_tasks.jsonl
2025-06-28 10:54:14,853 - services.synthesis_service - INFO - ✅ TrajectoryMonitor v2.0 初始化完成
2025-06-28 10:54:14,853 - services.synthesis_service - INFO - 合成服务初始化完成，轨迹目录: output/trajectories
2025-06-28 10:54:14,853 - __main__ - DEBUG - ✅ 所有服务初始化完成
2025-06-28 10:54:14,853 - __main__ - DEBUG - 🚀 开始启动所有服务...
2025-06-28 10:54:14,853 - services.service_manager - INFO - 正在启动所有服务...
2025-06-28 10:54:14,853 - services.service_manager - INFO - 启动服务: redis
2025-06-28 10:54:14,853 - services.redis_service - INFO - Redis客户端已就绪
2025-06-28 10:54:14,853 - services.service_manager - INFO - 启动服务: toolscore
2025-06-28 10:54:14,853 - services.toolscore_service - INFO - 正在启动ToolScore服务...
2025-06-28 10:54:14,853 - services.toolscore_service - INFO - 正在初始化工具库...
2025-06-28 10:54:14,853 - services.toolscore_service - INFO - 工具库初始化将在ToolScore MCP服务器线程中进行。
2025-06-28 10:54:14,853 - services.toolscore_service - INFO - 正在启动ToolScore HTTP API...
2025-06-28 10:54:14,864 - services.toolscore_service - INFO - ToolScore HTTP API已启动于端口: 8082
2025-06-28 10:54:14,864 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 10:54:14,864 - services.toolscore_service - INFO - ToolScore MCP 服务器不进行端口自动检测，使用配置端口: 8081
2025-06-28 10:54:14,864 - services.toolscore_service - INFO - ToolScore MCP server configured to use host: 0.0.0.0, port: 8081, path: /websocket
2025-06-28 10:54:14,864 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 10:54:14,864 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 10:54:14,864 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 10:54:14,864 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 10:54:14,865 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 10:54:14,865 - core.toolscore.monitoring_api - INFO - ToolScore monitoring API started on port 8082
2025-06-28 10:54:14,865 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 10:54:14,865 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 10:54:14,865 - services.toolscore_service - INFO - Starting ToolScore MCP server thread...
2025-06-28 10:54:14,865 - services.toolscore_service - INFO - ToolScore MCP server thread started, is_alive: True
2025-06-28 10:54:14,865 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 10:54:14,865 - services.toolscore_service - INFO - ToolScore MCP服务器启动线程已启动，等待就绪信号...
2025-06-28 10:54:14,865 - services.service_manager - INFO - 启动服务: task_processing_coordinator
2025-06-28 10:54:14,866 - core.toolscore.mcp_server - INFO - Attempting to start toolscore MCP Server on 0.0.0.0:8081
2025-06-28 10:54:14,866 - core.dispatcher_enhanced - INFO - ✅ TaskProcessingCoordinator 配置加载完成 - 队列映射: {<TaskType.CODE: 'code'>: 'tasks:reasoning', <TaskType.WEB: 'web'>: 'tasks:reasoning', <TaskType.REASONING: 'reasoning'>: 'tasks:reasoning', <TaskType.RESEARCH: 'research'>: 'tasks:reasoning'}
2025-06-28 10:54:14,866 - services.service_manager - INFO - 启动服务: mcp_servers
2025-06-28 10:54:14,866 - services.mcp_server_launcher - INFO - 正在启动MCP服务器...
2025-06-28 10:54:14,866 - services.mcp_server_launcher - INFO - 正在并行启动 4 个MCP服务器...
2025-06-28 10:54:14,866 - core.dispatcher_enhanced - INFO - 启动任务处理协调器...
2025-06-28 10:54:14,866 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 10:54:14,866 - websockets.server - INFO - server listening on 0.0.0.0:8081
2025-06-28 10:54:14,866 - core.toolscore.mcp_server - INFO - [toolscore] Initializing UnifiedToolLibrary...
2025-06-28 10:54:14,866 - core.toolscore.core_manager - INFO - 🚀 正在初始化增强的CoreManager...
2025-06-28 10:54:14,866 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:54:14,866 - core.toolscore.core_manager - INFO - 🔄 使用v2.0服务容器架构初始化...
2025-06-28 10:54:14,866 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 10:54:14,866 - core.toolscore.enhanced_core_manager_v2 - INFO - 🚀 初始化增强核心管理器 v2.0...
2025-06-28 10:54:14,866 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 10:54:14,866 - core.toolscore.service_container.mcp_service_container - INFO - 🚀 开始初始化MCP服务容器...
2025-06-28 10:54:14,866 - core.toolscore.service_container.mcp_service_container - INFO - 🔍 发现内置MCP服务...
2025-06-28 10:54:14,866 - core.toolscore.service_container.builtin_discovery - INFO - 🔍 开始发现内置MCP服务: mcp_servers
2025-06-28 10:54:14,866 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 10:54:14,866 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 10:54:14,867 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 10:54:14,867 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 10:54:14,867 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 10:54:14,867 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:54:14,867 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 10:54:14,867 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: Search Tool MCP Server
2025-06-28 10:54:14,867 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 10:54:14,867 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:54:14,870 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: MicroSandbox MCP Server
2025-06-28 10:54:14,870 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 跳过 __pycache__: 缺少main.py文件
2025-06-28 10:54:14,870 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 71310)
2025-06-28 10:54:14,870 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 10:54:14,871 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:54:14,871 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:54:14,871 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 10:54:14,871 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: Browser Use MCP Server
2025-06-28 10:54:14,871 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:54:14,871 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 10:54:14,871 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 10:54:14,871 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: DeepSearch MCP Server
2025-06-28 10:54:14,871 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 10:54:14,871 - core.toolscore.service_container.builtin_discovery - INFO - 🎯 内置服务发现完成，共发现 4 个服务
2025-06-28 10:54:14,871 - core.toolscore.service_container.builtin_discovery - INFO - 📝 创建服务配置文件...
2025-06-28 10:54:14,871 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 10:54:14,871 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/search_tool_server/service.json
2025-06-28 10:54:14,871 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 10:54:14,871 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/microsandbox_server/service.json
2025-06-28 10:54:14,871 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/browser_use_server/service.json
2025-06-28 10:54:14,871 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/deepsearch_server/service.json
2025-06-28 10:54:14,871 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 发现 4 个内置服务
2025-06-28 10:54:14,871 - core.toolscore.service_container.mcp_service_container - INFO - 📂 加载已安装的外部服务...
2025-06-28 10:54:14,872 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 10:54:14,872 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:54:14,872 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 加载 0 个外部服务
2025-06-28 10:54:14,872 - core.toolscore.service_container.mcp_service_container - INFO - 📋 构建统一服务目录...
2025-06-28 10:54:14,872 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 服务目录构建完成，共 4 个服务
2025-06-28 10:54:14,872 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 10:54:14,872 - core.toolscore.service_container.mcp_service_container - INFO - 📋 标记内置服务为启动中状态...
2025-06-28 10:54:14,872 - core.toolscore.service_container.mcp_service_container - INFO - 📋 已标记 4 个内置服务为启动中状态
2025-06-28 10:54:14,872 - core.toolscore.service_container.service_monitor - INFO - 🔍 启动服务监控...
2025-06-28 10:54:14,872 - core.toolscore.service_container.mcp_service_container - INFO - ✅ MCP服务容器初始化完成
2025-06-28 10:54:14,872 - core.toolscore.enhanced_core_manager_v2 - INFO - ✅ 增强核心管理器 v2.0 初始化完成
2025-06-28 10:54:14,872 - core.toolscore.core_manager - INFO - ✅ v2.0架构初始化完成
2025-06-28 10:54:14,872 - core.toolscore.tool_registry - INFO - Tool registry initialized
2025-06-28 10:54:14,872 - core.llm_client - DEBUG - Enriched config with environment variables: ['provider', 'gemini_api_key', 'gemini_api_url']
2025-06-28 10:54:14,872 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 10:54:14,872 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 10:54:14,872 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 10:54:14,872 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:54:14,875 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 71311)
2025-06-28 10:54:14,876 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 10:54:14,891 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: browser_use_server
2025-06-28 10:54:14,891 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:54:14,891 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: browser_use_server
2025-06-28 10:54:14,891 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server
2025-06-28 10:54:14,891 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) = True
2025-06-28 10:54:14,891 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) = True
2025-06-28 10:54:14,891 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) contents: ['service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 10:54:14,891 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server/main.py
2025-06-28 10:54:14,892 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:54:14,892 - services.mcp_server_launcher - INFO - [MCP启动器] 为 browser_use_server 使用配置文件指定端口: 8084
2025-06-28 10:54:14,892 - services.mcp_server_launcher - INFO - [MCP启动器] 为 browser_use_server 使用配置文件指定端口: 8084
2025-06-28 10:54:14,892 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 BROWSER_USE_SERVER_PORT=8084 给 browser_use_server
2025-06-28 10:54:14,892 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.browser_use_server.main
2025-06-28 10:54:14,892 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:54:14,896 - services.mcp_server_launcher - INFO - MCP服务器已启动: browser_use_server (PID: 71312)
2025-06-28 10:54:14,896 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 browser_use_server 就绪状态...
2025-06-28 10:54:14,897 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 10:54:14,897 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:54:14,897 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 10:54:14,897 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 10:54:14,897 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 10:54:14,897 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 10:54:14,898 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 10:54:14,898 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 10:54:14,898 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:54:14,898 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 10:54:14,898 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 10:54:14,898 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 10:54:14,898 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 10:54:14,898 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:54:14,901 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 71313)
2025-06-28 10:54:14,901 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 10:54:14,902 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第1次, 5s间隔)
2025-06-28 10:54:14,903 - core.monitoring.queue_monitor - INFO - 启动队列监控器...
2025-06-28 10:54:14,906 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 10:54:14,906 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 10:54:14,906 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 10:54:14,906 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 10:54:14,906 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 10:54:14,906 - websockets.client - DEBUG - > Sec-WebSocket-Key: HQNcMIFHu/E11JndxpOvfA==
2025-06-28 10:54:14,906 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 10:54:14,906 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:54:14,906 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:54:14,907 - websockets.client - DEBUG - > EOF
2025-06-28 10:54:14,907 - websockets.client - DEBUG - < EOF
2025-06-28 10:54:14,907 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 10:54:14,907 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 10:54:14,908 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 10:54:14,908 - websockets.client - DEBUG - > Host: localhost:8084
2025-06-28 10:54:14,908 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 10:54:14,908 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 10:54:14,908 - websockets.client - DEBUG - > Sec-WebSocket-Key: M850wVtm8G8KJ1RN2TJFaw==
2025-06-28 10:54:14,908 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 10:54:14,908 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:54:14,908 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:54:14,908 - websockets.client - DEBUG - > EOF
2025-06-28 10:54:14,908 - websockets.client - DEBUG - < EOF
2025-06-28 10:54:14,909 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 10:54:14,911 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 10:54:14,911 - services.mcp_server_launcher - DEBUG - 📋 browser_use_server 端口 8084 尚未就绪
2025-06-28 10:54:14,913 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 10:54:14,928 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 10:54:14,928 - core.toolscore.tool_gap_detector - INFO - 智能工具缺口检测器初始化 - 统一版本
2025-06-28 10:54:14,929 - core.toolscore.dynamic_mcp_manager - INFO - Dynamic MCP Manager initialized (ProcessRunner mode)
2025-06-28 10:54:14,929 - core.toolscore.dynamic_mcp_manager - INFO - 启动动态MCP管理器...
2025-06-28 10:54:14,929 - core.toolscore.dynamic_mcp_manager - INFO - 持久化配置为空，无需恢复外部MCP服务器
2025-06-28 10:54:14,929 - core.toolscore.dynamic_mcp_manager - INFO - 动态MCP管理器启动完成
2025-06-28 10:54:14,929 - core.toolscore.mcp_search_tool - INFO - ✅ MCP Search Tool initialized - 优化版本，包含失败工具跟踪
2025-06-28 10:54:14,929 - core.toolscore.unified_tool_library - INFO - Tool library initialization completed - 核心管理器模式
2025-06-28 10:54:14,929 - core.toolscore.mcp_server - INFO - [toolscore] UnifiedToolLibrary initialized.
2025-06-28 10:54:14,930 - core.toolscore.mcp_server - INFO - [toolscore] Auto-registering MCP servers...
2025-06-28 10:54:14,930 - core.toolscore.mcp_auto_registration - INFO - 🔍 开始自动发现和注册MCP服务器...
2025-06-28 10:54:14,930 - core.toolscore.mcp_auto_registration - DEBUG - ⚠️ 服务器目录 __pycache__ 缺少 service.json
2025-06-28 10:54:14,930 - core.toolscore.mcp_auto_registration - INFO - 🎯 发现 4 个MCP服务器
2025-06-28 10:54:14,944 - core.unified_tool_manager - DEBUG - ✅ 配置验证通过
2025-06-28 10:54:14,944 - core.unified_tool_manager - INFO - 🔄 成功加载工具配置: 4 个标准工具
2025-06-28 10:54:14,944 - core.unified_tool_manager - DEBUG -    - 标准工具ID: ['browser_use', 'deepsearch', 'mcp-search-tool', 'microsandbox']
2025-06-28 10:54:14,944 - core.unified_tool_manager - DEBUG -    - 兼容映射: 13 个变体
2025-06-28 10:54:14,944 - core.unified_tool_manager - INFO - ✅ 统一工具管理器初始化完成，管理 4 个工具
2025-06-28 10:54:14,944 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: mcp-search-tool
2025-06-28 10:54:14,944 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: Search Tool MCP Server (ID: mcp-search-tool)
2025-06-28 10:54:14,944 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: Search Tool MCP Server (ID: mcp-search-tool)
2025-06-28 10:54:14,944 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: Search Tool MCP Server
2025-06-28 10:54:14,944 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8080/websocket
2025-06-28 10:54:14,944 - core.toolscore.mcp_connector - INFO - Registered MCP server mcp-search-tool at ws://localhost:8080/websocket
2025-06-28 10:54:14,944 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: mcp-search-tool -> ws://localhost:8080/websocket
2025-06-28 10:54:14,944 - core.toolscore.core_manager - INFO - 工具立即可用: mcp-search-tool
2025-06-28 10:54:14,944 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: mcp-search-tool
2025-06-28 10:54:14,944 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: microsandbox
2025-06-28 10:54:14,944 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: MicroSandbox MCP Server (ID: microsandbox)
2025-06-28 10:54:14,944 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: MicroSandbox MCP Server (ID: microsandbox)
2025-06-28 10:54:14,944 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: MicroSandbox MCP Server
2025-06-28 10:54:14,944 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8090/websocket
2025-06-28 10:54:14,944 - core.toolscore.mcp_connector - INFO - Registered MCP server microsandbox at ws://localhost:8090/websocket
2025-06-28 10:54:14,944 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: microsandbox -> ws://localhost:8090/websocket
2025-06-28 10:54:14,944 - core.toolscore.core_manager - INFO - 工具立即可用: microsandbox
2025-06-28 10:54:14,944 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: microsandbox
2025-06-28 10:54:14,944 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: browser_use
2025-06-28 10:54:14,944 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: Browser Use MCP Server (ID: browser_use)
2025-06-28 10:54:14,944 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: Browser Use MCP Server (ID: browser_use)
2025-06-28 10:54:14,944 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: Browser Use MCP Server
2025-06-28 10:54:14,944 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8084/websocket
2025-06-28 10:54:14,944 - core.toolscore.mcp_connector - INFO - Registered MCP server browser_use at ws://localhost:8084/websocket
2025-06-28 10:54:14,944 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: browser_use -> ws://localhost:8084/websocket
2025-06-28 10:54:14,944 - core.toolscore.core_manager - INFO - 工具立即可用: browser_use
2025-06-28 10:54:14,944 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: browser_use
2025-06-28 10:54:14,944 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: deepsearch
2025-06-28 10:54:14,944 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: DeepSearch MCP Server (ID: deepsearch)
2025-06-28 10:54:14,944 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: DeepSearch MCP Server (ID: deepsearch)
2025-06-28 10:54:14,944 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: DeepSearch MCP Server
2025-06-28 10:54:14,944 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8086/websocket
2025-06-28 10:54:14,944 - core.toolscore.mcp_connector - INFO - Registered MCP server deepsearch at ws://localhost:8086/websocket
2025-06-28 10:54:14,944 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: deepsearch -> ws://localhost:8086/websocket
2025-06-28 10:54:14,944 - core.toolscore.core_manager - INFO - 工具立即可用: deepsearch
2025-06-28 10:54:14,944 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: deepsearch
2025-06-28 10:54:14,944 - core.toolscore.mcp_auto_registration - INFO - 📊 MCP服务器注册完成: 4/4 成功
2025-06-28 10:54:14,944 - core.toolscore.mcp_server - INFO - [toolscore] All MCP servers registered successfully.
2025-06-28 10:54:14,944 - core.toolscore.mcp_server - INFO - toolscore MCP Server started successfully on 0.0.0.0:8081 (Original endpoint: ws://0.0.0.0:8081/websocket) with ping_interval=30, ping_timeout=60
2025-06-28 10:54:14,944 - core.toolscore.mcp_server - INFO - toolscore MCP Server started event set.
2025-06-28 10:54:14,945 - core.toolscore.service_container.service_monitor - INFO - 🔄 开始服务监控循环，检查间隔: 30秒
2025-06-28 10:54:14,963 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [browser_use] BrowserUse logging setup complete with level info
2025-06-28 10:54:15,384 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [root] Anonymized telemetry enabled. See https://docs.browser-use.com/development/telemetry for more information.
2025-06-28 10:54:15,472 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:54:15,472 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:54:15,514 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 10:54:15,514 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 10:54:15,514 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 10:54:15,514 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 10:54:15,514 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 10:54:15,514 - websockets.client - DEBUG - > Sec-WebSocket-Key: EFPMvrOXd04uGls/esAJsw==
2025-06-28 10:54:15,514 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 10:54:15,514 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:54:15,514 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:54:15,514 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 10:54:15,514 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 10:54:15,515 - websockets.client - DEBUG - > Host: localhost:8084
2025-06-28 10:54:15,515 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 10:54:15,515 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 10:54:15,515 - websockets.client - DEBUG - > Sec-WebSocket-Key: OAM8cyCIe5c4OC/SGg/qhA==
2025-06-28 10:54:15,515 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 10:54:15,515 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:54:15,515 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:54:15,515 - websockets.client - DEBUG - > EOF
2025-06-28 10:54:15,515 - websockets.client - DEBUG - < EOF
2025-06-28 10:54:15,515 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 10:54:15,515 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 10:54:15,515 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 10:54:15,515 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 10:54:15,515 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 10:54:15,515 - websockets.client - DEBUG - < Sec-WebSocket-Accept: g8MAKos/81AjJxZDJ0KuWsFFN4A=
2025-06-28 10:54:15,515 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:54:15,515 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 02:54:15 GMT
2025-06-28 10:54:15,515 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 10:54:15,515 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 10:54:15,515 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 10:54:15,516 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:54:15,516 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 10:54:15,516 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:54:15,516 - websockets.client - DEBUG - < EOF
2025-06-28 10:54:15,516 - websockets.client - DEBUG - > EOF
2025-06-28 10:54:15,516 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 10:54:15,516 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 10:54:15,517 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.llm_client] Initialized LLM client with provider: gemini
2025-06-28 10:54:15,517 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Browser-Use server initialized with LLM provider: gemini
2025-06-28 10:54:15,517 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 10:54:15,517 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 使用动态分配端口: 8084
2025-06-28 10:54:15,517 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 10:54:15,517 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] BrowserUseMCPServer initialized:
2025-06-28 10:54:15,517 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Server Name: browser_use_server
2025-06-28 10:54:15,517 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Server ID: browser_use
2025-06-28 10:54:15,517 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Listen Host: 0.0.0.0
2025-06-28 10:54:15,517 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Listen Port: 8084
2025-06-28 10:54:15,517 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Public Endpoint: ws://localhost:8084
2025-06-28 10:54:15,517 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 10:54:15,517 - services.mcp_server_launcher - DEBUG - 📋 browser_use_server 端口 8084 尚未就绪
2025-06-28 10:54:15,518 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Starting browser_use_server...
2025-06-28 10:54:15,518 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Attempting to start MCPServer for browser_use_server at ws://localhost:8084...
2025-06-28 10:54:15,518 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Attempting to start browser_use_server MCP Server on localhost:8084
2025-06-28 10:54:15,518 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] server listening on 127.0.0.1:8084
2025-06-28 10:54:15,518 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] server listening on [::1]:8084
2025-06-28 10:54:15,518 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] browser_use_server MCP Server started successfully on localhost:8084 (Original endpoint: ws://localhost:8084) with ping_interval=30, ping_timeout=60
2025-06-28 10:54:15,518 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 10:54:15,518 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 10:54:15,518 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 10:54:16,193 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:54:16,193 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:54:16,240 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 10:54:16,240 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 10:54:16,240 - websockets.client - DEBUG - > Host: localhost:8084
2025-06-28 10:54:16,240 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 10:54:16,240 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 10:54:16,240 - websockets.client - DEBUG - > Sec-WebSocket-Key: 8yU0oIh85sddTlXTGoZU2Q==
2025-06-28 10:54:16,240 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 10:54:16,240 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:54:16,240 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:54:16,240 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection open
2025-06-28 10:54:16,240 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Client connected to browser_use_server MCP Server at path /: ('127.0.0.1', 59998)
2025-06-28 10:54:16,240 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 10:54:16,240 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 10:54:16,241 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 10:54:16,241 - websockets.client - DEBUG - < Sec-WebSocket-Accept: 2Y6e16wmo4YneI0iQU4y5KuwD00=
2025-06-28 10:54:16,241 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:54:16,241 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 02:54:16 GMT
2025-06-28 10:54:16,241 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 10:54:16,241 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 10:54:16,241 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 10:54:16,241 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:54:16,241 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 10:54:16,241 - services.mcp_server_launcher - DEBUG - [browser_use_server] WARNING  [core.toolscore.mcp_server] Unknown request type or server role mismatch: ping
2025-06-28 10:54:16,241 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 10:54:16,241 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:54:16,241 - websockets.client - DEBUG - < EOF
2025-06-28 10:54:16,241 - websockets.client - DEBUG - > EOF
2025-06-28 10:54:16,241 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 10:54:16,241 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 10:54:16,241 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 10:54:16,241 - services.mcp_server_launcher - DEBUG - ✅ browser_use_server 特定就绪检查通过
2025-06-28 10:54:16,241 - services.mcp_server_launcher - INFO - ✅ browser_use_server 已就绪
2025-06-28 10:54:16,519 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 10:54:17,059 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:54:17,059 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:54:18,097 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:54:18,097 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:54:19,342 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:54:19,342 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:54:19,904 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第2次, 5s间隔)
2025-06-28 10:54:20,837 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:54:20,837 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:54:22,629 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:54:22,629 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:54:24,780 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:54:24,780 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:54:24,905 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第3次, 5s间隔)
2025-06-28 10:54:25,064 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 10:54:25,064 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 10:54:25,064 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 10:54:25,064 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 10:54:25,064 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 10:54:25,064 - websockets.server - DEBUG - < Sec-WebSocket-Key: Vk4Y28b4xlDKntB8K8fCCg==
2025-06-28 10:54:25,064 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 10:54:25,064 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:54:25,064 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:54:25,064 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 10:54:25,064 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 10:54:25,064 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 10:54:25,064 - websockets.server - DEBUG - > Sec-WebSocket-Accept: CwXZVHQC58VTouVsshyADIW7iZY=
2025-06-28 10:54:25,064 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:54:25,064 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 02:54:25 GMT
2025-06-28 10:54:25,064 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 10:54:25,064 - websockets.server - INFO - connection open
2025-06-28 10:54:25,064 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 10:54:25,064 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 60008)
2025-06-28 10:54:25,065 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "26866d...onnection_params": {}}}' [2376 bytes]
2025-06-28 10:54:25,065 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: search_tool_server (ID: mcp-search-tool)
2025-06-28 10:54:25,065 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: search_tool_server
2025-06-28 10:54:25,065 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: mcp-search-tool -> ws://localhost:8080/mcp
2025-06-28 10:54:25,065 - core.toolscore.core_manager - INFO - 工具立即可用: mcp-search-tool
2025-06-28 10:54:25,065 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 10:54:25,066 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:54:25,066 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 10:54:25,066 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:54:25,066 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 10:54:25,066 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 10:54:25,066 - websockets.server - INFO - connection closed
2025-06-28 10:54:25,161 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 10:54:25,162 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 10:54:25,162 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 10:54:25,162 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 10:54:25,162 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 10:54:25,162 - websockets.server - DEBUG - < Sec-WebSocket-Key: TlEKndGBBoPMgI1YTX87iQ==
2025-06-28 10:54:25,162 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 10:54:25,162 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:54:25,162 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:54:25,162 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 10:54:25,162 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 10:54:25,162 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 10:54:25,162 - websockets.server - DEBUG - > Sec-WebSocket-Accept: eqO3ekwBtTgunp47c4aUU0TuFpY=
2025-06-28 10:54:25,162 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:54:25,162 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 02:54:25 GMT
2025-06-28 10:54:25,162 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 10:54:25,162 - websockets.server - INFO - connection open
2025-06-28 10:54:25,162 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 10:54:25,162 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 60010)
2025-06-28 10:54:25,163 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "f406bf...onnection_params": {}}}' [3263 bytes]
2025-06-28 10:54:25,163 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: microsandbox_server (ID: microsandbox)
2025-06-28 10:54:25,163 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: microsandbox_server
2025-06-28 10:54:25,163 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: microsandbox -> ws://localhost:8090
2025-06-28 10:54:25,163 - core.toolscore.core_manager - INFO - 工具立即可用: microsandbox
2025-06-28 10:54:25,163 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 10:54:25,163 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:54:25,163 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 10:54:25,163 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:54:25,163 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 10:54:25,163 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 10:54:25,164 - websockets.server - INFO - connection closed
2025-06-28 10:54:25,220 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 10:54:25,220 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 10:54:25,220 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 10:54:25,220 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 10:54:25,220 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 10:54:25,220 - websockets.server - DEBUG - < Sec-WebSocket-Key: azYtuHdzSoJ2PL50XKCxwQ==
2025-06-28 10:54:25,220 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 10:54:25,220 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:54:25,220 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:54:25,220 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 10:54:25,220 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 10:54:25,220 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 10:54:25,220 - websockets.server - DEBUG - > Sec-WebSocket-Accept: hTx2/ElaERI1C3kU2MZpkWhhogA=
2025-06-28 10:54:25,220 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:54:25,220 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 02:54:25 GMT
2025-06-28 10:54:25,220 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 10:54:25,220 - websockets.server - INFO - connection open
2025-06-28 10:54:25,220 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 10:54:25,220 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 60012)
2025-06-28 10:54:25,221 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "8394e2...onnection_params": {}}}' [2313 bytes]
2025-06-28 10:54:25,221 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: deepsearch_server (ID: deepsearch)
2025-06-28 10:54:25,221 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: deepsearch_server
2025-06-28 10:54:25,221 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: deepsearch -> ws://localhost:8086/mcp
2025-06-28 10:54:25,221 - core.toolscore.core_manager - INFO - 工具立即可用: deepsearch
2025-06-28 10:54:25,221 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 10:54:25,221 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:54:25,221 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 10:54:25,221 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:54:25,221 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 10:54:25,222 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 10:54:25,222 - websockets.server - INFO - connection closed
2025-06-28 10:54:25,519 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 10:54:25,520 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 10:54:25,520 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 10:54:25,520 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 10:54:25,520 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 10:54:25,520 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 10:54:25,520 - websockets.server - DEBUG - < Sec-WebSocket-Key: 2icm+4qAVNaL2wC5jXueCg==
2025-06-28 10:54:25,520 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 10:54:25,520 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:54:25,520 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:54:25,520 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 10:54:25,520 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 10:54:25,520 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 10:54:25,520 - websockets.server - DEBUG - > Sec-WebSocket-Accept: sYbqXLHadvoyI1EvfdYnjlog+ms=
2025-06-28 10:54:25,520 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:54:25,520 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 02:54:25 GMT
2025-06-28 10:54:25,520 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 10:54:25,520 - websockets.server - INFO - connection open
2025-06-28 10:54:25,520 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 10:54:25,520 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 60018)
2025-06-28 10:54:25,520 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 10:54:25,521 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "b3f321c1-d351-4db8-b2b7-d4cceb31632f", "tool_spec": {"tool_id": "browser_use", "name": "browser_use_server", "description": "\u57fa\u4e8eBrowser-Use\u7684AI\u6d4f\u89c8\u5668\u81ea\u52a8\u5316\u670d\u52a1\u5668\uff0c\u5b8c\u6574\u5b9e\u73b0browser-use\u7684\u6240\u6709\u529f\u80fd", "tool_type": "mcp_server", "capabilities": [{"name": "browser_use_execute_task", "description": "\u4f7f\u7528AI\u6267\u884c\u590d\u6742\u7684\u6d4f\u89c8\u5668\u4efb\u52a1\uff0c\u652f\u6301\u81ea\u7136\u8bed\u8a00\u63cf\u8ff0", "parameters": {"task": {"type": "string", "description": "\u8981\u6267\u884c\u7684\u4efb\u52a1\u63cf\u8ff0\uff0c\u4f7f\u7528\u81ea\u7136\u8bed\u8a00", "required": true}, "max_steps": {"type": "integer", "description": "\u6700\u5927\u6267\u884c\u6b65\u9aa4\u6570\uff0c\u9ed8\u8ba450", "required": false}, "use_vision": {"type": "boolean", "description": "\u662f\u5426\u4f7f\u7528\u89c6\u89c9\u7406\u89e3\uff0c\u9ed8\u8ba4true", "required": false}}, "examples": [{"task": "\u641c\u7d22Python\u6559\u7a0b\u5e76\u6253\u5f00\u7b2c\u4e00\u4e2a\u7ed3\u679c"}, {"task": "\u5728GitHub\u4e0a\u641c\u7d22browser-use\u9879\u76ee\u5e76\u67e5\u770bREADME"}, {"task": "\u767b\u5f55\u7f51\u7ad9\u5e76\u586b\u5199\u8868\u5355", "use_vision": true}], "category": "general"}, {"name": "browser_navigate", "description": "\u5bfc\u822a\u5230\u6307\u5b9a\u7f51\u5740", "parameters": {"url": {"type": "string", "description": "\u8981\u8bbf\u95ee\u7684URL\u5730\u5740", "required": true}}, "examples": [{"url": "https://www.google.com"}, {"url": "https://github.com"}], "category": "general"}, {"name": "browser_search_google", "description": "\u5728Google\u4e2d\u641c\u7d22\u6307\u5b9a\u67e5\u8be2", "parameters": {"query": {"type": "string", "description": "\u641c\u7d22\u67e5\u8be2\u8bcd", "required": true}}, "examples": [{"query": "Python machine learning tutorial"}, {"query": "browser automation tools"}], "category": "general"}, {"name": "browser_go_back", "description": "\u8fd4\u56de\u4e0a\u4e00\u9875", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_click_element", "description": "\u901a\u8fc7\u7d22\u5f15\u70b9\u51fb\u9875\u9762\u5143\u7d20", "parameters": {"index": {"type": "integer", "description": "\u8981\u70b9\u51fb\u7684\u5143\u7d20\u7d22\u5f15", "required": true}}, "examples": [{"index": 1}, {"index": 5}], "category": "general"}, {"name": "browser_input_text", "description": "\u5728\u6307\u5b9a\u5143\u7d20\u4e2d\u8f93\u5165\u6587\u672c", "parameters": {"index": {"type": "integer", "description": "\u8981\u8f93\u5165\u6587\u672c\u7684\u5143\u7d20\u7d22\u5f15", "required": true}, "text": {"type": "string", "description": "\u8981\u8f93\u5165\u7684\u6587\u672c", "required": true}}, "examples": [{"index": 2, "text": "hello world"}, {"index": 0, "text": "test@example.com"}], "category": "general"}, {"name": "browser_send_keys", "description": "\u53d1\u9001\u7279\u6b8a\u952e\u6216\u5feb\u6377\u952e", "parameters": {"keys": {"type": "string", "description": "\u8981\u53d1\u9001\u7684\u952e\uff0c\u5982Enter\u3001Escape\u3001Control+c\u7b49", "required": true}}, "examples": [{"keys": "Enter"}, {"keys": "Control+c"}, {"keys": "Escape"}], "category": "general"}, {"name": "browser_scroll_down", "description": "\u5411\u4e0b\u6eda\u52a8\u9875\u9762", "parameters": {"amount": {"type": "integer", "description": "\u6eda\u52a8\u50cf\u7d20\u6570\uff0c\u4e0d\u6307\u5b9a\u5219\u6eda\u52a8\u4e00\u9875", "required": false}}, "examples": [{}, {"amount": 500}], "category": "general"}, {"name": "browser_scroll_up", "description": "\u5411\u4e0a\u6eda\u52a8\u9875\u9762", "parameters": {"amount": {"type": "integer", "description": "\u6eda\u52a8\u50cf\u7d20\u6570\uff0c\u4e0d\u6307\u5b9a\u5219\u6eda\u52a8\u4e00\u9875", "required": false}}, "examples": [{}, {"amount": 300}], "category": "general"}, {"name": "browser_scroll_to_text", "description": "\u6eda\u52a8\u5230\u5305\u542b\u6307\u5b9a\u6587\u672c\u7684\u5143\u7d20", "parameters": {"text": {"type": "string", "description": "\u8981\u6eda\u52a8\u5230\u7684\u6587\u672c\u5185\u5bb9", "required": true}}, "examples": [{"text": "Sign up"}, {"text": "Contact us"}], "category": "general"}, {"name": "browser_switch_tab", "description": "\u5207\u6362\u5230\u6307\u5b9a\u6807\u7b7e", "parameters": {"page_id": {"type": "integer", "description": "\u8981\u5207\u6362\u5230\u7684\u6807\u7b7eID", "required": true}}, "examples": [{"page_id": 0}, {"page_id": 1}], "category": "general"}, {"name": "browser_open_tab", "description": "\u5728\u65b0\u6807\u7b7e\u4e2d\u6253\u5f00URL", "parameters": {"url": {"type": "string", "description": "\u8981\u5728\u65b0\u6807\u7b7e\u4e2d\u6253\u5f00\u7684URL", "required": true}}, "examples": [{"url": "https://www.example.com"}], "category": "general"}, {"name": "browser_close_tab", "description": "\u5173\u95ed\u6307\u5b9a\u6807\u7b7e", "parameters": {"page_id": {"type": "integer", "description": "\u8981\u5173\u95ed\u7684\u6807\u7b7eID", "required": true}}, "examples": [{"page_id": 1}], "category": "general"}, {"name": "browser_extract_content", "description": "\u4ece\u9875\u9762\u63d0\u53d6\u7279\u5b9a\u5185\u5bb9", "parameters": {"goal": {"type": "string", "description": "\u63d0\u53d6\u76ee\u6807\u63cf\u8ff0", "required": true}, "include_links": {"type": "boolean", "description": "\u662f\u5426\u5305\u542b\u94fe\u63a5\uff0c\u9ed8\u8ba4false", "required": false}}, "examples": [{"goal": "\u63d0\u53d6\u6240\u6709\u516c\u53f8\u540d\u79f0"}, {"goal": "\u83b7\u53d6\u4ea7\u54c1\u4ef7\u683c\u4fe1\u606f", "include_links": true}], "category": "general"}, {"name": "browser_get_content", "description": "\u83b7\u53d6\u9875\u9762\u5185\u5bb9", "parameters": {"selector": {"type": "string", "description": "CSS\u9009\u62e9\u5668\uff0c\u7a7a\u5219\u83b7\u53d6\u5168\u90e8\u5185\u5bb9", "required": false}}, "examples": [{"selector": "h1, p"}, {}], "category": "general"}, {"name": "browser_get_ax_tree", "description": "\u83b7\u53d6\u9875\u9762\u7684\u53ef\u8bbf\u95ee\u6027\u6811\u7ed3\u6784", "parameters": {"number_of_elements": {"type": "integer", "description": "\u8fd4\u56de\u7684\u5143\u7d20\u6570\u91cf", "required": true}}, "examples": [{"number_of_elements": 50}], "category": "general"}, {"name": "browser_get_dropdown_options", "description": "\u83b7\u53d6\u4e0b\u62c9\u83dc\u5355\u7684\u6240\u6709\u9009\u9879", "parameters": {"index": {"type": "integer", "description": "\u4e0b\u62c9\u83dc\u5355\u5143\u7d20\u7684\u7d22\u5f15", "required": true}}, "examples": [{"index": 3}], "category": "general"}, {"name": "browser_select_dropdown_option", "description": "\u9009\u62e9\u4e0b\u62c9\u83dc\u5355\u4e2d\u7684\u9009\u9879", "parameters": {"index": {"type": "integer", "description": "\u4e0b\u62c9\u83dc\u5355\u5143\u7d20\u7684\u7d22\u5f15", "required": true}, "text": {"type": "string", "description": "\u8981\u9009\u62e9\u7684\u9009\u9879\u6587\u672c", "required": true}}, "examples": [{"index": 3, "text": "Option 1"}], "category": "general"}, {"name": "browser_drag_drop", "description": "\u6267\u884c\u62d6\u62fd\u64cd\u4f5c", "parameters": {"element_source": {"type": "string", "description": "\u6e90\u5143\u7d20\u9009\u62e9\u5668", "required": false}, "element_target": {"type": "string", "description": "\u76ee\u6807\u5143\u7d20\u9009\u62e9\u5668", "required": false}, "coord_source_x": {"type": "integer", "description": "\u6e90\u5750\u6807X", "required": false}, "coord_source_y": {"type": "integer", "description": "\u6e90\u5750\u6807Y", "required": false}, "coord_target_x": {"type": "integer", "description": "\u76ee\u6807\u5750\u6807X", "required": false}, "coord_target_y": {"type": "integer", "description": "\u76ee\u6807\u5750\u6807Y", "required": false}, "steps": {"type": "integer", "description": "\u62d6\u62fd\u6b65\u9aa4\u6570\uff0c\u9ed8\u8ba410", "required": false}}, "examples": [{"element_source": ".item1", "element_target": ".dropzone"}], "category": "general"}, {"name": "browser_save_pdf", "description": "\u5c06\u5f53\u524d\u9875\u9762\u4fdd\u5b58\u4e3aPDF", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_screenshot", "description": "\u622a\u53d6\u5f53\u524d\u9875\u9762\u622a\u56fe", "parameters": {"filename": {"type": "string", "description": "\u622a\u56fe\u6587\u4ef6\u540d\uff0c\u53ef\u9009", "required": false}}, "examples": [{"filename": "current_page.png"}, {}], "category": "general"}, {"name": "browser_wait", "description": "\u7b49\u5f85\u6307\u5b9a\u79d2\u6570", "parameters": {"seconds": {"type": "number", "description": "\u7b49\u5f85\u7684\u79d2\u6570\uff0c\u9ed8\u8ba43", "required": false}}, "examples": [{"seconds": 5}, {}], "category": "general"}, {"name": "browser_done", "description": "\u6807\u8bb0\u4efb\u52a1\u5b8c\u6210", "parameters": {"text": {"type": "string", "description": "\u5b8c\u6210\u63cf\u8ff0", "required": true}, "success": {"type": "boolean", "description": "\u662f\u5426\u6210\u529f\u5b8c\u6210", "required": true}}, "examples": [{"text": "\u4efb\u52a1\u5df2\u5b8c\u6210", "success": true}], "category": "general"}, {"name": "browser_get_page_info", "description": "\u83b7\u53d6\u5f53\u524d\u9875\u9762\u4fe1\u606f", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_get_current_url", "description": "\u83b7\u53d6\u5f53\u524d\u9875\u9762URL", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_close_session", "description": "\u5173\u95ed\u6d4f\u89c8\u5668\u4f1a\u8bdd", "parameters": {}, "examples": [{}], "category": "general"}], "endpoint": "ws://localhost:8084", "connection_params": {}}}
2025-06-28 10:54:25,521 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "b3f321...onnection_params": {}}}' [9625 bytes]
2025-06-28 10:54:25,521 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Waiting for registration response from toolscore...
2025-06-28 10:54:25,521 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: browser_use_server (ID: browser_use)
2025-06-28 10:54:25,521 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: browser_use_server
2025-06-28 10:54:25,521 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: browser_use -> ws://localhost:8084
2025-06-28 10:54:25,521 - core.toolscore.core_manager - INFO - 工具立即可用: browser_use
2025-06-28 10:54:25,521 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 10:54:25,521 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Received registration response: {"type": "register_tool_response", "request_id": "b3f321c1-d351-4db8-b2b7-d4cceb31632f", "success": true, "message": null}
2025-06-28 10:54:25,521 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Successfully registered with toolscore.
2025-06-28 10:54:25,522 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:54:25,522 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 10:54:25,522 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:54:25,522 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 10:54:25,522 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 10:54:25,522 - websockets.server - INFO - connection closed
2025-06-28 10:54:27,362 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:54:27,362 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:54:29,906 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第4次, 5s间隔)
2025-06-28 10:54:30,362 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:54:30,363 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:54:33,364 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:54:33,365 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:54:34,907 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第5次, 5s间隔)
2025-06-28 10:54:36,366 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:54:36,366 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:54:39,367 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:54:39,367 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:54:39,908 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第6次, 5s间隔)
2025-06-28 10:54:42,369 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:54:42,369 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:54:44,878 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 10:54:44,897 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 10:54:44,898 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 10:54:44,898 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 10:54:44,904 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 10:54:44,909 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第7次, 5s间隔)
2025-06-28 10:54:45,370 - services.mcp_server_launcher - DEBUG - ⏱️ microsandbox_server 就绪检测超时 (30秒)
2025-06-28 10:54:45,370 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 10:54:45,370 - services.mcp_server_launcher - INFO - ✅ 成功启动 4/4 个MCP服务器: ['microsandbox_server', 'search_tool_server', 'browser_use_server', 'deepsearch_server']
2025-06-28 10:54:45,370 - services.service_manager - INFO - 启动服务: task_api
2025-06-28 10:54:45,370 - services.task_api_service - INFO - 正在启动任务API服务...
2025-06-28 10:54:45,380 - services.task_api_service - INFO - 任务API服务已启动于 0.0.0.0:8000
2025-06-28 10:54:45,380 - services.service_manager - INFO - 启动服务: runtime
2025-06-28 10:54:45,380 - services.runtime_service - INFO - 正在启动推理运行时服务...
2025-06-28 10:54:45,380 - services.service_manager - INFO - 启动服务: synthesis
2025-06-28 10:54:45,380 - services.synthesis_service - INFO - 正在启动合成服务...
2025-06-28 10:54:45,380 - services.synthesis_service - INFO - 合成服务工作线程已启动
2025-06-28 10:54:45,380 - services.synthesis_service - INFO - SynthesisCore v2.0监控器工作线程已启动
2025-06-28 10:54:45,380 - services.synthesis_service - INFO - 开始处理轨迹数据...
2025-06-28 10:54:45,380 - services.synthesis_service - INFO - 🚀 启动SynthesisCore v2.0监控器
2025-06-28 10:54:45,380 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 10:54:45,380 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 10:54:45,380 - services.synthesis_service - INFO - 合成服务已启动
2025-06-28 10:54:45,380 - core.synthesiscore.synthesis - INFO - 🔄 Processing only unprocessed trajectories...
2025-06-28 10:54:45,381 - services.service_manager - INFO - 所有服务已启动
2025-06-28 10:54:45,381 - __main__ - DEBUG - ✅ 所有服务启动完成
2025-06-28 10:54:45,381 - __main__ - INFO - 🎉 所有服务已启动，系统运行中...
2025-06-28 10:54:45,381 - __main__ - INFO - 📊 系统状态监控已启用，按 Ctrl+C 停止
2025-06-28 10:54:45,381 - services.runtime_service - INFO - 启动运行时实例: enhanced-reasoning-1
2025-06-28 10:54:45,381 - runtimes.reasoning.enhanced_runtime - INFO - 🚀 初始化Enhanced Reasoning Runtime - 简化版本
2025-06-28 10:54:45,381 - core.llm.response_parsers.reasoning_response_parser - DEBUG - ✅ 响应解析器已连接工具Schema管理器
2025-06-28 10:54:45,381 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 工具Schema管理器已注入到响应解析器
2025-06-28 10:54:45,381 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 10:54:45,381 - runtimes.reasoning.enhanced_runtime - INFO - ⏳ 等待ToolScore服务就绪...
2025-06-28 10:54:45,382 - core.synthesiscore.synthesis - INFO - 🎯 Unprocessed trajectories completed: 0 new trajectories processed
2025-06-28 10:54:45,382 - services.synthesis_service - DEBUG - 等待 300 秒后再次处理...
2025-06-28 10:54:45,382 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ Redis连接初始化成功
2025-06-28 10:54:45,382 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:corpus_queue
2025-06-28 10:54:45,382 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:atomic_tasks
2025-06-28 10:54:45,383 - runtimes.reasoning.toolscore_client - INFO - ✅ ToolScore服务已就绪
2025-06-28 10:54:45,383 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:extended_tasks
2025-06-28 10:54:45,383 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:10:54:45 +0800] "GET /health HTTP/1.1" 200 231 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 10:54:45,383 - runtimes.reasoning.enhanced_runtime - INFO - ✅ ToolScore HTTP服务已就绪
2025-06-28 10:54:45,383 - runtimes.reasoning.enhanced_runtime - INFO - 🔌 正在连接WebSocket端点: ws://localhost:8081/websocket
2025-06-28 10:54:45,383 - runtimes.reasoning.real_time_tool_client - INFO - 🔌 连接到ToolScore实时更新: ws://localhost:8081/websocket
2025-06-28 10:54:45,383 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:verification_queue
2025-06-28 10:54:45,383 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:training_data
2025-06-28 10:54:45,384 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:quality_reports
2025-06-28 10:54:45,384 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 10:54:45,384 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 10:54:45,384 - websockets.client - DEBUG - > GET /websocket HTTP/1.1
2025-06-28 10:54:45,384 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ Redis配置键初始化完成
2025-06-28 10:54:45,384 - websockets.client - DEBUG - > Host: localhost:8081
2025-06-28 10:54:45,384 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ 增强合成Redis管理器初始化完成
2025-06-28 10:54:45,384 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 10:54:45,384 - core.synthesiscore.enhanced_synthesis_engine - INFO - ✅ Enhanced Synthesis Engine 初始化完成
2025-06-28 10:54:45,385 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 10:54:45,385 - core.synthesiscore.enhanced_synthesis_engine - INFO - 🚀 SynthesisCore v2.0 已启动
2025-06-28 10:54:45,385 - websockets.client - DEBUG - > Sec-WebSocket-Key: BURRTJnlKRwvulCeZAVgCw==
2025-06-28 10:54:45,385 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 10:54:45,385 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:54:45,385 - websockets.client - DEBUG - > User-Agent: Enhanced-Reasoning-Runtime/1.0
2025-06-28 10:54:45,385 - core.synthesiscore.trajectory_monitor - INFO - 🔄 检查并处理现有轨迹...
2025-06-28 10:54:45,385 - core.synthesiscore.trajectory_monitor - INFO - 📝 没有现有轨迹文件
2025-06-28 10:54:45,385 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 10:54:45,385 - core.synthesiscore.trajectory_monitor - INFO - ✅ TrajectoryMonitor初始化完成
2025-06-28 10:54:45,385 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 10:54:45,385 - core.synthesiscore.trajectory_monitor - DEBUG - ✅ 获取主事件循环引用成功
2025-06-28 10:54:45,385 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 10:54:45,386 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 10:54:45,387 - websockets.server - DEBUG - < Sec-WebSocket-Key: BURRTJnlKRwvulCeZAVgCw==
2025-06-28 10:54:45,387 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 10:54:45,387 - core.synthesiscore.trajectory_monitor - INFO - 👁️ 开始监控轨迹文件变化: output/trajectories
2025-06-28 10:54:45,387 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:54:45,387 - services.synthesis_service - INFO - ✅ SynthesisCore v2.0监控器已启动
2025-06-28 10:54:45,387 - websockets.server - DEBUG - < User-Agent: Enhanced-Reasoning-Runtime/1.0
2025-06-28 10:54:45,387 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 10:54:45,387 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 10:54:45,387 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 10:54:45,387 - websockets.server - DEBUG - > Sec-WebSocket-Accept: zWOyF2Z+akBB3ZmtfW2dDzLJPxY=
2025-06-28 10:54:45,387 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:54:45,387 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 02:54:45 GMT
2025-06-28 10:54:45,387 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 10:54:45,387 - websockets.server - INFO - connection open
2025-06-28 10:54:45,387 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 10:54:45,387 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 60054)
2025-06-28 10:54:45,387 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 10:54:45,387 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 10:54:45,387 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 10:54:45,387 - websockets.client - DEBUG - < Sec-WebSocket-Accept: zWOyF2Z+akBB3ZmtfW2dDzLJPxY=
2025-06-28 10:54:45,387 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:54:45,388 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 02:54:45 GMT
2025-06-28 10:54:45,388 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 10:54:45,388 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 10:54:45,388 - runtimes.reasoning.real_time_tool_client - INFO - ✅ 已连接到ToolScore实时更新流
2025-06-28 10:54:45,388 - runtimes.reasoning.enhanced_runtime - INFO - ✅ WebSocket实时更新连接成功
2025-06-28 10:54:45,388 - runtimes.reasoning.real_time_tool_client - DEBUG - 已注册工具更新回调，当前回调数量: 1
2025-06-28 10:54:45,388 - runtimes.reasoning.enhanced_runtime - INFO - ⏳ 等待关键工具完全就绪...
2025-06-28 10:54:45,388 - runtimes.reasoning.enhanced_runtime - WARNING - 🚀 临时跳过详细工具等待，快速启动模式
2025-06-28 10:54:45,388 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 使用快速启动模式，工具将在后台异步就绪
2025-06-28 10:54:45,388 - runtimes.reasoning.enhanced_runtime - INFO - 🔍 开始MCP服务器同步验证...
2025-06-28 10:54:45,388 - core.tool_schema_manager - INFO - 正在执行MCP同步验证...
2025-06-28 10:54:45,388 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=False)，当前缓存: 0 个工具
2025-06-28 10:54:45,388 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 10:54:45,388 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
2025-06-28 10:54:45,388 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 10:54:45,388 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
[2025-06-28 10:54:45] [32mINFO[0m:     Started server process [[36m71265[0m]
2025-06-28 10:54:45,388 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
[2025-06-28 10:54:45] [32mINFO[0m:     Waiting for application startup.
2025-06-28 10:54:45,388 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 10:54:45,388 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 10:54:45,389 - core.tool_schema_manager - INFO - 🔄 检测到 4 个工具需要更新: ['deepsearch', 'microsandbox', 'browser_use', 'mcp-search-tool']
2025-06-28 10:54:45,389 - core.tool_schema_manager - INFO - 🔄 执行增量更新: 4 个工具
2025-06-28 10:54:45,389 - core.tool_schema_manager - INFO - 🔄 缓存为空，转为全量刷新模式
2025-06-28 10:54:45,389 - core.tool_schema_manager - DEBUG - 🔄 开始增强刷新工具Schemas...
2025-06-28 10:54:45,389 - core.tool_schema_manager - DEBUG - 🔍 工具注册表状态检查: _tools 字典包含 4 个条目
2025-06-28 10:54:45,389 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: deepsearch
2025-06-28 10:54:45,389 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: microsandbox
2025-06-28 10:54:45,389 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: browser_use
2025-06-28 10:54:45,389 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: mcp-search-tool
2025-06-28 10:54:45,389 - core.tool_schema_manager - INFO - 🔧 选项1: 从工具注册表获取到 4 个工具
2025-06-28 10:54:45,389 - core.tool_schema_manager - DEBUG -   工具 0: id=deepsearch, name=网络信息研究工具, actions=3
2025-06-28 10:54:45,389 - core.tool_schema_manager - DEBUG -   工具 1: id=microsandbox, name=MicroSandbox安全代码执行器, actions=7
2025-06-28 10:54:45,389 - core.tool_schema_manager - DEBUG -   工具 2: id=browser_use, name=智能浏览器操作工具, actions=6
2025-06-28 10:54:45,389 - core.tool_schema_manager - DEBUG -   工具 3: id=mcp-search-tool, name=工具管理和项目文件搜索器, actions=4
2025-06-28 10:54:45,389 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: deepsearch
2025-06-28 10:54:45,389 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: comprehensive_research
2025-06-28 10:54:45,390 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: quick_research
2025-06-28 10:54:45,390 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: research
2025-06-28 10:54:45,390 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 deepsearch (包含 3 个动作)
2025-06-28 10:54:45,391 - core.tool_schema_manager - DEBUG -    当前缓存大小: 1 个工具
2025-06-28 10:54:45,391 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: microsandbox
2025-06-28 10:54:45,391 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_cleanup_expired
2025-06-28 10:54:45,391 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_close_session
2025-06-28 10:54:45,391 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_execute
2025-06-28 10:54:45,391 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_health_status
2025-06-28 10:54:45,391 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_performance_stats
2025-06-28 10:54:45,391 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_install_package
2025-06-28 10:54:45,391 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_list_sessions
2025-06-28 10:54:45,392 - core.task_api - INFO - Connected to Redis: redis://localhost:6379
2025-06-28 10:54:45,392 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 microsandbox (包含 7 个动作)
[2025-06-28 10:54:45] [32mINFO[0m:     Application startup complete.
2025-06-28 10:54:45,392 - core.tool_schema_manager - DEBUG -    当前缓存大小: 2 个工具
2025-06-28 10:54:45,392 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: browser_use
2025-06-28 10:54:45,392 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_click_element
2025-06-28 10:54:45,392 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_use_execute_task
2025-06-28 10:54:45,392 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_extract_content
2025-06-28 10:54:45,392 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_input_text
2025-06-28 10:54:45,392 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_navigate
[2025-06-28 10:54:45] [32mINFO[0m:     Uvicorn running on [1mhttp://0.0.0.0:8000[0m (Press CTRL+C to quit)
2025-06-28 10:54:45,392 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_search_google
2025-06-28 10:54:45,393 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 browser_use (包含 6 个动作)
2025-06-28 10:54:45,393 - core.tool_schema_manager - DEBUG -    当前缓存大小: 3 个工具
2025-06-28 10:54:45,393 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: mcp-search-tool
2025-06-28 10:54:45,393 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: analyze_tool_needs
2025-06-28 10:54:45,393 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: list_code_definitions
2025-06-28 10:54:45,393 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_and_install_tools
2025-06-28 10:54:45,393 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_file_content
2025-06-28 10:54:45,393 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 mcp-search-tool (包含 4 个动作)
2025-06-28 10:54:45,393 - core.tool_schema_manager - DEBUG -    当前缓存大小: 4 个工具
2025-06-28 10:54:45,393 - core.tool_schema_manager - INFO - 🔧 选项1: 成功处理 4/4 个工具，当前缓存 4 个工具
2025-06-28 10:54:45,393 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: mcp-search-tool
2025-06-28 10:54:45,394 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: microsandbox
2025-06-28 10:54:45,394 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: browser_use
2025-06-28 10:54:45,394 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: deepsearch
2025-06-28 10:54:45,394 - core.tool_schema_manager - INFO - ✅ 增强刷新完成，当前可用工具: 4个
2025-06-28 10:54:45,394 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 10:54:45,395 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 10:54:45,395 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 10:54:45,395 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 10:54:45,396 - core.tool_schema_manager - INFO - ✅ Schema安全刷新完成，备份 4 个工具
2025-06-28 10:54:45,396 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 10:54:45,396 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 10:54:45,396 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 10:54:45,397 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 10:54:45,397 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 10:54:45,397 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 10:54:45,397 - core.tool_schema_manager - INFO - 🔍 同步验证完成: unhealthy (0/4 工具Schema一致)
2025-06-28 10:54:45,397 - runtimes.reasoning.enhanced_runtime - ERROR - ❌ MCP服务器同步验证失败: 未知错误
2025-06-28 10:54:45,397 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔧 开始获取可用工具ID列表...
2025-06-28 10:54:45,397 - runtimes.reasoning.real_time_tool_client - DEBUG - 可用工具ID列表: ['deepsearch', 'mcp-search-tool', 'microsandbox', 'browser_use']
2025-06-28 10:54:45,397 - runtimes.reasoning.enhanced_runtime - DEBUG - 📋 获取到的工具列表: ['deepsearch', 'mcp-search-tool', 'microsandbox', 'browser_use']
2025-06-28 10:54:45,397 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 工具Schema管理器已初始化
2025-06-28 10:54:45,397 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔧 更新Guardrails和ValidationCritic工具配置...
2025-06-28 10:54:45,397 - core.llm.guardrails_middleware - INFO - 🔧 初始化输入验证Guard...
2025-06-28 10:54:45,398 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 10:54:45,399 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 10:54:45,399 - core.llm.guardrails_middleware - INFO - 🔧 初始化输出验证Guard...
2025-06-28 10:54:45,399 - core.llm.guardrails_middleware - WARNING - ⚠️ 未提供LLM客户端，Guard将无法执行基于LLM的修正。回退到无API的Guard。
2025-06-28 10:54:45,400 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 10:54:45,400 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 10:54:45,401 - core.llm.guardrails_middleware - INFO - ✅ Guardrails Guards初始化成功
2025-06-28 10:54:45,401 - core.llm.guardrails_middleware - INFO -    - 输入Guard: ✅
2025-06-28 10:54:45,401 - core.llm.guardrails_middleware - INFO -    - 输出Guard: ✅
2025-06-28 10:54:45,401 - core.llm.guardrails_middleware - INFO - 🔄 Guardrails工具列表已更新: 4个工具
2025-06-28 10:54:45,401 - core.agents.validation_critic - INFO - 🔄 ValidationCritic工具列表已更新: 4个工具
2025-06-28 10:54:45,401 - runtimes.reasoning.enhanced_runtime - INFO - ✅ Guardrails和ValidationCritic已配置4个工具: deepsearch, mcp-search-tool, microsandbox, browser_use
2025-06-28 10:54:45,401 - runtimes.reasoning.enhanced_runtime - INFO - ✅ Enhanced Reasoning Runtime 已成功初始化为纯推理引擎（集成Guardrails + ValidationCritic）
2025-06-28 10:54:45,402 - services.runtime_service - INFO - 启动运行时任务消费: enhanced-reasoning-1
2025-06-28 10:54:45,403 - services.runtime_service - INFO - 推理运行时服务已启动 1 个实例和 1 个任务消费协程
2025-06-28 10:54:45,403 - core.tool_schema_manager - INFO - 🔍 启动MCP服务器配置监控...
2025-06-28 10:54:45,403 - core.task_manager - INFO - Runtime enhanced-reasoning-1 starting to consume from queue: tasks:reasoning
2025-06-28 10:54:45,403 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/search_tool_server/service.json
2025-06-28 10:54:45,404 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/microsandbox_server/service.json
2025-06-28 10:54:45,404 - core.task_manager - INFO - Runtime enhanced-reasoning-1 starting consumer loop for queue tasks:reasoning
2025-06-28 10:54:45,404 - core.task_manager - DEBUG - Runtime enhanced-reasoning-1 reading from queue tasks:reasoning...
2025-06-28 10:54:45,404 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/browser_use_server/service.json
2025-06-28 10:54:45,404 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/deepsearch_server/service.json
2025-06-28 10:54:45,404 - core.tool_schema_manager - INFO - 🔄 MCP配置变化，强制刷新schema...
2025-06-28 10:54:45,404 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=True)，当前缓存: 0 个工具
2025-06-28 10:54:45,404 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 10:54:45,404 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
2025-06-28 10:54:45,404 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 10:54:45,404 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
2025-06-28 10:54:45,404 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
2025-06-28 10:54:45,404 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 10:54:45,404 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 10:54:45,404 - core.tool_schema_manager - INFO - 🔄 检测到 4 个工具需要更新: ['deepsearch', 'microsandbox', 'browser_use', 'mcp-search-tool']
2025-06-28 10:54:45,404 - core.tool_schema_manager - INFO - 🔄 执行增量更新: 4 个工具
2025-06-28 10:54:45,404 - core.tool_schema_manager - INFO - 🔄 缓存为空，转为全量刷新模式
2025-06-28 10:54:45,404 - core.tool_schema_manager - DEBUG - 🔄 开始增强刷新工具Schemas...
2025-06-28 10:54:45,404 - core.tool_schema_manager - DEBUG - 🔍 工具注册表状态检查: _tools 字典包含 4 个条目
2025-06-28 10:54:45,404 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: deepsearch
2025-06-28 10:54:45,404 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: microsandbox
2025-06-28 10:54:45,404 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: browser_use
2025-06-28 10:54:45,404 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: mcp-search-tool
2025-06-28 10:54:45,404 - core.tool_schema_manager - INFO - 🔧 选项1: 从工具注册表获取到 4 个工具
2025-06-28 10:54:45,404 - core.tool_schema_manager - DEBUG -   工具 0: id=deepsearch, name=网络信息研究工具, actions=3
2025-06-28 10:54:45,405 - core.tool_schema_manager - DEBUG -   工具 1: id=microsandbox, name=MicroSandbox安全代码执行器, actions=7
2025-06-28 10:54:45,405 - core.tool_schema_manager - DEBUG -   工具 2: id=browser_use, name=智能浏览器操作工具, actions=6
2025-06-28 10:54:45,405 - core.tool_schema_manager - DEBUG -   工具 3: id=mcp-search-tool, name=工具管理和项目文件搜索器, actions=4
2025-06-28 10:54:45,405 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: deepsearch
2025-06-28 10:54:45,405 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: comprehensive_research
2025-06-28 10:54:45,405 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: quick_research
2025-06-28 10:54:45,406 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: research
2025-06-28 10:54:45,406 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 deepsearch (包含 3 个动作)
2025-06-28 10:54:45,406 - core.tool_schema_manager - DEBUG -    当前缓存大小: 1 个工具
2025-06-28 10:54:45,406 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: microsandbox
2025-06-28 10:54:45,406 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_cleanup_expired
2025-06-28 10:54:45,406 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_close_session
2025-06-28 10:54:45,406 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_execute
2025-06-28 10:54:45,406 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_health_status
2025-06-28 10:54:45,406 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_performance_stats
2025-06-28 10:54:45,407 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_install_package
2025-06-28 10:54:45,407 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_list_sessions
2025-06-28 10:54:45,407 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 microsandbox (包含 7 个动作)
2025-06-28 10:54:45,407 - core.tool_schema_manager - DEBUG -    当前缓存大小: 2 个工具
2025-06-28 10:54:45,407 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: browser_use
2025-06-28 10:54:45,407 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-49' coro=<start.<locals>.start_all_runtimes() running at /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/services/runtime_service.py:94> wait_for=<_GatheringFuture pending cb=[Task.task_wakeup()]>>
2025-06-28 10:54:45,407 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='runtime-enhanced-reasoning-1' coro=<start_runtime_service() running at /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/core/task_manager.py:388> wait_for=<Future pending cb=[Task.task_wakeup()]> cb=[gather.<locals>._done_callback() at /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/tasks.py:764]>
2025-06-28 10:54:45,407 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_click_element
2025-06-28 10:54:45,407 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_use_execute_task
2025-06-28 10:54:45,408 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_extract_content
2025-06-28 10:54:45,408 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_input_text
2025-06-28 10:54:45,408 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_navigate
2025-06-28 10:54:45,408 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_search_google
2025-06-28 10:54:45,408 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 browser_use (包含 6 个动作)
2025-06-28 10:54:45,408 - core.tool_schema_manager - DEBUG -    当前缓存大小: 3 个工具
2025-06-28 10:54:45,408 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: mcp-search-tool
2025-06-28 10:54:45,408 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: analyze_tool_needs
2025-06-28 10:54:45,408 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: list_code_definitions
2025-06-28 10:54:45,408 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_and_install_tools
2025-06-28 10:54:45,408 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_file_content
2025-06-28 10:54:45,408 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 mcp-search-tool (包含 4 个动作)
2025-06-28 10:54:45,408 - core.tool_schema_manager - DEBUG -    当前缓存大小: 4 个工具
2025-06-28 10:54:45,408 - core.tool_schema_manager - INFO - 🔧 选项1: 成功处理 4/4 个工具，当前缓存 4 个工具
2025-06-28 10:54:45,409 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: mcp-search-tool
2025-06-28 10:54:45,409 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: microsandbox
2025-06-28 10:54:45,409 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: browser_use
2025-06-28 10:54:45,409 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: deepsearch
2025-06-28 10:54:45,409 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:10:54:45 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 10:54:45,410 - core.tool_schema_manager - DEBUG - 🔍 从ToolScore获取到工具列表: ['mcp-search-tool', 'microsandbox', 'browser_use', 'deepsearch']
2025-06-28 10:54:45,410 - core.tool_schema_manager - DEBUG - 🔧 映射后的工具列表: ['mcp-search-tool', 'microsandbox', 'browser_use', 'deepsearch']
2025-06-28 10:54:45,410 - core.tool_schema_manager - DEBUG - ⏭️ 工具 mcp-search-tool 已在缓存中，跳过ToolScore获取
2025-06-28 10:54:45,410 - core.tool_schema_manager - DEBUG - ⏭️ 工具 microsandbox 已在缓存中，跳过ToolScore获取
2025-06-28 10:54:45,410 - core.tool_schema_manager - DEBUG - ⏭️ 工具 browser_use 已在缓存中，跳过ToolScore获取
2025-06-28 10:54:45,410 - core.tool_schema_manager - DEBUG - ⏭️ 工具 deepsearch 已在缓存中，跳过ToolScore获取
2025-06-28 10:54:45,410 - core.tool_schema_manager - INFO - ✅ 增强刷新完成，当前可用工具: 4个
2025-06-28 10:54:45,410 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 10:54:45,410 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 10:54:45,410 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 10:54:45,411 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 10:54:45,411 - core.tool_schema_manager - INFO - ✅ Schema安全刷新完成，备份 4 个工具
2025-06-28 10:54:45,411 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 10:54:45,411 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 10:54:45,412 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 10:54:45,412 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 10:54:45,412 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 10:54:45,412 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 10:54:49,911 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第8次, 5s间隔)
2025-06-28 10:54:54,912 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第9次, 5s间隔)
2025-06-28 10:54:59,913 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第10次, 5s间隔)
2025-06-28 10:55:04,914 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第11次, 5s间隔)
2025-06-28 10:55:05,395 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 10:55:05,395 - websockets.client - DEBUG - > PING 59 70 8c 73 [binary, 4 bytes]
2025-06-28 10:55:05,395 - websockets.server - DEBUG - < PING 59 70 8c 73 [binary, 4 bytes]
2025-06-28 10:55:05,395 - websockets.server - DEBUG - > PONG 59 70 8c 73 [binary, 4 bytes]
2025-06-28 10:55:05,395 - websockets.client - DEBUG - < PONG 59 70 8c 73 [binary, 4 bytes]
2025-06-28 10:55:05,395 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 10:55:09,915 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第12次, 5s间隔)
2025-06-28 10:55:12,833 - core.task_api - INFO - Task cd205c20-cfd2-423c-9968-51df20bedcb5 submitted successfully
[2025-06-28 10:55:12] [32mINFO[0m:     127.0.0.1:60092 - "[1mPOST /api/v1/tasks HTTP/1.1[0m" [32m200 OK[0m
2025-06-28 10:55:12,833 - core.task_api - INFO - Task 52fa2ff0-f580-4a04-9a35-4fd79b7032b9 submitted successfully
[2025-06-28 10:55:12] [32mINFO[0m:     127.0.0.1:60096 - "[1mPOST /api/v1/tasks HTTP/1.1[0m" [32m200 OK[0m
2025-06-28 10:55:12,833 - core.task_api - INFO - Task 41d86fa5-661e-492d-9306-8eab13f0d2f5 submitted successfully
[2025-06-28 10:55:12] [32mINFO[0m:     127.0.0.1:60095 - "[1mPOST /api/v1/tasks HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:12] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:12] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:12] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:14] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:14] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:14] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
2025-06-28 10:55:14,880 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 10:55:14,901 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 10:55:14,902 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 10:55:14,902 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 10:55:14,909 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 10:55:14,915 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第13次, 30s间隔)
2025-06-28 10:55:15,388 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 10:55:15,388 - websockets.server - DEBUG - > PING b4 64 42 12 [binary, 4 bytes]
2025-06-28 10:55:15,388 - websockets.client - DEBUG - < PING b4 64 42 12 [binary, 4 bytes]
2025-06-28 10:55:15,389 - websockets.client - DEBUG - > PONG b4 64 42 12 [binary, 4 bytes]
2025-06-28 10:55:15,389 - websockets.server - DEBUG - < PONG b4 64 42 12 [binary, 4 bytes]
2025-06-28 10:55:15,389 - websockets.server - DEBUG - % received keepalive pong
[2025-06-28 10:55:16] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:16] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:16] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:18] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:18] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:18] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:20] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:20] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:20] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:22] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:22] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:22] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:24] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:24] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:24] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
2025-06-28 10:55:25,396 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 10:55:25,397 - websockets.client - DEBUG - > PING 22 d9 d5 39 [binary, 4 bytes]
2025-06-28 10:55:25,397 - websockets.server - DEBUG - < PING 22 d9 d5 39 [binary, 4 bytes]
2025-06-28 10:55:25,397 - websockets.server - DEBUG - > PONG 22 d9 d5 39 [binary, 4 bytes]
2025-06-28 10:55:25,397 - websockets.client - DEBUG - < PONG 22 d9 d5 39 [binary, 4 bytes]
2025-06-28 10:55:25,397 - websockets.client - DEBUG - % received keepalive pong
[2025-06-28 10:55:26] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:26] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:26] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:28] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:28] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:28] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:30] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:30] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:30] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:32] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:32] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:32] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:34] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:34] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:34] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:36] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:36] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:36] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:38] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:38] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:38] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:40] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:40] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:40] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:42] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:42] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:42] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:44] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:44] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:44] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
2025-06-28 10:55:44,883 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 10:55:44,902 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 10:55:44,902 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 10:55:44,902 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 10:55:44,914 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 10:55:44,916 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第14次, 30s间隔)
2025-06-28 10:55:45,382 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 1m 0s
2025-06-28 10:55:45,390 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 10:55:45,390 - websockets.server - DEBUG - > PING 43 19 a1 3c [binary, 4 bytes]
2025-06-28 10:55:45,390 - websockets.client - DEBUG - < PING 43 19 a1 3c [binary, 4 bytes]
2025-06-28 10:55:45,390 - websockets.client - DEBUG - > PONG 43 19 a1 3c [binary, 4 bytes]
2025-06-28 10:55:45,390 - websockets.server - DEBUG - < PONG 43 19 a1 3c [binary, 4 bytes]
2025-06-28 10:55:45,390 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 10:55:45,398 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 10:55:45,398 - websockets.client - DEBUG - > PING 54 a0 14 57 [binary, 4 bytes]
2025-06-28 10:55:45,398 - websockets.server - DEBUG - < PING 54 a0 14 57 [binary, 4 bytes]
2025-06-28 10:55:45,398 - websockets.server - DEBUG - > PONG 54 a0 14 57 [binary, 4 bytes]
2025-06-28 10:55:45,398 - websockets.client - DEBUG - < PONG 54 a0 14 57 [binary, 4 bytes]
2025-06-28 10:55:45,398 - websockets.client - DEBUG - % received keepalive pong
[2025-06-28 10:55:46] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:46] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:46] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:48] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:48] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:48] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:50] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:50] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:50] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:52] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:52] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:52] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:54] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:54] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:54] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:56] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:56] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:56] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:58] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:58] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:55:58] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:00] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:00] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:00] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:02] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:02] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:02] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:04] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:04] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:04] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
2025-06-28 10:56:05,399 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 10:56:05,399 - websockets.client - DEBUG - > PING 16 f6 1a 9b [binary, 4 bytes]
2025-06-28 10:56:05,399 - websockets.server - DEBUG - < PING 16 f6 1a 9b [binary, 4 bytes]
2025-06-28 10:56:05,400 - websockets.server - DEBUG - > PONG 16 f6 1a 9b [binary, 4 bytes]
2025-06-28 10:56:05,400 - websockets.client - DEBUG - < PONG 16 f6 1a 9b [binary, 4 bytes]
2025-06-28 10:56:05,400 - websockets.client - DEBUG - % received keepalive pong
[2025-06-28 10:56:06] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:06] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:06] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:08] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:08] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:08] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:10] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:10] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:10] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:12] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:12] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:12] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
2025-06-28 10:56:14,888 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 10:56:14,906 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 10:56:14,906 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 10:56:14,906 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
[2025-06-28 10:56:14] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:14] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:14] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
2025-06-28 10:56:14,915 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 10:56:14,917 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第15次, 30s间隔)
2025-06-28 10:56:15,391 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 10:56:15,391 - websockets.server - DEBUG - > PING 7e ed 3f e1 [binary, 4 bytes]
2025-06-28 10:56:15,391 - websockets.client - DEBUG - < PING 7e ed 3f e1 [binary, 4 bytes]
2025-06-28 10:56:15,392 - websockets.client - DEBUG - > PONG 7e ed 3f e1 [binary, 4 bytes]
2025-06-28 10:56:15,392 - websockets.server - DEBUG - < PONG 7e ed 3f e1 [binary, 4 bytes]
2025-06-28 10:56:15,392 - websockets.server - DEBUG - % received keepalive pong
[2025-06-28 10:56:16] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:16] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:16] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:18] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:18] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:18] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:20] [32mINFO[0m:     127.0.0.1:60095 - "[1mGET /api/v1/tasks/52fa2ff0-f580-4a04-9a35-4fd79b7032b9 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:20] [32mINFO[0m:     127.0.0.1:60092 - "[1mGET /api/v1/tasks/41d86fa5-661e-492d-9306-8eab13f0d2f5 HTTP/1.1[0m" [32m200 OK[0m
[2025-06-28 10:56:20] [32mINFO[0m:     127.0.0.1:60096 - "[1mGET /api/v1/tasks/cd205c20-cfd2-423c-9968-51df20bedcb5 HTTP/1.1[0m" [32m200 OK[0m
2025-06-28 10:56:20,976 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 10:56:20,976 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 10:56:20,976 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 10:56:20,976 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 10:56:20,976 - services.synthesis_service - INFO - 🛑 SynthesisCore v2.0监控器已停止
2025-06-28 10:56:20,976 - services.synthesis_service - INFO - 等待合成服务线程结束...
2025-06-28 10:56:21,484 - core.synthesiscore.trajectory_monitor - INFO - 🛑 轨迹文件监控已停止
2025-06-28 10:56:21,484 - core.synthesiscore.enhanced_synthesis_engine - ERROR - ❌ Enhanced Synthesis Engine 关闭失败: object NoneType can't be used in 'await' expression
2025-06-28 10:56:21,484 - core.synthesiscore.enhanced_synthesis_engine - INFO - 🔒 SynthesisCore v2.0 已关闭
2025-06-28 10:56:21,484 - core.synthesiscore.trajectory_monitor - INFO - 🔒 SynthesisCore已关闭
2025-06-28 10:56:21,484 - services.synthesis_service - INFO - SynthesisCore v2.0监控器工作线程已停止
2025-06-28 10:56:21,760 - services.synthesis_service - INFO - 合成服务工作线程已停止
2025-06-28 10:56:21,762 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 10:56:21,762 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 10:56:21,762 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 10:56:21,762 - services.runtime_service - INFO - 停止运行时实例: enhanced-reasoning-1
2025-06-28 10:56:21,763 - services.runtime_service - WARNING - 运行时清理失败: asyncio.run() cannot be called from a running event loop
[2025-06-28 10:56:21] /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/services/runtime_service.py:117: RuntimeWarning: coroutine 'EnhancedReasoningRuntime.cleanup' was never awaited
  logger.warning(f"运行时清理失败: {e}")
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
2025-06-28 10:56:21,763 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 10:56:21,763 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 10:56:21,764 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 10:56:21,764 - services.task_api_service - INFO - 已发送停止信号给任务API服务器
[2025-06-28 10:56:21] [32mINFO[0m:     Shutting down

================================================================================
[系统启动] 2025-06-28 10:56:21
================================================================================
[2025-06-28 10:56:21] 🚀 Agent Data Platform 启动中... (所有日志将统一记录到 logs/System.log)
2025-06-28 10:56:21,841 - asyncio - DEBUG - Using selector: KqueueSelector
[2025-06-28 10:56:21] 🧹 开始增强端口清理...
[2025-06-28 10:56:21] 🔍 搜索并清理相关Python进程...
2025-06-28 10:56:21,856 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 10:56:21,856 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 10:56:21,856 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 10:56:21,856 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 10:56:21,856 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 10:56:21,856 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 10:56:21,856 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 10:56:21,856 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 10:56:21,856 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 10:56:21,856 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 10:56:21,856 - services.task_api_service - INFO - 已发送停止信号给任务API服务器
2025-06-28 10:56:21,875 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 收到停止信号，正在清理资源...
2025-06-28 10:56:21,877 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 10:56:21,878 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 10:54:15,155 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 10:54:15,155 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 10:54:15,155 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 10:54:15,155 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 10:54:15,155 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 10:54:15,155 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 10:54:15,155 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 10:54:15,155 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 10:54:15,155 - __main__ - INFO -   Listen Port: 8090
2025-06-28 10:54:15,155 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 10:54:15,155 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 10:54:15,156 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 10:54:15,156 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 10:54:15,156 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 10:54:15,159 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 10:54:15,159 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 10:54:15,159 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 10:54:15,159 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 10:54:25,160 - core.toolscore.mcp_server - INFO - [microsandbox_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 10:54:25,162 - core.toolscore.mcp_server - INFO - [microsandbox_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 10:54:25,162 - core.toolscore.mcp_server - INFO - [microsandbox_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "f406bf94-8756-44e3-be30-ccfea247680a", "tool_spec": {"tool_id": "microsandbox", "name": "microsandbox_server", "description": "\u57fa\u4e8eMicroSandbox\u7684\u5b89\u5168Python\u4ee3\u7801\u6267\u884c\u670d\u52a1\u5668", "tool_type": "mcp_server", "capabilities": [{"name": "microsandbox_execute", "description": "\u5728MicroSandbox\u5b89\u5168\u73af\u5883\u4e2d\u6267\u884cPython\u4ee3\u7801", "parameters": {"code": {"type": "string", "description": "\u8981\u6267\u884c\u7684Python\u4ee3\u7801", "required": true}, "session_id": {"type": "string", "description": "\u4f1a\u8bddID\uff0c\u7528\u4e8e\u591a\u8f6e\u6267\u884c\u548c\u72b6\u6001\u4fdd\u6301", "required": false}, "timeout": {"type": "integer", "description": "\u6267\u884c\u8d85\u65f6\u65f6\u95f4\uff08\u79d2\uff09\uff0c\u9ed8\u8ba430\u79d2\uff0c\u6700\u5927300\u79d2\u3002\u6ce8\u610f\uff1aMicroSandbox\u5185\u90e8\u6709\u81ea\u5df1\u7684\u8d85\u65f6\u673a\u5236\uff0c\u6b64\u53c2\u6570\u4e3b\u8981\u7528\u4e8e\u6587\u6863\u8bf4\u660e", "required": false}}, "examples": [{"code": "print('Hello from MicroSandbox!')"}, {"code": "import math\\nresult = math.sqrt(16)\\nprint(f'\u5e73\u65b9\u6839: {result}')", "timeout": 10}, {"code": "x = 42", "session_id": "my-session"}, {"code": "print(f'x = {x}')", "session_id": "my-session"}], "category": "general"}, {"name": "microsandbox_install_package", "description": "\u5728MicroSandbox\u73af\u5883\u4e2d\u5b89\u88c5Python\u5305", "parameters": {"package_name": {"type": "string", "description": "\u8981\u5b89\u88c5\u7684\u5305\u540d", "required": true}, "version": {"type": "string", "description": "\u6307\u5b9a\u7248\u672c\u53f7", "required": false}, "session_id": {"type": "string", "description": "\u4f1a\u8bddID", "required": false}}, "examples": [{"package_name": "requests"}, {"package_name": "numpy", "version": "1.21.0"}, {"package_name": "pandas", "session_id": "data-analysis"}], "category": "general"}, {"name": "microsandbox_list_sessions", "description": "\u5217\u51fa\u5f53\u524d\u6d3b\u8dc3\u7684\u6c99\u7bb1\u4f1a\u8bdd", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "microsandbox_close_session", "description": "\u5173\u95ed\u6307\u5b9a\u7684\u6c99\u7bb1\u4f1a\u8bdd", "parameters": {"session_id": {"type": "string", "description": "\u8981\u5173\u95ed\u7684\u4f1a\u8bddID", "required": true}}, "examples": [{"session_id": "my-session"}], "category": "general"}, {"name": "microsandbox_cleanup_expired", "description": "\u6e05\u7406\u8fc7\u671f\u7684\u6c99\u7bb1\u4f1a\u8bdd", "parameters": {"max_age": {"type": "integer", "description": "\u6700\u5927\u4f1a\u8bdd\u5e74\u9f84\uff08\u79d2\uff09\uff0c\u9ed8\u8ba4\u4e3a\u914d\u7f6e\u7684\u8d85\u65f6\u65f6\u95f4", "required": false}}, "examples": [{}, {"max_age": 1800}], "category": "general"}, {"name": "microsandbox_get_performance_stats", "description": "\u83b7\u53d6\u670d\u52a1\u5668\u6027\u80fd\u7edf\u8ba1\u4fe1\u606f", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "microsandbox_get_health_status", "description": "\u83b7\u53d6\u670d\u52a1\u5668\u5065\u5eb7\u72b6\u6001", "parameters": {}, "examples": [{}], "category": "general"}], "endpoint": "ws://localhost:8090", "connection_params": {}}}
2025-06-28 10:54:25,162 - core.toolscore.mcp_server - INFO - [microsandbox_server] Waiting for registration response from toolscore...
2025-06-28 10:54:25,163 - core.toolscore.mcp_server - INFO - [microsandbox_server] Received registration response: {"type": "register_tool_response", "request_id": "f406bf94-8756-44e3-be30-ccfea247680a", "success": true, "message": null}
2025-06-28 10:54:25,163 - core.toolscore.mcp_server - INFO - [microsandbox_server] Successfully registered with toolscore.

2025-06-28 10:56:21,878 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 10:56:21,878 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 10:56:21,878 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
[2025-06-28 10:56:21] [32mINFO[0m:     Waiting for application shutdown.
2025-06-28 10:56:21,878 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 10:54:15,216 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 10:54:15,216 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 10:54:15,216 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 10:54:15,216 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 10:54:15,216 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 10:54:15,217 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 10:54:15,218 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 10:54:15,218 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 10:54:15,218 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 10:54:15,218 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 10:54:15,517 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 10:54:15,517 - websockets.server - INFO - connection closed
2025-06-28 10:54:15,518 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:54:15,518 - websockets.server - INFO - connection closed
2025-06-28 10:54:25,219 - core.toolscore.mcp_server - INFO - [deepsearch_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 10:54:25,221 - core.toolscore.mcp_server - INFO - [deepsearch_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 10:54:25,221 - core.toolscore.mcp_server - INFO - [deepsearch_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "8394e22d-92ad-42a9-a617-7a4d7d0cb8d9", "tool_spec": {"tool_id": "deepsearch", "name": "deepsearch_server", "description": "\u4e13\u4e1a\u7ea7\u6df1\u5ea6\u641c\u7d22\u548c\u7814\u7a76\u5de5\u5177\u670d\u52a1\u5668\uff0c\u57fa\u4e8eLangGraph\u5b9e\u73b0\u7684\u591a\u8f6e\u8fed\u4ee3\u641c\u7d22\u4ee3\u7406", "tool_type": "mcp_server", "capabilities": [{"name": "research", "description": "\u6267\u884c\u4e13\u4e1a\u7ea7\u6df1\u5ea6\u7814\u7a76\uff0c\u83b7\u53d6\u8be6\u7ec6\u8c03\u7814\u4fe1\u606f", "parameters": {"question": {"type": "string", "description": "\u8981\u7814\u7a76\u7684\u95ee\u9898\u6216\u4e3b\u9898", "required": true}, "research_depth": {"type": "string", "description": "\u7814\u7a76\u6df1\u5ea6: quick/standard/comprehensive", "required": false}, "max_iterations": {"type": "integer", "description": "\u6700\u5927\u8fed\u4ee3\u6b21\u6570", "required": false}}, "examples": [], "category": "general"}, {"name": "quick_research", "description": "\u6267\u884c\u5feb\u901f\u7814\u7a76\uff0c\u9002\u7528\u4e8e\u9700\u8981\u5feb\u901f\u83b7\u53d6\u57fa\u7840\u4fe1\u606f\u7684\u573a\u666f", "parameters": {"question": {"type": "string", "description": "\u8981\u7814\u7a76\u7684\u95ee\u9898\u6216\u4e3b\u9898", "required": true}}, "examples": [], "category": "general"}, {"name": "comprehensive_research", "description": "\u6267\u884c\u5168\u9762\u6df1\u5ea6\u7814\u7a76\uff0c\u9002\u7528\u4e8e\u9700\u8981\u8be6\u7ec6\u3001\u4e13\u4e1a\u7ea7\u8c03\u7814\u4fe1\u606f\u7684\u573a\u666f", "parameters": {"question": {"type": "string", "description": "\u8981\u7814\u7a76\u7684\u95ee\u9898\u6216\u4e3b\u9898", "required": true}, "topic_focus": {"type": "string", "description": "\u53ef\u9009\u7684\u4e3b\u9898\u7126\u70b9\uff0c\u7528\u4e8e\u5f15\u5bfc\u7814\u7a76\u65b9\u5411", "required": false}}, "examples": [], "category": "general"}, {"name": "get_health_status", "description": "\u83b7\u53d6\u7cfb\u7edf\u5065\u5eb7\u72b6\u6001\u548c\u6027\u80fd\u6307\u6807", "parameters": {}, "examples": [], "category": "general"}, {"name": "get_optimization_stats", "description": "\u83b7\u53d6\u8bf7\u6c42\u4f18\u5316\u7edf\u8ba1\u4fe1\u606f", "parameters": {}, "examples": [], "category": "general"}], "endpoint": "ws://localhost:8086/mcp", "connection_params": {}}}
2025-06-28 10:54:25,221 - core.toolscore.mcp_server - INFO - [deepsearch_server] Waiting for registration response from toolscore...
2025-06-28 10:54:25,221 - core.toolscore.mcp_server - INFO - [deepsearch_server] Received registration response: {"type": "register_tool_response", "request_id": "8394e22d-92ad-42a9-a617-7a4d7d0cb8d9", "success": true, "message": null}
2025-06-28 10:54:25,221 - core.toolscore.mcp_server - INFO - [deepsearch_server] Successfully registered with toolscore.
2025-06-28 10:54:44,904 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:54:44,905 - websockets.server - INFO - connection closed
2025-06-28 10:55:14,909 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:55:14,909 - websockets.server - INFO - connection closed
2025-06-28 10:55:44,914 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:55:44,914 - websockets.server - INFO - connection closed
2025-06-28 10:56:14,915 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:56:14,916 - websockets.server - INFO - connection closed

2025-06-28 10:56:21,878 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 10:54:15,057 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 10:54:15,057 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 10:54:15,058 - __main__ - INFO - Starting search_tool_server...
2025-06-28 10:54:15,058 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 10:54:15,062 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 10:54:15,062 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 10:54:15,062 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 10:54:15,063 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 10:54:15,515 - websockets.server - INFO - connection open
2025-06-28 10:54:15,515 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 59991)
2025-06-28 10:54:15,516 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 10:54:15,516 - core.toolscore.mcp_server - ERROR - Error handling message: received 1000 (OK); then sent 1000 (OK)
Traceback (most recent call last):
  File "/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/core/toolscore/mcp_server.py", line 324, in _handle_message
    await websocket.send(json.dumps(response))
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 620, in send
    await self.ensure_open()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 930, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedOK: received 1000 (OK); then sent 1000 (OK)
2025-06-28 10:54:15,518 - core.toolscore.mcp_server - INFO - Client disconnected from search_tool_server MCP Server: ('127.0.0.1', 59991)
2025-06-28 10:54:15,518 - websockets.server - INFO - connection closed
2025-06-28 10:54:25,063 - core.toolscore.mcp_server - INFO - [search_tool_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 10:54:25,064 - core.toolscore.mcp_server - INFO - [search_tool_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 10:54:25,064 - core.toolscore.mcp_server - INFO - [search_tool_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "26866dac-5d49-417e-add4-e9321db4cc6c", "tool_spec": {"tool_id": "mcp-search-tool", "name": "search_tool_server", "description": "\u6587\u4ef6\u5185\u5bb9\u641c\u7d22\u548c\u4ee3\u7801\u5b9a\u4e49\u641c\u7d22\u5de5\u5177\u670d\u52a1\u5668", "tool_type": "mcp_server", "capabilities": [{"name": "search_file_content", "description": "\u5728\u6307\u5b9a\u6587\u4ef6\u4e2d\u641c\u7d22\u5339\u914d\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5185\u5bb9", "parameters": {"file_path": {"type": "string", "description": "\u8981\u641c\u7d22\u7684\u6587\u4ef6\u8def\u5f84", "required": true}, "regex_pattern": {"type": "string", "description": "\u8981\u5339\u914d\u7684\u6b63\u5219\u8868\u8fbe\u5f0f", "required": true}}, "examples": [{"file_path": "src/main.py", "regex_pattern": "def\\s+\\w+"}], "category": "general"}, {"name": "list_code_definitions", "description": "\u5217\u51fa\u6307\u5b9a\u6587\u4ef6\u6216\u76ee\u5f55\u4e2dPython\u4ee3\u7801\u7684\u7c7b\u3001\u51fd\u6570\u548c\u65b9\u6cd5\u5b9a\u4e49", "parameters": {"file_path": {"type": "string", "description": "\u8981\u89e3\u6790\u7684Python\u6587\u4ef6\u8def\u5f84", "required": false}, "directory_path": {"type": "string", "description": "\u8981\u89e3\u6790\u7684\u76ee\u5f55\u8def\u5f84", "required": false}}, "examples": [{"file_path": "src/utils.py"}, {"directory_path": "src/models"}], "category": "general"}, {"name": "analyze_tool_needs", "description": "\u5206\u6790\u4efb\u52a1\u9700\u6c42\uff0c\u786e\u5b9a\u662f\u5426\u9700\u8981\u989d\u5916\u7684\u5de5\u5177", "parameters": {"task_description": {"type": "string", "description": "\u8981\u5206\u6790\u7684\u4efb\u52a1\u63cf\u8ff0", "required": true}}, "examples": [{"task_description": "Create a chart showing sales data trends"}], "category": "general"}, {"name": "search_and_install_tools", "description": "\u641c\u7d22\u5e76\u5b89\u88c5\u65b0\u7684\u5de5\u5177\u4ee5\u6ee1\u8db3\u4efb\u52a1\u9700\u6c42", "parameters": {"task_description": {"type": "string", "description": "\u4efb\u52a1\u63cf\u8ff0", "required": true}, "reason": {"type": "string", "description": "\u9700\u8981\u65b0\u5de5\u5177\u7684\u539f\u56e0", "required": false}}, "examples": [{"task_description": "Create a chart", "reason": "Need charting capabilities"}], "category": "general"}], "endpoint": "ws://localhost:8080/mcp", "connection_params": {}}}
2025-06-28 10:54:25,065 - core.toolscore.mcp_server - INFO - [search_tool_server] Waiting for registration response from toolscore...
2025-06-28 10:54:25,065 - core.toolscore.mcp_server - INFO - [search_tool_server] Received registration response: {"type": "register_tool_response", "request_id": "26866dac-5d49-417e-add4-e9321db4cc6c", "success": true, "message": null}
2025-06-28 10:54:25,065 - core.toolscore.mcp_server - INFO - [search_tool_server] Successfully registered with toolscore.
2025-06-28 10:54:44,879 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:54:44,880 - websockets.server - INFO - connection closed
2025-06-28 10:55:14,880 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:55:14,880 - websockets.server - INFO - connection closed
2025-06-28 10:55:44,883 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:55:44,883 - websockets.server - INFO - connection closed
2025-06-28 10:56:14,888 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:56:14,888 - websockets.server - INFO - connection closed

2025-06-28 10:56:21,878 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 10:56:21,879 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
[2025-06-28 10:56:21] [32mINFO[0m:     Application shutdown complete.
[2025-06-28 10:56:21] [32mINFO[0m:     Finished server process [[36m71265[0m]
2025-06-28 10:56:21,879 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 10:56:21,879 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 10:56:21,879 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 10:56:21,879 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 10:56:21,879 - services.mcp_server_launcher - INFO - MCP服务器已经停止: microsandbox_server
2025-06-28 10:56:21,879 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 10:56:21,879 - services.mcp_server_launcher - INFO - MCP服务器已经停止: search_tool_server
2025-06-28 10:56:21,880 - services.mcp_server_launcher - INFO - 停止MCP服务器: browser_use_server
2025-06-28 10:56:21,880 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 收到停止信号，正在清理资源...
2025-06-28 10:56:21,917 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 收到停止信号，正在清理资源...
[2025-06-28 10:56:21] ✅ 进程清理完成
[2025-06-28 10:56:23] ✅ 端口 8088 空闲
[2025-06-28 10:56:24] ✅ 端口 8089 空闲
[2025-06-28 10:56:24] ✅ 端口 8090 空闲
[2025-06-28 10:56:24] ✅ 端口 8091 空闲
[2025-06-28 10:56:24] ✅ 端口 8092 空闲
[2025-06-28 10:56:24] ✅ 端口 5555 空闲
[2025-06-28 10:56:24] 🔥 强制清理端口 8081 的进程 71265
[2025-06-28 10:56:24] ✅ 端口 8082 空闲
[2025-06-28 10:56:24] ✅ 端口 8080 空闲
[2025-06-28 10:56:24] 🔥 强制清理端口 8084 的进程 71312
[2025-06-28 10:56:24] ✅ 端口 8085 空闲
[2025-06-28 10:56:24] ✅ 端口 8086 空闲
[2025-06-28 10:56:24] ✅ 端口 8087 空闲
[2025-06-28 10:56:24] ✅ 端口 8000 空闲
[2025-06-28 10:56:25] ✅ 增强端口清理完成
2025-06-28 10:56:25,356 - __main__ - INFO - === Agent Data Platform 启动中 ===
2025-06-28 10:56:25,356 - __main__ - DEBUG - 🔧 开始系统初始化流程...
2025-06-28 10:56:25,356 - __main__ - DEBUG - 📝 命令行参数: {'config_dir': 'config', 'debug': False, 'start_services': False}
2025-06-28 10:56:25,356 - __main__ - DEBUG - 🔧 步骤1: 初始化ConfigManager...
2025-06-28 10:56:25,356 - __main__ - DEBUG - ✅ ConfigManager初始化完成，配置目录: config
2025-06-28 10:56:25,356 - __main__ - DEBUG - 🔧 步骤2: 加载系统配置...
2025-06-28 10:56:25,356 - __main__ - DEBUG - 📡 Redis URL: redis://localhost:6379
2025-06-28 10:56:25,356 - __main__ - DEBUG - 📋 任务文件路径: tasks.jsonl
2025-06-28 10:56:25,359 - core.config_manager - INFO - 路由配置加载成功
2025-06-28 10:56:25,359 - __main__ - DEBUG - 🚦 路由配置加载完成，任务类型映射: {'CODE': 'tasks:reasoning', 'WEB': 'tasks:reasoning', 'REASONING': 'tasks:reasoning', 'RESEARCH': 'tasks:reasoning'}
2025-06-28 10:56:25,359 - __main__ - DEBUG - 📋 队列映射: {<TaskType.CODE: 'code'>: 'tasks:reasoning', <TaskType.WEB: 'web'>: 'tasks:reasoning', <TaskType.REASONING: 'reasoning'>: 'tasks:reasoning', <TaskType.RESEARCH: 'research'>: 'tasks:reasoning'}
2025-06-28 10:56:25,359 - __main__ - DEBUG - 🔧 步骤3: 初始化核心组件...
2025-06-28 10:56:25,359 - __main__ - DEBUG - ✅ EnhancedMetrics初始化完成
2025-06-28 10:56:25,359 - __main__ - DEBUG - ✅ RedisManager初始化完成
2025-06-28 10:56:25,360 - core.toolscore.toolscore_client - INFO - ✅ 增强的ToolScoreClient初始化完成
2025-06-28 10:56:25,360 - core.llm_client - DEBUG - Enriched config with environment variables: ['default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 10:56:25,461 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 10:56:25,463 - core.config_manager - INFO - 路由配置加载成功
2025-06-28 10:56:25,463 - core.monitoring.queue_monitor - INFO - ✅ QueueMonitor 配置加载完成
2025-06-28 10:56:25,463 - core.system_monitor - INFO - ✅ SystemMonitor 配置加载完成
2025-06-28 10:56:25,464 - __main__ - DEBUG - 🔧 开始初始化所有服务...
2025-06-28 10:56:25,464 - services.service_manager - INFO - 正在初始化所有服务...
2025-06-28 10:56:25,464 - services.service_manager - INFO - 初始化服务: redis
2025-06-28 10:56:25,464 - services.redis_service - INFO - Redis服务初始化完成，使用注入的RedisManager实例
2025-06-28 10:56:25,464 - services.service_manager - INFO - 初始化服务: toolscore
2025-06-28 10:56:25,464 - services.toolscore_service - INFO - 正在初始化ToolScore服务...
2025-06-28 10:56:25,464 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 10:56:25,464 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 10:56:25,464 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 10:56:25,464 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 10:56:25,464 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 10:56:25,464 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 10:56:25,464 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 10:56:25,464 - services.toolscore_service - INFO - ToolScore服务初始化完成（异步初始化将在start()中进行）
2025-06-28 10:56:25,464 - services.service_manager - INFO - 初始化服务: task_processing_coordinator
2025-06-28 10:56:25,464 - services.service_manager - INFO - 初始化服务: mcp_servers
2025-06-28 10:56:25,464 - services.mcp_server_launcher - INFO - 正在初始化MCP服务器启动器...
2025-06-28 10:56:25,465 - services.mcp_server_launcher - INFO - MCP服务器启动器初始化完成，配置了 4 个服务器: ['microsandbox_server', 'search_tool_server', 'browser_use_server', 'deepsearch_server']
2025-06-28 10:56:25,465 - services.service_manager - INFO - 初始化服务: task_api
2025-06-28 10:56:25,465 - services.task_api_service - INFO - 正在初始化任务API服务...
2025-06-28 10:56:25,465 - services.task_api_service - INFO - 任务API服务初始化完成
2025-06-28 10:56:25,465 - services.service_manager - INFO - 初始化服务: runtime
2025-06-28 10:56:25,465 - services.runtime_service - INFO - 正在初始化推理运行时服务...
2025-06-28 10:56:25,465 - services.runtime_service - INFO - 创建运行时实例: enhanced-runtime-1
2025-06-28 10:56:25,465 - core.memory_manager - INFO - MemoryManager initialized: use_redis=True, max_entries=1000
2025-06-28 10:56:25,465 - core.step_planner - INFO - StepPlanner initialized with max_steps=10
2025-06-28 10:56:25,465 - runtimes.reasoning.enhanced_runtime - INFO - DEBUG: Loaded toolscore_http_port: 8082, toolscore_mcp_port: 8081
2025-06-28 10:56:25,465 - runtimes.reasoning.enhanced_runtime - INFO - DEBUG: Configured toolscore_websocket_endpoint (using mcp_port): ws://localhost:8081/websocket
2025-06-28 10:56:25,465 - core.toolscore.mcp_client - INFO - Enhanced MCPToolClient initialized for toolscore at ws://localhost:8081/websocket
2025-06-28 10:56:25,465 - core.llm.guardrails_middleware - INFO - 🔧 初始化输入验证Guard...
2025-06-28 10:56:25,466 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 10:56:25,467 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 10:56:25,467 - core.llm.guardrails_middleware - INFO - 🔧 初始化输出验证Guard...
2025-06-28 10:56:25,467 - core.llm.guardrails_middleware - WARNING - ⚠️ 未提供LLM客户端，Guard将无法执行基于LLM的修正。回退到无API的Guard。
2025-06-28 10:56:25,468 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 10:56:25,468 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 10:56:25,468 - core.llm.guardrails_middleware - INFO - ✅ Guardrails Guards初始化成功
2025-06-28 10:56:25,468 - core.llm.guardrails_middleware - INFO -    - 输入Guard: ✅
2025-06-28 10:56:25,468 - core.llm.guardrails_middleware - INFO -    - 输出Guard: ✅
2025-06-28 10:56:25,468 - core.agents.validation_critic - INFO - 🎯 ValidationCritic Agent初始化完成
2025-06-28 10:56:25,468 - services.runtime_service - INFO - 推理运行时服务初始化完成，创建了 1 个实例
2025-06-28 10:56:25,468 - services.service_manager - INFO - 初始化服务: synthesis
2025-06-28 10:56:25,468 - services.synthesis_service - INFO - 正在初始化合成服务...
2025-06-28 10:56:25,468 - core.llm_client - DEBUG - Enriched config with environment variables: ['redis_url', 'TRAJECTORIES_DIR', 'default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 10:56:25,501 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 10:56:25,502 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 10:56:25,502 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 10:56:25,502 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 10:56:25,502 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 10:56:25,502 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 10:56:25,502 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 10:56:25,502 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 10:56:25,502 - core.synthesiscore.synthesis - INFO - ✅ JSON文件存储初始化完成
2025-06-28 10:56:25,502 - core.synthesiscore.synthesis - INFO - 📋 未发现已处理轨迹记录，从空白状态开始
2025-06-28 10:56:25,502 - core.llm_client - DEBUG - Enriched config with environment variables: ['redis_url', 'TRAJECTORIES_DIR', 'default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 10:56:25,535 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 10:56:25,535 - core.toolscore.mcp_client - INFO - Enhanced MCPToolClient initialized for toolscore at ws://localhost:8089/websocket
2025-06-28 10:56:25,538 - core.synthesiscore.config_loader - INFO - ✅ SynthesisCore配置加载成功: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/config/synthesiscore_config.yaml
2025-06-28 10:56:25,538 - core.synthesiscore.trajectory_monitor - INFO - 🔧 TrajectoryMonitor初始化完成
2025-06-28 10:56:25,538 - core.synthesiscore.trajectory_monitor - INFO - 📂 监控目录: output/trajectories
2025-06-28 10:56:25,538 - core.synthesiscore.trajectory_monitor - INFO - 📝 种子文件: output/trajectories/../seed_tasks.jsonl
2025-06-28 10:56:25,538 - services.synthesis_service - INFO - ✅ TrajectoryMonitor v2.0 初始化完成
2025-06-28 10:56:25,538 - services.synthesis_service - INFO - 合成服务初始化完成，轨迹目录: output/trajectories
2025-06-28 10:56:25,538 - __main__ - DEBUG - ✅ 所有服务初始化完成
2025-06-28 10:56:25,538 - __main__ - DEBUG - 🚀 开始启动所有服务...
2025-06-28 10:56:25,538 - services.service_manager - INFO - 正在启动所有服务...
2025-06-28 10:56:25,538 - services.service_manager - INFO - 启动服务: redis
2025-06-28 10:56:25,538 - services.redis_service - INFO - Redis客户端已就绪
2025-06-28 10:56:25,538 - services.service_manager - INFO - 启动服务: toolscore
2025-06-28 10:56:25,538 - services.toolscore_service - INFO - 正在启动ToolScore服务...
2025-06-28 10:56:25,538 - services.toolscore_service - INFO - 正在初始化工具库...
2025-06-28 10:56:25,538 - services.toolscore_service - INFO - 工具库初始化将在ToolScore MCP服务器线程中进行。
2025-06-28 10:56:25,538 - services.toolscore_service - INFO - 正在启动ToolScore HTTP API...
2025-06-28 10:56:25,547 - services.toolscore_service - INFO - ToolScore HTTP API已启动于端口: 8082
2025-06-28 10:56:25,547 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 10:56:25,548 - services.toolscore_service - INFO - ToolScore MCP 服务器不进行端口自动检测，使用配置端口: 8081
2025-06-28 10:56:25,548 - services.toolscore_service - INFO - ToolScore MCP server configured to use host: 0.0.0.0, port: 8081, path: /websocket
2025-06-28 10:56:25,548 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 10:56:25,548 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 10:56:25,548 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 10:56:25,548 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 10:56:25,548 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 10:56:25,548 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 10:56:25,548 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 10:56:25,548 - core.toolscore.monitoring_api - INFO - ToolScore monitoring API started on port 8082
2025-06-28 10:56:25,548 - services.toolscore_service - INFO - Starting ToolScore MCP server thread...
2025-06-28 10:56:25,548 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 10:56:25,548 - services.toolscore_service - INFO - ToolScore MCP server thread started, is_alive: True
2025-06-28 10:56:25,548 - services.toolscore_service - INFO - ToolScore MCP服务器启动线程已启动，等待就绪信号...
2025-06-28 10:56:25,548 - core.toolscore.mcp_server - INFO - Attempting to start toolscore MCP Server on 0.0.0.0:8081
2025-06-28 10:56:25,548 - services.service_manager - INFO - 启动服务: task_processing_coordinator
2025-06-28 10:56:25,548 - core.dispatcher_enhanced - INFO - ✅ TaskProcessingCoordinator 配置加载完成 - 队列映射: {<TaskType.CODE: 'code'>: 'tasks:reasoning', <TaskType.WEB: 'web'>: 'tasks:reasoning', <TaskType.REASONING: 'reasoning'>: 'tasks:reasoning', <TaskType.RESEARCH: 'research'>: 'tasks:reasoning'}
2025-06-28 10:56:25,548 - services.service_manager - INFO - 启动服务: mcp_servers
2025-06-28 10:56:25,548 - services.mcp_server_launcher - INFO - 正在启动MCP服务器...
2025-06-28 10:56:25,548 - services.mcp_server_launcher - INFO - 正在并行启动 4 个MCP服务器...
2025-06-28 10:56:25,548 - core.dispatcher_enhanced - INFO - 启动任务处理协调器...
2025-06-28 10:56:25,548 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 10:56:25,549 - websockets.server - INFO - server listening on 0.0.0.0:8081
2025-06-28 10:56:25,549 - core.toolscore.mcp_server - INFO - [toolscore] Initializing UnifiedToolLibrary...
2025-06-28 10:56:25,549 - core.toolscore.core_manager - INFO - 🚀 正在初始化增强的CoreManager...
2025-06-28 10:56:25,549 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:56:25,549 - core.toolscore.core_manager - INFO - 🔄 使用v2.0服务容器架构初始化...
2025-06-28 10:56:25,549 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 10:56:25,549 - core.toolscore.enhanced_core_manager_v2 - INFO - 🚀 初始化增强核心管理器 v2.0...
2025-06-28 10:56:25,549 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 10:56:25,549 - core.toolscore.service_container.mcp_service_container - INFO - 🚀 开始初始化MCP服务容器...
2025-06-28 10:56:25,549 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 10:56:25,549 - core.toolscore.service_container.mcp_service_container - INFO - 🔍 发现内置MCP服务...
2025-06-28 10:56:25,549 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 10:56:25,549 - core.toolscore.service_container.builtin_discovery - INFO - 🔍 开始发现内置MCP服务: mcp_servers
2025-06-28 10:56:25,549 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 10:56:25,549 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 10:56:25,549 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 10:56:25,549 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: Search Tool MCP Server
2025-06-28 10:56:25,549 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:56:25,549 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: MicroSandbox MCP Server
2025-06-28 10:56:25,549 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 10:56:25,549 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 10:56:25,549 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 跳过 __pycache__: 缺少main.py文件
2025-06-28 10:56:25,549 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:56:25,552 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: Browser Use MCP Server
2025-06-28 10:56:25,552 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 71828)
2025-06-28 10:56:25,552 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 10:56:25,552 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: DeepSearch MCP Server
2025-06-28 10:56:25,552 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:56:25,552 - core.toolscore.service_container.builtin_discovery - INFO - 🎯 内置服务发现完成，共发现 4 个服务
2025-06-28 10:56:25,552 - core.toolscore.service_container.builtin_discovery - INFO - 📝 创建服务配置文件...
2025-06-28 10:56:25,553 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/search_tool_server/service.json
2025-06-28 10:56:25,553 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:56:25,553 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/microsandbox_server/service.json
2025-06-28 10:56:25,553 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 10:56:25,553 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/browser_use_server/service.json
2025-06-28 10:56:25,553 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/deepsearch_server/service.json
2025-06-28 10:56:25,553 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 发现 4 个内置服务
2025-06-28 10:56:25,553 - core.toolscore.service_container.mcp_service_container - INFO - 📂 加载已安装的外部服务...
2025-06-28 10:56:25,553 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:56:25,553 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 10:56:25,553 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 加载 0 个外部服务
2025-06-28 10:56:25,553 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 10:56:25,553 - core.toolscore.service_container.mcp_service_container - INFO - 📋 构建统一服务目录...
2025-06-28 10:56:25,553 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 10:56:25,553 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 服务目录构建完成，共 4 个服务
2025-06-28 10:56:25,553 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 10:56:25,553 - core.toolscore.service_container.mcp_service_container - INFO - 📋 标记内置服务为启动中状态...
2025-06-28 10:56:25,553 - core.toolscore.service_container.mcp_service_container - INFO - 📋 已标记 4 个内置服务为启动中状态
2025-06-28 10:56:25,553 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 10:56:25,553 - core.toolscore.service_container.service_monitor - INFO - 🔍 启动服务监控...
2025-06-28 10:56:25,553 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 10:56:25,553 - core.toolscore.service_container.mcp_service_container - INFO - ✅ MCP服务容器初始化完成
2025-06-28 10:56:25,553 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:56:25,553 - core.toolscore.enhanced_core_manager_v2 - INFO - ✅ 增强核心管理器 v2.0 初始化完成
2025-06-28 10:56:25,553 - core.toolscore.core_manager - INFO - ✅ v2.0架构初始化完成
2025-06-28 10:56:25,553 - core.toolscore.tool_registry - INFO - Tool registry initialized
2025-06-28 10:56:25,553 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 10:56:25,553 - core.llm_client - DEBUG - Enriched config with environment variables: ['provider', 'gemini_api_key', 'gemini_api_url']
2025-06-28 10:56:25,554 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 10:56:25,554 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 10:56:25,554 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 10:56:25,554 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:56:25,556 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 71829)
2025-06-28 10:56:25,557 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 10:56:25,566 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: browser_use_server
2025-06-28 10:56:25,566 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:56:25,567 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: browser_use_server
2025-06-28 10:56:25,567 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server
2025-06-28 10:56:25,567 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) = True
2025-06-28 10:56:25,567 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) = True
2025-06-28 10:56:25,567 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) contents: ['service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 10:56:25,567 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server/main.py
2025-06-28 10:56:25,567 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:56:25,567 - services.mcp_server_launcher - INFO - [MCP启动器] 为 browser_use_server 使用配置文件指定端口: 8084
2025-06-28 10:56:25,567 - services.mcp_server_launcher - INFO - [MCP启动器] 为 browser_use_server 使用配置文件指定端口: 8084
2025-06-28 10:56:25,567 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 BROWSER_USE_SERVER_PORT=8084 给 browser_use_server
2025-06-28 10:56:25,567 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.browser_use_server.main
2025-06-28 10:56:25,567 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:56:25,571 - services.mcp_server_launcher - INFO - MCP服务器已启动: browser_use_server (PID: 71830)
2025-06-28 10:56:25,571 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 browser_use_server 就绪状态...
2025-06-28 10:56:25,573 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 10:56:25,573 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:56:25,573 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 10:56:25,573 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 10:56:25,573 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 10:56:25,573 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 10:56:25,573 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 10:56:25,573 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 10:56:25,573 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:56:25,573 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 10:56:25,574 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 10:56:25,574 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 10:56:25,574 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 10:56:25,574 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:56:25,577 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 71831)
2025-06-28 10:56:25,578 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 10:56:25,579 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第1次, 5s间隔)
2025-06-28 10:56:25,579 - core.monitoring.queue_monitor - INFO - 启动队列监控器...
2025-06-28 10:56:25,581 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 10:56:25,581 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 10:56:25,582 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 10:56:25,582 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 10:56:25,582 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 10:56:25,582 - websockets.client - DEBUG - > Sec-WebSocket-Key: tNND3VI54Jf/z2+hDGAbyA==
2025-06-28 10:56:25,582 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 10:56:25,582 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:56:25,582 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:56:25,582 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 10:56:25,582 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 10:56:25,582 - websockets.client - DEBUG - > Host: localhost:8084
2025-06-28 10:56:25,582 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 10:56:25,582 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 10:56:25,582 - websockets.client - DEBUG - > Sec-WebSocket-Key: y5nPFyf/bkuwny5rxv4cYw==
2025-06-28 10:56:25,582 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 10:56:25,582 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:56:25,582 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:56:25,582 - websockets.client - DEBUG - > EOF
2025-06-28 10:56:25,582 - websockets.client - DEBUG - < EOF
2025-06-28 10:56:25,582 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 10:56:25,582 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 10:56:25,582 - websockets.client - DEBUG - > EOF
2025-06-28 10:56:25,582 - websockets.client - DEBUG - < EOF
2025-06-28 10:56:25,582 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 10:56:25,584 - services.mcp_server_launcher - DEBUG - 📋 browser_use_server 端口 8084 尚未就绪
2025-06-28 10:56:25,585 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 10:56:25,585 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 10:56:25,598 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 10:56:25,598 - core.toolscore.tool_gap_detector - INFO - 智能工具缺口检测器初始化 - 统一版本
2025-06-28 10:56:25,598 - core.toolscore.dynamic_mcp_manager - INFO - Dynamic MCP Manager initialized (ProcessRunner mode)
2025-06-28 10:56:25,598 - core.toolscore.dynamic_mcp_manager - INFO - 启动动态MCP管理器...
2025-06-28 10:56:25,599 - core.toolscore.dynamic_mcp_manager - INFO - 持久化配置为空，无需恢复外部MCP服务器
2025-06-28 10:56:25,599 - core.toolscore.dynamic_mcp_manager - INFO - 动态MCP管理器启动完成
2025-06-28 10:56:25,599 - core.toolscore.mcp_search_tool - INFO - ✅ MCP Search Tool initialized - 优化版本，包含失败工具跟踪
2025-06-28 10:56:25,599 - core.toolscore.unified_tool_library - INFO - Tool library initialization completed - 核心管理器模式
2025-06-28 10:56:25,599 - core.toolscore.mcp_server - INFO - [toolscore] UnifiedToolLibrary initialized.
2025-06-28 10:56:25,599 - core.toolscore.mcp_server - INFO - [toolscore] Auto-registering MCP servers...
2025-06-28 10:56:25,599 - core.toolscore.mcp_auto_registration - INFO - 🔍 开始自动发现和注册MCP服务器...
2025-06-28 10:56:25,599 - core.toolscore.mcp_auto_registration - DEBUG - ⚠️ 服务器目录 __pycache__ 缺少 service.json
2025-06-28 10:56:25,599 - core.toolscore.mcp_auto_registration - INFO - 🎯 发现 4 个MCP服务器
2025-06-28 10:56:25,611 - core.unified_tool_manager - DEBUG - ✅ 配置验证通过
2025-06-28 10:56:25,611 - core.unified_tool_manager - INFO - 🔄 成功加载工具配置: 4 个标准工具
2025-06-28 10:56:25,611 - core.unified_tool_manager - DEBUG -    - 标准工具ID: ['browser_use', 'deepsearch', 'mcp-search-tool', 'microsandbox']
2025-06-28 10:56:25,611 - core.unified_tool_manager - DEBUG -    - 兼容映射: 13 个变体
2025-06-28 10:56:25,611 - core.unified_tool_manager - INFO - ✅ 统一工具管理器初始化完成，管理 4 个工具
2025-06-28 10:56:25,611 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: mcp-search-tool
2025-06-28 10:56:25,611 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: Search Tool MCP Server (ID: mcp-search-tool)
2025-06-28 10:56:25,611 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: Search Tool MCP Server (ID: mcp-search-tool)
2025-06-28 10:56:25,611 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: Search Tool MCP Server
2025-06-28 10:56:25,611 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8080/websocket
2025-06-28 10:56:25,611 - core.toolscore.mcp_connector - INFO - Registered MCP server mcp-search-tool at ws://localhost:8080/websocket
2025-06-28 10:56:25,611 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: mcp-search-tool -> ws://localhost:8080/websocket
2025-06-28 10:56:25,611 - core.toolscore.core_manager - INFO - 工具立即可用: mcp-search-tool
2025-06-28 10:56:25,611 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: mcp-search-tool
2025-06-28 10:56:25,611 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: microsandbox
2025-06-28 10:56:25,612 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: MicroSandbox MCP Server (ID: microsandbox)
2025-06-28 10:56:25,612 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: MicroSandbox MCP Server (ID: microsandbox)
2025-06-28 10:56:25,612 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: MicroSandbox MCP Server
2025-06-28 10:56:25,612 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8090/websocket
2025-06-28 10:56:25,612 - core.toolscore.mcp_connector - INFO - Registered MCP server microsandbox at ws://localhost:8090/websocket
2025-06-28 10:56:25,612 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: microsandbox -> ws://localhost:8090/websocket
2025-06-28 10:56:25,612 - core.toolscore.core_manager - INFO - 工具立即可用: microsandbox
2025-06-28 10:56:25,612 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: microsandbox
2025-06-28 10:56:25,612 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: browser_use
2025-06-28 10:56:25,612 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: Browser Use MCP Server (ID: browser_use)
2025-06-28 10:56:25,612 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: Browser Use MCP Server (ID: browser_use)
2025-06-28 10:56:25,612 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: Browser Use MCP Server
2025-06-28 10:56:25,612 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8084/websocket
2025-06-28 10:56:25,612 - core.toolscore.mcp_connector - INFO - Registered MCP server browser_use at ws://localhost:8084/websocket
2025-06-28 10:56:25,612 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: browser_use -> ws://localhost:8084/websocket
2025-06-28 10:56:25,612 - core.toolscore.core_manager - INFO - 工具立即可用: browser_use
2025-06-28 10:56:25,612 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: browser_use
2025-06-28 10:56:25,612 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: deepsearch
2025-06-28 10:56:25,612 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: DeepSearch MCP Server (ID: deepsearch)
2025-06-28 10:56:25,612 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: DeepSearch MCP Server (ID: deepsearch)
2025-06-28 10:56:25,612 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: DeepSearch MCP Server
2025-06-28 10:56:25,612 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8086/websocket
2025-06-28 10:56:25,612 - core.toolscore.mcp_connector - INFO - Registered MCP server deepsearch at ws://localhost:8086/websocket
2025-06-28 10:56:25,612 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: deepsearch -> ws://localhost:8086/websocket
2025-06-28 10:56:25,612 - core.toolscore.core_manager - INFO - 工具立即可用: deepsearch
2025-06-28 10:56:25,612 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: deepsearch
2025-06-28 10:56:25,612 - core.toolscore.mcp_auto_registration - INFO - 📊 MCP服务器注册完成: 4/4 成功
2025-06-28 10:56:25,612 - core.toolscore.mcp_server - INFO - [toolscore] All MCP servers registered successfully.
2025-06-28 10:56:25,612 - core.toolscore.mcp_server - INFO - toolscore MCP Server started successfully on 0.0.0.0:8081 (Original endpoint: ws://0.0.0.0:8081/websocket) with ping_interval=30, ping_timeout=60
2025-06-28 10:56:25,612 - core.toolscore.mcp_server - INFO - toolscore MCP Server started event set.
2025-06-28 10:56:25,612 - core.toolscore.service_container.service_monitor - INFO - 🔄 开始服务监控循环，检查间隔: 30秒
2025-06-28 10:56:25,621 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [browser_use] BrowserUse logging setup complete with level info
2025-06-28 10:56:25,989 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [root] Anonymized telemetry enabled. See https://docs.browser-use.com/development/telemetry for more information.
2025-06-28 10:56:26,118 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.llm_client] Initialized LLM client with provider: gemini
2025-06-28 10:56:26,118 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Browser-Use server initialized with LLM provider: gemini
2025-06-28 10:56:26,118 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 使用动态分配端口: 8084
2025-06-28 10:56:26,118 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] BrowserUseMCPServer initialized:
2025-06-28 10:56:26,118 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Server Name: browser_use_server
2025-06-28 10:56:26,118 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Server ID: browser_use
2025-06-28 10:56:26,118 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Listen Host: 0.0.0.0
2025-06-28 10:56:26,118 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Listen Port: 8084
2025-06-28 10:56:26,118 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Public Endpoint: ws://localhost:8084
2025-06-28 10:56:26,118 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 10:56:26,118 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Starting browser_use_server...
2025-06-28 10:56:26,118 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Attempting to start MCPServer for browser_use_server at ws://localhost:8084...
2025-06-28 10:56:26,118 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Attempting to start browser_use_server MCP Server on localhost:8084
2025-06-28 10:56:26,119 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] server listening on 127.0.0.1:8084
2025-06-28 10:56:26,119 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] server listening on [::1]:8084
2025-06-28 10:56:26,119 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] browser_use_server MCP Server started successfully on localhost:8084 (Original endpoint: ws://localhost:8084) with ping_interval=30, ping_timeout=60
2025-06-28 10:56:26,119 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 10:56:26,154 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:56:26,154 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:56:26,187 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 10:56:26,187 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 10:56:26,187 - websockets.client - DEBUG - > Host: localhost:8084
2025-06-28 10:56:26,187 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 10:56:26,187 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 10:56:26,187 - websockets.client - DEBUG - > Sec-WebSocket-Key: vw6Qf0uN4qA3ewteyJo5Jg==
2025-06-28 10:56:26,187 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 10:56:26,187 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:56:26,187 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:56:26,187 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 10:56:26,187 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 10:56:26,187 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 10:56:26,187 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 10:56:26,187 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 10:56:26,188 - websockets.client - DEBUG - > Sec-WebSocket-Key: Yh9UIG5+o+K6S6FTgn4s0g==
2025-06-28 10:56:26,188 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 10:56:26,188 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:56:26,188 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:56:26,188 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection open
2025-06-28 10:56:26,188 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Client connected to browser_use_server MCP Server at path /: ('127.0.0.1', 60207)
2025-06-28 10:56:26,188 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 10:56:26,188 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 10:56:26,188 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 10:56:26,188 - websockets.client - DEBUG - < Sec-WebSocket-Accept: mUfJr+rKI4nZHhIDAEy2SUDRBVM=
2025-06-28 10:56:26,188 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:56:26,188 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 02:56:26 GMT
2025-06-28 10:56:26,188 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 10:56:26,188 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 10:56:26,188 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 10:56:26,188 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 10:56:26,188 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 10:56:26,188 - websockets.client - DEBUG - < Sec-WebSocket-Accept: aQWTXl6vgX4RTg7yQiGYy6ILPiY=
2025-06-28 10:56:26,188 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:56:26,188 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 02:56:26 GMT
2025-06-28 10:56:26,188 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 10:56:26,188 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 10:56:26,188 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 10:56:26,188 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:56:26,188 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 10:56:26,189 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 10:56:26,189 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:56:26,189 - services.mcp_server_launcher - DEBUG - [browser_use_server] WARNING  [core.toolscore.mcp_server] Unknown request type or server role mismatch: ping
2025-06-28 10:56:26,189 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 10:56:26,189 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 10:56:26,189 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:56:26,189 - websockets.client - DEBUG - < EOF
2025-06-28 10:56:26,189 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 10:56:26,189 - websockets.client - DEBUG - > EOF
2025-06-28 10:56:26,189 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 10:56:26,189 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 10:56:26,189 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 10:56:26,189 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:56:26,189 - websockets.client - DEBUG - < EOF
2025-06-28 10:56:26,189 - websockets.client - DEBUG - > EOF
2025-06-28 10:56:26,189 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 10:56:26,189 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 10:56:26,189 - services.mcp_server_launcher - DEBUG - ✅ browser_use_server 特定就绪检查通过
2025-06-28 10:56:26,189 - services.mcp_server_launcher - INFO - ✅ browser_use_server 已就绪
2025-06-28 10:56:26,189 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 10:56:26,189 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 10:56:26,190 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 10:56:26,190 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 10:56:26,875 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:56:26,875 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:56:27,191 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 10:56:27,741 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:56:27,741 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:56:28,779 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:56:28,779 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:56:30,024 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:56:30,024 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:56:30,579 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第2次, 5s间隔)
2025-06-28 10:56:31,519 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:56:31,519 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:56:33,312 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:56:33,312 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:56:35,462 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:56:35,462 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:56:35,581 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第3次, 5s间隔)
2025-06-28 10:56:35,713 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 10:56:35,713 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 10:56:35,713 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 10:56:35,713 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 10:56:35,713 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 10:56:35,713 - websockets.server - DEBUG - < Sec-WebSocket-Key: eWXZdRJpiUgNfEi8fJQNog==
2025-06-28 10:56:35,713 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 10:56:35,713 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:56:35,713 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:56:35,713 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 10:56:35,713 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 10:56:35,713 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 10:56:35,713 - websockets.server - DEBUG - > Sec-WebSocket-Accept: YmSvqMDOqX+MFebFhguv3sBl4nc=
2025-06-28 10:56:35,713 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:56:35,713 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 02:56:35 GMT
2025-06-28 10:56:35,713 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 10:56:35,713 - websockets.server - INFO - connection open
2025-06-28 10:56:35,713 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 10:56:35,713 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 60256)
2025-06-28 10:56:35,714 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "b31532...onnection_params": {}}}' [2376 bytes]
2025-06-28 10:56:35,714 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: search_tool_server (ID: mcp-search-tool)
2025-06-28 10:56:35,714 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: search_tool_server
2025-06-28 10:56:35,714 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: mcp-search-tool -> ws://localhost:8080/mcp
2025-06-28 10:56:35,714 - core.toolscore.core_manager - INFO - 工具立即可用: mcp-search-tool
2025-06-28 10:56:35,714 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 10:56:35,714 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:56:35,714 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 10:56:35,714 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:56:35,714 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 10:56:35,715 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 10:56:35,715 - websockets.server - INFO - connection closed
2025-06-28 10:56:35,799 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 10:56:35,799 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 10:56:35,800 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 10:56:35,800 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 10:56:35,800 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 10:56:35,800 - websockets.server - DEBUG - < Sec-WebSocket-Key: 2XT5VxMwk5R0YbxUNJQ4Hg==
2025-06-28 10:56:35,800 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 10:56:35,800 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:56:35,800 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:56:35,800 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 10:56:35,800 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 10:56:35,800 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 10:56:35,800 - websockets.server - DEBUG - > Sec-WebSocket-Accept: hDS70eK23cjU+Bh7/zgxRtNZ4AU=
2025-06-28 10:56:35,800 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:56:35,800 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 02:56:35 GMT
2025-06-28 10:56:35,800 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 10:56:35,800 - websockets.server - INFO - connection open
2025-06-28 10:56:35,800 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 10:56:35,800 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 60258)
2025-06-28 10:56:35,800 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "77007f...onnection_params": {}}}' [3263 bytes]
2025-06-28 10:56:35,800 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: microsandbox_server (ID: microsandbox)
2025-06-28 10:56:35,800 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: microsandbox_server
2025-06-28 10:56:35,800 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: microsandbox -> ws://localhost:8090
2025-06-28 10:56:35,800 - core.toolscore.core_manager - INFO - 工具立即可用: microsandbox
2025-06-28 10:56:35,800 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 10:56:35,801 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:56:35,801 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 10:56:35,801 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:56:35,801 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 10:56:35,801 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 10:56:35,801 - websockets.server - INFO - connection closed
2025-06-28 10:56:35,872 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 10:56:35,873 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 10:56:35,873 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 10:56:35,873 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 10:56:35,873 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 10:56:35,873 - websockets.server - DEBUG - < Sec-WebSocket-Key: 6hAIOYzqsWkOREEdWtM8AA==
2025-06-28 10:56:35,873 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 10:56:35,873 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:56:35,873 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:56:35,873 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 10:56:35,873 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 10:56:35,873 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 10:56:35,873 - websockets.server - DEBUG - > Sec-WebSocket-Accept: LFYKvMmAhwXiYG5nVFYOeJcvAK0=
2025-06-28 10:56:35,873 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:56:35,873 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 02:56:35 GMT
2025-06-28 10:56:35,873 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 10:56:35,873 - websockets.server - INFO - connection open
2025-06-28 10:56:35,873 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 10:56:35,873 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 60260)
2025-06-28 10:56:35,873 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "debdd2...onnection_params": {}}}' [2313 bytes]
2025-06-28 10:56:35,873 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: deepsearch_server (ID: deepsearch)
2025-06-28 10:56:35,873 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: deepsearch_server
2025-06-28 10:56:35,873 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: deepsearch -> ws://localhost:8086/mcp
2025-06-28 10:56:35,873 - core.toolscore.core_manager - INFO - 工具立即可用: deepsearch
2025-06-28 10:56:35,873 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 10:56:35,874 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:56:35,874 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 10:56:35,874 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:56:35,874 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 10:56:35,874 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 10:56:35,874 - websockets.server - INFO - connection closed
2025-06-28 10:56:36,121 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 10:56:36,121 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 10:56:36,122 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 10:56:36,122 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 10:56:36,122 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 10:56:36,122 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 10:56:36,122 - websockets.server - DEBUG - < Sec-WebSocket-Key: iZ4hEqbEhtWO4KZZPp2NJQ==
2025-06-28 10:56:36,122 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 10:56:36,122 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:56:36,122 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:56:36,122 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 10:56:36,122 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 10:56:36,122 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 10:56:36,122 - websockets.server - DEBUG - > Sec-WebSocket-Accept: 1nmIV2BuoaWD5iBwjJHPywTHRJQ=
2025-06-28 10:56:36,122 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:56:36,122 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 02:56:36 GMT
2025-06-28 10:56:36,122 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 10:56:36,122 - websockets.server - INFO - connection open
2025-06-28 10:56:36,122 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 10:56:36,122 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 60262)
2025-06-28 10:56:36,122 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 10:56:36,122 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "7a117bab-63a5-4b65-8b93-29852d269248", "tool_spec": {"tool_id": "browser_use", "name": "browser_use_server", "description": "\u57fa\u4e8eBrowser-Use\u7684AI\u6d4f\u89c8\u5668\u81ea\u52a8\u5316\u670d\u52a1\u5668\uff0c\u5b8c\u6574\u5b9e\u73b0browser-use\u7684\u6240\u6709\u529f\u80fd", "tool_type": "mcp_server", "capabilities": [{"name": "browser_use_execute_task", "description": "\u4f7f\u7528AI\u6267\u884c\u590d\u6742\u7684\u6d4f\u89c8\u5668\u4efb\u52a1\uff0c\u652f\u6301\u81ea\u7136\u8bed\u8a00\u63cf\u8ff0", "parameters": {"task": {"type": "string", "description": "\u8981\u6267\u884c\u7684\u4efb\u52a1\u63cf\u8ff0\uff0c\u4f7f\u7528\u81ea\u7136\u8bed\u8a00", "required": true}, "max_steps": {"type": "integer", "description": "\u6700\u5927\u6267\u884c\u6b65\u9aa4\u6570\uff0c\u9ed8\u8ba450", "required": false}, "use_vision": {"type": "boolean", "description": "\u662f\u5426\u4f7f\u7528\u89c6\u89c9\u7406\u89e3\uff0c\u9ed8\u8ba4true", "required": false}}, "examples": [{"task": "\u641c\u7d22Python\u6559\u7a0b\u5e76\u6253\u5f00\u7b2c\u4e00\u4e2a\u7ed3\u679c"}, {"task": "\u5728GitHub\u4e0a\u641c\u7d22browser-use\u9879\u76ee\u5e76\u67e5\u770bREADME"}, {"task": "\u767b\u5f55\u7f51\u7ad9\u5e76\u586b\u5199\u8868\u5355", "use_vision": true}], "category": "general"}, {"name": "browser_navigate", "description": "\u5bfc\u822a\u5230\u6307\u5b9a\u7f51\u5740", "parameters": {"url": {"type": "string", "description": "\u8981\u8bbf\u95ee\u7684URL\u5730\u5740", "required": true}}, "examples": [{"url": "https://www.google.com"}, {"url": "https://github.com"}], "category": "general"}, {"name": "browser_search_google", "description": "\u5728Google\u4e2d\u641c\u7d22\u6307\u5b9a\u67e5\u8be2", "parameters": {"query": {"type": "string", "description": "\u641c\u7d22\u67e5\u8be2\u8bcd", "required": true}}, "examples": [{"query": "Python machine learning tutorial"}, {"query": "browser automation tools"}], "category": "general"}, {"name": "browser_go_back", "description": "\u8fd4\u56de\u4e0a\u4e00\u9875", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_click_element", "description": "\u901a\u8fc7\u7d22\u5f15\u70b9\u51fb\u9875\u9762\u5143\u7d20", "parameters": {"index": {"type": "integer", "description": "\u8981\u70b9\u51fb\u7684\u5143\u7d20\u7d22\u5f15", "required": true}}, "examples": [{"index": 1}, {"index": 5}], "category": "general"}, {"name": "browser_input_text", "description": "\u5728\u6307\u5b9a\u5143\u7d20\u4e2d\u8f93\u5165\u6587\u672c", "parameters": {"index": {"type": "integer", "description": "\u8981\u8f93\u5165\u6587\u672c\u7684\u5143\u7d20\u7d22\u5f15", "required": true}, "text": {"type": "string", "description": "\u8981\u8f93\u5165\u7684\u6587\u672c", "required": true}}, "examples": [{"index": 2, "text": "hello world"}, {"index": 0, "text": "test@example.com"}], "category": "general"}, {"name": "browser_send_keys", "description": "\u53d1\u9001\u7279\u6b8a\u952e\u6216\u5feb\u6377\u952e", "parameters": {"keys": {"type": "string", "description": "\u8981\u53d1\u9001\u7684\u952e\uff0c\u5982Enter\u3001Escape\u3001Control+c\u7b49", "required": true}}, "examples": [{"keys": "Enter"}, {"keys": "Control+c"}, {"keys": "Escape"}], "category": "general"}, {"name": "browser_scroll_down", "description": "\u5411\u4e0b\u6eda\u52a8\u9875\u9762", "parameters": {"amount": {"type": "integer", "description": "\u6eda\u52a8\u50cf\u7d20\u6570\uff0c\u4e0d\u6307\u5b9a\u5219\u6eda\u52a8\u4e00\u9875", "required": false}}, "examples": [{}, {"amount": 500}], "category": "general"}, {"name": "browser_scroll_up", "description": "\u5411\u4e0a\u6eda\u52a8\u9875\u9762", "parameters": {"amount": {"type": "integer", "description": "\u6eda\u52a8\u50cf\u7d20\u6570\uff0c\u4e0d\u6307\u5b9a\u5219\u6eda\u52a8\u4e00\u9875", "required": false}}, "examples": [{}, {"amount": 300}], "category": "general"}, {"name": "browser_scroll_to_text", "description": "\u6eda\u52a8\u5230\u5305\u542b\u6307\u5b9a\u6587\u672c\u7684\u5143\u7d20", "parameters": {"text": {"type": "string", "description": "\u8981\u6eda\u52a8\u5230\u7684\u6587\u672c\u5185\u5bb9", "required": true}}, "examples": [{"text": "Sign up"}, {"text": "Contact us"}], "category": "general"}, {"name": "browser_switch_tab", "description": "\u5207\u6362\u5230\u6307\u5b9a\u6807\u7b7e", "parameters": {"page_id": {"type": "integer", "description": "\u8981\u5207\u6362\u5230\u7684\u6807\u7b7eID", "required": true}}, "examples": [{"page_id": 0}, {"page_id": 1}], "category": "general"}, {"name": "browser_open_tab", "description": "\u5728\u65b0\u6807\u7b7e\u4e2d\u6253\u5f00URL", "parameters": {"url": {"type": "string", "description": "\u8981\u5728\u65b0\u6807\u7b7e\u4e2d\u6253\u5f00\u7684URL", "required": true}}, "examples": [{"url": "https://www.example.com"}], "category": "general"}, {"name": "browser_close_tab", "description": "\u5173\u95ed\u6307\u5b9a\u6807\u7b7e", "parameters": {"page_id": {"type": "integer", "description": "\u8981\u5173\u95ed\u7684\u6807\u7b7eID", "required": true}}, "examples": [{"page_id": 1}], "category": "general"}, {"name": "browser_extract_content", "description": "\u4ece\u9875\u9762\u63d0\u53d6\u7279\u5b9a\u5185\u5bb9", "parameters": {"goal": {"type": "string", "description": "\u63d0\u53d6\u76ee\u6807\u63cf\u8ff0", "required": true}, "include_links": {"type": "boolean", "description": "\u662f\u5426\u5305\u542b\u94fe\u63a5\uff0c\u9ed8\u8ba4false", "required": false}}, "examples": [{"goal": "\u63d0\u53d6\u6240\u6709\u516c\u53f8\u540d\u79f0"}, {"goal": "\u83b7\u53d6\u4ea7\u54c1\u4ef7\u683c\u4fe1\u606f", "include_links": true}], "category": "general"}, {"name": "browser_get_content", "description": "\u83b7\u53d6\u9875\u9762\u5185\u5bb9", "parameters": {"selector": {"type": "string", "description": "CSS\u9009\u62e9\u5668\uff0c\u7a7a\u5219\u83b7\u53d6\u5168\u90e8\u5185\u5bb9", "required": false}}, "examples": [{"selector": "h1, p"}, {}], "category": "general"}, {"name": "browser_get_ax_tree", "description": "\u83b7\u53d6\u9875\u9762\u7684\u53ef\u8bbf\u95ee\u6027\u6811\u7ed3\u6784", "parameters": {"number_of_elements": {"type": "integer", "description": "\u8fd4\u56de\u7684\u5143\u7d20\u6570\u91cf", "required": true}}, "examples": [{"number_of_elements": 50}], "category": "general"}, {"name": "browser_get_dropdown_options", "description": "\u83b7\u53d6\u4e0b\u62c9\u83dc\u5355\u7684\u6240\u6709\u9009\u9879", "parameters": {"index": {"type": "integer", "description": "\u4e0b\u62c9\u83dc\u5355\u5143\u7d20\u7684\u7d22\u5f15", "required": true}}, "examples": [{"index": 3}], "category": "general"}, {"name": "browser_select_dropdown_option", "description": "\u9009\u62e9\u4e0b\u62c9\u83dc\u5355\u4e2d\u7684\u9009\u9879", "parameters": {"index": {"type": "integer", "description": "\u4e0b\u62c9\u83dc\u5355\u5143\u7d20\u7684\u7d22\u5f15", "required": true}, "text": {"type": "string", "description": "\u8981\u9009\u62e9\u7684\u9009\u9879\u6587\u672c", "required": true}}, "examples": [{"index": 3, "text": "Option 1"}], "category": "general"}, {"name": "browser_drag_drop", "description": "\u6267\u884c\u62d6\u62fd\u64cd\u4f5c", "parameters": {"element_source": {"type": "string", "description": "\u6e90\u5143\u7d20\u9009\u62e9\u5668", "required": false}, "element_target": {"type": "string", "description": "\u76ee\u6807\u5143\u7d20\u9009\u62e9\u5668", "required": false}, "coord_source_x": {"type": "integer", "description": "\u6e90\u5750\u6807X", "required": false}, "coord_source_y": {"type": "integer", "description": "\u6e90\u5750\u6807Y", "required": false}, "coord_target_x": {"type": "integer", "description": "\u76ee\u6807\u5750\u6807X", "required": false}, "coord_target_y": {"type": "integer", "description": "\u76ee\u6807\u5750\u6807Y", "required": false}, "steps": {"type": "integer", "description": "\u62d6\u62fd\u6b65\u9aa4\u6570\uff0c\u9ed8\u8ba410", "required": false}}, "examples": [{"element_source": ".item1", "element_target": ".dropzone"}], "category": "general"}, {"name": "browser_save_pdf", "description": "\u5c06\u5f53\u524d\u9875\u9762\u4fdd\u5b58\u4e3aPDF", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_screenshot", "description": "\u622a\u53d6\u5f53\u524d\u9875\u9762\u622a\u56fe", "parameters": {"filename": {"type": "string", "description": "\u622a\u56fe\u6587\u4ef6\u540d\uff0c\u53ef\u9009", "required": false}}, "examples": [{"filename": "current_page.png"}, {}], "category": "general"}, {"name": "browser_wait", "description": "\u7b49\u5f85\u6307\u5b9a\u79d2\u6570", "parameters": {"seconds": {"type": "number", "description": "\u7b49\u5f85\u7684\u79d2\u6570\uff0c\u9ed8\u8ba43", "required": false}}, "examples": [{"seconds": 5}, {}], "category": "general"}, {"name": "browser_done", "description": "\u6807\u8bb0\u4efb\u52a1\u5b8c\u6210", "parameters": {"text": {"type": "string", "description": "\u5b8c\u6210\u63cf\u8ff0", "required": true}, "success": {"type": "boolean", "description": "\u662f\u5426\u6210\u529f\u5b8c\u6210", "required": true}}, "examples": [{"text": "\u4efb\u52a1\u5df2\u5b8c\u6210", "success": true}], "category": "general"}, {"name": "browser_get_page_info", "description": "\u83b7\u53d6\u5f53\u524d\u9875\u9762\u4fe1\u606f", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_get_current_url", "description": "\u83b7\u53d6\u5f53\u524d\u9875\u9762URL", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_close_session", "description": "\u5173\u95ed\u6d4f\u89c8\u5668\u4f1a\u8bdd", "parameters": {}, "examples": [{}], "category": "general"}], "endpoint": "ws://localhost:8084", "connection_params": {}}}
2025-06-28 10:56:36,122 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Waiting for registration response from toolscore...
2025-06-28 10:56:36,123 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "7a117b...onnection_params": {}}}' [9625 bytes]
2025-06-28 10:56:36,123 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: browser_use_server (ID: browser_use)
2025-06-28 10:56:36,123 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: browser_use_server
2025-06-28 10:56:36,123 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: browser_use -> ws://localhost:8084
2025-06-28 10:56:36,123 - core.toolscore.core_manager - INFO - 工具立即可用: browser_use
2025-06-28 10:56:36,123 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 10:56:36,123 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Received registration response: {"type": "register_tool_response", "request_id": "7a117bab-63a5-4b65-8b93-29852d269248", "success": true, "message": null}
2025-06-28 10:56:36,123 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Successfully registered with toolscore.
2025-06-28 10:56:36,123 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:56:36,123 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 10:56:36,123 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:56:36,123 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 10:56:36,123 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 10:56:36,123 - websockets.server - INFO - connection closed
2025-06-28 10:56:38,043 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:56:38,044 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:56:40,582 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第4次, 5s间隔)
2025-06-28 10:56:41,045 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:56:41,045 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:56:44,046 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:56:44,047 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:56:45,583 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第5次, 5s间隔)
2025-06-28 10:56:47,048 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:56:47,048 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:56:50,049 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:56:50,049 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:56:50,584 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第6次, 5s间隔)
2025-06-28 10:56:53,051 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:56:53,051 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:56:55,558 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 10:56:55,572 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 10:56:55,572 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 10:56:55,572 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 10:56:55,583 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 10:56:55,585 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第7次, 5s间隔)
2025-06-28 10:56:56,052 - services.mcp_server_launcher - DEBUG - ⏱️ microsandbox_server 就绪检测超时 (30秒)
2025-06-28 10:56:56,052 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 10:56:56,052 - services.mcp_server_launcher - INFO - ✅ 成功启动 4/4 个MCP服务器: ['microsandbox_server', 'search_tool_server', 'browser_use_server', 'deepsearch_server']
2025-06-28 10:56:56,052 - services.service_manager - INFO - 启动服务: task_api
2025-06-28 10:56:56,052 - services.task_api_service - INFO - 正在启动任务API服务...
2025-06-28 10:56:56,061 - services.task_api_service - INFO - 任务API服务已启动于 0.0.0.0:8000
2025-06-28 10:56:56,061 - services.service_manager - INFO - 启动服务: runtime
2025-06-28 10:56:56,061 - services.runtime_service - INFO - 正在启动推理运行时服务...
2025-06-28 10:56:56,061 - services.service_manager - INFO - 启动服务: synthesis
2025-06-28 10:56:56,061 - services.synthesis_service - INFO - 正在启动合成服务...
2025-06-28 10:56:56,061 - services.synthesis_service - INFO - 合成服务工作线程已启动
2025-06-28 10:56:56,061 - services.synthesis_service - INFO - 开始处理轨迹数据...
2025-06-28 10:56:56,061 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 10:56:56,062 - services.synthesis_service - INFO - SynthesisCore v2.0监控器工作线程已启动
2025-06-28 10:56:56,062 - core.synthesiscore.synthesis - INFO - 🔄 Processing only unprocessed trajectories...
2025-06-28 10:56:56,062 - services.synthesis_service - INFO - 🚀 启动SynthesisCore v2.0监控器
2025-06-28 10:56:56,062 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 10:56:56,062 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 10:56:56,062 - services.synthesis_service - INFO - 合成服务已启动
2025-06-28 10:56:56,062 - services.service_manager - INFO - 所有服务已启动
2025-06-28 10:56:56,062 - __main__ - DEBUG - ✅ 所有服务启动完成
2025-06-28 10:56:56,062 - __main__ - INFO - 🎉 所有服务已启动，系统运行中...
2025-06-28 10:56:56,063 - __main__ - INFO - 📊 系统状态监控已启用，按 Ctrl+C 停止
2025-06-28 10:56:56,063 - core.synthesiscore.synthesis - INFO - 🎯 Unprocessed trajectories completed: 0 new trajectories processed
2025-06-28 10:56:56,063 - services.runtime_service - INFO - 启动运行时实例: enhanced-reasoning-1
2025-06-28 10:56:56,063 - runtimes.reasoning.enhanced_runtime - INFO - 🚀 初始化Enhanced Reasoning Runtime - 简化版本
2025-06-28 10:56:56,063 - core.llm.response_parsers.reasoning_response_parser - DEBUG - ✅ 响应解析器已连接工具Schema管理器
2025-06-28 10:56:56,063 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 工具Schema管理器已注入到响应解析器
2025-06-28 10:56:56,063 - runtimes.reasoning.enhanced_runtime - INFO - ⏳ 等待ToolScore服务就绪...
2025-06-28 10:56:56,063 - services.synthesis_service - DEBUG - 等待 300 秒后再次处理...
2025-06-28 10:56:56,064 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ Redis连接初始化成功
2025-06-28 10:56:56,064 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:corpus_queue
2025-06-28 10:56:56,064 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:atomic_tasks
2025-06-28 10:56:56,065 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:10:56:56 +0800] "GET /health HTTP/1.1" 200 231 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 10:56:56,065 - runtimes.reasoning.toolscore_client - INFO - ✅ ToolScore服务已就绪
2025-06-28 10:56:56,065 - runtimes.reasoning.enhanced_runtime - INFO - ✅ ToolScore HTTP服务已就绪
2025-06-28 10:56:56,065 - runtimes.reasoning.enhanced_runtime - INFO - 🔌 正在连接WebSocket端点: ws://localhost:8081/websocket
2025-06-28 10:56:56,065 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:extended_tasks
2025-06-28 10:56:56,065 - runtimes.reasoning.real_time_tool_client - INFO - 🔌 连接到ToolScore实时更新: ws://localhost:8081/websocket
2025-06-28 10:56:56,066 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:verification_queue
2025-06-28 10:56:56,066 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 10:56:56,066 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:training_data
2025-06-28 10:56:56,066 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 10:56:56,066 - websockets.client - DEBUG - > GET /websocket HTTP/1.1
2025-06-28 10:56:56,067 - websockets.client - DEBUG - > Host: localhost:8081
2025-06-28 10:56:56,067 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 10:56:56,067 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 10:56:56,067 - websockets.client - DEBUG - > Sec-WebSocket-Key: ZQQKJaRpy5f/XTtQAN95BQ==
2025-06-28 10:56:56,067 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 10:56:56,067 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:quality_reports
2025-06-28 10:56:56,067 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:56:56,067 - websockets.client - DEBUG - > User-Agent: Enhanced-Reasoning-Runtime/1.0
[2025-06-28 10:56:56] INFO:     Started server process [71711]
[2025-06-28 10:56:56] INFO:     Waiting for application startup.
2025-06-28 10:56:56,067 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 10:56:56,067 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ Redis配置键初始化完成
2025-06-28 10:56:56,067 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 10:56:56,067 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ 增强合成Redis管理器初始化完成
2025-06-28 10:56:56,067 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 10:56:56,067 - core.synthesiscore.enhanced_synthesis_engine - INFO - ✅ Enhanced Synthesis Engine 初始化完成
2025-06-28 10:56:56,067 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 10:56:56,067 - core.synthesiscore.enhanced_synthesis_engine - INFO - 🚀 SynthesisCore v2.0 已启动
2025-06-28 10:56:56,067 - websockets.server - DEBUG - < Sec-WebSocket-Key: ZQQKJaRpy5f/XTtQAN95BQ==
2025-06-28 10:56:56,067 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 10:56:56,068 - core.synthesiscore.trajectory_monitor - INFO - 🔄 检查并处理现有轨迹...
2025-06-28 10:56:56,068 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:56:56,068 - core.synthesiscore.trajectory_monitor - INFO - 📝 没有现有轨迹文件
2025-06-28 10:56:56,068 - websockets.server - DEBUG - < User-Agent: Enhanced-Reasoning-Runtime/1.0
2025-06-28 10:56:56,068 - core.synthesiscore.trajectory_monitor - INFO - ✅ TrajectoryMonitor初始化完成
2025-06-28 10:56:56,068 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 10:56:56,068 - core.synthesiscore.trajectory_monitor - DEBUG - ✅ 获取主事件循环引用成功
2025-06-28 10:56:56,068 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 10:56:56,068 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 10:56:56,068 - websockets.server - DEBUG - > Sec-WebSocket-Accept: hpGYjuv/u1Z3FPzPAXTTbudZLRo=
2025-06-28 10:56:56,068 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:56:56,068 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 02:56:56 GMT
2025-06-28 10:56:56,068 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 10:56:56,069 - websockets.server - INFO - connection open
2025-06-28 10:56:56,069 - core.synthesiscore.trajectory_monitor - INFO - 👁️ 开始监控轨迹文件变化: output/trajectories
2025-06-28 10:56:56,069 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 10:56:56,069 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 10:56:56,069 - services.synthesis_service - INFO - ✅ SynthesisCore v2.0监控器已启动
2025-06-28 10:56:56,069 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 60302)
2025-06-28 10:56:56,069 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 10:56:56,069 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 10:56:56,069 - websockets.client - DEBUG - < Sec-WebSocket-Accept: hpGYjuv/u1Z3FPzPAXTTbudZLRo=
2025-06-28 10:56:56,069 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:56:56,069 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 02:56:56 GMT
2025-06-28 10:56:56,069 - core.task_api - INFO - Connected to Redis: redis://localhost:6379
2025-06-28 10:56:56,069 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
[2025-06-28 10:56:56] INFO:     Application startup complete.
2025-06-28 10:56:56,069 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 10:56:56,069 - runtimes.reasoning.real_time_tool_client - INFO - ✅ 已连接到ToolScore实时更新流
2025-06-28 10:56:56,069 - runtimes.reasoning.enhanced_runtime - INFO - ✅ WebSocket实时更新连接成功
2025-06-28 10:56:56,069 - runtimes.reasoning.real_time_tool_client - DEBUG - 已注册工具更新回调，当前回调数量: 1
2025-06-28 10:56:56,069 - runtimes.reasoning.enhanced_runtime - INFO - ⏳ 等待关键工具完全就绪...
2025-06-28 10:56:56,069 - runtimes.reasoning.enhanced_runtime - WARNING - 🚀 临时跳过详细工具等待，快速启动模式
2025-06-28 10:56:56,069 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 使用快速启动模式，工具将在后台异步就绪
2025-06-28 10:56:56,069 - runtimes.reasoning.enhanced_runtime - INFO - 🔍 开始MCP服务器同步验证...
2025-06-28 10:56:56,069 - core.tool_schema_manager - INFO - 正在执行MCP同步验证...
2025-06-28 10:56:56,069 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=False)，当前缓存: 0 个工具
[2025-06-28 10:56:56] INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-06-28 10:56:56,070 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 10:56:56,070 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
2025-06-28 10:56:56,070 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 10:56:56,070 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
2025-06-28 10:56:56,070 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
2025-06-28 10:56:56,070 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 10:56:56,070 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 10:56:56,070 - core.tool_schema_manager - INFO - 🔄 检测到 4 个工具需要更新: ['deepsearch', 'microsandbox', 'browser_use', 'mcp-search-tool']
2025-06-28 10:56:56,070 - core.tool_schema_manager - INFO - 🔄 执行增量更新: 4 个工具
2025-06-28 10:56:56,070 - core.tool_schema_manager - INFO - 🔄 缓存为空，转为全量刷新模式
2025-06-28 10:56:56,070 - core.tool_schema_manager - DEBUG - 🔄 开始增强刷新工具Schemas...
2025-06-28 10:56:56,070 - core.tool_schema_manager - DEBUG - 🔍 工具注册表状态检查: _tools 字典包含 4 个条目
2025-06-28 10:56:56,070 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: deepsearch
2025-06-28 10:56:56,070 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: microsandbox
2025-06-28 10:56:56,070 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: browser_use
2025-06-28 10:56:56,070 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: mcp-search-tool
2025-06-28 10:56:56,070 - core.tool_schema_manager - INFO - 🔧 选项1: 从工具注册表获取到 4 个工具
2025-06-28 10:56:56,070 - core.tool_schema_manager - DEBUG -   工具 0: id=deepsearch, name=网络信息研究工具, actions=3
2025-06-28 10:56:56,070 - core.tool_schema_manager - DEBUG -   工具 1: id=microsandbox, name=MicroSandbox安全代码执行器, actions=7
2025-06-28 10:56:56,070 - core.tool_schema_manager - DEBUG -   工具 2: id=browser_use, name=智能浏览器操作工具, actions=6
2025-06-28 10:56:56,070 - core.tool_schema_manager - DEBUG -   工具 3: id=mcp-search-tool, name=工具管理和项目文件搜索器, actions=4
2025-06-28 10:56:56,070 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: deepsearch
2025-06-28 10:56:56,071 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: comprehensive_research
2025-06-28 10:56:56,071 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: quick_research
2025-06-28 10:56:56,071 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: research
2025-06-28 10:56:56,071 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 deepsearch (包含 3 个动作)
2025-06-28 10:56:56,071 - core.tool_schema_manager - DEBUG -    当前缓存大小: 1 个工具
2025-06-28 10:56:56,071 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: microsandbox
2025-06-28 10:56:56,071 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_cleanup_expired
2025-06-28 10:56:56,071 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_close_session
2025-06-28 10:56:56,072 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_execute
2025-06-28 10:56:56,072 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_health_status
2025-06-28 10:56:56,072 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_performance_stats
2025-06-28 10:56:56,072 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_install_package
2025-06-28 10:56:56,072 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_list_sessions
2025-06-28 10:56:56,072 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 microsandbox (包含 7 个动作)
2025-06-28 10:56:56,072 - core.tool_schema_manager - DEBUG -    当前缓存大小: 2 个工具
2025-06-28 10:56:56,072 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: browser_use
2025-06-28 10:56:56,072 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_click_element
2025-06-28 10:56:56,072 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_use_execute_task
2025-06-28 10:56:56,072 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_extract_content
2025-06-28 10:56:56,073 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_input_text
2025-06-28 10:56:56,073 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_navigate
2025-06-28 10:56:56,073 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_search_google
2025-06-28 10:56:56,073 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 browser_use (包含 6 个动作)
2025-06-28 10:56:56,073 - core.tool_schema_manager - DEBUG -    当前缓存大小: 3 个工具
2025-06-28 10:56:56,073 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: mcp-search-tool
2025-06-28 10:56:56,073 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: analyze_tool_needs
2025-06-28 10:56:56,073 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: list_code_definitions
2025-06-28 10:56:56,073 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_and_install_tools
2025-06-28 10:56:56,073 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_file_content
2025-06-28 10:56:56,073 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 mcp-search-tool (包含 4 个动作)
2025-06-28 10:56:56,073 - core.tool_schema_manager - DEBUG -    当前缓存大小: 4 个工具
2025-06-28 10:56:56,073 - core.tool_schema_manager - INFO - 🔧 选项1: 成功处理 4/4 个工具，当前缓存 4 个工具
2025-06-28 10:56:56,074 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: mcp-search-tool
2025-06-28 10:56:56,074 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: microsandbox
2025-06-28 10:56:56,074 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: browser_use
2025-06-28 10:56:56,074 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: deepsearch
2025-06-28 10:56:56,074 - core.tool_schema_manager - INFO - ✅ 增强刷新完成，当前可用工具: 4个
2025-06-28 10:56:56,075 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 10:56:56,075 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 10:56:56,075 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 10:56:56,075 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 10:56:56,076 - core.tool_schema_manager - INFO - ✅ Schema安全刷新完成，备份 4 个工具
2025-06-28 10:56:56,076 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 10:56:56,076 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 10:56:56,076 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 10:56:56,076 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 10:56:56,076 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 10:56:56,076 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 10:56:56,076 - core.tool_schema_manager - INFO - 🔍 同步验证完成: unhealthy (0/4 工具Schema一致)
2025-06-28 10:56:56,076 - runtimes.reasoning.enhanced_runtime - ERROR - ❌ MCP服务器同步验证失败: 未知错误
2025-06-28 10:56:56,077 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔧 开始获取可用工具ID列表...
2025-06-28 10:56:56,077 - runtimes.reasoning.real_time_tool_client - DEBUG - 可用工具ID列表: ['mcp-search-tool', 'deepsearch', 'browser_use', 'microsandbox']
2025-06-28 10:56:56,077 - runtimes.reasoning.enhanced_runtime - DEBUG - 📋 获取到的工具列表: ['mcp-search-tool', 'deepsearch', 'browser_use', 'microsandbox']
2025-06-28 10:56:56,077 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 工具Schema管理器已初始化
2025-06-28 10:56:56,077 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔧 更新Guardrails和ValidationCritic工具配置...
2025-06-28 10:56:56,077 - core.llm.guardrails_middleware - INFO - 🔧 初始化输入验证Guard...
2025-06-28 10:56:56,078 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 10:56:56,079 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 10:56:56,079 - core.llm.guardrails_middleware - INFO - 🔧 初始化输出验证Guard...
2025-06-28 10:56:56,079 - core.llm.guardrails_middleware - WARNING - ⚠️ 未提供LLM客户端，Guard将无法执行基于LLM的修正。回退到无API的Guard。
2025-06-28 10:56:56,080 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 10:56:56,080 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 10:56:56,080 - core.llm.guardrails_middleware - INFO - ✅ Guardrails Guards初始化成功
2025-06-28 10:56:56,080 - core.llm.guardrails_middleware - INFO -    - 输入Guard: ✅
2025-06-28 10:56:56,080 - core.llm.guardrails_middleware - INFO -    - 输出Guard: ✅
2025-06-28 10:56:56,080 - core.llm.guardrails_middleware - INFO - 🔄 Guardrails工具列表已更新: 4个工具
2025-06-28 10:56:56,080 - core.agents.validation_critic - INFO - 🔄 ValidationCritic工具列表已更新: 4个工具
2025-06-28 10:56:56,080 - runtimes.reasoning.enhanced_runtime - INFO - ✅ Guardrails和ValidationCritic已配置4个工具: mcp-search-tool, deepsearch, browser_use, microsandbox
2025-06-28 10:56:56,080 - runtimes.reasoning.enhanced_runtime - INFO - ✅ Enhanced Reasoning Runtime 已成功初始化为纯推理引擎（集成Guardrails + ValidationCritic）
2025-06-28 10:56:56,081 - services.runtime_service - INFO - 启动运行时任务消费: enhanced-reasoning-1
2025-06-28 10:56:56,081 - services.runtime_service - INFO - 推理运行时服务已启动 1 个实例和 1 个任务消费协程
2025-06-28 10:56:56,081 - core.tool_schema_manager - INFO - 🔍 启动MCP服务器配置监控...
2025-06-28 10:56:56,081 - core.task_manager - INFO - Runtime enhanced-reasoning-1 starting to consume from queue: tasks:reasoning
2025-06-28 10:56:56,082 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/search_tool_server/service.json
2025-06-28 10:56:56,082 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/microsandbox_server/service.json
2025-06-28 10:56:56,082 - core.task_manager - INFO - Runtime enhanced-reasoning-1 starting consumer loop for queue tasks:reasoning
2025-06-28 10:56:56,082 - core.task_manager - DEBUG - Runtime enhanced-reasoning-1 reading from queue tasks:reasoning...
2025-06-28 10:56:56,082 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/browser_use_server/service.json
2025-06-28 10:56:56,083 - core.task_manager - INFO - Runtime enhanced-reasoning-1 received 1 message(s) from queue tasks:reasoning
2025-06-28 10:56:56,083 - core.task_manager - INFO - Runtime enhanced-reasoning-1 processing message b'1751016872624-0'
2025-06-28 10:56:56,083 - core.task_manager - INFO - Processing task 9ead0806-b09e-40a8-b4e9-a4e0e4eba0f4 from queue tasks:reasoning
2025-06-28 10:56:56,083 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/deepsearch_server/service.json
2025-06-28 10:56:56,083 - core.tool_schema_manager - INFO - 🔄 MCP配置变化，强制刷新schema...
2025-06-28 10:56:56,083 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=True)，当前缓存: 0 个工具
2025-06-28 10:56:56,083 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 10:56:56,083 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
2025-06-28 10:56:56,083 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 10:56:56,083 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
2025-06-28 10:56:56,083 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
2025-06-28 10:56:56,083 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 10:56:56,083 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 10:56:56,083 - core.tool_schema_manager - INFO - 🔄 检测到 4 个工具需要更新: ['deepsearch', 'microsandbox', 'browser_use', 'mcp-search-tool']
2025-06-28 10:56:56,083 - core.tool_schema_manager - INFO - 🔄 执行增量更新: 4 个工具
2025-06-28 10:56:56,083 - core.tool_schema_manager - INFO - 🔄 缓存为空，转为全量刷新模式
2025-06-28 10:56:56,083 - core.tool_schema_manager - DEBUG - 🔄 开始增强刷新工具Schemas...
2025-06-28 10:56:56,083 - core.tool_schema_manager - DEBUG - 🔍 工具注册表状态检查: _tools 字典包含 4 个条目
2025-06-28 10:56:56,083 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: deepsearch
2025-06-28 10:56:56,083 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: microsandbox
2025-06-28 10:56:56,083 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: browser_use
2025-06-28 10:56:56,083 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: mcp-search-tool
2025-06-28 10:56:56,083 - core.tool_schema_manager - INFO - 🔧 选项1: 从工具注册表获取到 4 个工具
2025-06-28 10:56:56,083 - core.tool_schema_manager - DEBUG -   工具 0: id=deepsearch, name=网络信息研究工具, actions=3
2025-06-28 10:56:56,083 - core.tool_schema_manager - DEBUG -   工具 1: id=microsandbox, name=MicroSandbox安全代码执行器, actions=7
2025-06-28 10:56:56,083 - core.tool_schema_manager - DEBUG -   工具 2: id=browser_use, name=智能浏览器操作工具, actions=6
2025-06-28 10:56:56,083 - core.tool_schema_manager - DEBUG -   工具 3: id=mcp-search-tool, name=工具管理和项目文件搜索器, actions=4
2025-06-28 10:56:56,083 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: deepsearch
2025-06-28 10:56:56,084 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: comprehensive_research
2025-06-28 10:56:56,084 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: quick_research
2025-06-28 10:56:56,084 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: research
2025-06-28 10:56:56,084 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 deepsearch (包含 3 个动作)
2025-06-28 10:56:56,084 - core.tool_schema_manager - DEBUG -    当前缓存大小: 1 个工具
2025-06-28 10:56:56,084 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: microsandbox
2025-06-28 10:56:56,084 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_cleanup_expired
2025-06-28 10:56:56,084 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_close_session
2025-06-28 10:56:56,085 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_execute
2025-06-28 10:56:56,085 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_health_status
2025-06-28 10:56:56,085 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_performance_stats
2025-06-28 10:56:56,085 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_install_package
2025-06-28 10:56:56,085 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_list_sessions
2025-06-28 10:56:56,085 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 microsandbox (包含 7 个动作)
2025-06-28 10:56:56,085 - core.tool_schema_manager - DEBUG -    当前缓存大小: 2 个工具
2025-06-28 10:56:56,085 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: browser_use
2025-06-28 10:56:56,085 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_click_element
2025-06-28 10:56:56,086 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-48' coro=<start.<locals>.start_all_runtimes() running at /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/services/runtime_service.py:94> wait_for=<_GatheringFuture pending cb=[Task.task_wakeup()]>>
2025-06-28 10:56:56,086 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='runtime-enhanced-reasoning-1' coro=<start_runtime_service() running at /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/core/task_manager.py:388> wait_for=<Future pending cb=[Task.task_wakeup()]> cb=[gather.<locals>._done_callback() at /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/tasks.py:764]>
2025-06-28 10:56:56,086 - core.task_manager - ERROR - ❌ Runtime enhanced-reasoning-1 crashed: coroutine ignored GeneratorExit
Traceback (most recent call last):
  File "/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/core/task_manager.py", line 388, in start_runtime_service
    await _run_service()
RuntimeError: coroutine ignored GeneratorExit
[2025-06-28 10:56:56] Exception ignored in: [2025-06-28 10:56:56] <coroutine object start_runtime_service at 0x10e1f4400>
[2025-06-28 10:56:56] Traceback (most recent call last):
[2025-06-28 10:56:56]   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/pydantic/json_schema.py", line 463, in generate_inner
    [2025-06-28 10:56:56] def handler_func(schema_or_field: CoreSchemaOrField) -> JsonSchemaValue:
[2025-06-28 10:56:56] RuntimeError[2025-06-28 10:56:56] : [2025-06-28 10:56:56] coroutine ignored GeneratorExit
2025-06-28 10:56:56,087 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_use_execute_task
2025-06-28 10:56:56,087 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_extract_content
2025-06-28 10:56:56,087 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_input_text
2025-06-28 10:56:56,087 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_navigate
2025-06-28 10:56:56,087 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_search_google
2025-06-28 10:56:56,087 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 browser_use (包含 6 个动作)
2025-06-28 10:56:56,087 - core.tool_schema_manager - DEBUG -    当前缓存大小: 3 个工具
2025-06-28 10:56:56,087 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: mcp-search-tool
2025-06-28 10:56:56,088 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: analyze_tool_needs
2025-06-28 10:56:56,088 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: list_code_definitions
2025-06-28 10:56:56,088 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_and_install_tools
2025-06-28 10:56:56,088 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_file_content
2025-06-28 10:56:56,088 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 mcp-search-tool (包含 4 个动作)
2025-06-28 10:56:56,088 - core.tool_schema_manager - DEBUG -    当前缓存大小: 4 个工具
2025-06-28 10:56:56,088 - core.tool_schema_manager - INFO - 🔧 选项1: 成功处理 4/4 个工具，当前缓存 4 个工具
2025-06-28 10:56:56,088 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: mcp-search-tool
2025-06-28 10:56:56,088 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: microsandbox
2025-06-28 10:56:56,088 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: browser_use
2025-06-28 10:56:56,088 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: deepsearch
2025-06-28 10:56:56,089 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:10:56:56 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 10:56:56,089 - core.tool_schema_manager - DEBUG - 🔍 从ToolScore获取到工具列表: ['mcp-search-tool', 'microsandbox', 'browser_use', 'deepsearch']
2025-06-28 10:56:56,089 - core.tool_schema_manager - DEBUG - 🔧 映射后的工具列表: ['mcp-search-tool', 'microsandbox', 'browser_use', 'deepsearch']
2025-06-28 10:56:56,089 - core.tool_schema_manager - DEBUG - ⏭️ 工具 mcp-search-tool 已在缓存中，跳过ToolScore获取
2025-06-28 10:56:56,089 - core.tool_schema_manager - DEBUG - ⏭️ 工具 microsandbox 已在缓存中，跳过ToolScore获取
2025-06-28 10:56:56,089 - core.tool_schema_manager - DEBUG - ⏭️ 工具 browser_use 已在缓存中，跳过ToolScore获取
2025-06-28 10:56:56,089 - core.tool_schema_manager - DEBUG - ⏭️ 工具 deepsearch 已在缓存中，跳过ToolScore获取
2025-06-28 10:56:56,089 - core.tool_schema_manager - INFO - ✅ 增强刷新完成，当前可用工具: 4个
2025-06-28 10:56:56,089 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 10:56:56,089 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 10:56:56,090 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 10:56:56,090 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 10:56:56,090 - core.tool_schema_manager - INFO - ✅ Schema安全刷新完成，备份 4 个工具
2025-06-28 10:56:56,090 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 10:56:56,090 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 10:56:56,090 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 10:56:56,091 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 10:56:56,091 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 10:56:56,091 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 10:57:00,586 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第8次, 5s间隔)
2025-06-28 10:57:05,588 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第9次, 5s间隔)
2025-06-28 10:57:10,589 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第10次, 5s间隔)
2025-06-28 10:57:15,590 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第11次, 5s间隔)
2025-06-28 10:57:16,075 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 10:57:16,076 - websockets.client - DEBUG - > PING c4 6f dd 6d [binary, 4 bytes]
2025-06-28 10:57:16,076 - websockets.server - DEBUG - < PING c4 6f dd 6d [binary, 4 bytes]
2025-06-28 10:57:16,076 - websockets.server - DEBUG - > PONG c4 6f dd 6d [binary, 4 bytes]
2025-06-28 10:57:16,076 - websockets.client - DEBUG - < PONG c4 6f dd 6d [binary, 4 bytes]
2025-06-28 10:57:16,076 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 10:57:20,592 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第12次, 5s间隔)
2025-06-28 10:57:25,564 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 10:57:25,578 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 10:57:25,579 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 10:57:25,579 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 10:57:25,589 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 10:57:25,593 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第13次, 30s间隔)
2025-06-28 10:57:26,069 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 10:57:26,069 - websockets.server - DEBUG - > PING 33 1a bb c9 [binary, 4 bytes]
2025-06-28 10:57:26,070 - websockets.client - DEBUG - < PING 33 1a bb c9 [binary, 4 bytes]
2025-06-28 10:57:26,070 - websockets.client - DEBUG - > PONG 33 1a bb c9 [binary, 4 bytes]
2025-06-28 10:57:26,070 - websockets.server - DEBUG - < PONG 33 1a bb c9 [binary, 4 bytes]
2025-06-28 10:57:26,070 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 10:57:36,077 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 10:57:36,078 - websockets.client - DEBUG - > PING 6a 79 32 bc [binary, 4 bytes]
2025-06-28 10:57:36,079 - websockets.server - DEBUG - < PING 6a 79 32 bc [binary, 4 bytes]
2025-06-28 10:57:36,079 - websockets.server - DEBUG - > PONG 6a 79 32 bc [binary, 4 bytes]
2025-06-28 10:57:36,079 - websockets.client - DEBUG - < PONG 6a 79 32 bc [binary, 4 bytes]
2025-06-28 10:57:36,079 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 10:57:55,569 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 10:57:55,580 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 10:57:55,581 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 10:57:55,582 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 10:57:55,590 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 10:57:55,592 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第14次, 30s间隔)
2025-06-28 10:57:56,061 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 1m 0s
2025-06-28 10:57:56,069 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 10:57:56,070 - websockets.server - DEBUG - > PING a3 0f 29 23 [binary, 4 bytes]
2025-06-28 10:57:56,070 - websockets.client - DEBUG - < PING a3 0f 29 23 [binary, 4 bytes]
2025-06-28 10:57:56,070 - websockets.client - DEBUG - > PONG a3 0f 29 23 [binary, 4 bytes]
2025-06-28 10:57:56,070 - websockets.server - DEBUG - < PONG a3 0f 29 23 [binary, 4 bytes]
2025-06-28 10:57:56,070 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 10:57:56,078 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 10:57:56,078 - websockets.client - DEBUG - > PING b8 b0 77 69 [binary, 4 bytes]
2025-06-28 10:57:56,079 - websockets.server - DEBUG - < PING b8 b0 77 69 [binary, 4 bytes]
2025-06-28 10:57:56,079 - websockets.server - DEBUG - > PONG b8 b0 77 69 [binary, 4 bytes]
2025-06-28 10:57:56,079 - websockets.client - DEBUG - < PONG b8 b0 77 69 [binary, 4 bytes]
2025-06-28 10:57:56,079 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 10:58:16,060 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 10:58:16,062 - websockets.client - DEBUG - > PING a9 f3 19 4e [binary, 4 bytes]
2025-06-28 10:58:16,063 - websockets.server - DEBUG - < PING a9 f3 19 4e [binary, 4 bytes]
2025-06-28 10:58:16,063 - websockets.server - DEBUG - > PONG a9 f3 19 4e [binary, 4 bytes]
2025-06-28 10:58:16,063 - websockets.client - DEBUG - < PONG a9 f3 19 4e [binary, 4 bytes]
2025-06-28 10:58:16,063 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 10:58:25,553 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 10:58:25,562 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 10:58:25,565 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 10:58:25,565 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 10:58:25,569 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第15次, 30s间隔)
2025-06-28 10:58:25,571 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 10:58:26,048 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 10:58:26,048 - websockets.server - DEBUG - > PING f2 ef 00 c1 [binary, 4 bytes]
2025-06-28 10:58:26,049 - websockets.client - DEBUG - < PING f2 ef 00 c1 [binary, 4 bytes]
2025-06-28 10:58:26,049 - websockets.client - DEBUG - > PONG f2 ef 00 c1 [binary, 4 bytes]
2025-06-28 10:58:26,049 - websockets.server - DEBUG - < PONG f2 ef 00 c1 [binary, 4 bytes]
2025-06-28 10:58:26,049 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 10:58:36,059 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 10:58:36,059 - websockets.client - DEBUG - > PING bf a5 18 11 [binary, 4 bytes]
2025-06-28 10:58:36,059 - websockets.server - DEBUG - < PING bf a5 18 11 [binary, 4 bytes]
2025-06-28 10:58:36,059 - websockets.server - DEBUG - > PONG bf a5 18 11 [binary, 4 bytes]
2025-06-28 10:58:36,059 - websockets.client - DEBUG - < PONG bf a5 18 11 [binary, 4 bytes]
2025-06-28 10:58:36,059 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 10:58:55,552 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 10:58:55,564 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 10:58:55,564 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 10:58:55,564 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 10:58:55,566 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第16次, 30s间隔)
2025-06-28 10:58:55,571 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 10:58:56,035 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 2m 0s
2025-06-28 10:58:56,047 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 10:58:56,047 - websockets.server - DEBUG - > PING 11 24 f3 92 [binary, 4 bytes]
2025-06-28 10:58:56,047 - websockets.client - DEBUG - < PING 11 24 f3 92 [binary, 4 bytes]
2025-06-28 10:58:56,047 - websockets.client - DEBUG - > PONG 11 24 f3 92 [binary, 4 bytes]
2025-06-28 10:58:56,047 - websockets.server - DEBUG - < PONG 11 24 f3 92 [binary, 4 bytes]
2025-06-28 10:58:56,047 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 10:58:56,058 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 10:58:56,058 - websockets.client - DEBUG - > PING 61 00 15 fe [binary, 4 bytes]
2025-06-28 10:58:56,059 - websockets.server - DEBUG - < PING 61 00 15 fe [binary, 4 bytes]
2025-06-28 10:58:56,059 - websockets.server - DEBUG - > PONG 61 00 15 fe [binary, 4 bytes]
2025-06-28 10:58:56,059 - websockets.client - DEBUG - < PONG 61 00 15 fe [binary, 4 bytes]
2025-06-28 10:58:56,059 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 10:59:03,860 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 10:59:03,860 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 10:59:03,860 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 10:59:03,860 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 10:59:03,860 - services.synthesis_service - INFO - 🛑 SynthesisCore v2.0监控器已停止
2025-06-28 10:59:03,860 - services.synthesis_service - INFO - 等待合成服务线程结束...
2025-06-28 10:59:04,171 - core.synthesiscore.trajectory_monitor - INFO - 🛑 轨迹文件监控已停止
2025-06-28 10:59:04,171 - core.synthesiscore.enhanced_synthesis_engine - ERROR - ❌ Enhanced Synthesis Engine 关闭失败: object NoneType can't be used in 'await' expression
2025-06-28 10:59:04,172 - core.synthesiscore.enhanced_synthesis_engine - INFO - 🔒 SynthesisCore v2.0 已关闭
2025-06-28 10:59:04,172 - core.synthesiscore.trajectory_monitor - INFO - 🔒 SynthesisCore已关闭
2025-06-28 10:59:04,172 - services.synthesis_service - INFO - SynthesisCore v2.0监控器工作线程已停止
2025-06-28 10:59:04,525 - services.synthesis_service - INFO - 合成服务工作线程已停止
2025-06-28 10:59:04,528 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 10:59:04,528 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 10:59:04,528 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 10:59:04,528 - services.runtime_service - INFO - 停止运行时实例: enhanced-reasoning-1
2025-06-28 10:59:04,528 - services.runtime_service - WARNING - 运行时清理失败: asyncio.run() cannot be called from a running event loop
[2025-06-28 10:59:04] /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/services/runtime_service.py:117: RuntimeWarning: coroutine 'EnhancedReasoningRuntime.cleanup' was never awaited
  logger.warning(f"运行时清理失败: {e}")
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
2025-06-28 10:59:04,530 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 10:59:04,530 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 10:59:04,530 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 10:59:04,530 - services.task_api_service - INFO - 已发送停止信号给任务API服务器
[2025-06-28 10:59:04] INFO:     Shutting down
[2025-06-28 10:59:04] INFO:     Waiting for application shutdown.
[2025-06-28 10:59:04] INFO:     Application shutdown complete.
[2025-06-28 10:59:04] INFO:     Finished server process [71711]
2025-06-28 10:59:04,701 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 10:59:04,702 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 10:59:04,702 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 10:59:04,702 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 10:59:04,705 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 10:59:04,705 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 10:56:25,793 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 10:56:25,794 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 10:56:25,794 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 10:56:25,794 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 10:56:25,794 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 10:56:25,794 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 10:56:25,794 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 10:56:25,794 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 10:56:25,794 - __main__ - INFO -   Listen Port: 8090
2025-06-28 10:56:25,794 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 10:56:25,794 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 10:56:25,794 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 10:56:25,794 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 10:56:25,794 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 10:56:25,797 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 10:56:25,797 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 10:56:25,797 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 10:56:25,797 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 10:56:35,798 - core.toolscore.mcp_server - INFO - [microsandbox_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 10:56:35,800 - core.toolscore.mcp_server - INFO - [microsandbox_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 10:56:35,800 - core.toolscore.mcp_server - INFO - [microsandbox_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "77007f98-aa2b-4413-b6cf-ec5a522b5d7f", "tool_spec": {"tool_id": "microsandbox", "name": "microsandbox_server", "description": "\u57fa\u4e8eMicroSandbox\u7684\u5b89\u5168Python\u4ee3\u7801\u6267\u884c\u670d\u52a1\u5668", "tool_type": "mcp_server", "capabilities": [{"name": "microsandbox_execute", "description": "\u5728MicroSandbox\u5b89\u5168\u73af\u5883\u4e2d\u6267\u884cPython\u4ee3\u7801", "parameters": {"code": {"type": "string", "description": "\u8981\u6267\u884c\u7684Python\u4ee3\u7801", "required": true}, "session_id": {"type": "string", "description": "\u4f1a\u8bddID\uff0c\u7528\u4e8e\u591a\u8f6e\u6267\u884c\u548c\u72b6\u6001\u4fdd\u6301", "required": false}, "timeout": {"type": "integer", "description": "\u6267\u884c\u8d85\u65f6\u65f6\u95f4\uff08\u79d2\uff09\uff0c\u9ed8\u8ba430\u79d2\uff0c\u6700\u5927300\u79d2\u3002\u6ce8\u610f\uff1aMicroSandbox\u5185\u90e8\u6709\u81ea\u5df1\u7684\u8d85\u65f6\u673a\u5236\uff0c\u6b64\u53c2\u6570\u4e3b\u8981\u7528\u4e8e\u6587\u6863\u8bf4\u660e", "required": false}}, "examples": [{"code": "print('Hello from MicroSandbox!')"}, {"code": "import math\\nresult = math.sqrt(16)\\nprint(f'\u5e73\u65b9\u6839: {result}')", "timeout": 10}, {"code": "x = 42", "session_id": "my-session"}, {"code": "print(f'x = {x}')", "session_id": "my-session"}], "category": "general"}, {"name": "microsandbox_install_package", "description": "\u5728MicroSandbox\u73af\u5883\u4e2d\u5b89\u88c5Python\u5305", "parameters": {"package_name": {"type": "string", "description": "\u8981\u5b89\u88c5\u7684\u5305\u540d", "required": true}, "version": {"type": "string", "description": "\u6307\u5b9a\u7248\u672c\u53f7", "required": false}, "session_id": {"type": "string", "description": "\u4f1a\u8bddID", "required": false}}, "examples": [{"package_name": "requests"}, {"package_name": "numpy", "version": "1.21.0"}, {"package_name": "pandas", "session_id": "data-analysis"}], "category": "general"}, {"name": "microsandbox_list_sessions", "description": "\u5217\u51fa\u5f53\u524d\u6d3b\u8dc3\u7684\u6c99\u7bb1\u4f1a\u8bdd", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "microsandbox_close_session", "description": "\u5173\u95ed\u6307\u5b9a\u7684\u6c99\u7bb1\u4f1a\u8bdd", "parameters": {"session_id": {"type": "string", "description": "\u8981\u5173\u95ed\u7684\u4f1a\u8bddID", "required": true}}, "examples": [{"session_id": "my-session"}], "category": "general"}, {"name": "microsandbox_cleanup_expired", "description": "\u6e05\u7406\u8fc7\u671f\u7684\u6c99\u7bb1\u4f1a\u8bdd", "parameters": {"max_age": {"type": "integer", "description": "\u6700\u5927\u4f1a\u8bdd\u5e74\u9f84\uff08\u79d2\uff09\uff0c\u9ed8\u8ba4\u4e3a\u914d\u7f6e\u7684\u8d85\u65f6\u65f6\u95f4", "required": false}}, "examples": [{}, {"max_age": 1800}], "category": "general"}, {"name": "microsandbox_get_performance_stats", "description": "\u83b7\u53d6\u670d\u52a1\u5668\u6027\u80fd\u7edf\u8ba1\u4fe1\u606f", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "microsandbox_get_health_status", "description": "\u83b7\u53d6\u670d\u52a1\u5668\u5065\u5eb7\u72b6\u6001", "parameters": {}, "examples": [{}], "category": "general"}], "endpoint": "ws://localhost:8090", "connection_params": {}}}
2025-06-28 10:56:35,800 - core.toolscore.mcp_server - INFO - [microsandbox_server] Waiting for registration response from toolscore...
2025-06-28 10:56:35,801 - core.toolscore.mcp_server - INFO - [microsandbox_server] Received registration response: {"type": "register_tool_response", "request_id": "77007f98-aa2b-4413-b6cf-ec5a522b5d7f", "success": true, "message": null}
2025-06-28 10:56:35,801 - core.toolscore.mcp_server - INFO - [microsandbox_server] Successfully registered with toolscore.

2025-06-28 10:59:04,705 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 10:59:04,705 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 10:59:04,705 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 10:59:04,707 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 10:59:04,707 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 10:56:25,707 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 10:56:25,707 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 10:56:25,707 - __main__ - INFO - Starting search_tool_server...
2025-06-28 10:56:25,707 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 10:56:25,711 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 10:56:25,711 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 10:56:25,711 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 10:56:25,711 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 10:56:26,188 - websockets.server - INFO - connection open
2025-06-28 10:56:26,188 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 60208)
2025-06-28 10:56:26,189 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 10:56:26,189 - websockets.server - INFO - connection closed
2025-06-28 10:56:35,712 - core.toolscore.mcp_server - INFO - [search_tool_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 10:56:35,713 - core.toolscore.mcp_server - INFO - [search_tool_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 10:56:35,713 - core.toolscore.mcp_server - INFO - [search_tool_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "b31532a9-5fe5-4abc-93e5-33a738227733", "tool_spec": {"tool_id": "mcp-search-tool", "name": "search_tool_server", "description": "\u6587\u4ef6\u5185\u5bb9\u641c\u7d22\u548c\u4ee3\u7801\u5b9a\u4e49\u641c\u7d22\u5de5\u5177\u670d\u52a1\u5668", "tool_type": "mcp_server", "capabilities": [{"name": "search_file_content", "description": "\u5728\u6307\u5b9a\u6587\u4ef6\u4e2d\u641c\u7d22\u5339\u914d\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5185\u5bb9", "parameters": {"file_path": {"type": "string", "description": "\u8981\u641c\u7d22\u7684\u6587\u4ef6\u8def\u5f84", "required": true}, "regex_pattern": {"type": "string", "description": "\u8981\u5339\u914d\u7684\u6b63\u5219\u8868\u8fbe\u5f0f", "required": true}}, "examples": [{"file_path": "src/main.py", "regex_pattern": "def\\s+\\w+"}], "category": "general"}, {"name": "list_code_definitions", "description": "\u5217\u51fa\u6307\u5b9a\u6587\u4ef6\u6216\u76ee\u5f55\u4e2dPython\u4ee3\u7801\u7684\u7c7b\u3001\u51fd\u6570\u548c\u65b9\u6cd5\u5b9a\u4e49", "parameters": {"file_path": {"type": "string", "description": "\u8981\u89e3\u6790\u7684Python\u6587\u4ef6\u8def\u5f84", "required": false}, "directory_path": {"type": "string", "description": "\u8981\u89e3\u6790\u7684\u76ee\u5f55\u8def\u5f84", "required": false}}, "examples": [{"file_path": "src/utils.py"}, {"directory_path": "src/models"}], "category": "general"}, {"name": "analyze_tool_needs", "description": "\u5206\u6790\u4efb\u52a1\u9700\u6c42\uff0c\u786e\u5b9a\u662f\u5426\u9700\u8981\u989d\u5916\u7684\u5de5\u5177", "parameters": {"task_description": {"type": "string", "description": "\u8981\u5206\u6790\u7684\u4efb\u52a1\u63cf\u8ff0", "required": true}}, "examples": [{"task_description": "Create a chart showing sales data trends"}], "category": "general"}, {"name": "search_and_install_tools", "description": "\u641c\u7d22\u5e76\u5b89\u88c5\u65b0\u7684\u5de5\u5177\u4ee5\u6ee1\u8db3\u4efb\u52a1\u9700\u6c42", "parameters": {"task_description": {"type": "string", "description": "\u4efb\u52a1\u63cf\u8ff0", "required": true}, "reason": {"type": "string", "description": "\u9700\u8981\u65b0\u5de5\u5177\u7684\u539f\u56e0", "required": false}}, "examples": [{"task_description": "Create a chart", "reason": "Need charting capabilities"}], "category": "general"}], "endpoint": "ws://localhost:8080/mcp", "connection_params": {}}}
2025-06-28 10:56:35,713 - core.toolscore.mcp_server - INFO - [search_tool_server] Waiting for registration response from toolscore...
2025-06-28 10:56:35,714 - core.toolscore.mcp_server - INFO - [search_tool_server] Received registration response: {"type": "register_tool_response", "request_id": "b31532a9-5fe5-4abc-93e5-33a738227733", "success": true, "message": null}
2025-06-28 10:56:35,714 - core.toolscore.mcp_server - INFO - [search_tool_server] Successfully registered with toolscore.
2025-06-28 10:56:55,558 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:56:55,558 - websockets.server - INFO - connection closed
2025-06-28 10:57:25,566 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:57:25,566 - websockets.server - INFO - connection closed
2025-06-28 10:57:55,570 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:57:55,570 - websockets.server - INFO - connection closed
2025-06-28 10:58:25,555 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:58:25,555 - websockets.server - INFO - connection closed
2025-06-28 10:58:55,552 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:58:55,552 - websockets.server - INFO - connection closed

2025-06-28 10:59:04,707 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 10:59:04,709 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 10:59:04,709 - services.mcp_server_launcher - INFO - 停止MCP服务器: browser_use_server
2025-06-28 10:59:04,709 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 收到停止信号，正在清理资源...

================================================================================
[系统启动] 2025-06-28 10:59:04
================================================================================
[2025-06-28 10:59:04] 🚀 Agent Data Platform 启动中... (所有日志将统一记录到 logs/System.log)
2025-06-28 10:59:04,722 - asyncio - DEBUG - Using selector: KqueueSelector
[2025-06-28 10:59:04] 🧹 开始增强端口清理...
[2025-06-28 10:59:04] 🔍 搜索并清理相关Python进程...
2025-06-28 10:59:04,734 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 10:59:04,735 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 10:59:04,735 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 10:59:04,735 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 10:59:04,735 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 10:59:04,735 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 10:59:04,735 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 10:59:04,735 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 10:59:04,735 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 10:59:04,735 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 10:59:04,735 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 10:59:04,735 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 10:59:04,735 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 10:59:04,735 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 10:59:04,735 - services.mcp_server_launcher - INFO - MCP服务器已经停止: microsandbox_server
2025-06-28 10:59:04,735 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 10:59:04,735 - services.mcp_server_launcher - INFO - MCP服务器已经停止: search_tool_server
2025-06-28 10:59:04,735 - services.mcp_server_launcher - INFO - 停止MCP服务器: browser_use_server
2025-06-28 10:59:04,735 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 收到停止信号，正在清理资源...
2025-06-28 10:59:04,756 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 收到停止信号，正在清理资源...
2025-06-28 10:59:04,758 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 10:59:04,758 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 10:56:25,869 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 10:56:25,869 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 10:56:25,869 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 10:56:25,869 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 10:56:25,869 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 10:56:25,869 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 10:56:25,870 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 10:56:25,870 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 10:56:25,870 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 10:56:25,870 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 10:56:26,189 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 10:56:26,190 - websockets.server - INFO - connection closed
2025-06-28 10:56:26,190 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:56:26,190 - websockets.server - INFO - connection closed
2025-06-28 10:56:35,871 - core.toolscore.mcp_server - INFO - [deepsearch_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 10:56:35,873 - core.toolscore.mcp_server - INFO - [deepsearch_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 10:56:35,873 - core.toolscore.mcp_server - INFO - [deepsearch_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "debdd217-8e82-4635-a996-1ce7700b4853", "tool_spec": {"tool_id": "deepsearch", "name": "deepsearch_server", "description": "\u4e13\u4e1a\u7ea7\u6df1\u5ea6\u641c\u7d22\u548c\u7814\u7a76\u5de5\u5177\u670d\u52a1\u5668\uff0c\u57fa\u4e8eLangGraph\u5b9e\u73b0\u7684\u591a\u8f6e\u8fed\u4ee3\u641c\u7d22\u4ee3\u7406", "tool_type": "mcp_server", "capabilities": [{"name": "research", "description": "\u6267\u884c\u4e13\u4e1a\u7ea7\u6df1\u5ea6\u7814\u7a76\uff0c\u83b7\u53d6\u8be6\u7ec6\u8c03\u7814\u4fe1\u606f", "parameters": {"question": {"type": "string", "description": "\u8981\u7814\u7a76\u7684\u95ee\u9898\u6216\u4e3b\u9898", "required": true}, "research_depth": {"type": "string", "description": "\u7814\u7a76\u6df1\u5ea6: quick/standard/comprehensive", "required": false}, "max_iterations": {"type": "integer", "description": "\u6700\u5927\u8fed\u4ee3\u6b21\u6570", "required": false}}, "examples": [], "category": "general"}, {"name": "quick_research", "description": "\u6267\u884c\u5feb\u901f\u7814\u7a76\uff0c\u9002\u7528\u4e8e\u9700\u8981\u5feb\u901f\u83b7\u53d6\u57fa\u7840\u4fe1\u606f\u7684\u573a\u666f", "parameters": {"question": {"type": "string", "description": "\u8981\u7814\u7a76\u7684\u95ee\u9898\u6216\u4e3b\u9898", "required": true}}, "examples": [], "category": "general"}, {"name": "comprehensive_research", "description": "\u6267\u884c\u5168\u9762\u6df1\u5ea6\u7814\u7a76\uff0c\u9002\u7528\u4e8e\u9700\u8981\u8be6\u7ec6\u3001\u4e13\u4e1a\u7ea7\u8c03\u7814\u4fe1\u606f\u7684\u573a\u666f", "parameters": {"question": {"type": "string", "description": "\u8981\u7814\u7a76\u7684\u95ee\u9898\u6216\u4e3b\u9898", "required": true}, "topic_focus": {"type": "string", "description": "\u53ef\u9009\u7684\u4e3b\u9898\u7126\u70b9\uff0c\u7528\u4e8e\u5f15\u5bfc\u7814\u7a76\u65b9\u5411", "required": false}}, "examples": [], "category": "general"}, {"name": "get_health_status", "description": "\u83b7\u53d6\u7cfb\u7edf\u5065\u5eb7\u72b6\u6001\u548c\u6027\u80fd\u6307\u6807", "parameters": {}, "examples": [], "category": "general"}, {"name": "get_optimization_stats", "description": "\u83b7\u53d6\u8bf7\u6c42\u4f18\u5316\u7edf\u8ba1\u4fe1\u606f", "parameters": {}, "examples": [], "category": "general"}], "endpoint": "ws://localhost:8086/mcp", "connection_params": {}}}
2025-06-28 10:56:35,873 - core.toolscore.mcp_server - INFO - [deepsearch_server] Waiting for registration response from toolscore...
2025-06-28 10:56:35,874 - core.toolscore.mcp_server - INFO - [deepsearch_server] Received registration response: {"type": "register_tool_response", "request_id": "debdd217-8e82-4635-a996-1ce7700b4853", "success": true, "message": null}
2025-06-28 10:56:35,874 - core.toolscore.mcp_server - INFO - [deepsearch_server] Successfully registered with toolscore.
2025-06-28 10:56:55,583 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:56:55,584 - websockets.server - INFO - connection closed
2025-06-28 10:57:25,590 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:57:25,591 - websockets.server - INFO - connection closed
2025-06-28 10:57:55,591 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:57:55,591 - websockets.server - INFO - connection closed
2025-06-28 10:58:25,573 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:58:25,574 - websockets.server - INFO - connection closed
2025-06-28 10:58:55,571 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:58:55,571 - websockets.server - INFO - connection closed

2025-06-28 10:59:04,758 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 10:59:04,795 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 收到停止信号，正在清理资源...
[2025-06-28 10:59:04] ✅ 进程清理完成
[2025-06-28 10:59:06] ✅ 端口 8088 空闲
[2025-06-28 10:59:06] ✅ 端口 8089 空闲
[2025-06-28 10:59:06] ✅ 端口 8090 空闲
[2025-06-28 10:59:06] ✅ 端口 8091 空闲
[2025-06-28 10:59:06] ✅ 端口 8092 空闲
[2025-06-28 10:59:07] ✅ 端口 5555 空闲
[2025-06-28 10:59:07] 🔥 强制清理端口 8081 的进程 71711
[2025-06-28 10:59:07] ✅ 端口 8082 空闲
[2025-06-28 10:59:07] ✅ 端口 8080 空闲
[2025-06-28 10:59:07] 🔥 强制清理端口 8084 的进程 71830
[2025-06-28 10:59:07] ✅ 端口 8085 空闲
[2025-06-28 10:59:07] ✅ 端口 8086 空闲
[2025-06-28 10:59:07] ✅ 端口 8087 空闲
[2025-06-28 10:59:07] ✅ 端口 8000 空闲
[2025-06-28 10:59:08] ✅ 增强端口清理完成
2025-06-28 10:59:08,214 - __main__ - INFO - === Agent Data Platform 启动中 ===
2025-06-28 10:59:08,214 - __main__ - DEBUG - 🔧 开始系统初始化流程...
2025-06-28 10:59:08,214 - __main__ - DEBUG - 📝 命令行参数: {'config_dir': 'config', 'debug': False, 'start_services': False}
2025-06-28 10:59:08,214 - __main__ - DEBUG - 🔧 步骤1: 初始化ConfigManager...
2025-06-28 10:59:08,214 - __main__ - DEBUG - ✅ ConfigManager初始化完成，配置目录: config
2025-06-28 10:59:08,214 - __main__ - DEBUG - 🔧 步骤2: 加载系统配置...
2025-06-28 10:59:08,214 - __main__ - DEBUG - 📡 Redis URL: redis://localhost:6379
2025-06-28 10:59:08,214 - __main__ - DEBUG - 📋 任务文件路径: tasks.jsonl
2025-06-28 10:59:08,217 - core.config_manager - INFO - 路由配置加载成功
2025-06-28 10:59:08,217 - __main__ - DEBUG - 🚦 路由配置加载完成，任务类型映射: {'CODE': 'tasks:reasoning', 'WEB': 'tasks:reasoning', 'REASONING': 'tasks:reasoning', 'RESEARCH': 'tasks:reasoning'}
2025-06-28 10:59:08,217 - __main__ - DEBUG - 📋 队列映射: {<TaskType.CODE: 'code'>: 'tasks:reasoning', <TaskType.WEB: 'web'>: 'tasks:reasoning', <TaskType.REASONING: 'reasoning'>: 'tasks:reasoning', <TaskType.RESEARCH: 'research'>: 'tasks:reasoning'}
2025-06-28 10:59:08,217 - __main__ - DEBUG - 🔧 步骤3: 初始化核心组件...
2025-06-28 10:59:08,217 - __main__ - DEBUG - ✅ EnhancedMetrics初始化完成
2025-06-28 10:59:08,218 - __main__ - DEBUG - ✅ RedisManager初始化完成
2025-06-28 10:59:08,218 - core.toolscore.toolscore_client - INFO - ✅ 增强的ToolScoreClient初始化完成
2025-06-28 10:59:08,218 - core.llm_client - DEBUG - Enriched config with environment variables: ['default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 10:59:08,320 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 10:59:08,322 - core.config_manager - INFO - 路由配置加载成功
2025-06-28 10:59:08,322 - core.monitoring.queue_monitor - INFO - ✅ QueueMonitor 配置加载完成
2025-06-28 10:59:08,322 - core.system_monitor - INFO - ✅ SystemMonitor 配置加载完成
2025-06-28 10:59:08,323 - __main__ - DEBUG - 🔧 开始初始化所有服务...
2025-06-28 10:59:08,323 - services.service_manager - INFO - 正在初始化所有服务...
2025-06-28 10:59:08,323 - services.service_manager - INFO - 初始化服务: redis
2025-06-28 10:59:08,323 - services.redis_service - INFO - Redis服务初始化完成，使用注入的RedisManager实例
2025-06-28 10:59:08,323 - services.service_manager - INFO - 初始化服务: toolscore
2025-06-28 10:59:08,323 - services.toolscore_service - INFO - 正在初始化ToolScore服务...
2025-06-28 10:59:08,323 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 10:59:08,323 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 10:59:08,323 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 10:59:08,323 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 10:59:08,323 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 10:59:08,324 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 10:59:08,324 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 10:59:08,324 - services.toolscore_service - INFO - ToolScore服务初始化完成（异步初始化将在start()中进行）
2025-06-28 10:59:08,324 - services.service_manager - INFO - 初始化服务: task_processing_coordinator
2025-06-28 10:59:08,324 - services.service_manager - INFO - 初始化服务: mcp_servers
2025-06-28 10:59:08,324 - services.mcp_server_launcher - INFO - 正在初始化MCP服务器启动器...
2025-06-28 10:59:08,324 - services.mcp_server_launcher - INFO - MCP服务器启动器初始化完成，配置了 4 个服务器: ['microsandbox_server', 'search_tool_server', 'browser_use_server', 'deepsearch_server']
2025-06-28 10:59:08,324 - services.service_manager - INFO - 初始化服务: task_api
2025-06-28 10:59:08,324 - services.task_api_service - INFO - 正在初始化任务API服务...
2025-06-28 10:59:08,324 - services.task_api_service - INFO - 任务API服务初始化完成
2025-06-28 10:59:08,324 - services.service_manager - INFO - 初始化服务: runtime
2025-06-28 10:59:08,324 - services.runtime_service - INFO - 正在初始化推理运行时服务...
2025-06-28 10:59:08,324 - services.runtime_service - INFO - 创建运行时实例: enhanced-runtime-1
2025-06-28 10:59:08,324 - core.memory_manager - INFO - MemoryManager initialized: use_redis=True, max_entries=1000
2025-06-28 10:59:08,324 - core.step_planner - INFO - StepPlanner initialized with max_steps=10
2025-06-28 10:59:08,324 - runtimes.reasoning.enhanced_runtime - INFO - DEBUG: Loaded toolscore_http_port: 8082, toolscore_mcp_port: 8081
2025-06-28 10:59:08,324 - runtimes.reasoning.enhanced_runtime - INFO - DEBUG: Configured toolscore_websocket_endpoint (using mcp_port): ws://localhost:8081/websocket
2025-06-28 10:59:08,324 - core.toolscore.mcp_client - INFO - Enhanced MCPToolClient initialized for toolscore at ws://localhost:8081/websocket
2025-06-28 10:59:08,324 - core.llm.guardrails_middleware - INFO - 🔧 初始化输入验证Guard...
2025-06-28 10:59:08,325 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 10:59:08,326 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 10:59:08,326 - core.llm.guardrails_middleware - INFO - 🔧 初始化输出验证Guard...
2025-06-28 10:59:08,326 - core.llm.guardrails_middleware - INFO - 🔧 使用本地LLM客户端初始化Guard...
2025-06-28 10:59:08,326 - core.llm.guardrails_middleware - ERROR - ❌ 创建高级输出Guard失败: Guard.for_rail_string() got an unexpected keyword argument 'api'
2025-06-28 10:59:08,327 - core.llm.guardrails_middleware - ERROR - Traceback (most recent call last):
  File "/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/core/llm/guardrails_middleware.py", line 142, in _create_advanced_output_guard
    guard = Guard.from_rail_string(rail_schema, api=llm_api_wrapper, num_reasks=2)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/guardrails/guard.py", line 477, in from_rail_string
    return cls.for_rail_string(rail_string, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Guard.for_rail_string() got an unexpected keyword argument 'api'

2025-06-28 10:59:08,327 - core.llm.guardrails_middleware - INFO - ✅ Guardrails Guards初始化成功
2025-06-28 10:59:08,327 - core.llm.guardrails_middleware - INFO -    - 输入Guard: ✅
2025-06-28 10:59:08,327 - core.llm.guardrails_middleware - INFO -    - 输出Guard: ❌
2025-06-28 10:59:08,327 - core.agents.validation_critic - INFO - 🎯 ValidationCritic Agent初始化完成
2025-06-28 10:59:08,327 - services.runtime_service - INFO - 推理运行时服务初始化完成，创建了 1 个实例
2025-06-28 10:59:08,327 - services.service_manager - INFO - 初始化服务: synthesis
2025-06-28 10:59:08,327 - services.synthesis_service - INFO - 正在初始化合成服务...
2025-06-28 10:59:08,327 - core.llm_client - DEBUG - Enriched config with environment variables: ['redis_url', 'TRAJECTORIES_DIR', 'default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 10:59:08,361 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 10:59:08,362 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 10:59:08,362 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 10:59:08,362 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 10:59:08,362 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 10:59:08,362 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 10:59:08,362 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 10:59:08,362 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 10:59:08,362 - core.synthesiscore.synthesis - INFO - ✅ JSON文件存储初始化完成
2025-06-28 10:59:08,362 - core.synthesiscore.synthesis - INFO - 📋 未发现已处理轨迹记录，从空白状态开始
2025-06-28 10:59:08,362 - core.llm_client - DEBUG - Enriched config with environment variables: ['redis_url', 'TRAJECTORIES_DIR', 'default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 10:59:08,396 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 10:59:08,396 - core.toolscore.mcp_client - INFO - Enhanced MCPToolClient initialized for toolscore at ws://localhost:8089/websocket
2025-06-28 10:59:08,399 - core.synthesiscore.config_loader - INFO - ✅ SynthesisCore配置加载成功: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/config/synthesiscore_config.yaml
2025-06-28 10:59:08,399 - core.synthesiscore.trajectory_monitor - INFO - 🔧 TrajectoryMonitor初始化完成
2025-06-28 10:59:08,399 - core.synthesiscore.trajectory_monitor - INFO - 📂 监控目录: output/trajectories
2025-06-28 10:59:08,399 - core.synthesiscore.trajectory_monitor - INFO - 📝 种子文件: output/trajectories/../seed_tasks.jsonl
2025-06-28 10:59:08,399 - services.synthesis_service - INFO - ✅ TrajectoryMonitor v2.0 初始化完成
2025-06-28 10:59:08,399 - services.synthesis_service - INFO - 合成服务初始化完成，轨迹目录: output/trajectories
2025-06-28 10:59:08,400 - __main__ - DEBUG - ✅ 所有服务初始化完成
2025-06-28 10:59:08,400 - __main__ - DEBUG - 🚀 开始启动所有服务...
2025-06-28 10:59:08,400 - services.service_manager - INFO - 正在启动所有服务...
2025-06-28 10:59:08,400 - services.service_manager - INFO - 启动服务: redis
2025-06-28 10:59:08,400 - services.redis_service - INFO - Redis客户端已就绪
2025-06-28 10:59:08,400 - services.service_manager - INFO - 启动服务: toolscore
2025-06-28 10:59:08,400 - services.toolscore_service - INFO - 正在启动ToolScore服务...
2025-06-28 10:59:08,400 - services.toolscore_service - INFO - 正在初始化工具库...
2025-06-28 10:59:08,400 - services.toolscore_service - INFO - 工具库初始化将在ToolScore MCP服务器线程中进行。
2025-06-28 10:59:08,400 - services.toolscore_service - INFO - 正在启动ToolScore HTTP API...
2025-06-28 10:59:08,409 - services.toolscore_service - INFO - ToolScore HTTP API已启动于端口: 8082
2025-06-28 10:59:08,409 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 10:59:08,409 - services.toolscore_service - INFO - ToolScore MCP 服务器不进行端口自动检测，使用配置端口: 8081
2025-06-28 10:59:08,409 - services.toolscore_service - INFO - ToolScore MCP server configured to use host: 0.0.0.0, port: 8081, path: /websocket
2025-06-28 10:59:08,409 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 10:59:08,409 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 10:59:08,409 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 10:59:08,409 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 10:59:08,409 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 10:59:08,409 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 10:59:08,409 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 10:59:08,409 - core.toolscore.monitoring_api - INFO - ToolScore monitoring API started on port 8082
2025-06-28 10:59:08,409 - services.toolscore_service - INFO - Starting ToolScore MCP server thread...
2025-06-28 10:59:08,409 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 10:59:08,409 - services.toolscore_service - INFO - ToolScore MCP server thread started, is_alive: True
2025-06-28 10:59:08,409 - services.toolscore_service - INFO - ToolScore MCP服务器启动线程已启动，等待就绪信号...
2025-06-28 10:59:08,409 - core.toolscore.mcp_server - INFO - Attempting to start toolscore MCP Server on 0.0.0.0:8081
2025-06-28 10:59:08,409 - services.service_manager - INFO - 启动服务: task_processing_coordinator
2025-06-28 10:59:08,410 - core.dispatcher_enhanced - INFO - ✅ TaskProcessingCoordinator 配置加载完成 - 队列映射: {<TaskType.CODE: 'code'>: 'tasks:reasoning', <TaskType.WEB: 'web'>: 'tasks:reasoning', <TaskType.REASONING: 'reasoning'>: 'tasks:reasoning', <TaskType.RESEARCH: 'research'>: 'tasks:reasoning'}
2025-06-28 10:59:08,410 - services.service_manager - INFO - 启动服务: mcp_servers
2025-06-28 10:59:08,410 - services.mcp_server_launcher - INFO - 正在启动MCP服务器...
2025-06-28 10:59:08,410 - services.mcp_server_launcher - INFO - 正在并行启动 4 个MCP服务器...
2025-06-28 10:59:08,410 - websockets.server - INFO - server listening on 0.0.0.0:8081
2025-06-28 10:59:08,410 - core.dispatcher_enhanced - INFO - 启动任务处理协调器...
2025-06-28 10:59:08,410 - core.toolscore.mcp_server - INFO - [toolscore] Initializing UnifiedToolLibrary...
2025-06-28 10:59:08,410 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 10:59:08,410 - core.toolscore.core_manager - INFO - 🚀 正在初始化增强的CoreManager...
2025-06-28 10:59:08,410 - core.toolscore.core_manager - INFO - 🔄 使用v2.0服务容器架构初始化...
2025-06-28 10:59:08,410 - core.toolscore.enhanced_core_manager_v2 - INFO - 🚀 初始化增强核心管理器 v2.0...
2025-06-28 10:59:08,410 - core.toolscore.service_container.mcp_service_container - INFO - 🚀 开始初始化MCP服务容器...
2025-06-28 10:59:08,410 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:59:08,410 - core.toolscore.service_container.mcp_service_container - INFO - 🔍 发现内置MCP服务...
2025-06-28 10:59:08,410 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 10:59:08,410 - core.toolscore.service_container.builtin_discovery - INFO - 🔍 开始发现内置MCP服务: mcp_servers
2025-06-28 10:59:08,410 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 10:59:08,410 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 10:59:08,410 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 10:59:08,410 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 10:59:08,410 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 10:59:08,410 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 10:59:08,410 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:59:08,410 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: Search Tool MCP Server
2025-06-28 10:59:08,410 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 10:59:08,410 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 10:59:08,410 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:59:08,413 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: MicroSandbox MCP Server
2025-06-28 10:59:08,413 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 72072)
2025-06-28 10:59:08,413 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 10:59:08,413 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 跳过 __pycache__: 缺少main.py文件
2025-06-28 10:59:08,413 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:59:08,413 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:59:08,413 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 10:59:08,413 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: Browser Use MCP Server
2025-06-28 10:59:08,413 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:59:08,414 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 10:59:08,414 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 10:59:08,414 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 10:59:08,414 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 10:59:08,414 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 10:59:08,414 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 10:59:08,414 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:59:08,414 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: DeepSearch MCP Server
2025-06-28 10:59:08,414 - core.toolscore.service_container.builtin_discovery - INFO - 🎯 内置服务发现完成，共发现 4 个服务
2025-06-28 10:59:08,414 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 10:59:08,414 - core.toolscore.service_container.builtin_discovery - INFO - 📝 创建服务配置文件...
2025-06-28 10:59:08,414 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/search_tool_server/service.json
2025-06-28 10:59:08,414 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/microsandbox_server/service.json
2025-06-28 10:59:08,414 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/browser_use_server/service.json
2025-06-28 10:59:08,414 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/deepsearch_server/service.json
2025-06-28 10:59:08,414 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 发现 4 个内置服务
2025-06-28 10:59:08,414 - core.toolscore.service_container.mcp_service_container - INFO - 📂 加载已安装的外部服务...
2025-06-28 10:59:08,414 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 加载 0 个外部服务
2025-06-28 10:59:08,414 - core.toolscore.service_container.mcp_service_container - INFO - 📋 构建统一服务目录...
2025-06-28 10:59:08,414 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 服务目录构建完成，共 4 个服务
2025-06-28 10:59:08,414 - core.toolscore.service_container.mcp_service_container - INFO - 📋 标记内置服务为启动中状态...
2025-06-28 10:59:08,414 - core.toolscore.service_container.mcp_service_container - INFO - 📋 已标记 4 个内置服务为启动中状态
2025-06-28 10:59:08,414 - core.toolscore.service_container.service_monitor - INFO - 🔍 启动服务监控...
2025-06-28 10:59:08,414 - core.toolscore.service_container.mcp_service_container - INFO - ✅ MCP服务容器初始化完成
2025-06-28 10:59:08,414 - core.toolscore.enhanced_core_manager_v2 - INFO - ✅ 增强核心管理器 v2.0 初始化完成
2025-06-28 10:59:08,414 - core.toolscore.core_manager - INFO - ✅ v2.0架构初始化完成
2025-06-28 10:59:08,414 - core.toolscore.tool_registry - INFO - Tool registry initialized
2025-06-28 10:59:08,414 - core.llm_client - DEBUG - Enriched config with environment variables: ['provider', 'gemini_api_key', 'gemini_api_url']
2025-06-28 10:59:08,414 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 10:59:08,415 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 10:59:08,415 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 10:59:08,415 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:59:08,417 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 72073)
2025-06-28 10:59:08,417 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 10:59:08,427 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: browser_use_server
2025-06-28 10:59:08,427 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:59:08,427 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: browser_use_server
2025-06-28 10:59:08,427 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server
2025-06-28 10:59:08,428 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) = True
2025-06-28 10:59:08,428 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) = True
2025-06-28 10:59:08,428 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) contents: ['service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 10:59:08,428 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server/main.py
2025-06-28 10:59:08,428 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:59:08,428 - services.mcp_server_launcher - INFO - [MCP启动器] 为 browser_use_server 使用配置文件指定端口: 8084
2025-06-28 10:59:08,428 - services.mcp_server_launcher - INFO - [MCP启动器] 为 browser_use_server 使用配置文件指定端口: 8084
2025-06-28 10:59:08,428 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 BROWSER_USE_SERVER_PORT=8084 给 browser_use_server
2025-06-28 10:59:08,428 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.browser_use_server.main
2025-06-28 10:59:08,428 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:59:08,431 - services.mcp_server_launcher - INFO - MCP服务器已启动: browser_use_server (PID: 72074)
2025-06-28 10:59:08,432 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 browser_use_server 就绪状态...
2025-06-28 10:59:08,434 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 10:59:08,434 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:59:08,434 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 10:59:08,435 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 10:59:08,435 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 10:59:08,435 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 10:59:08,435 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 10:59:08,435 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 10:59:08,435 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:59:08,435 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 10:59:08,435 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 10:59:08,436 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 10:59:08,436 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 10:59:08,436 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 10:59:08,441 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 72075)
2025-06-28 10:59:08,442 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 10:59:08,443 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第1次, 5s间隔)
2025-06-28 10:59:08,443 - core.monitoring.queue_monitor - INFO - 启动队列监控器...
2025-06-28 10:59:08,446 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 10:59:08,446 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 10:59:08,446 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 10:59:08,447 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 10:59:08,447 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 10:59:08,447 - websockets.client - DEBUG - > Sec-WebSocket-Key: +xQqFtR8wFCFujvOYLf+pA==
2025-06-28 10:59:08,447 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 10:59:08,447 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:59:08,447 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:59:08,447 - websockets.client - DEBUG - > EOF
2025-06-28 10:59:08,447 - websockets.client - DEBUG - < EOF
2025-06-28 10:59:08,447 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 10:59:08,447 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 10:59:08,447 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 10:59:08,447 - websockets.client - DEBUG - > Host: localhost:8084
2025-06-28 10:59:08,447 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 10:59:08,448 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 10:59:08,448 - websockets.client - DEBUG - > Sec-WebSocket-Key: letYPM/FQrZQRxEentJAFA==
2025-06-28 10:59:08,448 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 10:59:08,448 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:59:08,448 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:59:08,448 - websockets.client - DEBUG - > EOF
2025-06-28 10:59:08,448 - websockets.client - DEBUG - < EOF
2025-06-28 10:59:08,448 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 10:59:08,448 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 10:59:08,451 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 10:59:08,453 - services.mcp_server_launcher - DEBUG - 📋 browser_use_server 端口 8084 尚未就绪
2025-06-28 10:59:08,454 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 10:59:08,468 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 10:59:08,468 - core.toolscore.tool_gap_detector - INFO - 智能工具缺口检测器初始化 - 统一版本
2025-06-28 10:59:08,468 - core.toolscore.dynamic_mcp_manager - INFO - Dynamic MCP Manager initialized (ProcessRunner mode)
2025-06-28 10:59:08,468 - core.toolscore.dynamic_mcp_manager - INFO - 启动动态MCP管理器...
2025-06-28 10:59:08,469 - core.toolscore.dynamic_mcp_manager - INFO - 持久化配置为空，无需恢复外部MCP服务器
2025-06-28 10:59:08,469 - core.toolscore.dynamic_mcp_manager - INFO - 动态MCP管理器启动完成
2025-06-28 10:59:08,469 - core.toolscore.mcp_search_tool - INFO - ✅ MCP Search Tool initialized - 优化版本，包含失败工具跟踪
2025-06-28 10:59:08,469 - core.toolscore.unified_tool_library - INFO - Tool library initialization completed - 核心管理器模式
2025-06-28 10:59:08,469 - core.toolscore.mcp_server - INFO - [toolscore] UnifiedToolLibrary initialized.
2025-06-28 10:59:08,469 - core.toolscore.mcp_server - INFO - [toolscore] Auto-registering MCP servers...
2025-06-28 10:59:08,469 - core.toolscore.mcp_auto_registration - INFO - 🔍 开始自动发现和注册MCP服务器...
2025-06-28 10:59:08,469 - core.toolscore.mcp_auto_registration - DEBUG - ⚠️ 服务器目录 __pycache__ 缺少 service.json
2025-06-28 10:59:08,469 - core.toolscore.mcp_auto_registration - INFO - 🎯 发现 4 个MCP服务器
2025-06-28 10:59:08,482 - core.unified_tool_manager - DEBUG - ✅ 配置验证通过
2025-06-28 10:59:08,482 - core.unified_tool_manager - INFO - 🔄 成功加载工具配置: 4 个标准工具
2025-06-28 10:59:08,482 - core.unified_tool_manager - DEBUG -    - 标准工具ID: ['browser_use', 'deepsearch', 'mcp-search-tool', 'microsandbox']
2025-06-28 10:59:08,482 - core.unified_tool_manager - DEBUG -    - 兼容映射: 13 个变体
2025-06-28 10:59:08,482 - core.unified_tool_manager - INFO - ✅ 统一工具管理器初始化完成，管理 4 个工具
2025-06-28 10:59:08,482 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: mcp-search-tool
2025-06-28 10:59:08,482 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: Search Tool MCP Server (ID: mcp-search-tool)
2025-06-28 10:59:08,482 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: Search Tool MCP Server (ID: mcp-search-tool)
2025-06-28 10:59:08,482 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: Search Tool MCP Server
2025-06-28 10:59:08,483 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8080/websocket
2025-06-28 10:59:08,483 - core.toolscore.mcp_connector - INFO - Registered MCP server mcp-search-tool at ws://localhost:8080/websocket
2025-06-28 10:59:08,483 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: mcp-search-tool -> ws://localhost:8080/websocket
2025-06-28 10:59:08,483 - core.toolscore.core_manager - INFO - 工具立即可用: mcp-search-tool
2025-06-28 10:59:08,483 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: mcp-search-tool
2025-06-28 10:59:08,483 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: microsandbox
2025-06-28 10:59:08,483 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: MicroSandbox MCP Server (ID: microsandbox)
2025-06-28 10:59:08,483 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: MicroSandbox MCP Server (ID: microsandbox)
2025-06-28 10:59:08,483 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: MicroSandbox MCP Server
2025-06-28 10:59:08,483 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8090/websocket
2025-06-28 10:59:08,483 - core.toolscore.mcp_connector - INFO - Registered MCP server microsandbox at ws://localhost:8090/websocket
2025-06-28 10:59:08,483 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: microsandbox -> ws://localhost:8090/websocket
2025-06-28 10:59:08,483 - core.toolscore.core_manager - INFO - 工具立即可用: microsandbox
2025-06-28 10:59:08,483 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: microsandbox
2025-06-28 10:59:08,483 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: browser_use
2025-06-28 10:59:08,483 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: Browser Use MCP Server (ID: browser_use)
2025-06-28 10:59:08,483 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: Browser Use MCP Server (ID: browser_use)
2025-06-28 10:59:08,483 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: Browser Use MCP Server
2025-06-28 10:59:08,483 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8084/websocket
2025-06-28 10:59:08,483 - core.toolscore.mcp_connector - INFO - Registered MCP server browser_use at ws://localhost:8084/websocket
2025-06-28 10:59:08,483 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: browser_use -> ws://localhost:8084/websocket
2025-06-28 10:59:08,483 - core.toolscore.core_manager - INFO - 工具立即可用: browser_use
2025-06-28 10:59:08,483 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: browser_use
2025-06-28 10:59:08,483 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: deepsearch
2025-06-28 10:59:08,483 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: DeepSearch MCP Server (ID: deepsearch)
2025-06-28 10:59:08,483 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: DeepSearch MCP Server (ID: deepsearch)
2025-06-28 10:59:08,483 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: DeepSearch MCP Server
2025-06-28 10:59:08,483 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8086/websocket
2025-06-28 10:59:08,483 - core.toolscore.mcp_connector - INFO - Registered MCP server deepsearch at ws://localhost:8086/websocket
2025-06-28 10:59:08,483 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: deepsearch -> ws://localhost:8086/websocket
2025-06-28 10:59:08,483 - core.toolscore.core_manager - INFO - 工具立即可用: deepsearch
2025-06-28 10:59:08,483 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: deepsearch
2025-06-28 10:59:08,483 - core.toolscore.mcp_auto_registration - INFO - 📊 MCP服务器注册完成: 4/4 成功
2025-06-28 10:59:08,483 - core.toolscore.mcp_server - INFO - [toolscore] All MCP servers registered successfully.
2025-06-28 10:59:08,483 - core.toolscore.mcp_server - INFO - toolscore MCP Server started successfully on 0.0.0.0:8081 (Original endpoint: ws://0.0.0.0:8081/websocket) with ping_interval=30, ping_timeout=60
2025-06-28 10:59:08,483 - core.toolscore.mcp_server - INFO - toolscore MCP Server started event set.
2025-06-28 10:59:08,483 - core.toolscore.service_container.service_monitor - INFO - 🔄 开始服务监控循环，检查间隔: 30秒
2025-06-28 10:59:08,499 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [browser_use] BrowserUse logging setup complete with level info
2025-06-28 10:59:08,888 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [root] Anonymized telemetry enabled. See https://docs.browser-use.com/development/telemetry for more information.
2025-06-28 10:59:09,014 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.llm_client] Initialized LLM client with provider: gemini
2025-06-28 10:59:09,014 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Browser-Use server initialized with LLM provider: gemini
2025-06-28 10:59:09,015 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 使用动态分配端口: 8084
2025-06-28 10:59:09,015 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] BrowserUseMCPServer initialized:
2025-06-28 10:59:09,015 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:59:09,015 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Server Name: browser_use_server
2025-06-28 10:59:09,015 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Server ID: browser_use
2025-06-28 10:59:09,015 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Listen Host: 0.0.0.0
2025-06-28 10:59:09,015 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Listen Port: 8084
2025-06-28 10:59:09,015 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Public Endpoint: ws://localhost:8084
2025-06-28 10:59:09,015 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 10:59:09,015 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Starting browser_use_server...
2025-06-28 10:59:09,015 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:59:09,015 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Attempting to start MCPServer for browser_use_server at ws://localhost:8084...
2025-06-28 10:59:09,015 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Attempting to start browser_use_server MCP Server on localhost:8084
2025-06-28 10:59:09,015 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] server listening on 127.0.0.1:8084
2025-06-28 10:59:09,015 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] server listening on [::1]:8084
2025-06-28 10:59:09,016 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] browser_use_server MCP Server started successfully on localhost:8084 (Original endpoint: ws://localhost:8084) with ping_interval=30, ping_timeout=60
2025-06-28 10:59:09,016 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 10:59:09,054 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 10:59:09,054 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 10:59:09,054 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 10:59:09,054 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 10:59:09,054 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 10:59:09,054 - websockets.client - DEBUG - > Sec-WebSocket-Key: w6CWSjmeOXU6ZGAgbxZNeA==
2025-06-28 10:59:09,054 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 10:59:09,054 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:59:09,054 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:59:09,054 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 10:59:09,054 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 10:59:09,054 - websockets.client - DEBUG - > Host: localhost:8084
2025-06-28 10:59:09,054 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 10:59:09,054 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 10:59:09,054 - websockets.client - DEBUG - > Sec-WebSocket-Key: lpTYkk7V5m4KQIhK/RAUVw==
2025-06-28 10:59:09,054 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 10:59:09,054 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:59:09,054 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:59:09,054 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection open
2025-06-28 10:59:09,054 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Client connected to browser_use_server MCP Server at path /: ('127.0.0.1', 60763)
2025-06-28 10:59:09,055 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 10:59:09,055 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 10:59:09,055 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 10:59:09,055 - websockets.client - DEBUG - < Sec-WebSocket-Accept: y3K9b1/Gkq7A5pkCbv9oA2zLjFU=
2025-06-28 10:59:09,055 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:59:09,055 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 02:59:09 GMT
2025-06-28 10:59:09,055 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 10:59:09,055 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 10:59:09,055 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 10:59:09,055 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 10:59:09,055 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 10:59:09,055 - websockets.client - DEBUG - < Sec-WebSocket-Accept: FeQnU7uNw1DrkyClMZgOGyz7gtg=
2025-06-28 10:59:09,055 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:59:09,055 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 02:59:09 GMT
2025-06-28 10:59:09,055 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 10:59:09,055 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 10:59:09,055 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 10:59:09,055 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:59:09,055 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 10:59:09,055 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 10:59:09,055 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:59:09,055 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 10:59:09,055 - services.mcp_server_launcher - DEBUG - [browser_use_server] WARNING  [core.toolscore.mcp_server] Unknown request type or server role mismatch: ping
2025-06-28 10:59:09,055 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 10:59:09,056 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:59:09,056 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 10:59:09,056 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:59:09,056 - websockets.client - DEBUG - < EOF
2025-06-28 10:59:09,056 - websockets.client - DEBUG - > EOF
2025-06-28 10:59:09,056 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 10:59:09,056 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 10:59:09,056 - websockets.client - DEBUG - < EOF
2025-06-28 10:59:09,056 - websockets.client - DEBUG - > EOF
2025-06-28 10:59:09,056 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 10:59:09,056 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 10:59:09,056 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 10:59:09,056 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 10:59:09,056 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 10:59:09,056 - services.mcp_server_launcher - DEBUG - ✅ browser_use_server 特定就绪检查通过
2025-06-28 10:59:09,056 - services.mcp_server_launcher - INFO - ✅ browser_use_server 已就绪
2025-06-28 10:59:09,057 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 10:59:09,057 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 10:59:09,736 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:59:09,736 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:59:10,058 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 10:59:10,602 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:59:10,602 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:59:11,640 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:59:11,640 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:59:12,885 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:59:12,886 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:59:13,444 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第2次, 5s间隔)
2025-06-28 10:59:14,380 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:59:14,380 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:59:16,173 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:59:16,173 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:59:18,324 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:59:18,324 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:59:18,446 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第3次, 5s间隔)
2025-06-28 10:59:18,585 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 10:59:18,585 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 10:59:18,585 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 10:59:18,585 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 10:59:18,585 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 10:59:18,586 - websockets.server - DEBUG - < Sec-WebSocket-Key: lmRGKSbsS8E2ln81uB9UdA==
2025-06-28 10:59:18,586 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 10:59:18,586 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:59:18,586 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:59:18,586 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 10:59:18,586 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 10:59:18,586 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 10:59:18,586 - websockets.server - DEBUG - > Sec-WebSocket-Accept: F+M6pMRHKTRmXEh5S/zfi9GAkX0=
2025-06-28 10:59:18,586 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:59:18,586 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 02:59:18 GMT
2025-06-28 10:59:18,586 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 10:59:18,586 - websockets.server - INFO - connection open
2025-06-28 10:59:18,586 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 10:59:18,586 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 60783)
2025-06-28 10:59:18,586 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "916108...onnection_params": {}}}' [2376 bytes]
2025-06-28 10:59:18,587 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: search_tool_server (ID: mcp-search-tool)
2025-06-28 10:59:18,587 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: search_tool_server
2025-06-28 10:59:18,587 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: mcp-search-tool -> ws://localhost:8080/mcp
2025-06-28 10:59:18,587 - core.toolscore.core_manager - INFO - 工具立即可用: mcp-search-tool
2025-06-28 10:59:18,587 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 10:59:18,587 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:59:18,587 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 10:59:18,587 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:59:18,587 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 10:59:18,587 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 10:59:18,587 - websockets.server - INFO - connection closed
2025-06-28 10:59:18,698 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 10:59:18,698 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 10:59:18,698 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 10:59:18,698 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 10:59:18,698 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 10:59:18,698 - websockets.server - DEBUG - < Sec-WebSocket-Key: cLTfQOth8xRjcwx1SAFAyw==
2025-06-28 10:59:18,698 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 10:59:18,698 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:59:18,698 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:59:18,698 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 10:59:18,698 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 10:59:18,698 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 10:59:18,698 - websockets.server - DEBUG - > Sec-WebSocket-Accept: CT/uRmZ+m3JtxYHS5L2Y+CJ52Z0=
2025-06-28 10:59:18,698 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:59:18,698 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 02:59:18 GMT
2025-06-28 10:59:18,698 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 10:59:18,698 - websockets.server - INFO - connection open
2025-06-28 10:59:18,698 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 10:59:18,698 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 60785)
2025-06-28 10:59:18,699 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "e77491...onnection_params": {}}}' [3263 bytes]
2025-06-28 10:59:18,699 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: microsandbox_server (ID: microsandbox)
2025-06-28 10:59:18,699 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: microsandbox_server
2025-06-28 10:59:18,699 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: microsandbox -> ws://localhost:8090
2025-06-28 10:59:18,699 - core.toolscore.core_manager - INFO - 工具立即可用: microsandbox
2025-06-28 10:59:18,699 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 10:59:18,700 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:59:18,700 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 10:59:18,700 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:59:18,700 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 10:59:18,700 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 10:59:18,700 - websockets.server - INFO - connection closed
2025-06-28 10:59:18,751 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 10:59:18,751 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 10:59:18,751 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 10:59:18,751 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 10:59:18,751 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 10:59:18,751 - websockets.server - DEBUG - < Sec-WebSocket-Key: gEj99KVi2j02buxBDZBCgg==
2025-06-28 10:59:18,751 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 10:59:18,751 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:59:18,751 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:59:18,751 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 10:59:18,751 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 10:59:18,751 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 10:59:18,751 - websockets.server - DEBUG - > Sec-WebSocket-Accept: J6wNckcR/9iI/6J122udyTzsK8M=
2025-06-28 10:59:18,751 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:59:18,751 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 02:59:18 GMT
2025-06-28 10:59:18,751 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 10:59:18,751 - websockets.server - INFO - connection open
2025-06-28 10:59:18,751 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 10:59:18,751 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 60787)
2025-06-28 10:59:18,752 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "3409fa...onnection_params": {}}}' [2313 bytes]
2025-06-28 10:59:18,752 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: deepsearch_server (ID: deepsearch)
2025-06-28 10:59:18,752 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: deepsearch_server
2025-06-28 10:59:18,752 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: deepsearch -> ws://localhost:8086/mcp
2025-06-28 10:59:18,752 - core.toolscore.core_manager - INFO - 工具立即可用: deepsearch
2025-06-28 10:59:18,752 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 10:59:18,752 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:59:18,752 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 10:59:18,752 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:59:18,752 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 10:59:18,752 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 10:59:18,752 - websockets.server - INFO - connection closed
2025-06-28 10:59:19,017 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 10:59:19,018 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 10:59:19,018 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 10:59:19,018 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 10:59:19,018 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 10:59:19,018 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 10:59:19,018 - websockets.server - DEBUG - < Sec-WebSocket-Key: +BXqzKmv0Un518QByfPQvw==
2025-06-28 10:59:19,018 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 10:59:19,018 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:59:19,018 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 10:59:19,018 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 10:59:19,018 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 10:59:19,018 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 10:59:19,018 - websockets.server - DEBUG - > Sec-WebSocket-Accept: XDqyF7TKg7KR3Y+NuWN+LJqKSCM=
2025-06-28 10:59:19,018 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:59:19,018 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 02:59:19 GMT
2025-06-28 10:59:19,018 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 10:59:19,018 - websockets.server - INFO - connection open
2025-06-28 10:59:19,018 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 10:59:19,018 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 60789)
2025-06-28 10:59:19,018 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 10:59:19,019 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "fedfe4e8-d89d-4a1d-a9bb-a6d2c8e1d8e6", "tool_spec": {"tool_id": "browser_use", "name": "browser_use_server", "description": "\u57fa\u4e8eBrowser-Use\u7684AI\u6d4f\u89c8\u5668\u81ea\u52a8\u5316\u670d\u52a1\u5668\uff0c\u5b8c\u6574\u5b9e\u73b0browser-use\u7684\u6240\u6709\u529f\u80fd", "tool_type": "mcp_server", "capabilities": [{"name": "browser_use_execute_task", "description": "\u4f7f\u7528AI\u6267\u884c\u590d\u6742\u7684\u6d4f\u89c8\u5668\u4efb\u52a1\uff0c\u652f\u6301\u81ea\u7136\u8bed\u8a00\u63cf\u8ff0", "parameters": {"task": {"type": "string", "description": "\u8981\u6267\u884c\u7684\u4efb\u52a1\u63cf\u8ff0\uff0c\u4f7f\u7528\u81ea\u7136\u8bed\u8a00", "required": true}, "max_steps": {"type": "integer", "description": "\u6700\u5927\u6267\u884c\u6b65\u9aa4\u6570\uff0c\u9ed8\u8ba450", "required": false}, "use_vision": {"type": "boolean", "description": "\u662f\u5426\u4f7f\u7528\u89c6\u89c9\u7406\u89e3\uff0c\u9ed8\u8ba4true", "required": false}}, "examples": [{"task": "\u641c\u7d22Python\u6559\u7a0b\u5e76\u6253\u5f00\u7b2c\u4e00\u4e2a\u7ed3\u679c"}, {"task": "\u5728GitHub\u4e0a\u641c\u7d22browser-use\u9879\u76ee\u5e76\u67e5\u770bREADME"}, {"task": "\u767b\u5f55\u7f51\u7ad9\u5e76\u586b\u5199\u8868\u5355", "use_vision": true}], "category": "general"}, {"name": "browser_navigate", "description": "\u5bfc\u822a\u5230\u6307\u5b9a\u7f51\u5740", "parameters": {"url": {"type": "string", "description": "\u8981\u8bbf\u95ee\u7684URL\u5730\u5740", "required": true}}, "examples": [{"url": "https://www.google.com"}, {"url": "https://github.com"}], "category": "general"}, {"name": "browser_search_google", "description": "\u5728Google\u4e2d\u641c\u7d22\u6307\u5b9a\u67e5\u8be2", "parameters": {"query": {"type": "string", "description": "\u641c\u7d22\u67e5\u8be2\u8bcd", "required": true}}, "examples": [{"query": "Python machine learning tutorial"}, {"query": "browser automation tools"}], "category": "general"}, {"name": "browser_go_back", "description": "\u8fd4\u56de\u4e0a\u4e00\u9875", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_click_element", "description": "\u901a\u8fc7\u7d22\u5f15\u70b9\u51fb\u9875\u9762\u5143\u7d20", "parameters": {"index": {"type": "integer", "description": "\u8981\u70b9\u51fb\u7684\u5143\u7d20\u7d22\u5f15", "required": true}}, "examples": [{"index": 1}, {"index": 5}], "category": "general"}, {"name": "browser_input_text", "description": "\u5728\u6307\u5b9a\u5143\u7d20\u4e2d\u8f93\u5165\u6587\u672c", "parameters": {"index": {"type": "integer", "description": "\u8981\u8f93\u5165\u6587\u672c\u7684\u5143\u7d20\u7d22\u5f15", "required": true}, "text": {"type": "string", "description": "\u8981\u8f93\u5165\u7684\u6587\u672c", "required": true}}, "examples": [{"index": 2, "text": "hello world"}, {"index": 0, "text": "test@example.com"}], "category": "general"}, {"name": "browser_send_keys", "description": "\u53d1\u9001\u7279\u6b8a\u952e\u6216\u5feb\u6377\u952e", "parameters": {"keys": {"type": "string", "description": "\u8981\u53d1\u9001\u7684\u952e\uff0c\u5982Enter\u3001Escape\u3001Control+c\u7b49", "required": true}}, "examples": [{"keys": "Enter"}, {"keys": "Control+c"}, {"keys": "Escape"}], "category": "general"}, {"name": "browser_scroll_down", "description": "\u5411\u4e0b\u6eda\u52a8\u9875\u9762", "parameters": {"amount": {"type": "integer", "description": "\u6eda\u52a8\u50cf\u7d20\u6570\uff0c\u4e0d\u6307\u5b9a\u5219\u6eda\u52a8\u4e00\u9875", "required": false}}, "examples": [{}, {"amount": 500}], "category": "general"}, {"name": "browser_scroll_up", "description": "\u5411\u4e0a\u6eda\u52a8\u9875\u9762", "parameters": {"amount": {"type": "integer", "description": "\u6eda\u52a8\u50cf\u7d20\u6570\uff0c\u4e0d\u6307\u5b9a\u5219\u6eda\u52a8\u4e00\u9875", "required": false}}, "examples": [{}, {"amount": 300}], "category": "general"}, {"name": "browser_scroll_to_text", "description": "\u6eda\u52a8\u5230\u5305\u542b\u6307\u5b9a\u6587\u672c\u7684\u5143\u7d20", "parameters": {"text": {"type": "string", "description": "\u8981\u6eda\u52a8\u5230\u7684\u6587\u672c\u5185\u5bb9", "required": true}}, "examples": [{"text": "Sign up"}, {"text": "Contact us"}], "category": "general"}, {"name": "browser_switch_tab", "description": "\u5207\u6362\u5230\u6307\u5b9a\u6807\u7b7e", "parameters": {"page_id": {"type": "integer", "description": "\u8981\u5207\u6362\u5230\u7684\u6807\u7b7eID", "required": true}}, "examples": [{"page_id": 0}, {"page_id": 1}], "category": "general"}, {"name": "browser_open_tab", "description": "\u5728\u65b0\u6807\u7b7e\u4e2d\u6253\u5f00URL", "parameters": {"url": {"type": "string", "description": "\u8981\u5728\u65b0\u6807\u7b7e\u4e2d\u6253\u5f00\u7684URL", "required": true}}, "examples": [{"url": "https://www.example.com"}], "category": "general"}, {"name": "browser_close_tab", "description": "\u5173\u95ed\u6307\u5b9a\u6807\u7b7e", "parameters": {"page_id": {"type": "integer", "description": "\u8981\u5173\u95ed\u7684\u6807\u7b7eID", "required": true}}, "examples": [{"page_id": 1}], "category": "general"}, {"name": "browser_extract_content", "description": "\u4ece\u9875\u9762\u63d0\u53d6\u7279\u5b9a\u5185\u5bb9", "parameters": {"goal": {"type": "string", "description": "\u63d0\u53d6\u76ee\u6807\u63cf\u8ff0", "required": true}, "include_links": {"type": "boolean", "description": "\u662f\u5426\u5305\u542b\u94fe\u63a5\uff0c\u9ed8\u8ba4false", "required": false}}, "examples": [{"goal": "\u63d0\u53d6\u6240\u6709\u516c\u53f8\u540d\u79f0"}, {"goal": "\u83b7\u53d6\u4ea7\u54c1\u4ef7\u683c\u4fe1\u606f", "include_links": true}], "category": "general"}, {"name": "browser_get_content", "description": "\u83b7\u53d6\u9875\u9762\u5185\u5bb9", "parameters": {"selector": {"type": "string", "description": "CSS\u9009\u62e9\u5668\uff0c\u7a7a\u5219\u83b7\u53d6\u5168\u90e8\u5185\u5bb9", "required": false}}, "examples": [{"selector": "h1, p"}, {}], "category": "general"}, {"name": "browser_get_ax_tree", "description": "\u83b7\u53d6\u9875\u9762\u7684\u53ef\u8bbf\u95ee\u6027\u6811\u7ed3\u6784", "parameters": {"number_of_elements": {"type": "integer", "description": "\u8fd4\u56de\u7684\u5143\u7d20\u6570\u91cf", "required": true}}, "examples": [{"number_of_elements": 50}], "category": "general"}, {"name": "browser_get_dropdown_options", "description": "\u83b7\u53d6\u4e0b\u62c9\u83dc\u5355\u7684\u6240\u6709\u9009\u9879", "parameters": {"index": {"type": "integer", "description": "\u4e0b\u62c9\u83dc\u5355\u5143\u7d20\u7684\u7d22\u5f15", "required": true}}, "examples": [{"index": 3}], "category": "general"}, {"name": "browser_select_dropdown_option", "description": "\u9009\u62e9\u4e0b\u62c9\u83dc\u5355\u4e2d\u7684\u9009\u9879", "parameters": {"index": {"type": "integer", "description": "\u4e0b\u62c9\u83dc\u5355\u5143\u7d20\u7684\u7d22\u5f15", "required": true}, "text": {"type": "string", "description": "\u8981\u9009\u62e9\u7684\u9009\u9879\u6587\u672c", "required": true}}, "examples": [{"index": 3, "text": "Option 1"}], "category": "general"}, {"name": "browser_drag_drop", "description": "\u6267\u884c\u62d6\u62fd\u64cd\u4f5c", "parameters": {"element_source": {"type": "string", "description": "\u6e90\u5143\u7d20\u9009\u62e9\u5668", "required": false}, "element_target": {"type": "string", "description": "\u76ee\u6807\u5143\u7d20\u9009\u62e9\u5668", "required": false}, "coord_source_x": {"type": "integer", "description": "\u6e90\u5750\u6807X", "required": false}, "coord_source_y": {"type": "integer", "description": "\u6e90\u5750\u6807Y", "required": false}, "coord_target_x": {"type": "integer", "description": "\u76ee\u6807\u5750\u6807X", "required": false}, "coord_target_y": {"type": "integer", "description": "\u76ee\u6807\u5750\u6807Y", "required": false}, "steps": {"type": "integer", "description": "\u62d6\u62fd\u6b65\u9aa4\u6570\uff0c\u9ed8\u8ba410", "required": false}}, "examples": [{"element_source": ".item1", "element_target": ".dropzone"}], "category": "general"}, {"name": "browser_save_pdf", "description": "\u5c06\u5f53\u524d\u9875\u9762\u4fdd\u5b58\u4e3aPDF", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_screenshot", "description": "\u622a\u53d6\u5f53\u524d\u9875\u9762\u622a\u56fe", "parameters": {"filename": {"type": "string", "description": "\u622a\u56fe\u6587\u4ef6\u540d\uff0c\u53ef\u9009", "required": false}}, "examples": [{"filename": "current_page.png"}, {}], "category": "general"}, {"name": "browser_wait", "description": "\u7b49\u5f85\u6307\u5b9a\u79d2\u6570", "parameters": {"seconds": {"type": "number", "description": "\u7b49\u5f85\u7684\u79d2\u6570\uff0c\u9ed8\u8ba43", "required": false}}, "examples": [{"seconds": 5}, {}], "category": "general"}, {"name": "browser_done", "description": "\u6807\u8bb0\u4efb\u52a1\u5b8c\u6210", "parameters": {"text": {"type": "string", "description": "\u5b8c\u6210\u63cf\u8ff0", "required": true}, "success": {"type": "boolean", "description": "\u662f\u5426\u6210\u529f\u5b8c\u6210", "required": true}}, "examples": [{"text": "\u4efb\u52a1\u5df2\u5b8c\u6210", "success": true}], "category": "general"}, {"name": "browser_get_page_info", "description": "\u83b7\u53d6\u5f53\u524d\u9875\u9762\u4fe1\u606f", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_get_current_url", "description": "\u83b7\u53d6\u5f53\u524d\u9875\u9762URL", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_close_session", "description": "\u5173\u95ed\u6d4f\u89c8\u5668\u4f1a\u8bdd", "parameters": {}, "examples": [{}], "category": "general"}], "endpoint": "ws://localhost:8084", "connection_params": {}}}
2025-06-28 10:59:19,019 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Waiting for registration response from toolscore...
2025-06-28 10:59:19,019 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "fedfe4...onnection_params": {}}}' [9625 bytes]
2025-06-28 10:59:19,019 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: browser_use_server (ID: browser_use)
2025-06-28 10:59:19,019 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: browser_use_server
2025-06-28 10:59:19,019 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: browser_use -> ws://localhost:8084
2025-06-28 10:59:19,019 - core.toolscore.core_manager - INFO - 工具立即可用: browser_use
2025-06-28 10:59:19,019 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 10:59:19,019 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Received registration response: {"type": "register_tool_response", "request_id": "fedfe4e8-d89d-4a1d-a9bb-a6d2c8e1d8e6", "success": true, "message": null}
2025-06-28 10:59:19,019 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Successfully registered with toolscore.
2025-06-28 10:59:19,019 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:59:19,019 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 10:59:19,019 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 10:59:19,020 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 10:59:19,020 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 10:59:19,020 - websockets.server - INFO - connection closed
2025-06-28 10:59:20,905 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:59:20,906 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:59:23,446 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第4次, 5s间隔)
2025-06-28 10:59:23,907 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:59:23,907 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:59:26,908 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:59:26,909 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:59:28,447 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第5次, 5s间隔)
2025-06-28 10:59:29,910 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:59:29,910 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:59:32,911 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:59:32,911 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:59:33,448 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第6次, 5s间隔)
2025-06-28 10:59:35,913 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 10:59:35,913 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 10:59:38,421 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 10:59:38,437 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 10:59:38,437 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 10:59:38,437 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 10:59:38,447 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 10:59:38,449 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第7次, 5s间隔)
2025-06-28 10:59:38,914 - services.mcp_server_launcher - DEBUG - ⏱️ microsandbox_server 就绪检测超时 (30秒)
2025-06-28 10:59:38,914 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 10:59:38,914 - services.mcp_server_launcher - INFO - ✅ 成功启动 4/4 个MCP服务器: ['microsandbox_server', 'search_tool_server', 'browser_use_server', 'deepsearch_server']
2025-06-28 10:59:38,914 - services.service_manager - INFO - 启动服务: task_api
2025-06-28 10:59:38,914 - services.task_api_service - INFO - 正在启动任务API服务...
2025-06-28 10:59:38,923 - services.task_api_service - INFO - 任务API服务已启动于 0.0.0.0:8000
2025-06-28 10:59:38,923 - services.service_manager - INFO - 启动服务: runtime
2025-06-28 10:59:38,923 - services.runtime_service - INFO - 正在启动推理运行时服务...
2025-06-28 10:59:38,924 - services.service_manager - INFO - 启动服务: synthesis
2025-06-28 10:59:38,924 - services.synthesis_service - INFO - 正在启动合成服务...
2025-06-28 10:59:38,924 - services.synthesis_service - INFO - 合成服务工作线程已启动
2025-06-28 10:59:38,924 - services.synthesis_service - INFO - SynthesisCore v2.0监控器工作线程已启动
2025-06-28 10:59:38,924 - services.synthesis_service - INFO - 开始处理轨迹数据...
2025-06-28 10:59:38,924 - services.synthesis_service - INFO - 🚀 启动SynthesisCore v2.0监控器
2025-06-28 10:59:38,924 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 10:59:38,924 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 10:59:38,924 - services.synthesis_service - INFO - 合成服务已启动
2025-06-28 10:59:38,924 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 10:59:38,924 - services.service_manager - INFO - 所有服务已启动
2025-06-28 10:59:38,924 - core.synthesiscore.synthesis - INFO - 🔄 Processing only unprocessed trajectories...
2025-06-28 10:59:38,924 - __main__ - DEBUG - ✅ 所有服务启动完成
2025-06-28 10:59:38,925 - __main__ - INFO - 🎉 所有服务已启动，系统运行中...
2025-06-28 10:59:38,925 - __main__ - INFO - 📊 系统状态监控已启用，按 Ctrl+C 停止
2025-06-28 10:59:38,925 - services.runtime_service - INFO - 启动运行时实例: enhanced-reasoning-1
2025-06-28 10:59:38,925 - runtimes.reasoning.enhanced_runtime - INFO - 🚀 初始化Enhanced Reasoning Runtime - 简化版本
2025-06-28 10:59:38,925 - core.llm.response_parsers.reasoning_response_parser - DEBUG - ✅ 响应解析器已连接工具Schema管理器
2025-06-28 10:59:38,925 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 工具Schema管理器已注入到响应解析器
2025-06-28 10:59:38,925 - runtimes.reasoning.enhanced_runtime - INFO - ⏳ 等待ToolScore服务就绪...
2025-06-28 10:59:38,925 - core.synthesiscore.synthesis - INFO - 🎯 Unprocessed trajectories completed: 0 new trajectories processed
2025-06-28 10:59:38,925 - services.synthesis_service - DEBUG - 等待 300 秒后再次处理...
2025-06-28 10:59:38,926 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ Redis连接初始化成功
2025-06-28 10:59:38,926 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:corpus_queue
2025-06-28 10:59:38,926 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:atomic_tasks
2025-06-28 10:59:38,927 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:extended_tasks
2025-06-28 10:59:38,927 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:10:59:38 +0800] "GET /health HTTP/1.1" 200 231 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 10:59:38,927 - runtimes.reasoning.toolscore_client - INFO - ✅ ToolScore服务已就绪
2025-06-28 10:59:38,927 - runtimes.reasoning.enhanced_runtime - INFO - ✅ ToolScore HTTP服务已就绪
2025-06-28 10:59:38,928 - runtimes.reasoning.enhanced_runtime - INFO - 🔌 正在连接WebSocket端点: ws://localhost:8081/websocket
2025-06-28 10:59:38,928 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:verification_queue
2025-06-28 10:59:38,928 - runtimes.reasoning.real_time_tool_client - INFO - 🔌 连接到ToolScore实时更新: ws://localhost:8081/websocket
2025-06-28 10:59:38,928 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:training_data
2025-06-28 10:59:38,928 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:quality_reports
2025-06-28 10:59:38,928 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 10:59:38,929 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 10:59:38,929 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ Redis配置键初始化完成
2025-06-28 10:59:38,929 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ 增强合成Redis管理器初始化完成
2025-06-28 10:59:38,929 - websockets.client - DEBUG - > GET /websocket HTTP/1.1
2025-06-28 10:59:38,929 - core.synthesiscore.enhanced_synthesis_engine - INFO - ✅ Enhanced Synthesis Engine 初始化完成
2025-06-28 10:59:38,929 - websockets.client - DEBUG - > Host: localhost:8081
2025-06-28 10:59:38,929 - core.synthesiscore.enhanced_synthesis_engine - INFO - 🚀 SynthesisCore v2.0 已启动
2025-06-28 10:59:38,929 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 10:59:38,929 - core.synthesiscore.trajectory_monitor - INFO - 🔄 检查并处理现有轨迹...
2025-06-28 10:59:38,929 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 10:59:38,929 - core.synthesiscore.trajectory_monitor - INFO - 📝 没有现有轨迹文件
2025-06-28 10:59:38,929 - websockets.client - DEBUG - > Sec-WebSocket-Key: 2Z8mMMPanS3FnG9f3bRW+A==
2025-06-28 10:59:38,929 - core.synthesiscore.trajectory_monitor - INFO - ✅ TrajectoryMonitor初始化完成
2025-06-28 10:59:38,929 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 10:59:38,930 - core.synthesiscore.trajectory_monitor - DEBUG - ✅ 获取主事件循环引用成功
[2025-06-28 10:59:38] INFO:     Started server process [72025]
2025-06-28 10:59:38,930 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
[2025-06-28 10:59:38] INFO:     Waiting for application startup.
2025-06-28 10:59:38,930 - websockets.client - DEBUG - > User-Agent: Enhanced-Reasoning-Runtime/1.0
2025-06-28 10:59:38,931 - core.synthesiscore.trajectory_monitor - INFO - 👁️ 开始监控轨迹文件变化: output/trajectories
2025-06-28 10:59:38,931 - services.synthesis_service - INFO - ✅ SynthesisCore v2.0监控器已启动
2025-06-28 10:59:38,931 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 10:59:38,931 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 10:59:38,931 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 10:59:38,931 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 10:59:38,931 - websockets.server - DEBUG - < Sec-WebSocket-Key: 2Z8mMMPanS3FnG9f3bRW+A==
2025-06-28 10:59:38,931 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 10:59:38,931 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 10:59:38,932 - websockets.server - DEBUG - < User-Agent: Enhanced-Reasoning-Runtime/1.0
2025-06-28 10:59:38,932 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 10:59:38,932 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 10:59:38,932 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 10:59:38,932 - websockets.server - DEBUG - > Sec-WebSocket-Accept: aj1LdZNj6ViiagVTdxged0UTod4=
2025-06-28 10:59:38,932 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:59:38,932 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 02:59:38 GMT
2025-06-28 10:59:38,932 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 10:59:38,932 - websockets.server - INFO - connection open
2025-06-28 10:59:38,932 - core.task_api - INFO - Connected to Redis: redis://localhost:6379
2025-06-28 10:59:38,932 - websockets.server - DEBUG - = connection is OPEN
[2025-06-28 10:59:38] INFO:     Application startup complete.
2025-06-28 10:59:38,932 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 10:59:38,932 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 60827)
2025-06-28 10:59:38,932 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 10:59:38,932 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 10:59:38,932 - websockets.client - DEBUG - < Sec-WebSocket-Accept: aj1LdZNj6ViiagVTdxged0UTod4=
2025-06-28 10:59:38,932 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 10:59:38,932 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 02:59:38 GMT
2025-06-28 10:59:38,932 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 10:59:38,932 - websockets.client - DEBUG - = connection is OPEN
[2025-06-28 10:59:38] INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-06-28 10:59:38,932 - runtimes.reasoning.real_time_tool_client - INFO - ✅ 已连接到ToolScore实时更新流
2025-06-28 10:59:38,932 - runtimes.reasoning.enhanced_runtime - INFO - ✅ WebSocket实时更新连接成功
2025-06-28 10:59:38,933 - runtimes.reasoning.real_time_tool_client - DEBUG - 已注册工具更新回调，当前回调数量: 1
2025-06-28 10:59:38,933 - runtimes.reasoning.enhanced_runtime - INFO - ⏳ 等待关键工具完全就绪...
2025-06-28 10:59:38,933 - runtimes.reasoning.enhanced_runtime - WARNING - 🚀 临时跳过详细工具等待，快速启动模式
2025-06-28 10:59:38,933 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 使用快速启动模式，工具将在后台异步就绪
2025-06-28 10:59:38,933 - runtimes.reasoning.enhanced_runtime - INFO - 🔍 开始MCP服务器同步验证...
2025-06-28 10:59:38,933 - core.tool_schema_manager - INFO - 正在执行MCP同步验证...
2025-06-28 10:59:38,933 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=False)，当前缓存: 0 个工具
2025-06-28 10:59:38,933 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 10:59:38,933 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
2025-06-28 10:59:38,933 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 10:59:38,933 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
2025-06-28 10:59:38,933 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
2025-06-28 10:59:38,933 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 10:59:38,933 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 10:59:38,933 - core.tool_schema_manager - INFO - 🔄 检测到 4 个工具需要更新: ['deepsearch', 'microsandbox', 'browser_use', 'mcp-search-tool']
2025-06-28 10:59:38,933 - core.tool_schema_manager - INFO - 🔄 执行增量更新: 4 个工具
2025-06-28 10:59:38,933 - core.tool_schema_manager - INFO - 🔄 缓存为空，转为全量刷新模式
2025-06-28 10:59:38,933 - core.tool_schema_manager - DEBUG - 🔄 开始增强刷新工具Schemas...
2025-06-28 10:59:38,933 - core.tool_schema_manager - DEBUG - 🔍 工具注册表状态检查: _tools 字典包含 4 个条目
2025-06-28 10:59:38,933 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: deepsearch
2025-06-28 10:59:38,933 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: microsandbox
2025-06-28 10:59:38,933 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: browser_use
2025-06-28 10:59:38,933 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: mcp-search-tool
2025-06-28 10:59:38,933 - core.tool_schema_manager - INFO - 🔧 选项1: 从工具注册表获取到 4 个工具
2025-06-28 10:59:38,933 - core.tool_schema_manager - DEBUG -   工具 0: id=deepsearch, name=网络信息研究工具, actions=3
2025-06-28 10:59:38,933 - core.tool_schema_manager - DEBUG -   工具 1: id=microsandbox, name=MicroSandbox安全代码执行器, actions=7
2025-06-28 10:59:38,933 - core.tool_schema_manager - DEBUG -   工具 2: id=browser_use, name=智能浏览器操作工具, actions=6
2025-06-28 10:59:38,933 - core.tool_schema_manager - DEBUG -   工具 3: id=mcp-search-tool, name=工具管理和项目文件搜索器, actions=4
2025-06-28 10:59:38,933 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: deepsearch
2025-06-28 10:59:38,934 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: comprehensive_research
2025-06-28 10:59:38,934 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: quick_research
2025-06-28 10:59:38,934 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: research
2025-06-28 10:59:38,934 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 deepsearch (包含 3 个动作)
2025-06-28 10:59:38,934 - core.tool_schema_manager - DEBUG -    当前缓存大小: 1 个工具
2025-06-28 10:59:38,934 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: microsandbox
2025-06-28 10:59:38,934 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_cleanup_expired
2025-06-28 10:59:38,935 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_close_session
2025-06-28 10:59:38,935 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_execute
2025-06-28 10:59:38,935 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_health_status
2025-06-28 10:59:38,935 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_performance_stats
2025-06-28 10:59:38,935 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_install_package
2025-06-28 10:59:38,935 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_list_sessions
2025-06-28 10:59:38,935 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 microsandbox (包含 7 个动作)
2025-06-28 10:59:38,935 - core.tool_schema_manager - DEBUG -    当前缓存大小: 2 个工具
2025-06-28 10:59:38,935 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: browser_use
2025-06-28 10:59:38,935 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_click_element
2025-06-28 10:59:38,935 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_use_execute_task
2025-06-28 10:59:38,936 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_extract_content
2025-06-28 10:59:38,936 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_input_text
2025-06-28 10:59:38,936 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_navigate
2025-06-28 10:59:38,936 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_search_google
2025-06-28 10:59:38,936 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 browser_use (包含 6 个动作)
2025-06-28 10:59:38,936 - core.tool_schema_manager - DEBUG -    当前缓存大小: 3 个工具
2025-06-28 10:59:38,936 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: mcp-search-tool
2025-06-28 10:59:38,936 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: analyze_tool_needs
2025-06-28 10:59:38,936 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: list_code_definitions
2025-06-28 10:59:38,936 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_and_install_tools
2025-06-28 10:59:38,936 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_file_content
2025-06-28 10:59:38,936 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 mcp-search-tool (包含 4 个动作)
2025-06-28 10:59:38,936 - core.tool_schema_manager - DEBUG -    当前缓存大小: 4 个工具
2025-06-28 10:59:38,936 - core.tool_schema_manager - INFO - 🔧 选项1: 成功处理 4/4 个工具，当前缓存 4 个工具
2025-06-28 10:59:38,937 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: mcp-search-tool
2025-06-28 10:59:38,937 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: microsandbox
2025-06-28 10:59:38,937 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: browser_use
2025-06-28 10:59:38,937 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: deepsearch
2025-06-28 10:59:38,937 - core.tool_schema_manager - INFO - ✅ 增强刷新完成，当前可用工具: 4个
2025-06-28 10:59:38,938 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 10:59:38,938 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 10:59:38,938 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 10:59:38,938 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 10:59:38,939 - core.tool_schema_manager - INFO - ✅ Schema安全刷新完成，备份 4 个工具
2025-06-28 10:59:38,939 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 10:59:38,939 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 10:59:38,939 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 10:59:38,939 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 10:59:38,939 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 10:59:38,939 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 10:59:38,939 - core.tool_schema_manager - INFO - 🔍 同步验证完成: unhealthy (0/4 工具Schema一致)
2025-06-28 10:59:38,939 - runtimes.reasoning.enhanced_runtime - ERROR - ❌ MCP服务器同步验证失败: 未知错误
2025-06-28 10:59:38,940 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔧 开始获取可用工具ID列表...
2025-06-28 10:59:38,940 - runtimes.reasoning.real_time_tool_client - DEBUG - 可用工具ID列表: ['microsandbox', 'mcp-search-tool', 'deepsearch', 'browser_use']
2025-06-28 10:59:38,940 - runtimes.reasoning.enhanced_runtime - DEBUG - 📋 获取到的工具列表: ['microsandbox', 'mcp-search-tool', 'deepsearch', 'browser_use']
2025-06-28 10:59:38,940 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 工具Schema管理器已初始化
2025-06-28 10:59:38,940 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔧 更新Guardrails和ValidationCritic工具配置...
2025-06-28 10:59:38,940 - core.llm.guardrails_middleware - INFO - 🔧 初始化输入验证Guard...
2025-06-28 10:59:38,941 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 10:59:38,942 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 10:59:38,942 - core.llm.guardrails_middleware - INFO - 🔧 初始化输出验证Guard...
2025-06-28 10:59:38,942 - core.llm.guardrails_middleware - INFO - 🔧 使用本地LLM客户端初始化Guard...
2025-06-28 10:59:38,942 - core.llm.guardrails_middleware - ERROR - ❌ 创建高级输出Guard失败: Guard.for_rail_string() got an unexpected keyword argument 'api'
2025-06-28 10:59:38,942 - core.llm.guardrails_middleware - ERROR - Traceback (most recent call last):
  File "/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/core/llm/guardrails_middleware.py", line 142, in _create_advanced_output_guard
    guard = Guard.from_rail_string(rail_schema, api=llm_api_wrapper, num_reasks=2)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/guardrails/guard.py", line 477, in from_rail_string
    return cls.for_rail_string(rail_string, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Guard.for_rail_string() got an unexpected keyword argument 'api'

2025-06-28 10:59:38,942 - core.llm.guardrails_middleware - INFO - ✅ Guardrails Guards初始化成功
2025-06-28 10:59:38,942 - core.llm.guardrails_middleware - INFO -    - 输入Guard: ✅
2025-06-28 10:59:38,942 - core.llm.guardrails_middleware - INFO -    - 输出Guard: ❌
2025-06-28 10:59:38,942 - core.llm.guardrails_middleware - INFO - 🔄 Guardrails工具列表已更新: 4个工具
2025-06-28 10:59:38,942 - core.agents.validation_critic - INFO - 🔄 ValidationCritic工具列表已更新: 4个工具
2025-06-28 10:59:38,942 - runtimes.reasoning.enhanced_runtime - INFO - ✅ Guardrails和ValidationCritic已配置4个工具: microsandbox, mcp-search-tool, deepsearch, browser_use
2025-06-28 10:59:38,942 - runtimes.reasoning.enhanced_runtime - INFO - ✅ Enhanced Reasoning Runtime 已成功初始化为纯推理引擎（集成Guardrails + ValidationCritic）
2025-06-28 10:59:38,942 - services.runtime_service - INFO - 启动运行时任务消费: enhanced-reasoning-1
2025-06-28 10:59:38,942 - services.runtime_service - INFO - 推理运行时服务已启动 1 个实例和 1 个任务消费协程
2025-06-28 10:59:38,943 - core.tool_schema_manager - INFO - 🔍 启动MCP服务器配置监控...
2025-06-28 10:59:38,943 - core.task_manager - INFO - Runtime enhanced-reasoning-1 starting to consume from queue: tasks:reasoning
2025-06-28 10:59:38,943 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/search_tool_server/service.json
2025-06-28 10:59:38,943 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/microsandbox_server/service.json
2025-06-28 10:59:38,944 - core.task_manager - INFO - Runtime enhanced-reasoning-1 starting consumer loop for queue tasks:reasoning
2025-06-28 10:59:38,944 - core.task_manager - DEBUG - Runtime enhanced-reasoning-1 reading from queue tasks:reasoning...
2025-06-28 10:59:38,944 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/browser_use_server/service.json
2025-06-28 10:59:38,944 - core.task_manager - INFO - Runtime enhanced-reasoning-1 received 1 message(s) from queue tasks:reasoning
2025-06-28 10:59:38,944 - core.task_manager - INFO - Runtime enhanced-reasoning-1 processing message b'1751038503471-0'
2025-06-28 10:59:38,944 - core.task_manager - INFO - Processing task 7cb67434-cbe9-42bc-b526-7b3de18936d4 from queue tasks:reasoning
2025-06-28 10:59:38,944 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/deepsearch_server/service.json
2025-06-28 10:59:38,944 - core.tool_schema_manager - INFO - 🔄 MCP配置变化，强制刷新schema...
2025-06-28 10:59:38,944 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=True)，当前缓存: 0 个工具
2025-06-28 10:59:38,944 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 10:59:38,944 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
2025-06-28 10:59:38,944 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 10:59:38,944 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
2025-06-28 10:59:38,944 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
2025-06-28 10:59:38,944 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 10:59:38,944 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 10:59:38,944 - core.tool_schema_manager - INFO - 🔄 检测到 4 个工具需要更新: ['deepsearch', 'microsandbox', 'browser_use', 'mcp-search-tool']
2025-06-28 10:59:38,944 - core.tool_schema_manager - INFO - 🔄 执行增量更新: 4 个工具
2025-06-28 10:59:38,944 - core.tool_schema_manager - INFO - 🔄 缓存为空，转为全量刷新模式
2025-06-28 10:59:38,944 - core.tool_schema_manager - DEBUG - 🔄 开始增强刷新工具Schemas...
2025-06-28 10:59:38,944 - core.tool_schema_manager - DEBUG - 🔍 工具注册表状态检查: _tools 字典包含 4 个条目
2025-06-28 10:59:38,944 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: deepsearch
2025-06-28 10:59:38,944 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: microsandbox
2025-06-28 10:59:38,944 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: browser_use
2025-06-28 10:59:38,944 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: mcp-search-tool
2025-06-28 10:59:38,945 - core.tool_schema_manager - INFO - 🔧 选项1: 从工具注册表获取到 4 个工具
2025-06-28 10:59:38,945 - core.tool_schema_manager - DEBUG -   工具 0: id=deepsearch, name=网络信息研究工具, actions=3
2025-06-28 10:59:38,945 - core.tool_schema_manager - DEBUG -   工具 1: id=microsandbox, name=MicroSandbox安全代码执行器, actions=7
2025-06-28 10:59:38,945 - core.tool_schema_manager - DEBUG -   工具 2: id=browser_use, name=智能浏览器操作工具, actions=6
2025-06-28 10:59:38,945 - core.tool_schema_manager - DEBUG -   工具 3: id=mcp-search-tool, name=工具管理和项目文件搜索器, actions=4
2025-06-28 10:59:38,945 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: deepsearch
2025-06-28 10:59:38,945 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: comprehensive_research
2025-06-28 10:59:38,945 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: quick_research
2025-06-28 10:59:38,946 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: research
2025-06-28 10:59:38,946 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 deepsearch (包含 3 个动作)
2025-06-28 10:59:38,946 - core.tool_schema_manager - DEBUG -    当前缓存大小: 1 个工具
2025-06-28 10:59:38,946 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: microsandbox
2025-06-28 10:59:38,946 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_cleanup_expired
2025-06-28 10:59:38,946 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_close_session
2025-06-28 10:59:38,946 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_execute
2025-06-28 10:59:38,946 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_health_status
2025-06-28 10:59:38,946 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_performance_stats
2025-06-28 10:59:38,946 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_install_package
2025-06-28 10:59:38,946 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_list_sessions
2025-06-28 10:59:38,947 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 microsandbox (包含 7 个动作)
2025-06-28 10:59:38,947 - core.tool_schema_manager - DEBUG -    当前缓存大小: 2 个工具
2025-06-28 10:59:38,947 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: browser_use
2025-06-28 10:59:38,947 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_click_element
2025-06-28 10:59:38,947 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-48' coro=<start.<locals>.start_all_runtimes() running at /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/services/runtime_service.py:94> wait_for=<_GatheringFuture pending cb=[Task.task_wakeup()]>>
2025-06-28 10:59:38,947 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='runtime-enhanced-reasoning-1' coro=<start_runtime_service() running at /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/core/task_manager.py:388> wait_for=<Future pending cb=[Task.task_wakeup()]> cb=[gather.<locals>._done_callback() at /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/tasks.py:764]>
2025-06-28 10:59:38,947 - core.task_manager - ERROR - ❌ Runtime enhanced-reasoning-1 crashed: coroutine ignored GeneratorExit
Traceback (most recent call last):
  File "/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/core/task_manager.py", line 388, in start_runtime_service
    await _run_service()
RuntimeError: coroutine ignored GeneratorExit
[2025-06-28 10:59:38] Exception ignored in: [2025-06-28 10:59:38] <coroutine object start_runtime_service at 0x108a08540>
[2025-06-28 10:59:38] Traceback (most recent call last):
[2025-06-28 10:59:38]   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/pydantic/json_schema.py", line 463, in generate_inner
    [2025-06-28 10:59:38] def handler_func(schema_or_field: CoreSchemaOrField) -> JsonSchemaValue:
[2025-06-28 10:59:38] RuntimeError[2025-06-28 10:59:38] : [2025-06-28 10:59:38] coroutine ignored GeneratorExit
2025-06-28 10:59:38,948 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_use_execute_task
2025-06-28 10:59:38,949 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_extract_content
2025-06-28 10:59:38,949 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_input_text
2025-06-28 10:59:38,949 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_navigate
2025-06-28 10:59:38,949 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_search_google
2025-06-28 10:59:38,949 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 browser_use (包含 6 个动作)
2025-06-28 10:59:38,949 - core.tool_schema_manager - DEBUG -    当前缓存大小: 3 个工具
2025-06-28 10:59:38,949 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: mcp-search-tool
2025-06-28 10:59:38,949 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: analyze_tool_needs
2025-06-28 10:59:38,949 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: list_code_definitions
2025-06-28 10:59:38,949 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_and_install_tools
2025-06-28 10:59:38,949 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_file_content
2025-06-28 10:59:38,949 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 mcp-search-tool (包含 4 个动作)
2025-06-28 10:59:38,949 - core.tool_schema_manager - DEBUG -    当前缓存大小: 4 个工具
2025-06-28 10:59:38,949 - core.tool_schema_manager - INFO - 🔧 选项1: 成功处理 4/4 个工具，当前缓存 4 个工具
2025-06-28 10:59:38,949 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: mcp-search-tool
2025-06-28 10:59:38,950 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: microsandbox
2025-06-28 10:59:38,950 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: browser_use
2025-06-28 10:59:38,950 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: deepsearch
2025-06-28 10:59:38,950 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:10:59:38 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 10:59:38,950 - core.tool_schema_manager - DEBUG - 🔍 从ToolScore获取到工具列表: ['mcp-search-tool', 'microsandbox', 'browser_use', 'deepsearch']
2025-06-28 10:59:38,950 - core.tool_schema_manager - DEBUG - 🔧 映射后的工具列表: ['mcp-search-tool', 'microsandbox', 'browser_use', 'deepsearch']
2025-06-28 10:59:38,950 - core.tool_schema_manager - DEBUG - ⏭️ 工具 mcp-search-tool 已在缓存中，跳过ToolScore获取
2025-06-28 10:59:38,950 - core.tool_schema_manager - DEBUG - ⏭️ 工具 microsandbox 已在缓存中，跳过ToolScore获取
2025-06-28 10:59:38,950 - core.tool_schema_manager - DEBUG - ⏭️ 工具 browser_use 已在缓存中，跳过ToolScore获取
2025-06-28 10:59:38,950 - core.tool_schema_manager - DEBUG - ⏭️ 工具 deepsearch 已在缓存中，跳过ToolScore获取
2025-06-28 10:59:38,950 - core.tool_schema_manager - INFO - ✅ 增强刷新完成，当前可用工具: 4个
2025-06-28 10:59:38,951 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 10:59:38,951 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 10:59:38,951 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 10:59:38,951 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 10:59:38,951 - core.tool_schema_manager - INFO - ✅ Schema安全刷新完成，备份 4 个工具
2025-06-28 10:59:38,952 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 10:59:38,952 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 10:59:38,952 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 10:59:38,952 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 10:59:38,952 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 10:59:38,952 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 10:59:43,451 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第8次, 5s间隔)
2025-06-28 10:59:48,451 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第9次, 5s间隔)
2025-06-28 10:59:53,452 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第10次, 5s间隔)
2025-06-28 10:59:58,453 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第11次, 5s间隔)
2025-06-28 10:59:58,938 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 10:59:58,938 - websockets.client - DEBUG - > PING a1 3f e4 da [binary, 4 bytes]
2025-06-28 10:59:58,939 - websockets.server - DEBUG - < PING a1 3f e4 da [binary, 4 bytes]
2025-06-28 10:59:58,939 - websockets.server - DEBUG - > PONG a1 3f e4 da [binary, 4 bytes]
2025-06-28 10:59:58,939 - websockets.client - DEBUG - < PONG a1 3f e4 da [binary, 4 bytes]
2025-06-28 10:59:58,939 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:00:03,454 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第12次, 5s间隔)
2025-06-28 11:00:08,424 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:00:08,442 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:00:08,443 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:00:08,443 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:00:08,452 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:00:08,455 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第13次, 30s间隔)
2025-06-28 11:00:08,933 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:00:08,933 - websockets.server - DEBUG - > PING b0 79 bd 25 [binary, 4 bytes]
2025-06-28 11:00:08,933 - websockets.client - DEBUG - < PING b0 79 bd 25 [binary, 4 bytes]
2025-06-28 11:00:08,933 - websockets.client - DEBUG - > PONG b0 79 bd 25 [binary, 4 bytes]
2025-06-28 11:00:08,934 - websockets.server - DEBUG - < PONG b0 79 bd 25 [binary, 4 bytes]
2025-06-28 11:00:08,934 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:00:18,940 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:00:18,940 - websockets.client - DEBUG - > PING '⇓b' [text, 4 bytes]
2025-06-28 11:00:18,940 - websockets.server - DEBUG - < PING '⇓b' [text, 4 bytes]
2025-06-28 11:00:18,940 - websockets.server - DEBUG - > PONG '⇓b' [text, 4 bytes]
2025-06-28 11:00:18,940 - websockets.client - DEBUG - < PONG '⇓b' [text, 4 bytes]
2025-06-28 11:00:18,940 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:00:19,913 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:00:19,913 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:00:19,913 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:00:19,913 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:00:19,913 - services.synthesis_service - INFO - 🛑 SynthesisCore v2.0监控器已停止
2025-06-28 11:00:19,913 - services.synthesis_service - INFO - 等待合成服务线程结束...
2025-06-28 11:00:19,973 - core.synthesiscore.trajectory_monitor - INFO - 🛑 轨迹文件监控已停止
2025-06-28 11:00:19,973 - core.synthesiscore.enhanced_synthesis_engine - ERROR - ❌ Enhanced Synthesis Engine 关闭失败: object NoneType can't be used in 'await' expression
2025-06-28 11:00:19,973 - core.synthesiscore.enhanced_synthesis_engine - INFO - 🔒 SynthesisCore v2.0 已关闭
2025-06-28 11:00:19,973 - core.synthesiscore.trajectory_monitor - INFO - 🔒 SynthesisCore已关闭
2025-06-28 11:00:19,973 - services.synthesis_service - INFO - SynthesisCore v2.0监控器工作线程已停止
2025-06-28 11:00:20,072 - services.synthesis_service - INFO - 合成服务工作线程已停止
2025-06-28 11:00:20,074 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:00:20,074 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:00:20,074 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:00:20,074 - services.runtime_service - INFO - 停止运行时实例: enhanced-reasoning-1
2025-06-28 11:00:20,074 - services.runtime_service - WARNING - 运行时清理失败: asyncio.run() cannot be called from a running event loop
[2025-06-28 11:00:20] /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/services/runtime_service.py:117: RuntimeWarning: coroutine 'EnhancedReasoningRuntime.cleanup' was never awaited
  logger.warning(f"运行时清理失败: {e}")
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
2025-06-28 11:00:20,075 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:00:20,075 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:00:20,075 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:00:20,075 - services.task_api_service - INFO - 已发送停止信号给任务API服务器
[2025-06-28 11:00:20] INFO:     Shutting down
[2025-06-28 11:00:20] INFO:     Waiting for application shutdown.
[2025-06-28 11:00:20] INFO:     Application shutdown complete.
[2025-06-28 11:00:20] INFO:     Finished server process [72025]
2025-06-28 11:00:20,243 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:00:20,243 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:00:20,243 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:00:20,243 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:00:20,246 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:00:20,246 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 10:59:08,692 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 10:59:08,692 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 10:59:08,692 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 10:59:08,692 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 10:59:08,692 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 10:59:08,692 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 10:59:08,692 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 10:59:08,692 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 10:59:08,692 - __main__ - INFO -   Listen Port: 8090
2025-06-28 10:59:08,692 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 10:59:08,692 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 10:59:08,692 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 10:59:08,693 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 10:59:08,693 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 10:59:08,696 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 10:59:08,696 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 10:59:08,696 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 10:59:08,696 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 10:59:18,697 - core.toolscore.mcp_server - INFO - [microsandbox_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 10:59:18,699 - core.toolscore.mcp_server - INFO - [microsandbox_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 10:59:18,699 - core.toolscore.mcp_server - INFO - [microsandbox_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "e77491d1-15aa-4912-a9ea-1c4abdcb67e6", "tool_spec": {"tool_id": "microsandbox", "name": "microsandbox_server", "description": "\u57fa\u4e8eMicroSandbox\u7684\u5b89\u5168Python\u4ee3\u7801\u6267\u884c\u670d\u52a1\u5668", "tool_type": "mcp_server", "capabilities": [{"name": "microsandbox_execute", "description": "\u5728MicroSandbox\u5b89\u5168\u73af\u5883\u4e2d\u6267\u884cPython\u4ee3\u7801", "parameters": {"code": {"type": "string", "description": "\u8981\u6267\u884c\u7684Python\u4ee3\u7801", "required": true}, "session_id": {"type": "string", "description": "\u4f1a\u8bddID\uff0c\u7528\u4e8e\u591a\u8f6e\u6267\u884c\u548c\u72b6\u6001\u4fdd\u6301", "required": false}, "timeout": {"type": "integer", "description": "\u6267\u884c\u8d85\u65f6\u65f6\u95f4\uff08\u79d2\uff09\uff0c\u9ed8\u8ba430\u79d2\uff0c\u6700\u5927300\u79d2\u3002\u6ce8\u610f\uff1aMicroSandbox\u5185\u90e8\u6709\u81ea\u5df1\u7684\u8d85\u65f6\u673a\u5236\uff0c\u6b64\u53c2\u6570\u4e3b\u8981\u7528\u4e8e\u6587\u6863\u8bf4\u660e", "required": false}}, "examples": [{"code": "print('Hello from MicroSandbox!')"}, {"code": "import math\\nresult = math.sqrt(16)\\nprint(f'\u5e73\u65b9\u6839: {result}')", "timeout": 10}, {"code": "x = 42", "session_id": "my-session"}, {"code": "print(f'x = {x}')", "session_id": "my-session"}], "category": "general"}, {"name": "microsandbox_install_package", "description": "\u5728MicroSandbox\u73af\u5883\u4e2d\u5b89\u88c5Python\u5305", "parameters": {"package_name": {"type": "string", "description": "\u8981\u5b89\u88c5\u7684\u5305\u540d", "required": true}, "version": {"type": "string", "description": "\u6307\u5b9a\u7248\u672c\u53f7", "required": false}, "session_id": {"type": "string", "description": "\u4f1a\u8bddID", "required": false}}, "examples": [{"package_name": "requests"}, {"package_name": "numpy", "version": "1.21.0"}, {"package_name": "pandas", "session_id": "data-analysis"}], "category": "general"}, {"name": "microsandbox_list_sessions", "description": "\u5217\u51fa\u5f53\u524d\u6d3b\u8dc3\u7684\u6c99\u7bb1\u4f1a\u8bdd", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "microsandbox_close_session", "description": "\u5173\u95ed\u6307\u5b9a\u7684\u6c99\u7bb1\u4f1a\u8bdd", "parameters": {"session_id": {"type": "string", "description": "\u8981\u5173\u95ed\u7684\u4f1a\u8bddID", "required": true}}, "examples": [{"session_id": "my-session"}], "category": "general"}, {"name": "microsandbox_cleanup_expired", "description": "\u6e05\u7406\u8fc7\u671f\u7684\u6c99\u7bb1\u4f1a\u8bdd", "parameters": {"max_age": {"type": "integer", "description": "\u6700\u5927\u4f1a\u8bdd\u5e74\u9f84\uff08\u79d2\uff09\uff0c\u9ed8\u8ba4\u4e3a\u914d\u7f6e\u7684\u8d85\u65f6\u65f6\u95f4", "required": false}}, "examples": [{}, {"max_age": 1800}], "category": "general"}, {"name": "microsandbox_get_performance_stats", "description": "\u83b7\u53d6\u670d\u52a1\u5668\u6027\u80fd\u7edf\u8ba1\u4fe1\u606f", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "microsandbox_get_health_status", "description": "\u83b7\u53d6\u670d\u52a1\u5668\u5065\u5eb7\u72b6\u6001", "parameters": {}, "examples": [{}], "category": "general"}], "endpoint": "ws://localhost:8090", "connection_params": {}}}
2025-06-28 10:59:18,699 - core.toolscore.mcp_server - INFO - [microsandbox_server] Waiting for registration response from toolscore...
2025-06-28 10:59:18,699 - core.toolscore.mcp_server - INFO - [microsandbox_server] Received registration response: {"type": "register_tool_response", "request_id": "e77491d1-15aa-4912-a9ea-1c4abdcb67e6", "success": true, "message": null}
2025-06-28 10:59:18,699 - core.toolscore.mcp_server - INFO - [microsandbox_server] Successfully registered with toolscore.

2025-06-28 11:00:20,246 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:00:20,247 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:00:20,247 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:00:20,249 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:00:20,249 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 10:59:08,578 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 10:59:08,578 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 10:59:08,578 - __main__ - INFO - Starting search_tool_server...
2025-06-28 10:59:08,578 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 10:59:08,583 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 10:59:08,583 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 10:59:08,583 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 10:59:08,583 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 10:59:09,054 - websockets.server - INFO - connection open
2025-06-28 10:59:09,054 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 60762)
2025-06-28 10:59:09,055 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 10:59:09,056 - websockets.server - INFO - connection closed
2025-06-28 10:59:18,584 - core.toolscore.mcp_server - INFO - [search_tool_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 10:59:18,586 - core.toolscore.mcp_server - INFO - [search_tool_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 10:59:18,586 - core.toolscore.mcp_server - INFO - [search_tool_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "91610899-20b7-4c1e-9d9f-bca154582c6c", "tool_spec": {"tool_id": "mcp-search-tool", "name": "search_tool_server", "description": "\u6587\u4ef6\u5185\u5bb9\u641c\u7d22\u548c\u4ee3\u7801\u5b9a\u4e49\u641c\u7d22\u5de5\u5177\u670d\u52a1\u5668", "tool_type": "mcp_server", "capabilities": [{"name": "search_file_content", "description": "\u5728\u6307\u5b9a\u6587\u4ef6\u4e2d\u641c\u7d22\u5339\u914d\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5185\u5bb9", "parameters": {"file_path": {"type": "string", "description": "\u8981\u641c\u7d22\u7684\u6587\u4ef6\u8def\u5f84", "required": true}, "regex_pattern": {"type": "string", "description": "\u8981\u5339\u914d\u7684\u6b63\u5219\u8868\u8fbe\u5f0f", "required": true}}, "examples": [{"file_path": "src/main.py", "regex_pattern": "def\\s+\\w+"}], "category": "general"}, {"name": "list_code_definitions", "description": "\u5217\u51fa\u6307\u5b9a\u6587\u4ef6\u6216\u76ee\u5f55\u4e2dPython\u4ee3\u7801\u7684\u7c7b\u3001\u51fd\u6570\u548c\u65b9\u6cd5\u5b9a\u4e49", "parameters": {"file_path": {"type": "string", "description": "\u8981\u89e3\u6790\u7684Python\u6587\u4ef6\u8def\u5f84", "required": false}, "directory_path": {"type": "string", "description": "\u8981\u89e3\u6790\u7684\u76ee\u5f55\u8def\u5f84", "required": false}}, "examples": [{"file_path": "src/utils.py"}, {"directory_path": "src/models"}], "category": "general"}, {"name": "analyze_tool_needs", "description": "\u5206\u6790\u4efb\u52a1\u9700\u6c42\uff0c\u786e\u5b9a\u662f\u5426\u9700\u8981\u989d\u5916\u7684\u5de5\u5177", "parameters": {"task_description": {"type": "string", "description": "\u8981\u5206\u6790\u7684\u4efb\u52a1\u63cf\u8ff0", "required": true}}, "examples": [{"task_description": "Create a chart showing sales data trends"}], "category": "general"}, {"name": "search_and_install_tools", "description": "\u641c\u7d22\u5e76\u5b89\u88c5\u65b0\u7684\u5de5\u5177\u4ee5\u6ee1\u8db3\u4efb\u52a1\u9700\u6c42", "parameters": {"task_description": {"type": "string", "description": "\u4efb\u52a1\u63cf\u8ff0", "required": true}, "reason": {"type": "string", "description": "\u9700\u8981\u65b0\u5de5\u5177\u7684\u539f\u56e0", "required": false}}, "examples": [{"task_description": "Create a chart", "reason": "Need charting capabilities"}], "category": "general"}], "endpoint": "ws://localhost:8080/mcp", "connection_params": {}}}
2025-06-28 10:59:18,586 - core.toolscore.mcp_server - INFO - [search_tool_server] Waiting for registration response from toolscore...
2025-06-28 10:59:18,587 - core.toolscore.mcp_server - INFO - [search_tool_server] Received registration response: {"type": "register_tool_response", "request_id": "91610899-20b7-4c1e-9d9f-bca154582c6c", "success": true, "message": null}
2025-06-28 10:59:18,587 - core.toolscore.mcp_server - INFO - [search_tool_server] Successfully registered with toolscore.
2025-06-28 10:59:38,421 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:59:38,421 - websockets.server - INFO - connection closed
2025-06-28 11:00:08,425 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:00:08,425 - websockets.server - INFO - connection closed

2025-06-28 11:00:20,249 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:00:20,251 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:00:20,251 - services.mcp_server_launcher - INFO - 停止MCP服务器: browser_use_server
2025-06-28 11:00:20,251 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 收到停止信号，正在清理资源...

================================================================================
[系统启动] 2025-06-28 11:00:20
================================================================================
[2025-06-28 11:00:20] 🚀 Agent Data Platform 启动中... (所有日志将统一记录到 logs/System.log)
2025-06-28 11:00:20,774 - asyncio - DEBUG - Using selector: KqueueSelector
[2025-06-28 11:00:20] 🧹 开始增强端口清理...
[2025-06-28 11:00:20] 🔍 搜索并清理相关Python进程...
2025-06-28 11:00:20,787 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:00:20,787 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:00:20,787 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:00:20,787 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:00:20,787 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:00:20,787 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:00:20,787 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:00:20,787 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:00:20,787 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:00:20,788 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:00:20,788 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:00:20,788 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:00:20,788 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:00:20,788 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:00:20,788 - services.mcp_server_launcher - INFO - MCP服务器已经停止: microsandbox_server
2025-06-28 11:00:20,788 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:00:20,788 - services.mcp_server_launcher - INFO - MCP服务器已经停止: search_tool_server
2025-06-28 11:00:20,788 - services.mcp_server_launcher - INFO - 停止MCP服务器: browser_use_server
2025-06-28 11:00:20,788 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 收到停止信号，正在清理资源...
2025-06-28 11:00:20,808 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 收到停止信号，正在清理资源...
2025-06-28 11:00:20,811 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:00:20,811 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 10:59:08,746 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 10:59:08,746 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 10:59:08,747 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 10:59:08,747 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 10:59:08,747 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 10:59:08,747 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 10:59:08,748 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 10:59:08,748 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 10:59:08,748 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 10:59:08,748 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 10:59:09,056 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 10:59:09,057 - websockets.server - INFO - connection closed
2025-06-28 10:59:09,057 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:59:09,057 - websockets.server - INFO - connection closed
2025-06-28 10:59:18,750 - core.toolscore.mcp_server - INFO - [deepsearch_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 10:59:18,751 - core.toolscore.mcp_server - INFO - [deepsearch_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 10:59:18,751 - core.toolscore.mcp_server - INFO - [deepsearch_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "3409fad3-da7f-4506-b1c2-e6f0afc65d42", "tool_spec": {"tool_id": "deepsearch", "name": "deepsearch_server", "description": "\u4e13\u4e1a\u7ea7\u6df1\u5ea6\u641c\u7d22\u548c\u7814\u7a76\u5de5\u5177\u670d\u52a1\u5668\uff0c\u57fa\u4e8eLangGraph\u5b9e\u73b0\u7684\u591a\u8f6e\u8fed\u4ee3\u641c\u7d22\u4ee3\u7406", "tool_type": "mcp_server", "capabilities": [{"name": "research", "description": "\u6267\u884c\u4e13\u4e1a\u7ea7\u6df1\u5ea6\u7814\u7a76\uff0c\u83b7\u53d6\u8be6\u7ec6\u8c03\u7814\u4fe1\u606f", "parameters": {"question": {"type": "string", "description": "\u8981\u7814\u7a76\u7684\u95ee\u9898\u6216\u4e3b\u9898", "required": true}, "research_depth": {"type": "string", "description": "\u7814\u7a76\u6df1\u5ea6: quick/standard/comprehensive", "required": false}, "max_iterations": {"type": "integer", "description": "\u6700\u5927\u8fed\u4ee3\u6b21\u6570", "required": false}}, "examples": [], "category": "general"}, {"name": "quick_research", "description": "\u6267\u884c\u5feb\u901f\u7814\u7a76\uff0c\u9002\u7528\u4e8e\u9700\u8981\u5feb\u901f\u83b7\u53d6\u57fa\u7840\u4fe1\u606f\u7684\u573a\u666f", "parameters": {"question": {"type": "string", "description": "\u8981\u7814\u7a76\u7684\u95ee\u9898\u6216\u4e3b\u9898", "required": true}}, "examples": [], "category": "general"}, {"name": "comprehensive_research", "description": "\u6267\u884c\u5168\u9762\u6df1\u5ea6\u7814\u7a76\uff0c\u9002\u7528\u4e8e\u9700\u8981\u8be6\u7ec6\u3001\u4e13\u4e1a\u7ea7\u8c03\u7814\u4fe1\u606f\u7684\u573a\u666f", "parameters": {"question": {"type": "string", "description": "\u8981\u7814\u7a76\u7684\u95ee\u9898\u6216\u4e3b\u9898", "required": true}, "topic_focus": {"type": "string", "description": "\u53ef\u9009\u7684\u4e3b\u9898\u7126\u70b9\uff0c\u7528\u4e8e\u5f15\u5bfc\u7814\u7a76\u65b9\u5411", "required": false}}, "examples": [], "category": "general"}, {"name": "get_health_status", "description": "\u83b7\u53d6\u7cfb\u7edf\u5065\u5eb7\u72b6\u6001\u548c\u6027\u80fd\u6307\u6807", "parameters": {}, "examples": [], "category": "general"}, {"name": "get_optimization_stats", "description": "\u83b7\u53d6\u8bf7\u6c42\u4f18\u5316\u7edf\u8ba1\u4fe1\u606f", "parameters": {}, "examples": [], "category": "general"}], "endpoint": "ws://localhost:8086/mcp", "connection_params": {}}}
2025-06-28 10:59:18,751 - core.toolscore.mcp_server - INFO - [deepsearch_server] Waiting for registration response from toolscore...
2025-06-28 10:59:18,752 - core.toolscore.mcp_server - INFO - [deepsearch_server] Received registration response: {"type": "register_tool_response", "request_id": "3409fad3-da7f-4506-b1c2-e6f0afc65d42", "success": true, "message": null}
2025-06-28 10:59:18,752 - core.toolscore.mcp_server - INFO - [deepsearch_server] Successfully registered with toolscore.
2025-06-28 10:59:38,448 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 10:59:38,448 - websockets.server - INFO - connection closed
2025-06-28 11:00:08,453 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:00:08,453 - websockets.server - INFO - connection closed

2025-06-28 11:00:20,811 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:00:20,847 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 收到停止信号，正在清理资源...
[2025-06-28 11:00:20] ✅ 进程清理完成
[2025-06-28 11:00:22] ✅ 端口 8088 空闲
[2025-06-28 11:00:22] ✅ 端口 8089 空闲
[2025-06-28 11:00:22] ✅ 端口 8090 空闲
[2025-06-28 11:00:23] ✅ 端口 8091 空闲
[2025-06-28 11:00:23] ✅ 端口 8092 空闲
[2025-06-28 11:00:23] ✅ 端口 5555 空闲
[2025-06-28 11:00:23] 🔥 强制清理端口 8081 的进程 72025
[2025-06-28 11:00:23] ✅ 端口 8082 空闲
[2025-06-28 11:00:23] ✅ 端口 8080 空闲
[2025-06-28 11:00:23] 🔥 强制清理端口 8084 的进程 72074
[2025-06-28 11:00:23] ✅ 端口 8085 空闲
[2025-06-28 11:00:23] ✅ 端口 8086 空闲
[2025-06-28 11:00:23] ✅ 端口 8087 空闲
[2025-06-28 11:00:23] ✅ 端口 8000 空闲
[2025-06-28 11:00:24] ✅ 增强端口清理完成
2025-06-28 11:00:24,266 - __main__ - INFO - === Agent Data Platform 启动中 ===
2025-06-28 11:00:24,266 - __main__ - DEBUG - 🔧 开始系统初始化流程...
2025-06-28 11:00:24,267 - __main__ - DEBUG - 📝 命令行参数: {'config_dir': 'config', 'debug': False, 'start_services': False}
2025-06-28 11:00:24,267 - __main__ - DEBUG - 🔧 步骤1: 初始化ConfigManager...
2025-06-28 11:00:24,267 - __main__ - DEBUG - ✅ ConfigManager初始化完成，配置目录: config
2025-06-28 11:00:24,267 - __main__ - DEBUG - 🔧 步骤2: 加载系统配置...
2025-06-28 11:00:24,268 - __main__ - DEBUG - 📡 Redis URL: redis://localhost:6379
2025-06-28 11:00:24,268 - __main__ - DEBUG - 📋 任务文件路径: tasks.jsonl
2025-06-28 11:00:24,270 - core.config_manager - INFO - 路由配置加载成功
2025-06-28 11:00:24,270 - __main__ - DEBUG - 🚦 路由配置加载完成，任务类型映射: {'CODE': 'tasks:reasoning', 'WEB': 'tasks:reasoning', 'REASONING': 'tasks:reasoning', 'RESEARCH': 'tasks:reasoning'}
2025-06-28 11:00:24,270 - __main__ - DEBUG - 📋 队列映射: {<TaskType.CODE: 'code'>: 'tasks:reasoning', <TaskType.WEB: 'web'>: 'tasks:reasoning', <TaskType.REASONING: 'reasoning'>: 'tasks:reasoning', <TaskType.RESEARCH: 'research'>: 'tasks:reasoning'}
2025-06-28 11:00:24,270 - __main__ - DEBUG - 🔧 步骤3: 初始化核心组件...
2025-06-28 11:00:24,270 - __main__ - DEBUG - ✅ EnhancedMetrics初始化完成
2025-06-28 11:00:24,270 - __main__ - DEBUG - ✅ RedisManager初始化完成
2025-06-28 11:00:24,271 - core.toolscore.toolscore_client - INFO - ✅ 增强的ToolScoreClient初始化完成
2025-06-28 11:00:24,271 - core.llm_client - DEBUG - Enriched config with environment variables: ['default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:00:24,376 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:00:24,378 - core.config_manager - INFO - 路由配置加载成功
2025-06-28 11:00:24,378 - core.monitoring.queue_monitor - INFO - ✅ QueueMonitor 配置加载完成
2025-06-28 11:00:24,379 - core.system_monitor - INFO - ✅ SystemMonitor 配置加载完成
2025-06-28 11:00:24,379 - __main__ - DEBUG - 🔧 开始初始化所有服务...
2025-06-28 11:00:24,379 - services.service_manager - INFO - 正在初始化所有服务...
2025-06-28 11:00:24,379 - services.service_manager - INFO - 初始化服务: redis
2025-06-28 11:00:24,379 - services.redis_service - INFO - Redis服务初始化完成，使用注入的RedisManager实例
2025-06-28 11:00:24,379 - services.service_manager - INFO - 初始化服务: toolscore
2025-06-28 11:00:24,379 - services.toolscore_service - INFO - 正在初始化ToolScore服务...
2025-06-28 11:00:24,379 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 11:00:24,379 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 11:00:24,379 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 11:00:24,379 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:00:24,379 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 11:00:24,380 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 11:00:24,380 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 11:00:24,380 - services.toolscore_service - INFO - ToolScore服务初始化完成（异步初始化将在start()中进行）
2025-06-28 11:00:24,380 - services.service_manager - INFO - 初始化服务: task_processing_coordinator
2025-06-28 11:00:24,380 - services.service_manager - INFO - 初始化服务: mcp_servers
2025-06-28 11:00:24,380 - services.mcp_server_launcher - INFO - 正在初始化MCP服务器启动器...
2025-06-28 11:00:24,380 - services.mcp_server_launcher - INFO - MCP服务器启动器初始化完成，配置了 4 个服务器: ['microsandbox_server', 'search_tool_server', 'browser_use_server', 'deepsearch_server']
2025-06-28 11:00:24,380 - services.service_manager - INFO - 初始化服务: task_api
2025-06-28 11:00:24,380 - services.task_api_service - INFO - 正在初始化任务API服务...
2025-06-28 11:00:24,380 - services.task_api_service - INFO - 任务API服务初始化完成
2025-06-28 11:00:24,380 - services.service_manager - INFO - 初始化服务: runtime
2025-06-28 11:00:24,380 - services.runtime_service - INFO - 正在初始化推理运行时服务...
2025-06-28 11:00:24,380 - services.runtime_service - INFO - 创建运行时实例: enhanced-runtime-1
2025-06-28 11:00:24,380 - core.memory_manager - INFO - MemoryManager initialized: use_redis=True, max_entries=1000
2025-06-28 11:00:24,380 - core.step_planner - INFO - StepPlanner initialized with max_steps=10
2025-06-28 11:00:24,380 - runtimes.reasoning.enhanced_runtime - INFO - DEBUG: Loaded toolscore_http_port: 8082, toolscore_mcp_port: 8081
2025-06-28 11:00:24,380 - runtimes.reasoning.enhanced_runtime - INFO - DEBUG: Configured toolscore_websocket_endpoint (using mcp_port): ws://localhost:8081/websocket
2025-06-28 11:00:24,380 - core.toolscore.mcp_client - INFO - Enhanced MCPToolClient initialized for toolscore at ws://localhost:8081/websocket
2025-06-28 11:00:24,380 - core.llm.guardrails_middleware - INFO - 🔧 初始化输入验证Guard...
2025-06-28 11:00:24,381 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:00:24,382 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:00:24,382 - core.llm.guardrails_middleware - INFO - 🔧 初始化输出验证Guard...
2025-06-28 11:00:24,382 - core.llm.guardrails_middleware - INFO - 🔧 使用本地LLM客户端初始化Guard...
2025-06-28 11:00:24,383 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:00:24,383 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:00:24,383 - core.llm.guardrails_middleware - INFO - ✅ 使用LLM的Guard创建成功
2025-06-28 11:00:24,383 - core.llm.guardrails_middleware - INFO - ✅ Guardrails Guards初始化成功
2025-06-28 11:00:24,383 - core.llm.guardrails_middleware - INFO -    - 输入Guard: ✅
2025-06-28 11:00:24,384 - core.llm.guardrails_middleware - INFO -    - 输出Guard: ✅
2025-06-28 11:00:24,384 - core.agents.validation_critic - INFO - 🎯 ValidationCritic Agent初始化完成
2025-06-28 11:00:24,384 - services.runtime_service - INFO - 推理运行时服务初始化完成，创建了 1 个实例
2025-06-28 11:00:24,384 - services.service_manager - INFO - 初始化服务: synthesis
2025-06-28 11:00:24,384 - services.synthesis_service - INFO - 正在初始化合成服务...
2025-06-28 11:00:24,384 - core.llm_client - DEBUG - Enriched config with environment variables: ['redis_url', 'TRAJECTORIES_DIR', 'default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:00:24,418 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:00:24,418 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 11:00:24,418 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 11:00:24,418 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 11:00:24,418 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:00:24,418 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 11:00:24,418 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 11:00:24,418 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 11:00:24,418 - core.synthesiscore.synthesis - INFO - ✅ JSON文件存储初始化完成
2025-06-28 11:00:24,418 - core.synthesiscore.synthesis - INFO - 📋 未发现已处理轨迹记录，从空白状态开始
2025-06-28 11:00:24,418 - core.llm_client - DEBUG - Enriched config with environment variables: ['redis_url', 'TRAJECTORIES_DIR', 'default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:00:24,452 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:00:24,452 - core.toolscore.mcp_client - INFO - Enhanced MCPToolClient initialized for toolscore at ws://localhost:8089/websocket
2025-06-28 11:00:24,455 - core.synthesiscore.config_loader - INFO - ✅ SynthesisCore配置加载成功: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/config/synthesiscore_config.yaml
2025-06-28 11:00:24,455 - core.synthesiscore.trajectory_monitor - INFO - 🔧 TrajectoryMonitor初始化完成
2025-06-28 11:00:24,455 - core.synthesiscore.trajectory_monitor - INFO - 📂 监控目录: output/trajectories
2025-06-28 11:00:24,455 - core.synthesiscore.trajectory_monitor - INFO - 📝 种子文件: output/trajectories/../seed_tasks.jsonl
2025-06-28 11:00:24,455 - services.synthesis_service - INFO - ✅ TrajectoryMonitor v2.0 初始化完成
2025-06-28 11:00:24,455 - services.synthesis_service - INFO - 合成服务初始化完成，轨迹目录: output/trajectories
2025-06-28 11:00:24,455 - __main__ - DEBUG - ✅ 所有服务初始化完成
2025-06-28 11:00:24,455 - __main__ - DEBUG - 🚀 开始启动所有服务...
2025-06-28 11:00:24,455 - services.service_manager - INFO - 正在启动所有服务...
2025-06-28 11:00:24,455 - services.service_manager - INFO - 启动服务: redis
2025-06-28 11:00:24,455 - services.redis_service - INFO - Redis客户端已就绪
2025-06-28 11:00:24,455 - services.service_manager - INFO - 启动服务: toolscore
2025-06-28 11:00:24,455 - services.toolscore_service - INFO - 正在启动ToolScore服务...
2025-06-28 11:00:24,455 - services.toolscore_service - INFO - 正在初始化工具库...
2025-06-28 11:00:24,455 - services.toolscore_service - INFO - 工具库初始化将在ToolScore MCP服务器线程中进行。
2025-06-28 11:00:24,455 - services.toolscore_service - INFO - 正在启动ToolScore HTTP API...
2025-06-28 11:00:24,465 - services.toolscore_service - INFO - ToolScore HTTP API已启动于端口: 8082
2025-06-28 11:00:24,465 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:00:24,465 - services.toolscore_service - INFO - ToolScore MCP 服务器不进行端口自动检测，使用配置端口: 8081
2025-06-28 11:00:24,465 - services.toolscore_service - INFO - ToolScore MCP server configured to use host: 0.0.0.0, port: 8081, path: /websocket
2025-06-28 11:00:24,465 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 11:00:24,465 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 11:00:24,465 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 11:00:24,465 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:00:24,465 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 11:00:24,465 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 11:00:24,465 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 11:00:24,465 - core.toolscore.monitoring_api - INFO - ToolScore monitoring API started on port 8082
2025-06-28 11:00:24,465 - services.toolscore_service - INFO - Starting ToolScore MCP server thread...
2025-06-28 11:00:24,465 - services.toolscore_service - INFO - ToolScore MCP server thread started, is_alive: True
2025-06-28 11:00:24,465 - services.toolscore_service - INFO - ToolScore MCP服务器启动线程已启动，等待就绪信号...
2025-06-28 11:00:24,465 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:00:24,465 - services.service_manager - INFO - 启动服务: task_processing_coordinator
2025-06-28 11:00:24,466 - core.dispatcher_enhanced - INFO - ✅ TaskProcessingCoordinator 配置加载完成 - 队列映射: {<TaskType.CODE: 'code'>: 'tasks:reasoning', <TaskType.WEB: 'web'>: 'tasks:reasoning', <TaskType.REASONING: 'reasoning'>: 'tasks:reasoning', <TaskType.RESEARCH: 'research'>: 'tasks:reasoning'}
2025-06-28 11:00:24,466 - core.toolscore.mcp_server - INFO - Attempting to start toolscore MCP Server on 0.0.0.0:8081
2025-06-28 11:00:24,466 - services.service_manager - INFO - 启动服务: mcp_servers
2025-06-28 11:00:24,466 - services.mcp_server_launcher - INFO - 正在启动MCP服务器...
2025-06-28 11:00:24,466 - services.mcp_server_launcher - INFO - 正在并行启动 4 个MCP服务器...
2025-06-28 11:00:24,466 - core.dispatcher_enhanced - INFO - 启动任务处理协调器...
2025-06-28 11:00:24,466 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:00:24,466 - websockets.server - INFO - server listening on 0.0.0.0:8081
2025-06-28 11:00:24,466 - core.toolscore.mcp_server - INFO - [toolscore] Initializing UnifiedToolLibrary...
2025-06-28 11:00:24,466 - core.toolscore.core_manager - INFO - 🚀 正在初始化增强的CoreManager...
2025-06-28 11:00:24,466 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:00:24,466 - core.toolscore.core_manager - INFO - 🔄 使用v2.0服务容器架构初始化...
2025-06-28 11:00:24,466 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:00:24,466 - core.toolscore.enhanced_core_manager_v2 - INFO - 🚀 初始化增强核心管理器 v2.0...
2025-06-28 11:00:24,466 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:00:24,466 - core.toolscore.service_container.mcp_service_container - INFO - 🚀 开始初始化MCP服务容器...
2025-06-28 11:00:24,466 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:00:24,466 - core.toolscore.service_container.mcp_service_container - INFO - 🔍 发现内置MCP服务...
2025-06-28 11:00:24,466 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:00:24,466 - core.toolscore.service_container.builtin_discovery - INFO - 🔍 开始发现内置MCP服务: mcp_servers
2025-06-28 11:00:24,466 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:00:24,466 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:00:24,466 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:00:24,466 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:00:24,466 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:00:24,466 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:00:24,466 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:00:24,469 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: Search Tool MCP Server
2025-06-28 11:00:24,469 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 72185)
2025-06-28 11:00:24,469 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:00:24,469 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:00:24,469 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:00:24,470 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:00:24,470 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: MicroSandbox MCP Server
2025-06-28 11:00:24,470 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 跳过 __pycache__: 缺少main.py文件
2025-06-28 11:00:24,470 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:00:24,470 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:00:24,470 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:00:24,470 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:00:24,470 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:00:24,470 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:00:24,470 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:00:24,470 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:00:24,470 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: Browser Use MCP Server
2025-06-28 11:00:24,470 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:00:24,470 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: DeepSearch MCP Server
2025-06-28 11:00:24,470 - core.toolscore.service_container.builtin_discovery - INFO - 🎯 内置服务发现完成，共发现 4 个服务
2025-06-28 11:00:24,470 - core.toolscore.service_container.builtin_discovery - INFO - 📝 创建服务配置文件...
2025-06-28 11:00:24,470 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/search_tool_server/service.json
2025-06-28 11:00:24,470 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/microsandbox_server/service.json
2025-06-28 11:00:24,470 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/browser_use_server/service.json
2025-06-28 11:00:24,470 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/deepsearch_server/service.json
2025-06-28 11:00:24,470 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 发现 4 个内置服务
2025-06-28 11:00:24,470 - core.toolscore.service_container.mcp_service_container - INFO - 📂 加载已安装的外部服务...
2025-06-28 11:00:24,470 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 加载 0 个外部服务
2025-06-28 11:00:24,470 - core.toolscore.service_container.mcp_service_container - INFO - 📋 构建统一服务目录...
2025-06-28 11:00:24,470 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 服务目录构建完成，共 4 个服务
2025-06-28 11:00:24,470 - core.toolscore.service_container.mcp_service_container - INFO - 📋 标记内置服务为启动中状态...
2025-06-28 11:00:24,470 - core.toolscore.service_container.mcp_service_container - INFO - 📋 已标记 4 个内置服务为启动中状态
2025-06-28 11:00:24,471 - core.toolscore.service_container.service_monitor - INFO - 🔍 启动服务监控...
2025-06-28 11:00:24,471 - core.toolscore.service_container.mcp_service_container - INFO - ✅ MCP服务容器初始化完成
2025-06-28 11:00:24,471 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:00:24,471 - core.toolscore.enhanced_core_manager_v2 - INFO - ✅ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:00:24,471 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:00:24,471 - core.toolscore.core_manager - INFO - ✅ v2.0架构初始化完成
2025-06-28 11:00:24,471 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:00:24,471 - core.toolscore.tool_registry - INFO - Tool registry initialized
2025-06-28 11:00:24,471 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:00:24,471 - core.llm_client - DEBUG - Enriched config with environment variables: ['provider', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:00:24,474 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 72186)
2025-06-28 11:00:24,475 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:00:24,486 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: browser_use_server
2025-06-28 11:00:24,487 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:00:24,487 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: browser_use_server
2025-06-28 11:00:24,487 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server
2025-06-28 11:00:24,487 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) = True
2025-06-28 11:00:24,487 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) = True
2025-06-28 11:00:24,487 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) contents: ['service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:00:24,487 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server/main.py
2025-06-28 11:00:24,487 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:00:24,487 - services.mcp_server_launcher - INFO - [MCP启动器] 为 browser_use_server 使用配置文件指定端口: 8084
2025-06-28 11:00:24,488 - services.mcp_server_launcher - INFO - [MCP启动器] 为 browser_use_server 使用配置文件指定端口: 8084
2025-06-28 11:00:24,488 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 BROWSER_USE_SERVER_PORT=8084 给 browser_use_server
2025-06-28 11:00:24,488 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.browser_use_server.main
2025-06-28 11:00:24,488 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:00:24,491 - services.mcp_server_launcher - INFO - MCP服务器已启动: browser_use_server (PID: 72187)
2025-06-28 11:00:24,491 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 browser_use_server 就绪状态...
2025-06-28 11:00:24,493 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:00:24,493 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:00:24,493 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:00:24,493 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:00:24,493 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:00:24,493 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:00:24,493 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:00:24,493 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:00:24,493 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:00:24,494 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:00:24,494 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:00:24,494 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:00:24,494 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:00:24,494 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:00:24,498 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 72188)
2025-06-28 11:00:24,498 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:00:24,499 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第1次, 5s间隔)
2025-06-28 11:00:24,500 - core.monitoring.queue_monitor - INFO - 启动队列监控器...
2025-06-28 11:00:24,502 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:00:24,502 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:00:24,502 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:00:24,502 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:00:24,502 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:00:24,502 - websockets.client - DEBUG - > Sec-WebSocket-Key: 76si94ZjYJ+B5Utg8h6DRw==
2025-06-28 11:00:24,503 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:00:24,503 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:00:24,503 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:00:24,503 - websockets.client - DEBUG - > EOF
2025-06-28 11:00:24,503 - websockets.client - DEBUG - < EOF
2025-06-28 11:00:24,503 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:00:24,503 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:00:24,503 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:00:24,503 - websockets.client - DEBUG - > Host: localhost:8084
2025-06-28 11:00:24,503 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:00:24,503 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:00:24,504 - websockets.client - DEBUG - > Sec-WebSocket-Key: f3GbYoifVtHQ3jDO8h9fAw==
2025-06-28 11:00:24,504 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:00:24,504 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:00:24,504 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:00:24,504 - websockets.client - DEBUG - > EOF
2025-06-28 11:00:24,504 - websockets.client - DEBUG - < EOF
2025-06-28 11:00:24,504 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:00:24,506 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:00:24,507 - services.mcp_server_launcher - DEBUG - 📋 browser_use_server 端口 8084 尚未就绪
2025-06-28 11:00:24,507 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:00:24,526 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:00:24,527 - core.toolscore.tool_gap_detector - INFO - 智能工具缺口检测器初始化 - 统一版本
2025-06-28 11:00:24,527 - core.toolscore.dynamic_mcp_manager - INFO - Dynamic MCP Manager initialized (ProcessRunner mode)
2025-06-28 11:00:24,527 - core.toolscore.dynamic_mcp_manager - INFO - 启动动态MCP管理器...
2025-06-28 11:00:24,527 - core.toolscore.dynamic_mcp_manager - INFO - 持久化配置为空，无需恢复外部MCP服务器
2025-06-28 11:00:24,527 - core.toolscore.dynamic_mcp_manager - INFO - 动态MCP管理器启动完成
2025-06-28 11:00:24,527 - core.toolscore.mcp_search_tool - INFO - ✅ MCP Search Tool initialized - 优化版本，包含失败工具跟踪
2025-06-28 11:00:24,527 - core.toolscore.unified_tool_library - INFO - Tool library initialization completed - 核心管理器模式
2025-06-28 11:00:24,527 - core.toolscore.mcp_server - INFO - [toolscore] UnifiedToolLibrary initialized.
2025-06-28 11:00:24,527 - core.toolscore.mcp_server - INFO - [toolscore] Auto-registering MCP servers...
2025-06-28 11:00:24,527 - core.toolscore.mcp_auto_registration - INFO - 🔍 开始自动发现和注册MCP服务器...
2025-06-28 11:00:24,527 - core.toolscore.mcp_auto_registration - DEBUG - ⚠️ 服务器目录 __pycache__ 缺少 service.json
2025-06-28 11:00:24,528 - core.toolscore.mcp_auto_registration - INFO - 🎯 发现 4 个MCP服务器
2025-06-28 11:00:24,539 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [browser_use] BrowserUse logging setup complete with level info
2025-06-28 11:00:24,542 - core.unified_tool_manager - DEBUG - ✅ 配置验证通过
2025-06-28 11:00:24,542 - core.unified_tool_manager - INFO - 🔄 成功加载工具配置: 4 个标准工具
2025-06-28 11:00:24,542 - core.unified_tool_manager - DEBUG -    - 标准工具ID: ['browser_use', 'deepsearch', 'mcp-search-tool', 'microsandbox']
2025-06-28 11:00:24,542 - core.unified_tool_manager - DEBUG -    - 兼容映射: 13 个变体
2025-06-28 11:00:24,542 - core.unified_tool_manager - INFO - ✅ 统一工具管理器初始化完成，管理 4 个工具
2025-06-28 11:00:24,542 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: mcp-search-tool
2025-06-28 11:00:24,542 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: Search Tool MCP Server (ID: mcp-search-tool)
2025-06-28 11:00:24,542 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: Search Tool MCP Server (ID: mcp-search-tool)
2025-06-28 11:00:24,542 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: Search Tool MCP Server
2025-06-28 11:00:24,542 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8080/websocket
2025-06-28 11:00:24,542 - core.toolscore.mcp_connector - INFO - Registered MCP server mcp-search-tool at ws://localhost:8080/websocket
2025-06-28 11:00:24,542 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: mcp-search-tool -> ws://localhost:8080/websocket
2025-06-28 11:00:24,542 - core.toolscore.core_manager - INFO - 工具立即可用: mcp-search-tool
2025-06-28 11:00:24,542 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: mcp-search-tool
2025-06-28 11:00:24,542 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: microsandbox
2025-06-28 11:00:24,542 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: MicroSandbox MCP Server (ID: microsandbox)
2025-06-28 11:00:24,542 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: MicroSandbox MCP Server (ID: microsandbox)
2025-06-28 11:00:24,542 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: MicroSandbox MCP Server
2025-06-28 11:00:24,542 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8090/websocket
2025-06-28 11:00:24,542 - core.toolscore.mcp_connector - INFO - Registered MCP server microsandbox at ws://localhost:8090/websocket
2025-06-28 11:00:24,542 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: microsandbox -> ws://localhost:8090/websocket
2025-06-28 11:00:24,542 - core.toolscore.core_manager - INFO - 工具立即可用: microsandbox
2025-06-28 11:00:24,542 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: microsandbox
2025-06-28 11:00:24,542 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: browser_use
2025-06-28 11:00:24,542 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: Browser Use MCP Server (ID: browser_use)
2025-06-28 11:00:24,542 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: Browser Use MCP Server (ID: browser_use)
2025-06-28 11:00:24,542 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: Browser Use MCP Server
2025-06-28 11:00:24,542 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8084/websocket
2025-06-28 11:00:24,542 - core.toolscore.mcp_connector - INFO - Registered MCP server browser_use at ws://localhost:8084/websocket
2025-06-28 11:00:24,542 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: browser_use -> ws://localhost:8084/websocket
2025-06-28 11:00:24,542 - core.toolscore.core_manager - INFO - 工具立即可用: browser_use
2025-06-28 11:00:24,543 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: browser_use
2025-06-28 11:00:24,543 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: deepsearch
2025-06-28 11:00:24,543 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: DeepSearch MCP Server (ID: deepsearch)
2025-06-28 11:00:24,543 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: DeepSearch MCP Server (ID: deepsearch)
2025-06-28 11:00:24,543 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: DeepSearch MCP Server
2025-06-28 11:00:24,543 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8086/websocket
2025-06-28 11:00:24,543 - core.toolscore.mcp_connector - INFO - Registered MCP server deepsearch at ws://localhost:8086/websocket
2025-06-28 11:00:24,543 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: deepsearch -> ws://localhost:8086/websocket
2025-06-28 11:00:24,543 - core.toolscore.core_manager - INFO - 工具立即可用: deepsearch
2025-06-28 11:00:24,543 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: deepsearch
2025-06-28 11:00:24,543 - core.toolscore.mcp_auto_registration - INFO - 📊 MCP服务器注册完成: 4/4 成功
2025-06-28 11:00:24,543 - core.toolscore.mcp_server - INFO - [toolscore] All MCP servers registered successfully.
2025-06-28 11:00:24,543 - core.toolscore.mcp_server - INFO - toolscore MCP Server started successfully on 0.0.0.0:8081 (Original endpoint: ws://0.0.0.0:8081/websocket) with ping_interval=30, ping_timeout=60
2025-06-28 11:00:24,543 - core.toolscore.mcp_server - INFO - toolscore MCP Server started event set.
2025-06-28 11:00:24,543 - core.toolscore.service_container.service_monitor - INFO - 🔄 开始服务监控循环，检查间隔: 30秒
2025-06-28 11:00:24,934 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [root] Anonymized telemetry enabled. See https://docs.browser-use.com/development/telemetry for more information.
2025-06-28 11:00:25,064 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.llm_client] Initialized LLM client with provider: gemini
2025-06-28 11:00:25,065 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Browser-Use server initialized with LLM provider: gemini
2025-06-28 11:00:25,065 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 使用动态分配端口: 8084
2025-06-28 11:00:25,065 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] BrowserUseMCPServer initialized:
2025-06-28 11:00:25,065 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Server Name: browser_use_server
2025-06-28 11:00:25,065 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Server ID: browser_use
2025-06-28 11:00:25,065 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Listen Host: 0.0.0.0
2025-06-28 11:00:25,065 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Listen Port: 8084
2025-06-28 11:00:25,065 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Public Endpoint: ws://localhost:8084
2025-06-28 11:00:25,065 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:00:25,065 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Starting browser_use_server...
2025-06-28 11:00:25,065 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Attempting to start MCPServer for browser_use_server at ws://localhost:8084...
2025-06-28 11:00:25,065 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Attempting to start browser_use_server MCP Server on localhost:8084
2025-06-28 11:00:25,066 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] server listening on 127.0.0.1:8084
2025-06-28 11:00:25,066 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] server listening on [::1]:8084
2025-06-28 11:00:25,066 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] browser_use_server MCP Server started successfully on localhost:8084 (Original endpoint: ws://localhost:8084) with ping_interval=30, ping_timeout=60
2025-06-28 11:00:25,066 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:00:25,071 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:00:25,071 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:00:25,109 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:00:25,109 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:00:25,109 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:00:25,109 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:00:25,109 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:00:25,109 - websockets.client - DEBUG - > Sec-WebSocket-Key: g1p1gkU2eYbBZdOqYaguig==
2025-06-28 11:00:25,109 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:00:25,109 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:00:25,109 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:00:25,109 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:00:25,109 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:00:25,109 - websockets.client - DEBUG - > Host: localhost:8084
2025-06-28 11:00:25,109 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:00:25,109 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:00:25,109 - websockets.client - DEBUG - > Sec-WebSocket-Key: 9kr6Nd7uyOsgubR9st0NZQ==
2025-06-28 11:00:25,109 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:00:25,109 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:00:25,109 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:00:25,110 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:00:25,110 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:00:25,110 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:00:25,110 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection open
2025-06-28 11:00:25,110 - websockets.client - DEBUG - < Sec-WebSocket-Accept: 9+NX6fF84HpeQKxDLdT3RdSLXgE=
2025-06-28 11:00:25,110 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Client connected to browser_use_server MCP Server at path /: ('127.0.0.1', 60899)
2025-06-28 11:00:25,110 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:00:25,110 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:00:25 GMT
2025-06-28 11:00:25,110 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:00:25,110 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:00:25,110 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:00:25,110 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:00:25,110 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:00:25,110 - websockets.client - DEBUG - < Sec-WebSocket-Accept: /PScq0l3N+ASm9VZo+1qLGENoRE=
2025-06-28 11:00:25,110 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:00:25,110 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:00:25 GMT
2025-06-28 11:00:25,110 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:00:25,110 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:00:25,111 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:00:25,111 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:00:25,111 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:00:25,111 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:00:25,111 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:00:25,111 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:00:25,111 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:00:25,111 - services.mcp_server_launcher - DEBUG - [browser_use_server] WARNING  [core.toolscore.mcp_server] Unknown request type or server role mismatch: ping
2025-06-28 11:00:25,111 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:00:25,111 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:00:25,111 - websockets.client - DEBUG - < EOF
2025-06-28 11:00:25,111 - websockets.client - DEBUG - > EOF
2025-06-28 11:00:25,112 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:00:25,112 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:00:25,112 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:00:25,112 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:00:25,112 - websockets.client - DEBUG - < EOF
2025-06-28 11:00:25,112 - websockets.client - DEBUG - > EOF
2025-06-28 11:00:25,112 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:00:25,112 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:00:25,112 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:00:25,112 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:00:25,112 - services.mcp_server_launcher - DEBUG - ✅ browser_use_server 特定就绪检查通过
2025-06-28 11:00:25,112 - services.mcp_server_launcher - INFO - ✅ browser_use_server 已就绪
2025-06-28 11:00:25,112 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:00:25,112 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:00:25,792 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:00:25,792 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:00:26,113 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:00:26,657 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:00:26,657 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:00:27,695 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:00:27,696 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:00:28,941 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:00:28,941 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:00:29,501 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第2次, 5s间隔)
2025-06-28 11:00:30,435 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:00:30,436 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:00:32,228 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:00:32,228 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:00:34,380 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:00:34,380 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:00:34,502 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第3次, 5s间隔)
2025-06-28 11:00:34,645 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:00:34,646 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:00:34,646 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:00:34,646 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:00:34,646 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:00:34,646 - websockets.server - DEBUG - < Sec-WebSocket-Key: Dpp507/8qVPj5blFkvBDZA==
2025-06-28 11:00:34,646 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:00:34,646 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:00:34,646 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:00:34,646 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:00:34,646 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:00:34,646 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:00:34,646 - websockets.server - DEBUG - > Sec-WebSocket-Accept: ReSXiTr3Jg4zAuhZv8/fau0gj2A=
2025-06-28 11:00:34,646 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:00:34,646 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:00:34 GMT
2025-06-28 11:00:34,646 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:00:34,646 - websockets.server - INFO - connection open
2025-06-28 11:00:34,646 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:00:34,646 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 60907)
2025-06-28 11:00:34,646 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "42cb2f...onnection_params": {}}}' [2376 bytes]
2025-06-28 11:00:34,647 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: search_tool_server (ID: mcp-search-tool)
2025-06-28 11:00:34,647 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: search_tool_server
2025-06-28 11:00:34,647 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: mcp-search-tool -> ws://localhost:8080/mcp
2025-06-28 11:00:34,647 - core.toolscore.core_manager - INFO - 工具立即可用: mcp-search-tool
2025-06-28 11:00:34,647 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 11:00:34,647 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:00:34,647 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 11:00:34,647 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:00:34,647 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 11:00:34,647 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 11:00:34,648 - websockets.server - INFO - connection closed
2025-06-28 11:00:34,740 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:00:34,740 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:00:34,740 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:00:34,740 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:00:34,740 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:00:34,740 - websockets.server - DEBUG - < Sec-WebSocket-Key: 5X+cUN+ovwOi2cMWr4LU3w==
2025-06-28 11:00:34,740 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:00:34,740 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:00:34,740 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:00:34,740 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:00:34,741 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:00:34,741 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:00:34,741 - websockets.server - DEBUG - > Sec-WebSocket-Accept: 3am5C3DmHJtHyTEXqH8VfT7O0Qk=
2025-06-28 11:00:34,741 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:00:34,741 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:00:34 GMT
2025-06-28 11:00:34,741 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:00:34,741 - websockets.server - INFO - connection open
2025-06-28 11:00:34,741 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:00:34,741 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 60909)
2025-06-28 11:00:34,741 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "1d4321...onnection_params": {}}}' [3263 bytes]
2025-06-28 11:00:34,742 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: microsandbox_server (ID: microsandbox)
2025-06-28 11:00:34,742 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: microsandbox_server
2025-06-28 11:00:34,742 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: microsandbox -> ws://localhost:8090
2025-06-28 11:00:34,742 - core.toolscore.core_manager - INFO - 工具立即可用: microsandbox
2025-06-28 11:00:34,742 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 11:00:34,742 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:00:34,742 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 11:00:34,742 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:00:34,742 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 11:00:34,743 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 11:00:34,743 - websockets.server - INFO - connection closed
2025-06-28 11:00:34,799 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:00:34,800 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:00:34,800 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:00:34,800 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:00:34,800 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:00:34,800 - websockets.server - DEBUG - < Sec-WebSocket-Key: BYWV6Ut90raIl2dGgFmKFQ==
2025-06-28 11:00:34,800 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:00:34,800 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:00:34,800 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:00:34,800 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:00:34,800 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:00:34,800 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:00:34,800 - websockets.server - DEBUG - > Sec-WebSocket-Accept: p0i5maAI32yqrrg7l8ZORKUj/Dg=
2025-06-28 11:00:34,800 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:00:34,800 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:00:34 GMT
2025-06-28 11:00:34,800 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:00:34,800 - websockets.server - INFO - connection open
2025-06-28 11:00:34,800 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:00:34,800 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 60911)
2025-06-28 11:00:34,800 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "7739f3...onnection_params": {}}}' [2313 bytes]
2025-06-28 11:00:34,801 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: deepsearch_server (ID: deepsearch)
2025-06-28 11:00:34,801 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: deepsearch_server
2025-06-28 11:00:34,801 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: deepsearch -> ws://localhost:8086/mcp
2025-06-28 11:00:34,801 - core.toolscore.core_manager - INFO - 工具立即可用: deepsearch
2025-06-28 11:00:34,801 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 11:00:34,801 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:00:34,801 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 11:00:34,801 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:00:34,801 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 11:00:34,801 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 11:00:34,801 - websockets.server - INFO - connection closed
2025-06-28 11:00:35,066 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 11:00:35,067 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:00:35,067 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:00:35,067 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:00:35,067 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:00:35,067 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:00:35,067 - websockets.server - DEBUG - < Sec-WebSocket-Key: JjDrSCVT6IgJOLjMVr92dA==
2025-06-28 11:00:35,067 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:00:35,067 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:00:35,067 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:00:35,067 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:00:35,067 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:00:35,067 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:00:35,067 - websockets.server - DEBUG - > Sec-WebSocket-Accept: 2oGrdVIfrFUnks77q+Go2l51Z2Q=
2025-06-28 11:00:35,067 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:00:35,067 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:00:35 GMT
2025-06-28 11:00:35,067 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:00:35,067 - websockets.server - INFO - connection open
2025-06-28 11:00:35,067 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:00:35,067 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 60913)
2025-06-28 11:00:35,067 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 11:00:35,068 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "fea7eb93-af46-4e46-9708-a8ae67253ff3", "tool_spec": {"tool_id": "browser_use", "name": "browser_use_server", "description": "\u57fa\u4e8eBrowser-Use\u7684AI\u6d4f\u89c8\u5668\u81ea\u52a8\u5316\u670d\u52a1\u5668\uff0c\u5b8c\u6574\u5b9e\u73b0browser-use\u7684\u6240\u6709\u529f\u80fd", "tool_type": "mcp_server", "capabilities": [{"name": "browser_use_execute_task", "description": "\u4f7f\u7528AI\u6267\u884c\u590d\u6742\u7684\u6d4f\u89c8\u5668\u4efb\u52a1\uff0c\u652f\u6301\u81ea\u7136\u8bed\u8a00\u63cf\u8ff0", "parameters": {"task": {"type": "string", "description": "\u8981\u6267\u884c\u7684\u4efb\u52a1\u63cf\u8ff0\uff0c\u4f7f\u7528\u81ea\u7136\u8bed\u8a00", "required": true}, "max_steps": {"type": "integer", "description": "\u6700\u5927\u6267\u884c\u6b65\u9aa4\u6570\uff0c\u9ed8\u8ba450", "required": false}, "use_vision": {"type": "boolean", "description": "\u662f\u5426\u4f7f\u7528\u89c6\u89c9\u7406\u89e3\uff0c\u9ed8\u8ba4true", "required": false}}, "examples": [{"task": "\u641c\u7d22Python\u6559\u7a0b\u5e76\u6253\u5f00\u7b2c\u4e00\u4e2a\u7ed3\u679c"}, {"task": "\u5728GitHub\u4e0a\u641c\u7d22browser-use\u9879\u76ee\u5e76\u67e5\u770bREADME"}, {"task": "\u767b\u5f55\u7f51\u7ad9\u5e76\u586b\u5199\u8868\u5355", "use_vision": true}], "category": "general"}, {"name": "browser_navigate", "description": "\u5bfc\u822a\u5230\u6307\u5b9a\u7f51\u5740", "parameters": {"url": {"type": "string", "description": "\u8981\u8bbf\u95ee\u7684URL\u5730\u5740", "required": true}}, "examples": [{"url": "https://www.google.com"}, {"url": "https://github.com"}], "category": "general"}, {"name": "browser_search_google", "description": "\u5728Google\u4e2d\u641c\u7d22\u6307\u5b9a\u67e5\u8be2", "parameters": {"query": {"type": "string", "description": "\u641c\u7d22\u67e5\u8be2\u8bcd", "required": true}}, "examples": [{"query": "Python machine learning tutorial"}, {"query": "browser automation tools"}], "category": "general"}, {"name": "browser_go_back", "description": "\u8fd4\u56de\u4e0a\u4e00\u9875", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_click_element", "description": "\u901a\u8fc7\u7d22\u5f15\u70b9\u51fb\u9875\u9762\u5143\u7d20", "parameters": {"index": {"type": "integer", "description": "\u8981\u70b9\u51fb\u7684\u5143\u7d20\u7d22\u5f15", "required": true}}, "examples": [{"index": 1}, {"index": 5}], "category": "general"}, {"name": "browser_input_text", "description": "\u5728\u6307\u5b9a\u5143\u7d20\u4e2d\u8f93\u5165\u6587\u672c", "parameters": {"index": {"type": "integer", "description": "\u8981\u8f93\u5165\u6587\u672c\u7684\u5143\u7d20\u7d22\u5f15", "required": true}, "text": {"type": "string", "description": "\u8981\u8f93\u5165\u7684\u6587\u672c", "required": true}}, "examples": [{"index": 2, "text": "hello world"}, {"index": 0, "text": "test@example.com"}], "category": "general"}, {"name": "browser_send_keys", "description": "\u53d1\u9001\u7279\u6b8a\u952e\u6216\u5feb\u6377\u952e", "parameters": {"keys": {"type": "string", "description": "\u8981\u53d1\u9001\u7684\u952e\uff0c\u5982Enter\u3001Escape\u3001Control+c\u7b49", "required": true}}, "examples": [{"keys": "Enter"}, {"keys": "Control+c"}, {"keys": "Escape"}], "category": "general"}, {"name": "browser_scroll_down", "description": "\u5411\u4e0b\u6eda\u52a8\u9875\u9762", "parameters": {"amount": {"type": "integer", "description": "\u6eda\u52a8\u50cf\u7d20\u6570\uff0c\u4e0d\u6307\u5b9a\u5219\u6eda\u52a8\u4e00\u9875", "required": false}}, "examples": [{}, {"amount": 500}], "category": "general"}, {"name": "browser_scroll_up", "description": "\u5411\u4e0a\u6eda\u52a8\u9875\u9762", "parameters": {"amount": {"type": "integer", "description": "\u6eda\u52a8\u50cf\u7d20\u6570\uff0c\u4e0d\u6307\u5b9a\u5219\u6eda\u52a8\u4e00\u9875", "required": false}}, "examples": [{}, {"amount": 300}], "category": "general"}, {"name": "browser_scroll_to_text", "description": "\u6eda\u52a8\u5230\u5305\u542b\u6307\u5b9a\u6587\u672c\u7684\u5143\u7d20", "parameters": {"text": {"type": "string", "description": "\u8981\u6eda\u52a8\u5230\u7684\u6587\u672c\u5185\u5bb9", "required": true}}, "examples": [{"text": "Sign up"}, {"text": "Contact us"}], "category": "general"}, {"name": "browser_switch_tab", "description": "\u5207\u6362\u5230\u6307\u5b9a\u6807\u7b7e", "parameters": {"page_id": {"type": "integer", "description": "\u8981\u5207\u6362\u5230\u7684\u6807\u7b7eID", "required": true}}, "examples": [{"page_id": 0}, {"page_id": 1}], "category": "general"}, {"name": "browser_open_tab", "description": "\u5728\u65b0\u6807\u7b7e\u4e2d\u6253\u5f00URL", "parameters": {"url": {"type": "string", "description": "\u8981\u5728\u65b0\u6807\u7b7e\u4e2d\u6253\u5f00\u7684URL", "required": true}}, "examples": [{"url": "https://www.example.com"}], "category": "general"}, {"name": "browser_close_tab", "description": "\u5173\u95ed\u6307\u5b9a\u6807\u7b7e", "parameters": {"page_id": {"type": "integer", "description": "\u8981\u5173\u95ed\u7684\u6807\u7b7eID", "required": true}}, "examples": [{"page_id": 1}], "category": "general"}, {"name": "browser_extract_content", "description": "\u4ece\u9875\u9762\u63d0\u53d6\u7279\u5b9a\u5185\u5bb9", "parameters": {"goal": {"type": "string", "description": "\u63d0\u53d6\u76ee\u6807\u63cf\u8ff0", "required": true}, "include_links": {"type": "boolean", "description": "\u662f\u5426\u5305\u542b\u94fe\u63a5\uff0c\u9ed8\u8ba4false", "required": false}}, "examples": [{"goal": "\u63d0\u53d6\u6240\u6709\u516c\u53f8\u540d\u79f0"}, {"goal": "\u83b7\u53d6\u4ea7\u54c1\u4ef7\u683c\u4fe1\u606f", "include_links": true}], "category": "general"}, {"name": "browser_get_content", "description": "\u83b7\u53d6\u9875\u9762\u5185\u5bb9", "parameters": {"selector": {"type": "string", "description": "CSS\u9009\u62e9\u5668\uff0c\u7a7a\u5219\u83b7\u53d6\u5168\u90e8\u5185\u5bb9", "required": false}}, "examples": [{"selector": "h1, p"}, {}], "category": "general"}, {"name": "browser_get_ax_tree", "description": "\u83b7\u53d6\u9875\u9762\u7684\u53ef\u8bbf\u95ee\u6027\u6811\u7ed3\u6784", "parameters": {"number_of_elements": {"type": "integer", "description": "\u8fd4\u56de\u7684\u5143\u7d20\u6570\u91cf", "required": true}}, "examples": [{"number_of_elements": 50}], "category": "general"}, {"name": "browser_get_dropdown_options", "description": "\u83b7\u53d6\u4e0b\u62c9\u83dc\u5355\u7684\u6240\u6709\u9009\u9879", "parameters": {"index": {"type": "integer", "description": "\u4e0b\u62c9\u83dc\u5355\u5143\u7d20\u7684\u7d22\u5f15", "required": true}}, "examples": [{"index": 3}], "category": "general"}, {"name": "browser_select_dropdown_option", "description": "\u9009\u62e9\u4e0b\u62c9\u83dc\u5355\u4e2d\u7684\u9009\u9879", "parameters": {"index": {"type": "integer", "description": "\u4e0b\u62c9\u83dc\u5355\u5143\u7d20\u7684\u7d22\u5f15", "required": true}, "text": {"type": "string", "description": "\u8981\u9009\u62e9\u7684\u9009\u9879\u6587\u672c", "required": true}}, "examples": [{"index": 3, "text": "Option 1"}], "category": "general"}, {"name": "browser_drag_drop", "description": "\u6267\u884c\u62d6\u62fd\u64cd\u4f5c", "parameters": {"element_source": {"type": "string", "description": "\u6e90\u5143\u7d20\u9009\u62e9\u5668", "required": false}, "element_target": {"type": "string", "description": "\u76ee\u6807\u5143\u7d20\u9009\u62e9\u5668", "required": false}, "coord_source_x": {"type": "integer", "description": "\u6e90\u5750\u6807X", "required": false}, "coord_source_y": {"type": "integer", "description": "\u6e90\u5750\u6807Y", "required": false}, "coord_target_x": {"type": "integer", "description": "\u76ee\u6807\u5750\u6807X", "required": false}, "coord_target_y": {"type": "integer", "description": "\u76ee\u6807\u5750\u6807Y", "required": false}, "steps": {"type": "integer", "description": "\u62d6\u62fd\u6b65\u9aa4\u6570\uff0c\u9ed8\u8ba410", "required": false}}, "examples": [{"element_source": ".item1", "element_target": ".dropzone"}], "category": "general"}, {"name": "browser_save_pdf", "description": "\u5c06\u5f53\u524d\u9875\u9762\u4fdd\u5b58\u4e3aPDF", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_screenshot", "description": "\u622a\u53d6\u5f53\u524d\u9875\u9762\u622a\u56fe", "parameters": {"filename": {"type": "string", "description": "\u622a\u56fe\u6587\u4ef6\u540d\uff0c\u53ef\u9009", "required": false}}, "examples": [{"filename": "current_page.png"}, {}], "category": "general"}, {"name": "browser_wait", "description": "\u7b49\u5f85\u6307\u5b9a\u79d2\u6570", "parameters": {"seconds": {"type": "number", "description": "\u7b49\u5f85\u7684\u79d2\u6570\uff0c\u9ed8\u8ba43", "required": false}}, "examples": [{"seconds": 5}, {}], "category": "general"}, {"name": "browser_done", "description": "\u6807\u8bb0\u4efb\u52a1\u5b8c\u6210", "parameters": {"text": {"type": "string", "description": "\u5b8c\u6210\u63cf\u8ff0", "required": true}, "success": {"type": "boolean", "description": "\u662f\u5426\u6210\u529f\u5b8c\u6210", "required": true}}, "examples": [{"text": "\u4efb\u52a1\u5df2\u5b8c\u6210", "success": true}], "category": "general"}, {"name": "browser_get_page_info", "description": "\u83b7\u53d6\u5f53\u524d\u9875\u9762\u4fe1\u606f", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_get_current_url", "description": "\u83b7\u53d6\u5f53\u524d\u9875\u9762URL", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_close_session", "description": "\u5173\u95ed\u6d4f\u89c8\u5668\u4f1a\u8bdd", "parameters": {}, "examples": [{}], "category": "general"}], "endpoint": "ws://localhost:8084", "connection_params": {}}}
2025-06-28 11:00:35,068 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Waiting for registration response from toolscore...
2025-06-28 11:00:35,068 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "fea7eb...onnection_params": {}}}' [9625 bytes]
2025-06-28 11:00:35,068 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: browser_use_server (ID: browser_use)
2025-06-28 11:00:35,068 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: browser_use_server
2025-06-28 11:00:35,068 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: browser_use -> ws://localhost:8084
2025-06-28 11:00:35,068 - core.toolscore.core_manager - INFO - 工具立即可用: browser_use
2025-06-28 11:00:35,068 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 11:00:35,068 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Received registration response: {"type": "register_tool_response", "request_id": "fea7eb93-af46-4e46-9708-a8ae67253ff3", "success": true, "message": null}
2025-06-28 11:00:35,068 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Successfully registered with toolscore.
2025-06-28 11:00:35,068 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:00:35,068 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 11:00:35,068 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:00:35,068 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 11:00:35,069 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 11:00:35,069 - websockets.server - INFO - connection closed
2025-06-28 11:00:36,961 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:00:36,961 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:00:39,503 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第4次, 5s间隔)
2025-06-28 11:00:39,962 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:00:39,962 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:00:42,964 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:00:42,964 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:00:44,504 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第5次, 5s间隔)
2025-06-28 11:00:45,965 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:00:45,966 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:00:48,966 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:00:48,966 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:00:49,505 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第6次, 5s间隔)
2025-06-28 11:00:51,968 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:00:51,968 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:00:54,479 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:00:54,496 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:00:54,497 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:00:54,497 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:00:54,503 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:00:54,506 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第7次, 5s间隔)
2025-06-28 11:00:54,969 - services.mcp_server_launcher - DEBUG - ⏱️ microsandbox_server 就绪检测超时 (30秒)
2025-06-28 11:00:54,969 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:00:54,969 - services.mcp_server_launcher - INFO - ✅ 成功启动 4/4 个MCP服务器: ['microsandbox_server', 'search_tool_server', 'browser_use_server', 'deepsearch_server']
2025-06-28 11:00:54,969 - services.service_manager - INFO - 启动服务: task_api
2025-06-28 11:00:54,969 - services.task_api_service - INFO - 正在启动任务API服务...
2025-06-28 11:00:54,979 - services.task_api_service - INFO - 任务API服务已启动于 0.0.0.0:8000
2025-06-28 11:00:54,979 - services.service_manager - INFO - 启动服务: runtime
2025-06-28 11:00:54,979 - services.runtime_service - INFO - 正在启动推理运行时服务...
2025-06-28 11:00:54,979 - services.service_manager - INFO - 启动服务: synthesis
2025-06-28 11:00:54,979 - services.synthesis_service - INFO - 正在启动合成服务...
2025-06-28 11:00:54,979 - services.synthesis_service - INFO - 合成服务工作线程已启动
2025-06-28 11:00:54,979 - services.synthesis_service - INFO - SynthesisCore v2.0监控器工作线程已启动
2025-06-28 11:00:54,979 - services.synthesis_service - INFO - 开始处理轨迹数据...
2025-06-28 11:00:54,979 - services.synthesis_service - INFO - 🚀 启动SynthesisCore v2.0监控器
2025-06-28 11:00:54,979 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:00:54,980 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:00:54,980 - services.synthesis_service - INFO - 合成服务已启动
2025-06-28 11:00:54,980 - services.service_manager - INFO - 所有服务已启动
2025-06-28 11:00:54,980 - core.synthesiscore.synthesis - INFO - 🔄 Processing only unprocessed trajectories...
2025-06-28 11:00:54,980 - __main__ - DEBUG - ✅ 所有服务启动完成
2025-06-28 11:00:54,981 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:00:54,981 - __main__ - INFO - 🎉 所有服务已启动，系统运行中...
2025-06-28 11:00:54,981 - __main__ - INFO - 📊 系统状态监控已启用，按 Ctrl+C 停止
2025-06-28 11:00:54,982 - services.runtime_service - INFO - 启动运行时实例: enhanced-reasoning-1
2025-06-28 11:00:54,982 - runtimes.reasoning.enhanced_runtime - INFO - 🚀 初始化Enhanced Reasoning Runtime - 简化版本
2025-06-28 11:00:54,982 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ Redis连接初始化成功
2025-06-28 11:00:54,982 - core.llm.response_parsers.reasoning_response_parser - DEBUG - ✅ 响应解析器已连接工具Schema管理器
2025-06-28 11:00:54,982 - core.synthesiscore.synthesis - INFO - 🎯 Unprocessed trajectories completed: 0 new trajectories processed
2025-06-28 11:00:54,982 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 工具Schema管理器已注入到响应解析器
2025-06-28 11:00:54,982 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:corpus_queue
2025-06-28 11:00:54,982 - runtimes.reasoning.enhanced_runtime - INFO - ⏳ 等待ToolScore服务就绪...
2025-06-28 11:00:54,983 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:atomic_tasks
2025-06-28 11:00:54,983 - services.synthesis_service - DEBUG - 等待 300 秒后再次处理...
2025-06-28 11:00:54,983 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:extended_tasks
2025-06-28 11:00:54,983 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:verification_queue
2025-06-28 11:00:54,984 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:training_data
2025-06-28 11:00:54,984 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:quality_reports
2025-06-28 11:00:54,985 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ Redis配置键初始化完成
2025-06-28 11:00:54,985 - runtimes.reasoning.toolscore_client - INFO - ✅ ToolScore服务已就绪
2025-06-28 11:00:54,985 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ 增强合成Redis管理器初始化完成
2025-06-28 11:00:54,986 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:11:00:54 +0800] "GET /health HTTP/1.1" 200 231 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 11:00:54,986 - runtimes.reasoning.enhanced_runtime - INFO - ✅ ToolScore HTTP服务已就绪
2025-06-28 11:00:54,986 - core.synthesiscore.enhanced_synthesis_engine - INFO - ✅ Enhanced Synthesis Engine 初始化完成
2025-06-28 11:00:54,986 - runtimes.reasoning.enhanced_runtime - INFO - 🔌 正在连接WebSocket端点: ws://localhost:8081/websocket
2025-06-28 11:00:54,986 - core.synthesiscore.enhanced_synthesis_engine - INFO - 🚀 SynthesisCore v2.0 已启动
2025-06-28 11:00:54,986 - runtimes.reasoning.real_time_tool_client - INFO - 🔌 连接到ToolScore实时更新: ws://localhost:8081/websocket
2025-06-28 11:00:54,987 - core.synthesiscore.trajectory_monitor - INFO - 🔄 检查并处理现有轨迹...
2025-06-28 11:00:54,987 - core.synthesiscore.trajectory_monitor - INFO - 📝 没有现有轨迹文件
2025-06-28 11:00:54,987 - core.synthesiscore.trajectory_monitor - INFO - ✅ TrajectoryMonitor初始化完成
2025-06-28 11:00:54,987 - core.synthesiscore.trajectory_monitor - DEBUG - ✅ 获取主事件循环引用成功
2025-06-28 11:00:54,988 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:00:54,988 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:00:54,988 - core.synthesiscore.trajectory_monitor - INFO - 👁️ 开始监控轨迹文件变化: output/trajectories
2025-06-28 11:00:54,989 - websockets.client - DEBUG - > GET /websocket HTTP/1.1
2025-06-28 11:00:54,989 - services.synthesis_service - INFO - ✅ SynthesisCore v2.0监控器已启动
2025-06-28 11:00:54,989 - websockets.client - DEBUG - > Host: localhost:8081
2025-06-28 11:00:54,989 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:00:54,989 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:00:54,989 - websockets.client - DEBUG - > Sec-WebSocket-Key: Kc2JI2QE+SJx95DFwwRD2A==
2025-06-28 11:00:54,989 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:00:54,989 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:00:54,989 - websockets.client - DEBUG - > User-Agent: Enhanced-Reasoning-Runtime/1.0
2025-06-28 11:00:54,990 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:00:54,990 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:00:54,990 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:00:54,990 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:00:54,990 - websockets.server - DEBUG - < Sec-WebSocket-Key: Kc2JI2QE+SJx95DFwwRD2A==
2025-06-28 11:00:54,990 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:00:54,990 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:00:54,990 - websockets.server - DEBUG - < User-Agent: Enhanced-Reasoning-Runtime/1.0
2025-06-28 11:00:54,990 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:00:54,990 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:00:54,990 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:00:54,990 - websockets.server - DEBUG - > Sec-WebSocket-Accept: XeYS39XfDd9KiDcuym0Pj0CoHTs=
2025-06-28 11:00:54,990 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:00:54,990 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:00:54 GMT
2025-06-28 11:00:54,990 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:00:54,990 - websockets.server - INFO - connection open
2025-06-28 11:00:54,990 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:00:54,990 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 60955)
2025-06-28 11:00:54,990 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
[2025-06-28 11:00:54] INFO:     Started server process [72140]
2025-06-28 11:00:54,991 - websockets.client - DEBUG - < Upgrade: websocket
[2025-06-28 11:00:54] INFO:     Waiting for application startup.
2025-06-28 11:00:54,991 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:00:54,991 - websockets.client - DEBUG - < Sec-WebSocket-Accept: XeYS39XfDd9KiDcuym0Pj0CoHTs=
2025-06-28 11:00:54,991 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:00:54,991 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:00:54 GMT
2025-06-28 11:00:54,991 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:00:54,991 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:00:54,991 - runtimes.reasoning.real_time_tool_client - INFO - ✅ 已连接到ToolScore实时更新流
2025-06-28 11:00:54,991 - runtimes.reasoning.enhanced_runtime - INFO - ✅ WebSocket实时更新连接成功
2025-06-28 11:00:54,991 - runtimes.reasoning.real_time_tool_client - DEBUG - 已注册工具更新回调，当前回调数量: 1
2025-06-28 11:00:54,991 - runtimes.reasoning.enhanced_runtime - INFO - ⏳ 等待关键工具完全就绪...
2025-06-28 11:00:54,991 - runtimes.reasoning.enhanced_runtime - WARNING - 🚀 临时跳过详细工具等待，快速启动模式
2025-06-28 11:00:54,991 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 使用快速启动模式，工具将在后台异步就绪
2025-06-28 11:00:54,991 - runtimes.reasoning.enhanced_runtime - INFO - 🔍 开始MCP服务器同步验证...
2025-06-28 11:00:54,991 - core.tool_schema_manager - INFO - 正在执行MCP同步验证...
2025-06-28 11:00:54,991 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=False)，当前缓存: 0 个工具
2025-06-28 11:00:54,991 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 11:00:54,991 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
2025-06-28 11:00:54,991 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 11:00:54,991 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
2025-06-28 11:00:54,991 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
2025-06-28 11:00:54,992 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 11:00:54,992 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 11:00:54,992 - core.tool_schema_manager - INFO - 🔄 检测到 4 个工具需要更新: ['deepsearch', 'microsandbox', 'browser_use', 'mcp-search-tool']
2025-06-28 11:00:54,992 - core.tool_schema_manager - INFO - 🔄 执行增量更新: 4 个工具
2025-06-28 11:00:54,992 - core.tool_schema_manager - INFO - 🔄 缓存为空，转为全量刷新模式
2025-06-28 11:00:54,992 - core.tool_schema_manager - DEBUG - 🔄 开始增强刷新工具Schemas...
2025-06-28 11:00:54,992 - core.tool_schema_manager - DEBUG - 🔍 工具注册表状态检查: _tools 字典包含 4 个条目
2025-06-28 11:00:54,992 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: deepsearch
2025-06-28 11:00:54,992 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: microsandbox
2025-06-28 11:00:54,992 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: browser_use
2025-06-28 11:00:54,992 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: mcp-search-tool
2025-06-28 11:00:54,992 - core.tool_schema_manager - INFO - 🔧 选项1: 从工具注册表获取到 4 个工具
2025-06-28 11:00:54,992 - core.tool_schema_manager - DEBUG -   工具 0: id=deepsearch, name=网络信息研究工具, actions=3
2025-06-28 11:00:54,992 - core.tool_schema_manager - DEBUG -   工具 1: id=microsandbox, name=MicroSandbox安全代码执行器, actions=7
2025-06-28 11:00:54,992 - core.tool_schema_manager - DEBUG -   工具 2: id=browser_use, name=智能浏览器操作工具, actions=6
2025-06-28 11:00:54,992 - core.tool_schema_manager - DEBUG -   工具 3: id=mcp-search-tool, name=工具管理和项目文件搜索器, actions=4
2025-06-28 11:00:54,992 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: deepsearch
2025-06-28 11:00:54,992 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: comprehensive_research
2025-06-28 11:00:54,993 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: quick_research
2025-06-28 11:00:54,993 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: research
2025-06-28 11:00:54,993 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 deepsearch (包含 3 个动作)
2025-06-28 11:00:54,993 - core.tool_schema_manager - DEBUG -    当前缓存大小: 1 个工具
2025-06-28 11:00:54,993 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: microsandbox
2025-06-28 11:00:54,994 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_cleanup_expired
2025-06-28 11:00:54,994 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_close_session
2025-06-28 11:00:54,994 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_execute
2025-06-28 11:00:54,994 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_health_status
2025-06-28 11:00:54,994 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_performance_stats
2025-06-28 11:00:54,994 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_install_package
2025-06-28 11:00:54,994 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_list_sessions
2025-06-28 11:00:54,994 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 microsandbox (包含 7 个动作)
2025-06-28 11:00:54,994 - core.tool_schema_manager - DEBUG -    当前缓存大小: 2 个工具
2025-06-28 11:00:54,994 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: browser_use
2025-06-28 11:00:54,994 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_click_element
2025-06-28 11:00:54,994 - core.task_api - INFO - Connected to Redis: redis://localhost:6379
2025-06-28 11:00:54,995 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_use_execute_task
[2025-06-28 11:00:54] INFO:     Application startup complete.
2025-06-28 11:00:54,995 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_extract_content
2025-06-28 11:00:54,995 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_input_text
2025-06-28 11:00:54,995 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_navigate
2025-06-28 11:00:54,995 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_search_google
2025-06-28 11:00:54,995 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 browser_use (包含 6 个动作)
2025-06-28 11:00:54,995 - core.tool_schema_manager - DEBUG -    当前缓存大小: 3 个工具
2025-06-28 11:00:54,995 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: mcp-search-tool
2025-06-28 11:00:54,995 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: analyze_tool_needs
2025-06-28 11:00:54,996 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: list_code_definitions
2025-06-28 11:00:54,996 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_and_install_tools
[2025-06-28 11:00:54] INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-06-28 11:00:54,996 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_file_content
2025-06-28 11:00:54,996 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 mcp-search-tool (包含 4 个动作)
2025-06-28 11:00:54,996 - core.tool_schema_manager - DEBUG -    当前缓存大小: 4 个工具
2025-06-28 11:00:54,996 - core.tool_schema_manager - INFO - 🔧 选项1: 成功处理 4/4 个工具，当前缓存 4 个工具
2025-06-28 11:00:54,996 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: mcp-search-tool
2025-06-28 11:00:54,996 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: microsandbox
2025-06-28 11:00:54,997 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: browser_use
2025-06-28 11:00:54,997 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: deepsearch
2025-06-28 11:00:54,997 - core.tool_schema_manager - INFO - ✅ 增强刷新完成，当前可用工具: 4个
2025-06-28 11:00:54,997 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:00:54,998 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:00:54,998 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:00:54,998 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:00:54,998 - core.tool_schema_manager - INFO - ✅ Schema安全刷新完成，备份 4 个工具
2025-06-28 11:00:54,999 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:00:54,999 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:00:54,999 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:00:55,000 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:00:55,000 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 11:00:55,000 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 11:00:55,000 - core.tool_schema_manager - INFO - 🔍 同步验证完成: unhealthy (0/4 工具Schema一致)
2025-06-28 11:00:55,000 - runtimes.reasoning.enhanced_runtime - ERROR - ❌ MCP服务器同步验证失败: 未知错误
2025-06-28 11:00:55,000 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔧 开始获取可用工具ID列表...
2025-06-28 11:00:55,000 - runtimes.reasoning.real_time_tool_client - DEBUG - 可用工具ID列表: ['deepsearch', 'microsandbox', 'browser_use', 'mcp-search-tool']
2025-06-28 11:00:55,000 - runtimes.reasoning.enhanced_runtime - DEBUG - 📋 获取到的工具列表: ['deepsearch', 'microsandbox', 'browser_use', 'mcp-search-tool']
2025-06-28 11:00:55,000 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 工具Schema管理器已初始化
2025-06-28 11:00:55,000 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔧 更新Guardrails和ValidationCritic工具配置...
2025-06-28 11:00:55,000 - core.llm.guardrails_middleware - INFO - 🔧 初始化输入验证Guard...
2025-06-28 11:00:55,001 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:00:55,002 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:00:55,002 - core.llm.guardrails_middleware - INFO - 🔧 初始化输出验证Guard...
2025-06-28 11:00:55,002 - core.llm.guardrails_middleware - INFO - 🔧 使用本地LLM客户端初始化Guard...
2025-06-28 11:00:55,003 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:00:55,003 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:00:55,004 - core.llm.guardrails_middleware - INFO - ✅ 使用LLM的Guard创建成功
2025-06-28 11:00:55,004 - core.llm.guardrails_middleware - INFO - ✅ Guardrails Guards初始化成功
2025-06-28 11:00:55,004 - core.llm.guardrails_middleware - INFO -    - 输入Guard: ✅
2025-06-28 11:00:55,004 - core.llm.guardrails_middleware - INFO -    - 输出Guard: ✅
2025-06-28 11:00:55,004 - core.llm.guardrails_middleware - INFO - 🔄 Guardrails工具列表已更新: 4个工具
2025-06-28 11:00:55,004 - core.agents.validation_critic - INFO - 🔄 ValidationCritic工具列表已更新: 4个工具
2025-06-28 11:00:55,004 - runtimes.reasoning.enhanced_runtime - INFO - ✅ Guardrails和ValidationCritic已配置4个工具: deepsearch, microsandbox, browser_use, mcp-search-tool
2025-06-28 11:00:55,004 - runtimes.reasoning.enhanced_runtime - INFO - ✅ Enhanced Reasoning Runtime 已成功初始化为纯推理引擎（集成Guardrails + ValidationCritic）
2025-06-28 11:00:55,004 - services.runtime_service - INFO - 启动运行时任务消费: enhanced-reasoning-1
2025-06-28 11:00:55,004 - services.runtime_service - INFO - 推理运行时服务已启动 1 个实例和 1 个任务消费协程
2025-06-28 11:00:55,004 - core.tool_schema_manager - INFO - 🔍 启动MCP服务器配置监控...
2025-06-28 11:00:55,004 - core.task_manager - INFO - Runtime enhanced-reasoning-1 starting to consume from queue: tasks:reasoning
2025-06-28 11:00:55,005 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/search_tool_server/service.json
2025-06-28 11:00:55,005 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/microsandbox_server/service.json
2025-06-28 11:00:55,005 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/browser_use_server/service.json
2025-06-28 11:00:55,005 - core.task_manager - INFO - Runtime enhanced-reasoning-1 starting consumer loop for queue tasks:reasoning
2025-06-28 11:00:55,005 - core.task_manager - DEBUG - Runtime enhanced-reasoning-1 reading from queue tasks:reasoning...
2025-06-28 11:00:55,006 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/deepsearch_server/service.json
2025-06-28 11:00:55,006 - core.tool_schema_manager - INFO - 🔄 MCP配置变化，强制刷新schema...
2025-06-28 11:00:55,006 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=True)，当前缓存: 0 个工具
2025-06-28 11:00:55,006 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 11:00:55,006 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
2025-06-28 11:00:55,006 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 11:00:55,006 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
2025-06-28 11:00:55,006 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
2025-06-28 11:00:55,006 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 11:00:55,006 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 11:00:55,006 - core.tool_schema_manager - INFO - 🔄 检测到 4 个工具需要更新: ['deepsearch', 'microsandbox', 'browser_use', 'mcp-search-tool']
2025-06-28 11:00:55,006 - core.tool_schema_manager - INFO - 🔄 执行增量更新: 4 个工具
2025-06-28 11:00:55,006 - core.tool_schema_manager - INFO - 🔄 缓存为空，转为全量刷新模式
2025-06-28 11:00:55,006 - core.tool_schema_manager - DEBUG - 🔄 开始增强刷新工具Schemas...
2025-06-28 11:00:55,006 - core.tool_schema_manager - DEBUG - 🔍 工具注册表状态检查: _tools 字典包含 4 个条目
2025-06-28 11:00:55,006 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: deepsearch
2025-06-28 11:00:55,006 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: microsandbox
2025-06-28 11:00:55,006 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: browser_use
2025-06-28 11:00:55,006 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: mcp-search-tool
2025-06-28 11:00:55,006 - core.tool_schema_manager - INFO - 🔧 选项1: 从工具注册表获取到 4 个工具
2025-06-28 11:00:55,006 - core.tool_schema_manager - DEBUG -   工具 0: id=deepsearch, name=网络信息研究工具, actions=3
2025-06-28 11:00:55,006 - core.tool_schema_manager - DEBUG -   工具 1: id=microsandbox, name=MicroSandbox安全代码执行器, actions=7
2025-06-28 11:00:55,006 - core.tool_schema_manager - DEBUG -   工具 2: id=browser_use, name=智能浏览器操作工具, actions=6
2025-06-28 11:00:55,006 - core.tool_schema_manager - DEBUG -   工具 3: id=mcp-search-tool, name=工具管理和项目文件搜索器, actions=4
2025-06-28 11:00:55,006 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: deepsearch
2025-06-28 11:00:55,006 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: comprehensive_research
2025-06-28 11:00:55,007 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: quick_research
2025-06-28 11:00:55,007 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: research
2025-06-28 11:00:55,007 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 deepsearch (包含 3 个动作)
2025-06-28 11:00:55,007 - core.tool_schema_manager - DEBUG -    当前缓存大小: 1 个工具
2025-06-28 11:00:55,007 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: microsandbox
2025-06-28 11:00:55,007 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_cleanup_expired
2025-06-28 11:00:55,007 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_close_session
2025-06-28 11:00:55,008 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_execute
2025-06-28 11:00:55,008 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_health_status
2025-06-28 11:00:55,008 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_performance_stats
2025-06-28 11:00:55,008 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_install_package
2025-06-28 11:00:55,008 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_list_sessions
2025-06-28 11:00:55,008 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 microsandbox (包含 7 个动作)
2025-06-28 11:00:55,008 - core.tool_schema_manager - DEBUG -    当前缓存大小: 2 个工具
2025-06-28 11:00:55,008 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: browser_use
2025-06-28 11:00:55,008 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_click_element
2025-06-28 11:00:55,009 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-48' coro=<start.<locals>.start_all_runtimes() running at /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/services/runtime_service.py:94> wait_for=<_GatheringFuture pending cb=[Task.task_wakeup()]>>
2025-06-28 11:00:55,009 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='runtime-enhanced-reasoning-1' coro=<start_runtime_service() running at /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/core/task_manager.py:388> wait_for=<Future pending cb=[Task.task_wakeup()]> cb=[gather.<locals>._done_callback() at /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/tasks.py:764]>
2025-06-28 11:00:55,009 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_use_execute_task
2025-06-28 11:00:55,009 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_extract_content
2025-06-28 11:00:55,009 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_input_text
2025-06-28 11:00:55,009 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_navigate
2025-06-28 11:00:55,009 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_search_google
2025-06-28 11:00:55,009 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 browser_use (包含 6 个动作)
2025-06-28 11:00:55,009 - core.tool_schema_manager - DEBUG -    当前缓存大小: 3 个工具
2025-06-28 11:00:55,009 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: mcp-search-tool
2025-06-28 11:00:55,009 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: analyze_tool_needs
2025-06-28 11:00:55,009 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: list_code_definitions
2025-06-28 11:00:55,010 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_and_install_tools
2025-06-28 11:00:55,010 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_file_content
2025-06-28 11:00:55,010 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 mcp-search-tool (包含 4 个动作)
2025-06-28 11:00:55,010 - core.tool_schema_manager - DEBUG -    当前缓存大小: 4 个工具
2025-06-28 11:00:55,010 - core.tool_schema_manager - INFO - 🔧 选项1: 成功处理 4/4 个工具，当前缓存 4 个工具
2025-06-28 11:00:55,010 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: mcp-search-tool
2025-06-28 11:00:55,010 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: microsandbox
2025-06-28 11:00:55,010 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: browser_use
2025-06-28 11:00:55,010 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: deepsearch
2025-06-28 11:00:55,011 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:11:00:55 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 11:00:55,011 - core.tool_schema_manager - DEBUG - 🔍 从ToolScore获取到工具列表: ['mcp-search-tool', 'microsandbox', 'browser_use', 'deepsearch']
2025-06-28 11:00:55,011 - core.tool_schema_manager - DEBUG - 🔧 映射后的工具列表: ['mcp-search-tool', 'microsandbox', 'browser_use', 'deepsearch']
2025-06-28 11:00:55,011 - core.tool_schema_manager - DEBUG - ⏭️ 工具 mcp-search-tool 已在缓存中，跳过ToolScore获取
2025-06-28 11:00:55,011 - core.tool_schema_manager - DEBUG - ⏭️ 工具 microsandbox 已在缓存中，跳过ToolScore获取
2025-06-28 11:00:55,011 - core.tool_schema_manager - DEBUG - ⏭️ 工具 browser_use 已在缓存中，跳过ToolScore获取
2025-06-28 11:00:55,011 - core.tool_schema_manager - DEBUG - ⏭️ 工具 deepsearch 已在缓存中，跳过ToolScore获取
2025-06-28 11:00:55,011 - core.tool_schema_manager - INFO - ✅ 增强刷新完成，当前可用工具: 4个
2025-06-28 11:00:55,011 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:00:55,012 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:00:55,012 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:00:55,012 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:00:55,012 - core.tool_schema_manager - INFO - ✅ Schema安全刷新完成，备份 4 个工具
2025-06-28 11:00:55,012 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:00:55,012 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:00:55,013 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:00:55,013 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:00:55,013 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 11:00:55,013 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 11:00:59,507 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第8次, 5s间隔)
2025-06-28 11:01:04,509 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第9次, 5s间隔)
2025-06-28 11:01:09,510 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第10次, 5s间隔)
2025-06-28 11:01:14,511 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第11次, 5s间隔)
2025-06-28 11:01:14,997 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:01:14,998 - websockets.client - DEBUG - > PING ec c1 4e 83 [binary, 4 bytes]
2025-06-28 11:01:14,998 - websockets.server - DEBUG - < PING ec c1 4e 83 [binary, 4 bytes]
2025-06-28 11:01:14,998 - websockets.server - DEBUG - > PONG ec c1 4e 83 [binary, 4 bytes]
2025-06-28 11:01:14,998 - websockets.client - DEBUG - < PONG ec c1 4e 83 [binary, 4 bytes]
2025-06-28 11:01:14,998 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:01:15,712 - core.task_api - INFO - Task 956b1da4-4ba5-4a5b-b36a-d2f895e55610 submitted successfully
[2025-06-28 11:01:15] INFO:     127.0.0.1:60988 - "POST /api/v1/tasks HTTP/1.1" 200 OK
2025-06-28 11:01:19,512 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第12次, 5s间隔)
2025-06-28 11:01:24,481 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:01:24,499 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:01:24,499 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:01:24,500 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:01:24,509 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:01:24,513 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第13次, 30s间隔)
2025-06-28 11:01:24,991 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:01:24,991 - websockets.server - DEBUG - > PING 3d a1 08 33 [binary, 4 bytes]
2025-06-28 11:01:24,992 - websockets.client - DEBUG - < PING 3d a1 08 33 [binary, 4 bytes]
2025-06-28 11:01:24,992 - websockets.client - DEBUG - > PONG 3d a1 08 33 [binary, 4 bytes]
2025-06-28 11:01:24,992 - websockets.server - DEBUG - < PONG 3d a1 08 33 [binary, 4 bytes]
2025-06-28 11:01:24,992 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:01:34,999 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:01:34,999 - websockets.client - DEBUG - > PING d6 23 26 e6 [binary, 4 bytes]
2025-06-28 11:01:34,999 - websockets.server - DEBUG - < PING d6 23 26 e6 [binary, 4 bytes]
2025-06-28 11:01:34,999 - websockets.server - DEBUG - > PONG d6 23 26 e6 [binary, 4 bytes]
2025-06-28 11:01:34,999 - websockets.client - DEBUG - < PONG d6 23 26 e6 [binary, 4 bytes]
2025-06-28 11:01:34,999 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:01:54,487 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:01:54,505 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:01:54,506 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:01:54,507 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:01:54,513 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第14次, 30s间隔)
2025-06-28 11:01:54,514 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:01:54,981 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 1m 0s
2025-06-28 11:01:54,993 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:01:54,994 - websockets.server - DEBUG - > PING 'O\\8\x08' [text, 4 bytes]
2025-06-28 11:01:54,994 - websockets.client - DEBUG - < PING 'O\\8\x08' [text, 4 bytes]
2025-06-28 11:01:54,994 - websockets.client - DEBUG - > PONG 'O\\8\x08' [text, 4 bytes]
2025-06-28 11:01:54,994 - websockets.server - DEBUG - < PONG 'O\\8\x08' [text, 4 bytes]
2025-06-28 11:01:54,995 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:01:55,000 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:01:55,000 - websockets.client - DEBUG - > PING 49 82 b1 e6 [binary, 4 bytes]
2025-06-28 11:01:55,000 - websockets.server - DEBUG - < PING 49 82 b1 e6 [binary, 4 bytes]
2025-06-28 11:01:55,000 - websockets.server - DEBUG - > PONG 49 82 b1 e6 [binary, 4 bytes]
2025-06-28 11:01:55,000 - websockets.client - DEBUG - < PONG 49 82 b1 e6 [binary, 4 bytes]
2025-06-28 11:01:55,001 - websockets.client - DEBUG - % received keepalive pong
[2025-06-28 11:02:00] INFO:     127.0.0.1:61036 - "GET /api/v1/tasks/956b1da4-4ba5-4a5b-b36a-d2f895e55610 HTTP/1.1" 200 OK
2025-06-28 11:02:15,002 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:02:15,002 - websockets.client - DEBUG - > PING 5c f6 7e 7d [binary, 4 bytes]
2025-06-28 11:02:15,003 - websockets.server - DEBUG - < PING 5c f6 7e 7d [binary, 4 bytes]
2025-06-28 11:02:15,003 - websockets.server - DEBUG - > PONG 5c f6 7e 7d [binary, 4 bytes]
2025-06-28 11:02:15,003 - websockets.client - DEBUG - < PONG 5c f6 7e 7d [binary, 4 bytes]
2025-06-28 11:02:15,003 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:02:24,494 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:02:24,511 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:02:24,513 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:02:24,513 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:02:24,514 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第15次, 30s间隔)
2025-06-28 11:02:24,517 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:02:24,996 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:02:24,996 - websockets.server - DEBUG - > PING 12 e3 1d 32 [binary, 4 bytes]
2025-06-28 11:02:24,997 - websockets.client - DEBUG - < PING 12 e3 1d 32 [binary, 4 bytes]
2025-06-28 11:02:24,997 - websockets.client - DEBUG - > PONG 12 e3 1d 32 [binary, 4 bytes]
2025-06-28 11:02:24,997 - websockets.server - DEBUG - < PONG 12 e3 1d 32 [binary, 4 bytes]
2025-06-28 11:02:24,997 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:02:35,005 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:02:35,005 - websockets.client - DEBUG - > PING 9f 03 1b a8 [binary, 4 bytes]
2025-06-28 11:02:35,005 - websockets.server - DEBUG - < PING 9f 03 1b a8 [binary, 4 bytes]
2025-06-28 11:02:35,006 - websockets.server - DEBUG - > PONG 9f 03 1b a8 [binary, 4 bytes]
2025-06-28 11:02:35,006 - websockets.client - DEBUG - < PONG 9f 03 1b a8 [binary, 4 bytes]
2025-06-28 11:02:35,006 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:02:54,498 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:02:54,515 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第16次, 30s间隔)
2025-06-28 11:02:54,518 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:02:54,519 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:02:54,520 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:02:54,520 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:02:54,982 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 2m 0s
2025-06-28 11:02:54,999 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:02:54,999 - websockets.server - DEBUG - > PING 08 08 94 b1 [binary, 4 bytes]
2025-06-28 11:02:55,000 - websockets.client - DEBUG - < PING 08 08 94 b1 [binary, 4 bytes]
2025-06-28 11:02:55,000 - websockets.client - DEBUG - > PONG 08 08 94 b1 [binary, 4 bytes]
2025-06-28 11:02:55,000 - websockets.server - DEBUG - < PONG 08 08 94 b1 [binary, 4 bytes]
2025-06-28 11:02:55,000 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:02:55,006 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:02:55,006 - websockets.client - DEBUG - > PING e1 18 95 e9 [binary, 4 bytes]
2025-06-28 11:02:55,007 - websockets.server - DEBUG - < PING e1 18 95 e9 [binary, 4 bytes]
2025-06-28 11:02:55,007 - websockets.server - DEBUG - > PONG e1 18 95 e9 [binary, 4 bytes]
2025-06-28 11:02:55,007 - websockets.client - DEBUG - < PONG e1 18 95 e9 [binary, 4 bytes]
2025-06-28 11:02:55,007 - websockets.client - DEBUG - % received keepalive pong

================================================================================
[系统启动] 2025-06-28 11:03:13
================================================================================
[2025-06-28 11:03:13] 🚀 Agent Data Platform 启动中... (所有日志将统一记录到 logs/System.log)
2025-06-28 11:03:13,517 - asyncio - DEBUG - Using selector: KqueueSelector
[2025-06-28 11:03:13] 🧹 开始增强端口清理...
[2025-06-28 11:03:13] 🔍 搜索并清理相关Python进程...
2025-06-28 11:03:13,528 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:03:13,529 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:03:13,529 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:03:13,529 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:03:13,529 - services.synthesis_service - INFO - 🛑 SynthesisCore v2.0监控器已停止
2025-06-28 11:03:13,529 - services.synthesis_service - INFO - 等待合成服务线程结束...
2025-06-28 11:03:13,532 - services.synthesis_service - INFO - 合成服务工作线程已停止
2025-06-28 11:03:13,534 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:03:13,535 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:03:13,535 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:03:13,535 - services.runtime_service - INFO - 停止运行时实例: enhanced-reasoning-1
2025-06-28 11:03:13,535 - services.runtime_service - WARNING - 运行时清理失败: asyncio.run() cannot be called from a running event loop
[2025-06-28 11:03:13] /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/services/runtime_service.py:117: RuntimeWarning: coroutine 'EnhancedReasoningRuntime.cleanup' was never awaited
  logger.warning(f"运行时清理失败: {e}")
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
2025-06-28 11:03:13,536 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:03:13,536 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:03:13,536 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:03:13,536 - services.task_api_service - INFO - 已发送停止信号给任务API服务器
2025-06-28 11:03:13,549 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 收到停止信号，正在清理资源...
2025-06-28 11:03:13,551 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:03:13,552 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:00:24,639 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:00:24,639 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:00:24,639 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:00:24,639 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:00:24,643 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:00:24,643 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:00:24,643 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:00:24,643 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:00:25,110 - websockets.server - INFO - connection open
2025-06-28 11:00:25,110 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 60898)
2025-06-28 11:00:25,111 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:00:25,111 - websockets.server - INFO - connection closed
2025-06-28 11:00:34,645 - core.toolscore.mcp_server - INFO - [search_tool_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 11:00:34,646 - core.toolscore.mcp_server - INFO - [search_tool_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 11:00:34,646 - core.toolscore.mcp_server - INFO - [search_tool_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "42cb2f0a-3dcb-4644-9258-88072bc54621", "tool_spec": {"tool_id": "mcp-search-tool", "name": "search_tool_server", "description": "\u6587\u4ef6\u5185\u5bb9\u641c\u7d22\u548c\u4ee3\u7801\u5b9a\u4e49\u641c\u7d22\u5de5\u5177\u670d\u52a1\u5668", "tool_type": "mcp_server", "capabilities": [{"name": "search_file_content", "description": "\u5728\u6307\u5b9a\u6587\u4ef6\u4e2d\u641c\u7d22\u5339\u914d\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5185\u5bb9", "parameters": {"file_path": {"type": "string", "description": "\u8981\u641c\u7d22\u7684\u6587\u4ef6\u8def\u5f84", "required": true}, "regex_pattern": {"type": "string", "description": "\u8981\u5339\u914d\u7684\u6b63\u5219\u8868\u8fbe\u5f0f", "required": true}}, "examples": [{"file_path": "src/main.py", "regex_pattern": "def\\s+\\w+"}], "category": "general"}, {"name": "list_code_definitions", "description": "\u5217\u51fa\u6307\u5b9a\u6587\u4ef6\u6216\u76ee\u5f55\u4e2dPython\u4ee3\u7801\u7684\u7c7b\u3001\u51fd\u6570\u548c\u65b9\u6cd5\u5b9a\u4e49", "parameters": {"file_path": {"type": "string", "description": "\u8981\u89e3\u6790\u7684Python\u6587\u4ef6\u8def\u5f84", "required": false}, "directory_path": {"type": "string", "description": "\u8981\u89e3\u6790\u7684\u76ee\u5f55\u8def\u5f84", "required": false}}, "examples": [{"file_path": "src/utils.py"}, {"directory_path": "src/models"}], "category": "general"}, {"name": "analyze_tool_needs", "description": "\u5206\u6790\u4efb\u52a1\u9700\u6c42\uff0c\u786e\u5b9a\u662f\u5426\u9700\u8981\u989d\u5916\u7684\u5de5\u5177", "parameters": {"task_description": {"type": "string", "description": "\u8981\u5206\u6790\u7684\u4efb\u52a1\u63cf\u8ff0", "required": true}}, "examples": [{"task_description": "Create a chart showing sales data trends"}], "category": "general"}, {"name": "search_and_install_tools", "description": "\u641c\u7d22\u5e76\u5b89\u88c5\u65b0\u7684\u5de5\u5177\u4ee5\u6ee1\u8db3\u4efb\u52a1\u9700\u6c42", "parameters": {"task_description": {"type": "string", "description": "\u4efb\u52a1\u63cf\u8ff0", "required": true}, "reason": {"type": "string", "description": "\u9700\u8981\u65b0\u5de5\u5177\u7684\u539f\u56e0", "required": false}}, "examples": [{"task_description": "Create a chart", "reason": "Need charting capabilities"}], "category": "general"}], "endpoint": "ws://localhost:8080/mcp", "connection_params": {}}}
2025-06-28 11:00:34,646 - core.toolscore.mcp_server - INFO - [search_tool_server] Waiting for registration response from toolscore...
2025-06-28 11:00:34,647 - core.toolscore.mcp_server - INFO - [search_tool_server] Received registration response: {"type": "register_tool_response", "request_id": "42cb2f0a-3dcb-4644-9258-88072bc54621", "success": true, "message": null}
2025-06-28 11:00:34,647 - core.toolscore.mcp_server - INFO - [search_tool_server] Successfully registered with toolscore.
2025-06-28 11:00:54,480 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:00:54,480 - websockets.server - INFO - connection closed
2025-06-28 11:01:24,481 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:01:24,482 - websockets.server - INFO - connection closed
2025-06-28 11:01:54,488 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:01:54,488 - websockets.server - INFO - connection closed
2025-06-28 11:02:24,495 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:02:24,495 - websockets.server - INFO - connection closed
2025-06-28 11:02:54,499 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:02:54,499 - websockets.server - INFO - connection closed

2025-06-28 11:03:13,552 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:03:13,552 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:03:13,552 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:00:24,733 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:00:24,733 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:00:24,733 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:00:24,733 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:00:24,733 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:00:24,733 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:00:24,733 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:00:24,733 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:00:24,733 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:00:24,733 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:00:24,733 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:00:24,734 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:00:24,734 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:00:24,734 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:00:24,737 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:00:24,737 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:00:24,737 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:00:24,737 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:00:34,738 - core.toolscore.mcp_server - INFO - [microsandbox_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 11:00:34,741 - core.toolscore.mcp_server - INFO - [microsandbox_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 11:00:34,741 - core.toolscore.mcp_server - INFO - [microsandbox_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "1d4321e9-b750-4e9c-a1a5-9bb475aaf79c", "tool_spec": {"tool_id": "microsandbox", "name": "microsandbox_server", "description": "\u57fa\u4e8eMicroSandbox\u7684\u5b89\u5168Python\u4ee3\u7801\u6267\u884c\u670d\u52a1\u5668", "tool_type": "mcp_server", "capabilities": [{"name": "microsandbox_execute", "description": "\u5728MicroSandbox\u5b89\u5168\u73af\u5883\u4e2d\u6267\u884cPython\u4ee3\u7801", "parameters": {"code": {"type": "string", "description": "\u8981\u6267\u884c\u7684Python\u4ee3\u7801", "required": true}, "session_id": {"type": "string", "description": "\u4f1a\u8bddID\uff0c\u7528\u4e8e\u591a\u8f6e\u6267\u884c\u548c\u72b6\u6001\u4fdd\u6301", "required": false}, "timeout": {"type": "integer", "description": "\u6267\u884c\u8d85\u65f6\u65f6\u95f4\uff08\u79d2\uff09\uff0c\u9ed8\u8ba430\u79d2\uff0c\u6700\u5927300\u79d2\u3002\u6ce8\u610f\uff1aMicroSandbox\u5185\u90e8\u6709\u81ea\u5df1\u7684\u8d85\u65f6\u673a\u5236\uff0c\u6b64\u53c2\u6570\u4e3b\u8981\u7528\u4e8e\u6587\u6863\u8bf4\u660e", "required": false}}, "examples": [{"code": "print('Hello from MicroSandbox!')"}, {"code": "import math\\nresult = math.sqrt(16)\\nprint(f'\u5e73\u65b9\u6839: {result}')", "timeout": 10}, {"code": "x = 42", "session_id": "my-session"}, {"code": "print(f'x = {x}')", "session_id": "my-session"}], "category": "general"}, {"name": "microsandbox_install_package", "description": "\u5728MicroSandbox\u73af\u5883\u4e2d\u5b89\u88c5Python\u5305", "parameters": {"package_name": {"type": "string", "description": "\u8981\u5b89\u88c5\u7684\u5305\u540d", "required": true}, "version": {"type": "string", "description": "\u6307\u5b9a\u7248\u672c\u53f7", "required": false}, "session_id": {"type": "string", "description": "\u4f1a\u8bddID", "required": false}}, "examples": [{"package_name": "requests"}, {"package_name": "numpy", "version": "1.21.0"}, {"package_name": "pandas", "session_id": "data-analysis"}], "category": "general"}, {"name": "microsandbox_list_sessions", "description": "\u5217\u51fa\u5f53\u524d\u6d3b\u8dc3\u7684\u6c99\u7bb1\u4f1a\u8bdd", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "microsandbox_close_session", "description": "\u5173\u95ed\u6307\u5b9a\u7684\u6c99\u7bb1\u4f1a\u8bdd", "parameters": {"session_id": {"type": "string", "description": "\u8981\u5173\u95ed\u7684\u4f1a\u8bddID", "required": true}}, "examples": [{"session_id": "my-session"}], "category": "general"}, {"name": "microsandbox_cleanup_expired", "description": "\u6e05\u7406\u8fc7\u671f\u7684\u6c99\u7bb1\u4f1a\u8bdd", "parameters": {"max_age": {"type": "integer", "description": "\u6700\u5927\u4f1a\u8bdd\u5e74\u9f84\uff08\u79d2\uff09\uff0c\u9ed8\u8ba4\u4e3a\u914d\u7f6e\u7684\u8d85\u65f6\u65f6\u95f4", "required": false}}, "examples": [{}, {"max_age": 1800}], "category": "general"}, {"name": "microsandbox_get_performance_stats", "description": "\u83b7\u53d6\u670d\u52a1\u5668\u6027\u80fd\u7edf\u8ba1\u4fe1\u606f", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "microsandbox_get_health_status", "description": "\u83b7\u53d6\u670d\u52a1\u5668\u5065\u5eb7\u72b6\u6001", "parameters": {}, "examples": [{}], "category": "general"}], "endpoint": "ws://localhost:8090", "connection_params": {}}}
2025-06-28 11:00:34,741 - core.toolscore.mcp_server - INFO - [microsandbox_server] Waiting for registration response from toolscore...
2025-06-28 11:00:34,742 - core.toolscore.mcp_server - INFO - [microsandbox_server] Received registration response: {"type": "register_tool_response", "request_id": "1d4321e9-b750-4e9c-a1a5-9bb475aaf79c", "success": true, "message": null}
2025-06-28 11:00:34,742 - core.toolscore.mcp_server - INFO - [microsandbox_server] Successfully registered with toolscore.

2025-06-28 11:03:13,552 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:03:13,552 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:03:13,552 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:00:24,795 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:00:24,795 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:00:24,795 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:00:24,795 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:00:24,795 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:00:24,796 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:00:24,797 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:00:24,797 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:00:24,797 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:00:24,797 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:00:25,111 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:00:25,111 - websockets.server - INFO - connection closed
2025-06-28 11:00:25,112 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:00:25,112 - websockets.server - INFO - connection closed
2025-06-28 11:00:34,798 - core.toolscore.mcp_server - INFO - [deepsearch_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 11:00:34,800 - core.toolscore.mcp_server - INFO - [deepsearch_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 11:00:34,800 - core.toolscore.mcp_server - INFO - [deepsearch_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "7739f389-758f-4333-a9d9-a0d2ee623636", "tool_spec": {"tool_id": "deepsearch", "name": "deepsearch_server", "description": "\u4e13\u4e1a\u7ea7\u6df1\u5ea6\u641c\u7d22\u548c\u7814\u7a76\u5de5\u5177\u670d\u52a1\u5668\uff0c\u57fa\u4e8eLangGraph\u5b9e\u73b0\u7684\u591a\u8f6e\u8fed\u4ee3\u641c\u7d22\u4ee3\u7406", "tool_type": "mcp_server", "capabilities": [{"name": "research", "description": "\u6267\u884c\u4e13\u4e1a\u7ea7\u6df1\u5ea6\u7814\u7a76\uff0c\u83b7\u53d6\u8be6\u7ec6\u8c03\u7814\u4fe1\u606f", "parameters": {"question": {"type": "string", "description": "\u8981\u7814\u7a76\u7684\u95ee\u9898\u6216\u4e3b\u9898", "required": true}, "research_depth": {"type": "string", "description": "\u7814\u7a76\u6df1\u5ea6: quick/standard/comprehensive", "required": false}, "max_iterations": {"type": "integer", "description": "\u6700\u5927\u8fed\u4ee3\u6b21\u6570", "required": false}}, "examples": [], "category": "general"}, {"name": "quick_research", "description": "\u6267\u884c\u5feb\u901f\u7814\u7a76\uff0c\u9002\u7528\u4e8e\u9700\u8981\u5feb\u901f\u83b7\u53d6\u57fa\u7840\u4fe1\u606f\u7684\u573a\u666f", "parameters": {"question": {"type": "string", "description": "\u8981\u7814\u7a76\u7684\u95ee\u9898\u6216\u4e3b\u9898", "required": true}}, "examples": [], "category": "general"}, {"name": "comprehensive_research", "description": "\u6267\u884c\u5168\u9762\u6df1\u5ea6\u7814\u7a76\uff0c\u9002\u7528\u4e8e\u9700\u8981\u8be6\u7ec6\u3001\u4e13\u4e1a\u7ea7\u8c03\u7814\u4fe1\u606f\u7684\u573a\u666f", "parameters": {"question": {"type": "string", "description": "\u8981\u7814\u7a76\u7684\u95ee\u9898\u6216\u4e3b\u9898", "required": true}, "topic_focus": {"type": "string", "description": "\u53ef\u9009\u7684\u4e3b\u9898\u7126\u70b9\uff0c\u7528\u4e8e\u5f15\u5bfc\u7814\u7a76\u65b9\u5411", "required": false}}, "examples": [], "category": "general"}, {"name": "get_health_status", "description": "\u83b7\u53d6\u7cfb\u7edf\u5065\u5eb7\u72b6\u6001\u548c\u6027\u80fd\u6307\u6807", "parameters": {}, "examples": [], "category": "general"}, {"name": "get_optimization_stats", "description": "\u83b7\u53d6\u8bf7\u6c42\u4f18\u5316\u7edf\u8ba1\u4fe1\u606f", "parameters": {}, "examples": [], "category": "general"}], "endpoint": "ws://localhost:8086/mcp", "connection_params": {}}}
2025-06-28 11:00:34,800 - core.toolscore.mcp_server - INFO - [deepsearch_server] Waiting for registration response from toolscore...
2025-06-28 11:00:34,801 - core.toolscore.mcp_server - INFO - [deepsearch_server] Received registration response: {"type": "register_tool_response", "request_id": "7739f389-758f-4333-a9d9-a0d2ee623636", "success": true, "message": null}
2025-06-28 11:00:34,801 - core.toolscore.mcp_server - INFO - [deepsearch_server] Successfully registered with toolscore.
2025-06-28 11:00:54,504 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:00:54,504 - websockets.server - INFO - connection closed
2025-06-28 11:01:24,509 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:01:24,509 - websockets.server - INFO - connection closed
2025-06-28 11:01:54,516 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:01:54,516 - websockets.server - INFO - connection closed
2025-06-28 11:02:24,518 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:02:24,519 - websockets.server - INFO - connection closed
2025-06-28 11:02:54,521 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:02:54,521 - websockets.server - INFO - connection closed

2025-06-28 11:03:13,552 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
[2025-06-28 11:03:13] INFO:     Shutting down
2025-06-28 11:03:13,588 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 收到停止信号，正在清理资源...
[2025-06-28 11:03:13] ✅ 进程清理完成
[2025-06-28 11:03:13] INFO:     Waiting for application shutdown.
[2025-06-28 11:03:13] INFO:     Application shutdown complete.
[2025-06-28 11:03:13] INFO:     Finished server process [72140]
2025-06-28 11:03:13,682 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:03:13,682 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:03:13,682 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:03:13,682 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:03:13,682 - services.mcp_server_launcher - INFO - MCP服务器已经停止: microsandbox_server
2025-06-28 11:03:13,682 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:03:13,683 - services.mcp_server_launcher - INFO - MCP服务器已经停止: search_tool_server
2025-06-28 11:03:13,683 - services.mcp_server_launcher - INFO - 停止MCP服务器: browser_use_server
2025-06-28 11:03:13,683 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 收到停止信号，正在清理资源...
2025-06-28 11:03:14,135 - services.synthesis_service - ERROR - ❌ SynthesisCore v2.0监控器启动失败: 'NoneType' object has no attribute 'stop_monitoring'
2025-06-28 11:03:14,136 - services.synthesis_service - INFO - SynthesisCore v2.0监控器工作线程已停止
[2025-06-28 11:03:15] ✅ 端口 8088 空闲
[2025-06-28 11:03:15] ✅ 端口 8089 空闲
[2025-06-28 11:03:15] ✅ 端口 8090 空闲
[2025-06-28 11:03:15] ✅ 端口 8091 空闲
[2025-06-28 11:03:15] ✅ 端口 8092 空闲
[2025-06-28 11:03:15] ✅ 端口 5555 空闲
[2025-06-28 11:03:15] 🔥 强制清理端口 8081 的进程 72140
[2025-06-28 11:03:15] ✅ 端口 8082 空闲
[2025-06-28 11:03:15] ✅ 端口 8080 空闲
[2025-06-28 11:03:15] 🔥 强制清理端口 8084 的进程 72187
[2025-06-28 11:03:15] ✅ 端口 8085 空闲
[2025-06-28 11:03:15] ✅ 端口 8086 空闲
[2025-06-28 11:03:15] ✅ 端口 8087 空闲
[2025-06-28 11:03:15] ✅ 端口 8000 空闲
[2025-06-28 11:03:16] ✅ 增强端口清理完成
2025-06-28 11:03:16,976 - __main__ - INFO - === Agent Data Platform 启动中 ===
2025-06-28 11:03:16,976 - __main__ - DEBUG - 🔧 开始系统初始化流程...
2025-06-28 11:03:16,978 - __main__ - DEBUG - 📝 命令行参数: {'config_dir': 'config', 'debug': False, 'start_services': False}
2025-06-28 11:03:16,978 - __main__ - DEBUG - 🔧 步骤1: 初始化ConfigManager...
2025-06-28 11:03:16,979 - __main__ - DEBUG - ✅ ConfigManager初始化完成，配置目录: config
2025-06-28 11:03:16,979 - __main__ - DEBUG - 🔧 步骤2: 加载系统配置...
2025-06-28 11:03:16,980 - __main__ - DEBUG - 📡 Redis URL: redis://localhost:6379
2025-06-28 11:03:16,980 - __main__ - DEBUG - 📋 任务文件路径: tasks.jsonl
2025-06-28 11:03:16,986 - core.config_manager - INFO - 路由配置加载成功
2025-06-28 11:03:16,986 - __main__ - DEBUG - 🚦 路由配置加载完成，任务类型映射: {'CODE': 'tasks:reasoning', 'WEB': 'tasks:reasoning', 'REASONING': 'tasks:reasoning', 'RESEARCH': 'tasks:reasoning'}
2025-06-28 11:03:16,986 - __main__ - DEBUG - 📋 队列映射: {<TaskType.CODE: 'code'>: 'tasks:reasoning', <TaskType.WEB: 'web'>: 'tasks:reasoning', <TaskType.REASONING: 'reasoning'>: 'tasks:reasoning', <TaskType.RESEARCH: 'research'>: 'tasks:reasoning'}
2025-06-28 11:03:16,987 - __main__ - DEBUG - 🔧 步骤3: 初始化核心组件...
2025-06-28 11:03:16,987 - __main__ - DEBUG - ✅ EnhancedMetrics初始化完成
2025-06-28 11:03:16,988 - __main__ - DEBUG - ✅ RedisManager初始化完成
2025-06-28 11:03:16,988 - core.toolscore.toolscore_client - INFO - ✅ 增强的ToolScoreClient初始化完成
2025-06-28 11:03:16,990 - core.llm_client - DEBUG - Enriched config with environment variables: ['default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:03:17,106 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:03:17,108 - core.config_manager - INFO - 路由配置加载成功
2025-06-28 11:03:17,108 - core.monitoring.queue_monitor - INFO - ✅ QueueMonitor 配置加载完成
2025-06-28 11:03:17,108 - core.system_monitor - INFO - ✅ SystemMonitor 配置加载完成
2025-06-28 11:03:17,108 - __main__ - DEBUG - 🔧 开始初始化所有服务...
2025-06-28 11:03:17,108 - services.service_manager - INFO - 正在初始化所有服务...
2025-06-28 11:03:17,108 - services.service_manager - INFO - 初始化服务: redis
2025-06-28 11:03:17,109 - services.redis_service - INFO - Redis服务初始化完成，使用注入的RedisManager实例
2025-06-28 11:03:17,109 - services.service_manager - INFO - 初始化服务: toolscore
2025-06-28 11:03:17,109 - services.toolscore_service - INFO - 正在初始化ToolScore服务...
2025-06-28 11:03:17,109 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 11:03:17,109 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 11:03:17,109 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 11:03:17,109 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:03:17,109 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 11:03:17,109 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 11:03:17,109 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 11:03:17,109 - services.toolscore_service - INFO - ToolScore服务初始化完成（异步初始化将在start()中进行）
2025-06-28 11:03:17,109 - services.service_manager - INFO - 初始化服务: task_processing_coordinator
2025-06-28 11:03:17,109 - services.service_manager - INFO - 初始化服务: mcp_servers
2025-06-28 11:03:17,109 - services.mcp_server_launcher - INFO - 正在初始化MCP服务器启动器...
2025-06-28 11:03:17,109 - services.mcp_server_launcher - INFO - MCP服务器启动器初始化完成，配置了 4 个服务器: ['microsandbox_server', 'search_tool_server', 'browser_use_server', 'deepsearch_server']
2025-06-28 11:03:17,109 - services.service_manager - INFO - 初始化服务: task_api
2025-06-28 11:03:17,109 - services.task_api_service - INFO - 正在初始化任务API服务...
2025-06-28 11:03:17,109 - services.task_api_service - INFO - 任务API服务初始化完成
2025-06-28 11:03:17,109 - services.service_manager - INFO - 初始化服务: runtime
2025-06-28 11:03:17,109 - services.runtime_service - INFO - 正在初始化推理运行时服务...
2025-06-28 11:03:17,109 - services.runtime_service - INFO - 创建运行时实例: enhanced-runtime-1
2025-06-28 11:03:17,109 - core.memory_manager - INFO - MemoryManager initialized: use_redis=True, max_entries=1000
2025-06-28 11:03:17,109 - core.step_planner - INFO - StepPlanner initialized with max_steps=10
2025-06-28 11:03:17,109 - runtimes.reasoning.enhanced_runtime - INFO - DEBUG: Loaded toolscore_http_port: 8082, toolscore_mcp_port: 8081
2025-06-28 11:03:17,109 - runtimes.reasoning.enhanced_runtime - INFO - DEBUG: Configured toolscore_websocket_endpoint (using mcp_port): ws://localhost:8081/websocket
2025-06-28 11:03:17,109 - core.toolscore.mcp_client - INFO - Enhanced MCPToolClient initialized for toolscore at ws://localhost:8081/websocket
2025-06-28 11:03:17,109 - core.llm.guardrails_middleware - INFO - 🔧 初始化输入验证Guard...
2025-06-28 11:03:17,111 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:03:17,111 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:03:17,111 - core.llm.guardrails_middleware - INFO - 🔧 初始化输出验证Guard...
2025-06-28 11:03:17,111 - core.llm.guardrails_middleware - INFO - 🔧 使用本地LLM客户端初始化Guard...
2025-06-28 11:03:17,112 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:03:17,113 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:03:17,113 - core.llm.guardrails_middleware - INFO - ✅ 使用LLM的Guard创建成功
2025-06-28 11:03:17,113 - core.llm.guardrails_middleware - INFO - ✅ Guardrails Guards初始化成功
2025-06-28 11:03:17,113 - core.llm.guardrails_middleware - INFO -    - 输入Guard: ✅
2025-06-28 11:03:17,113 - core.llm.guardrails_middleware - INFO -    - 输出Guard: ✅
2025-06-28 11:03:17,113 - core.agents.validation_critic - INFO - 🎯 ValidationCritic Agent初始化完成
2025-06-28 11:03:17,113 - services.runtime_service - INFO - 推理运行时服务初始化完成，创建了 1 个实例
2025-06-28 11:03:17,113 - services.service_manager - INFO - 初始化服务: synthesis
2025-06-28 11:03:17,113 - services.synthesis_service - INFO - 正在初始化合成服务...
2025-06-28 11:03:17,113 - core.llm_client - DEBUG - Enriched config with environment variables: ['redis_url', 'TRAJECTORIES_DIR', 'default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:03:17,145 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:03:17,145 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 11:03:17,145 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 11:03:17,145 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 11:03:17,145 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:03:17,145 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 11:03:17,145 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 11:03:17,145 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 11:03:17,146 - core.synthesiscore.synthesis - INFO - ✅ JSON文件存储初始化完成
2025-06-28 11:03:17,146 - core.synthesiscore.synthesis - INFO - 📋 未发现已处理轨迹记录，从空白状态开始
2025-06-28 11:03:17,146 - core.llm_client - DEBUG - Enriched config with environment variables: ['redis_url', 'TRAJECTORIES_DIR', 'default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:03:17,177 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:03:17,177 - core.toolscore.mcp_client - INFO - Enhanced MCPToolClient initialized for toolscore at ws://localhost:8089/websocket
2025-06-28 11:03:17,180 - core.synthesiscore.config_loader - INFO - ✅ SynthesisCore配置加载成功: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/config/synthesiscore_config.yaml
2025-06-28 11:03:17,180 - core.synthesiscore.trajectory_monitor - INFO - 🔧 TrajectoryMonitor初始化完成
2025-06-28 11:03:17,180 - core.synthesiscore.trajectory_monitor - INFO - 📂 监控目录: output/trajectories
2025-06-28 11:03:17,180 - core.synthesiscore.trajectory_monitor - INFO - 📝 种子文件: output/trajectories/../seed_tasks.jsonl
2025-06-28 11:03:17,180 - services.synthesis_service - INFO - ✅ TrajectoryMonitor v2.0 初始化完成
2025-06-28 11:03:17,180 - services.synthesis_service - INFO - 合成服务初始化完成，轨迹目录: output/trajectories
2025-06-28 11:03:17,180 - __main__ - DEBUG - ✅ 所有服务初始化完成
2025-06-28 11:03:17,180 - __main__ - DEBUG - 🚀 开始启动所有服务...
2025-06-28 11:03:17,180 - services.service_manager - INFO - 正在启动所有服务...
2025-06-28 11:03:17,180 - services.service_manager - INFO - 启动服务: redis
2025-06-28 11:03:17,180 - services.redis_service - INFO - Redis客户端已就绪
2025-06-28 11:03:17,180 - services.service_manager - INFO - 启动服务: toolscore
2025-06-28 11:03:17,180 - services.toolscore_service - INFO - 正在启动ToolScore服务...
2025-06-28 11:03:17,180 - services.toolscore_service - INFO - 正在初始化工具库...
2025-06-28 11:03:17,180 - services.toolscore_service - INFO - 工具库初始化将在ToolScore MCP服务器线程中进行。
2025-06-28 11:03:17,180 - services.toolscore_service - INFO - 正在启动ToolScore HTTP API...
2025-06-28 11:03:17,189 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:03:17,189 - services.toolscore_service - INFO - ToolScore HTTP API已启动于端口: 8082
2025-06-28 11:03:17,190 - services.toolscore_service - INFO - ToolScore MCP 服务器不进行端口自动检测，使用配置端口: 8081
2025-06-28 11:03:17,190 - services.toolscore_service - INFO - ToolScore MCP server configured to use host: 0.0.0.0, port: 8081, path: /websocket
2025-06-28 11:03:17,190 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 11:03:17,190 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 11:03:17,190 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 11:03:17,190 - core.toolscore.monitoring_api - INFO - ToolScore monitoring API started on port 8082
2025-06-28 11:03:17,190 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:03:17,190 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 11:03:17,190 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 11:03:17,190 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 11:03:17,190 - services.toolscore_service - INFO - Starting ToolScore MCP server thread...
2025-06-28 11:03:17,190 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:03:17,190 - services.toolscore_service - INFO - ToolScore MCP server thread started, is_alive: True
2025-06-28 11:03:17,190 - services.toolscore_service - INFO - ToolScore MCP服务器启动线程已启动，等待就绪信号...
2025-06-28 11:03:17,190 - core.toolscore.mcp_server - INFO - Attempting to start toolscore MCP Server on 0.0.0.0:8081
2025-06-28 11:03:17,190 - services.service_manager - INFO - 启动服务: task_processing_coordinator
2025-06-28 11:03:17,190 - core.dispatcher_enhanced - INFO - ✅ TaskProcessingCoordinator 配置加载完成 - 队列映射: {<TaskType.CODE: 'code'>: 'tasks:reasoning', <TaskType.WEB: 'web'>: 'tasks:reasoning', <TaskType.REASONING: 'reasoning'>: 'tasks:reasoning', <TaskType.RESEARCH: 'research'>: 'tasks:reasoning'}
2025-06-28 11:03:17,190 - services.service_manager - INFO - 启动服务: mcp_servers
2025-06-28 11:03:17,190 - services.mcp_server_launcher - INFO - 正在启动MCP服务器...
2025-06-28 11:03:17,190 - services.mcp_server_launcher - INFO - 正在并行启动 4 个MCP服务器...
2025-06-28 11:03:17,191 - core.dispatcher_enhanced - INFO - 启动任务处理协调器...
2025-06-28 11:03:17,191 - websockets.server - INFO - server listening on 0.0.0.0:8081
2025-06-28 11:03:17,191 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:03:17,191 - core.toolscore.mcp_server - INFO - [toolscore] Initializing UnifiedToolLibrary...
2025-06-28 11:03:17,191 - core.toolscore.core_manager - INFO - 🚀 正在初始化增强的CoreManager...
2025-06-28 11:03:17,191 - core.toolscore.core_manager - INFO - 🔄 使用v2.0服务容器架构初始化...
2025-06-28 11:03:17,191 - core.toolscore.enhanced_core_manager_v2 - INFO - 🚀 初始化增强核心管理器 v2.0...
2025-06-28 11:03:17,191 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:03:17,191 - core.toolscore.service_container.mcp_service_container - INFO - 🚀 开始初始化MCP服务容器...
2025-06-28 11:03:17,191 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:03:17,191 - core.toolscore.service_container.mcp_service_container - INFO - 🔍 发现内置MCP服务...
2025-06-28 11:03:17,191 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:03:17,191 - core.toolscore.service_container.builtin_discovery - INFO - 🔍 开始发现内置MCP服务: mcp_servers
2025-06-28 11:03:17,191 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:03:17,191 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:03:17,191 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:03:17,191 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:03:17,191 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:03:17,191 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:03:17,191 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: Search Tool MCP Server
2025-06-28 11:03:17,191 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:03:17,191 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:03:17,191 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:03:17,194 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: MicroSandbox MCP Server
2025-06-28 11:03:17,194 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 72529)
2025-06-28 11:03:17,194 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 跳过 __pycache__: 缺少main.py文件
2025-06-28 11:03:17,194 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:03:17,194 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:03:17,194 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:03:17,194 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:03:17,195 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: Browser Use MCP Server
2025-06-28 11:03:17,195 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:03:17,195 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:03:17,195 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:03:17,195 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:03:17,195 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:03:17,195 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:03:17,195 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: DeepSearch MCP Server
2025-06-28 11:03:17,195 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:03:17,195 - core.toolscore.service_container.builtin_discovery - INFO - 🎯 内置服务发现完成，共发现 4 个服务
2025-06-28 11:03:17,195 - core.toolscore.service_container.builtin_discovery - INFO - 📝 创建服务配置文件...
2025-06-28 11:03:17,195 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:03:17,195 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/search_tool_server/service.json
2025-06-28 11:03:17,195 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/microsandbox_server/service.json
2025-06-28 11:03:17,195 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:03:17,195 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/browser_use_server/service.json
2025-06-28 11:03:17,195 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/deepsearch_server/service.json
2025-06-28 11:03:17,195 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 发现 4 个内置服务
2025-06-28 11:03:17,195 - core.toolscore.service_container.mcp_service_container - INFO - 📂 加载已安装的外部服务...
2025-06-28 11:03:17,195 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 加载 0 个外部服务
2025-06-28 11:03:17,195 - core.toolscore.service_container.mcp_service_container - INFO - 📋 构建统一服务目录...
2025-06-28 11:03:17,195 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 服务目录构建完成，共 4 个服务
2025-06-28 11:03:17,195 - core.toolscore.service_container.mcp_service_container - INFO - 📋 标记内置服务为启动中状态...
2025-06-28 11:03:17,195 - core.toolscore.service_container.mcp_service_container - INFO - 📋 已标记 4 个内置服务为启动中状态
2025-06-28 11:03:17,195 - core.toolscore.service_container.service_monitor - INFO - 🔍 启动服务监控...
2025-06-28 11:03:17,195 - core.toolscore.service_container.mcp_service_container - INFO - ✅ MCP服务容器初始化完成
2025-06-28 11:03:17,195 - core.toolscore.enhanced_core_manager_v2 - INFO - ✅ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:03:17,196 - core.toolscore.core_manager - INFO - ✅ v2.0架构初始化完成
2025-06-28 11:03:17,196 - core.toolscore.tool_registry - INFO - Tool registry initialized
2025-06-28 11:03:17,196 - core.llm_client - DEBUG - Enriched config with environment variables: ['provider', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:03:17,196 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:03:17,196 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:03:17,196 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:03:17,196 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:03:17,199 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 72530)
2025-06-28 11:03:17,200 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:03:17,210 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: browser_use_server
2025-06-28 11:03:17,210 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:03:17,210 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: browser_use_server
2025-06-28 11:03:17,210 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server
2025-06-28 11:03:17,210 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) = True
2025-06-28 11:03:17,210 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) = True
2025-06-28 11:03:17,210 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) contents: ['service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:03:17,210 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server/main.py
2025-06-28 11:03:17,210 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:03:17,210 - services.mcp_server_launcher - INFO - [MCP启动器] 为 browser_use_server 使用配置文件指定端口: 8084
2025-06-28 11:03:17,210 - services.mcp_server_launcher - INFO - [MCP启动器] 为 browser_use_server 使用配置文件指定端口: 8084
2025-06-28 11:03:17,210 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 BROWSER_USE_SERVER_PORT=8084 给 browser_use_server
2025-06-28 11:03:17,210 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.browser_use_server.main
2025-06-28 11:03:17,210 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:03:17,213 - services.mcp_server_launcher - INFO - MCP服务器已启动: browser_use_server (PID: 72531)
2025-06-28 11:03:17,213 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 browser_use_server 就绪状态...
2025-06-28 11:03:17,215 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:03:17,215 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:03:17,215 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:03:17,215 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:03:17,215 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:03:17,215 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:03:17,215 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:03:17,215 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:03:17,215 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:03:17,215 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:03:17,216 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:03:17,216 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:03:17,216 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:03:17,216 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:03:17,219 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 72532)
2025-06-28 11:03:17,219 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:03:17,220 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第1次, 5s间隔)
2025-06-28 11:03:17,220 - core.monitoring.queue_monitor - INFO - 启动队列监控器...
2025-06-28 11:03:17,222 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:03:17,222 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:03:17,223 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:03:17,223 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:03:17,223 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:03:17,223 - websockets.client - DEBUG - > Sec-WebSocket-Key: JDmuHjurkCDrhWjahLf3+A==
2025-06-28 11:03:17,223 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:03:17,223 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:03:17,223 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:03:17,223 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:03:17,223 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:03:17,223 - websockets.client - DEBUG - > Host: localhost:8084
2025-06-28 11:03:17,223 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:03:17,223 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:03:17,223 - websockets.client - DEBUG - > Sec-WebSocket-Key: eI2rkzDERuL+5b7EElKbjw==
2025-06-28 11:03:17,223 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:03:17,223 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:03:17,223 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:03:17,223 - websockets.client - DEBUG - > EOF
2025-06-28 11:03:17,223 - websockets.client - DEBUG - < EOF
2025-06-28 11:03:17,223 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:03:17,223 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:03:17,223 - websockets.client - DEBUG - > EOF
2025-06-28 11:03:17,223 - websockets.client - DEBUG - < EOF
2025-06-28 11:03:17,223 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:03:17,225 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:03:17,226 - services.mcp_server_launcher - DEBUG - 📋 browser_use_server 端口 8084 尚未就绪
2025-06-28 11:03:17,226 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:03:17,245 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:03:17,245 - core.toolscore.tool_gap_detector - INFO - 智能工具缺口检测器初始化 - 统一版本
2025-06-28 11:03:17,246 - core.toolscore.dynamic_mcp_manager - INFO - Dynamic MCP Manager initialized (ProcessRunner mode)
2025-06-28 11:03:17,246 - core.toolscore.dynamic_mcp_manager - INFO - 启动动态MCP管理器...
2025-06-28 11:03:17,246 - core.toolscore.dynamic_mcp_manager - INFO - 持久化配置为空，无需恢复外部MCP服务器
2025-06-28 11:03:17,246 - core.toolscore.dynamic_mcp_manager - INFO - 动态MCP管理器启动完成
2025-06-28 11:03:17,246 - core.toolscore.mcp_search_tool - INFO - ✅ MCP Search Tool initialized - 优化版本，包含失败工具跟踪
2025-06-28 11:03:17,246 - core.toolscore.unified_tool_library - INFO - Tool library initialization completed - 核心管理器模式
2025-06-28 11:03:17,246 - core.toolscore.mcp_server - INFO - [toolscore] UnifiedToolLibrary initialized.
2025-06-28 11:03:17,246 - core.toolscore.mcp_server - INFO - [toolscore] Auto-registering MCP servers...
2025-06-28 11:03:17,246 - core.toolscore.mcp_auto_registration - INFO - 🔍 开始自动发现和注册MCP服务器...
2025-06-28 11:03:17,246 - core.toolscore.mcp_auto_registration - DEBUG - ⚠️ 服务器目录 __pycache__ 缺少 service.json
2025-06-28 11:03:17,247 - core.toolscore.mcp_auto_registration - INFO - 🎯 发现 4 个MCP服务器
2025-06-28 11:03:17,261 - core.unified_tool_manager - DEBUG - ✅ 配置验证通过
2025-06-28 11:03:17,261 - core.unified_tool_manager - INFO - 🔄 成功加载工具配置: 4 个标准工具
2025-06-28 11:03:17,261 - core.unified_tool_manager - DEBUG -    - 标准工具ID: ['browser_use', 'deepsearch', 'mcp-search-tool', 'microsandbox']
2025-06-28 11:03:17,261 - core.unified_tool_manager - DEBUG -    - 兼容映射: 13 个变体
2025-06-28 11:03:17,261 - core.unified_tool_manager - INFO - ✅ 统一工具管理器初始化完成，管理 4 个工具
2025-06-28 11:03:17,261 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: mcp-search-tool
2025-06-28 11:03:17,261 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: Search Tool MCP Server (ID: mcp-search-tool)
2025-06-28 11:03:17,261 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: Search Tool MCP Server (ID: mcp-search-tool)
2025-06-28 11:03:17,261 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: Search Tool MCP Server
2025-06-28 11:03:17,261 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8080/websocket
2025-06-28 11:03:17,261 - core.toolscore.mcp_connector - INFO - Registered MCP server mcp-search-tool at ws://localhost:8080/websocket
2025-06-28 11:03:17,261 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: mcp-search-tool -> ws://localhost:8080/websocket
2025-06-28 11:03:17,261 - core.toolscore.core_manager - INFO - 工具立即可用: mcp-search-tool
2025-06-28 11:03:17,261 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: mcp-search-tool
2025-06-28 11:03:17,261 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: microsandbox
2025-06-28 11:03:17,261 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: MicroSandbox MCP Server (ID: microsandbox)
2025-06-28 11:03:17,261 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: MicroSandbox MCP Server (ID: microsandbox)
2025-06-28 11:03:17,261 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: MicroSandbox MCP Server
2025-06-28 11:03:17,261 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8090/websocket
2025-06-28 11:03:17,261 - core.toolscore.mcp_connector - INFO - Registered MCP server microsandbox at ws://localhost:8090/websocket
2025-06-28 11:03:17,261 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: microsandbox -> ws://localhost:8090/websocket
2025-06-28 11:03:17,261 - core.toolscore.core_manager - INFO - 工具立即可用: microsandbox
2025-06-28 11:03:17,261 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: microsandbox
2025-06-28 11:03:17,261 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: browser_use
2025-06-28 11:03:17,261 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: Browser Use MCP Server (ID: browser_use)
2025-06-28 11:03:17,261 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: Browser Use MCP Server (ID: browser_use)
2025-06-28 11:03:17,261 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: Browser Use MCP Server
2025-06-28 11:03:17,261 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8084/websocket
2025-06-28 11:03:17,261 - core.toolscore.mcp_connector - INFO - Registered MCP server browser_use at ws://localhost:8084/websocket
2025-06-28 11:03:17,261 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: browser_use -> ws://localhost:8084/websocket
2025-06-28 11:03:17,261 - core.toolscore.core_manager - INFO - 工具立即可用: browser_use
2025-06-28 11:03:17,261 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: browser_use
2025-06-28 11:03:17,261 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: deepsearch
2025-06-28 11:03:17,261 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: DeepSearch MCP Server (ID: deepsearch)
2025-06-28 11:03:17,261 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: DeepSearch MCP Server (ID: deepsearch)
2025-06-28 11:03:17,261 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: DeepSearch MCP Server
2025-06-28 11:03:17,261 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8086/websocket
2025-06-28 11:03:17,261 - core.toolscore.mcp_connector - INFO - Registered MCP server deepsearch at ws://localhost:8086/websocket
2025-06-28 11:03:17,261 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: deepsearch -> ws://localhost:8086/websocket
2025-06-28 11:03:17,262 - core.toolscore.core_manager - INFO - 工具立即可用: deepsearch
2025-06-28 11:03:17,262 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: deepsearch
2025-06-28 11:03:17,262 - core.toolscore.mcp_auto_registration - INFO - 📊 MCP服务器注册完成: 4/4 成功
2025-06-28 11:03:17,262 - core.toolscore.mcp_server - INFO - [toolscore] All MCP servers registered successfully.
2025-06-28 11:03:17,262 - core.toolscore.mcp_server - INFO - toolscore MCP Server started successfully on 0.0.0.0:8081 (Original endpoint: ws://0.0.0.0:8081/websocket) with ping_interval=30, ping_timeout=60
2025-06-28 11:03:17,262 - core.toolscore.mcp_server - INFO - toolscore MCP Server started event set.
2025-06-28 11:03:17,262 - core.toolscore.service_container.service_monitor - INFO - 🔄 开始服务监控循环，检查间隔: 30秒
2025-06-28 11:03:17,274 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [browser_use] BrowserUse logging setup complete with level info
2025-06-28 11:03:17,648 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [root] Anonymized telemetry enabled. See https://docs.browser-use.com/development/telemetry for more information.
2025-06-28 11:03:17,771 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.llm_client] Initialized LLM client with provider: gemini
2025-06-28 11:03:17,771 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Browser-Use server initialized with LLM provider: gemini
2025-06-28 11:03:17,771 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 使用动态分配端口: 8084
2025-06-28 11:03:17,771 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] BrowserUseMCPServer initialized:
2025-06-28 11:03:17,771 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Server Name: browser_use_server
2025-06-28 11:03:17,771 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Server ID: browser_use
2025-06-28 11:03:17,771 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Listen Host: 0.0.0.0
2025-06-28 11:03:17,771 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Listen Port: 8084
2025-06-28 11:03:17,771 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Public Endpoint: ws://localhost:8084
2025-06-28 11:03:17,771 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:03:17,771 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Starting browser_use_server...
2025-06-28 11:03:17,772 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Attempting to start MCPServer for browser_use_server at ws://localhost:8084...
2025-06-28 11:03:17,772 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Attempting to start browser_use_server MCP Server on localhost:8084
2025-06-28 11:03:17,779 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] server listening on [::1]:8084
2025-06-28 11:03:17,779 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] server listening on 127.0.0.1:8084
2025-06-28 11:03:17,779 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] browser_use_server MCP Server started successfully on localhost:8084 (Original endpoint: ws://localhost:8084) with ping_interval=30, ping_timeout=60
2025-06-28 11:03:17,779 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:03:17,796 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:03:17,796 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:03:17,828 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:03:17,828 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:03:17,828 - websockets.client - DEBUG - > Host: localhost:8084
2025-06-28 11:03:17,828 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:03:17,828 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:03:17,828 - websockets.client - DEBUG - > Sec-WebSocket-Key: mfGSEqWKt67HkCvYOrOoBg==
2025-06-28 11:03:17,828 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:03:17,828 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:03:17,829 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:03:17,829 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:03:17,829 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:03:17,829 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:03:17,829 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:03:17,829 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:03:17,829 - websockets.client - DEBUG - > Sec-WebSocket-Key: 8817BMPuzbm+LouQaEJP5A==
2025-06-28 11:03:17,829 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:03:17,829 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:03:17,829 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:03:17,829 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection open
2025-06-28 11:03:17,829 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Client connected to browser_use_server MCP Server at path /: ('127.0.0.1', 61256)
2025-06-28 11:03:17,829 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:03:17,829 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:03:17,829 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:03:17,829 - websockets.client - DEBUG - < Sec-WebSocket-Accept: nuaX9qciL85MJcp64ep8G3JBAsk=
2025-06-28 11:03:17,829 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:03:17,829 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:03:17 GMT
2025-06-28 11:03:17,829 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:03:17,829 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:03:17,830 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:03:17,830 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:03:17,830 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:03:17,830 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:03:17,830 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:03:17,830 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:03:17,830 - websockets.client - DEBUG - < Sec-WebSocket-Accept: f4VQ63qAUiMwXtf+Z4Cpv4wK0vM=
2025-06-28 11:03:17,830 - services.mcp_server_launcher - DEBUG - [browser_use_server] WARNING  [core.toolscore.mcp_server] Unknown request type or server role mismatch: ping
2025-06-28 11:03:17,830 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:03:17,830 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:03:17 GMT
2025-06-28 11:03:17,830 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:03:17,830 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:03:17,830 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:03:17,830 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:03:17,830 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:03:17,830 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:03:17,831 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:03:17,831 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:03:17,831 - websockets.client - DEBUG - < EOF
2025-06-28 11:03:17,831 - websockets.client - DEBUG - > EOF
2025-06-28 11:03:17,831 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:03:17,831 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:03:17,831 - services.mcp_server_launcher - DEBUG - ✅ browser_use_server 特定就绪检查通过
2025-06-28 11:03:17,831 - services.mcp_server_launcher - INFO - ✅ browser_use_server 已就绪
2025-06-28 11:03:17,831 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:03:17,831 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:03:17,831 - websockets.client - DEBUG - < EOF
2025-06-28 11:03:17,831 - websockets.client - DEBUG - > EOF
2025-06-28 11:03:17,831 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:03:17,831 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:03:17,831 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:03:17,831 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:03:17,832 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:03:17,832 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:03:18,517 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:03:18,518 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:03:18,833 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:03:19,384 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:03:19,384 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:03:20,423 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:03:20,423 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:03:21,669 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:03:21,670 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:03:22,221 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第2次, 5s间隔)
2025-06-28 11:03:23,165 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:03:23,165 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:03:24,959 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:03:24,959 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:03:27,111 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:03:27,112 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:03:27,223 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第3次, 5s间隔)
2025-06-28 11:03:27,363 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:03:27,364 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:03:27,365 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:03:27,365 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:03:27,365 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:03:27,365 - websockets.server - DEBUG - < Sec-WebSocket-Key: fh6Hidtj/9FM6qE5lG+lQQ==
2025-06-28 11:03:27,365 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:03:27,365 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:03:27,365 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:03:27,365 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:03:27,365 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:03:27,365 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:03:27,365 - websockets.server - DEBUG - > Sec-WebSocket-Accept: gbeAZGGbH2TqlJP9dv+vrbSCWGY=
2025-06-28 11:03:27,365 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:03:27,365 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:03:27 GMT
2025-06-28 11:03:27,366 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:03:27,366 - websockets.server - INFO - connection open
2025-06-28 11:03:27,366 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:03:27,366 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 61281)
2025-06-28 11:03:27,367 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "ba43a3...onnection_params": {}}}' [2376 bytes]
2025-06-28 11:03:27,368 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: search_tool_server (ID: mcp-search-tool)
2025-06-28 11:03:27,368 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: search_tool_server
2025-06-28 11:03:27,368 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: mcp-search-tool -> ws://localhost:8080/mcp
2025-06-28 11:03:27,368 - core.toolscore.core_manager - INFO - 工具立即可用: mcp-search-tool
2025-06-28 11:03:27,368 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 11:03:27,369 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:03:27,369 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 11:03:27,369 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:03:27,370 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 11:03:27,370 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 11:03:27,371 - websockets.server - INFO - connection closed
2025-06-28 11:03:27,464 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:03:27,465 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:03:27,465 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:03:27,465 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:03:27,466 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:03:27,466 - websockets.server - DEBUG - < Sec-WebSocket-Key: 4u82Pk1g8jaJONSQWlPXmA==
2025-06-28 11:03:27,466 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:03:27,466 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:03:27,466 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:03:27,466 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:03:27,466 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:03:27,466 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:03:27,466 - websockets.server - DEBUG - > Sec-WebSocket-Accept: 2xXiEYqkQaH6owR6xABUKF5MTFk=
2025-06-28 11:03:27,466 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:03:27,466 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:03:27 GMT
2025-06-28 11:03:27,466 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:03:27,466 - websockets.server - INFO - connection open
2025-06-28 11:03:27,466 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:03:27,467 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 61283)
2025-06-28 11:03:27,468 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "00b194...onnection_params": {}}}' [3263 bytes]
2025-06-28 11:03:27,468 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: microsandbox_server (ID: microsandbox)
2025-06-28 11:03:27,468 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: microsandbox_server
2025-06-28 11:03:27,468 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: microsandbox -> ws://localhost:8090
2025-06-28 11:03:27,468 - core.toolscore.core_manager - INFO - 工具立即可用: microsandbox
2025-06-28 11:03:27,468 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 11:03:27,469 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:03:27,469 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 11:03:27,469 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:03:27,469 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 11:03:27,469 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 11:03:27,470 - websockets.server - INFO - connection closed
2025-06-28 11:03:27,512 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:03:27,513 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:03:27,513 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:03:27,513 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:03:27,513 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:03:27,513 - websockets.server - DEBUG - < Sec-WebSocket-Key: mKQcriKq9tYNmJnB0OhHYA==
2025-06-28 11:03:27,513 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:03:27,513 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:03:27,513 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:03:27,513 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:03:27,513 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:03:27,513 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:03:27,513 - websockets.server - DEBUG - > Sec-WebSocket-Accept: GQdE4zFFR5vUDD0bSe0RrcmYHNY=
2025-06-28 11:03:27,514 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:03:27,514 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:03:27 GMT
2025-06-28 11:03:27,514 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:03:27,514 - websockets.server - INFO - connection open
2025-06-28 11:03:27,514 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:03:27,514 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 61285)
2025-06-28 11:03:27,515 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "44db19...onnection_params": {}}}' [2313 bytes]
2025-06-28 11:03:27,515 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: deepsearch_server (ID: deepsearch)
2025-06-28 11:03:27,515 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: deepsearch_server
2025-06-28 11:03:27,515 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: deepsearch -> ws://localhost:8086/mcp
2025-06-28 11:03:27,515 - core.toolscore.core_manager - INFO - 工具立即可用: deepsearch
2025-06-28 11:03:27,516 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 11:03:27,516 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:03:27,516 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 11:03:27,516 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:03:27,516 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 11:03:27,517 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 11:03:27,517 - websockets.server - INFO - connection closed
2025-06-28 11:03:27,781 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 11:03:27,783 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:03:27,784 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:03:27,784 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:03:27,784 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:03:27,784 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:03:27,784 - websockets.server - DEBUG - < Sec-WebSocket-Key: 2fTLsJqiqwXjwmTFc9y/Zw==
2025-06-28 11:03:27,784 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:03:27,784 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:03:27,784 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:03:27,785 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:03:27,785 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:03:27,785 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:03:27,785 - websockets.server - DEBUG - > Sec-WebSocket-Accept: V/0PVswOqGiRKs6kgioMnUbB1wU=
2025-06-28 11:03:27,785 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:03:27,785 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:03:27 GMT
2025-06-28 11:03:27,785 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:03:27,785 - websockets.server - INFO - connection open
2025-06-28 11:03:27,785 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:03:27,785 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 61287)
2025-06-28 11:03:27,786 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 11:03:27,786 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "4f320bbd-0660-4832-97e4-6149eb1dac5c", "tool_spec": {"tool_id": "browser_use", "name": "browser_use_server", "description": "\u57fa\u4e8eBrowser-Use\u7684AI\u6d4f\u89c8\u5668\u81ea\u52a8\u5316\u670d\u52a1\u5668\uff0c\u5b8c\u6574\u5b9e\u73b0browser-use\u7684\u6240\u6709\u529f\u80fd", "tool_type": "mcp_server", "capabilities": [{"name": "browser_use_execute_task", "description": "\u4f7f\u7528AI\u6267\u884c\u590d\u6742\u7684\u6d4f\u89c8\u5668\u4efb\u52a1\uff0c\u652f\u6301\u81ea\u7136\u8bed\u8a00\u63cf\u8ff0", "parameters": {"task": {"type": "string", "description": "\u8981\u6267\u884c\u7684\u4efb\u52a1\u63cf\u8ff0\uff0c\u4f7f\u7528\u81ea\u7136\u8bed\u8a00", "required": true}, "max_steps": {"type": "integer", "description": "\u6700\u5927\u6267\u884c\u6b65\u9aa4\u6570\uff0c\u9ed8\u8ba450", "required": false}, "use_vision": {"type": "boolean", "description": "\u662f\u5426\u4f7f\u7528\u89c6\u89c9\u7406\u89e3\uff0c\u9ed8\u8ba4true", "required": false}}, "examples": [{"task": "\u641c\u7d22Python\u6559\u7a0b\u5e76\u6253\u5f00\u7b2c\u4e00\u4e2a\u7ed3\u679c"}, {"task": "\u5728GitHub\u4e0a\u641c\u7d22browser-use\u9879\u76ee\u5e76\u67e5\u770bREADME"}, {"task": "\u767b\u5f55\u7f51\u7ad9\u5e76\u586b\u5199\u8868\u5355", "use_vision": true}], "category": "general"}, {"name": "browser_navigate", "description": "\u5bfc\u822a\u5230\u6307\u5b9a\u7f51\u5740", "parameters": {"url": {"type": "string", "description": "\u8981\u8bbf\u95ee\u7684URL\u5730\u5740", "required": true}}, "examples": [{"url": "https://www.google.com"}, {"url": "https://github.com"}], "category": "general"}, {"name": "browser_search_google", "description": "\u5728Google\u4e2d\u641c\u7d22\u6307\u5b9a\u67e5\u8be2", "parameters": {"query": {"type": "string", "description": "\u641c\u7d22\u67e5\u8be2\u8bcd", "required": true}}, "examples": [{"query": "Python machine learning tutorial"}, {"query": "browser automation tools"}], "category": "general"}, {"name": "browser_go_back", "description": "\u8fd4\u56de\u4e0a\u4e00\u9875", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_click_element", "description": "\u901a\u8fc7\u7d22\u5f15\u70b9\u51fb\u9875\u9762\u5143\u7d20", "parameters": {"index": {"type": "integer", "description": "\u8981\u70b9\u51fb\u7684\u5143\u7d20\u7d22\u5f15", "required": true}}, "examples": [{"index": 1}, {"index": 5}], "category": "general"}, {"name": "browser_input_text", "description": "\u5728\u6307\u5b9a\u5143\u7d20\u4e2d\u8f93\u5165\u6587\u672c", "parameters": {"index": {"type": "integer", "description": "\u8981\u8f93\u5165\u6587\u672c\u7684\u5143\u7d20\u7d22\u5f15", "required": true}, "text": {"type": "string", "description": "\u8981\u8f93\u5165\u7684\u6587\u672c", "required": true}}, "examples": [{"index": 2, "text": "hello world"}, {"index": 0, "text": "test@example.com"}], "category": "general"}, {"name": "browser_send_keys", "description": "\u53d1\u9001\u7279\u6b8a\u952e\u6216\u5feb\u6377\u952e", "parameters": {"keys": {"type": "string", "description": "\u8981\u53d1\u9001\u7684\u952e\uff0c\u5982Enter\u3001Escape\u3001Control+c\u7b49", "required": true}}, "examples": [{"keys": "Enter"}, {"keys": "Control+c"}, {"keys": "Escape"}], "category": "general"}, {"name": "browser_scroll_down", "description": "\u5411\u4e0b\u6eda\u52a8\u9875\u9762", "parameters": {"amount": {"type": "integer", "description": "\u6eda\u52a8\u50cf\u7d20\u6570\uff0c\u4e0d\u6307\u5b9a\u5219\u6eda\u52a8\u4e00\u9875", "required": false}}, "examples": [{}, {"amount": 500}], "category": "general"}, {"name": "browser_scroll_up", "description": "\u5411\u4e0a\u6eda\u52a8\u9875\u9762", "parameters": {"amount": {"type": "integer", "description": "\u6eda\u52a8\u50cf\u7d20\u6570\uff0c\u4e0d\u6307\u5b9a\u5219\u6eda\u52a8\u4e00\u9875", "required": false}}, "examples": [{}, {"amount": 300}], "category": "general"}, {"name": "browser_scroll_to_text", "description": "\u6eda\u52a8\u5230\u5305\u542b\u6307\u5b9a\u6587\u672c\u7684\u5143\u7d20", "parameters": {"text": {"type": "string", "description": "\u8981\u6eda\u52a8\u5230\u7684\u6587\u672c\u5185\u5bb9", "required": true}}, "examples": [{"text": "Sign up"}, {"text": "Contact us"}], "category": "general"}, {"name": "browser_switch_tab", "description": "\u5207\u6362\u5230\u6307\u5b9a\u6807\u7b7e", "parameters": {"page_id": {"type": "integer", "description": "\u8981\u5207\u6362\u5230\u7684\u6807\u7b7eID", "required": true}}, "examples": [{"page_id": 0}, {"page_id": 1}], "category": "general"}, {"name": "browser_open_tab", "description": "\u5728\u65b0\u6807\u7b7e\u4e2d\u6253\u5f00URL", "parameters": {"url": {"type": "string", "description": "\u8981\u5728\u65b0\u6807\u7b7e\u4e2d\u6253\u5f00\u7684URL", "required": true}}, "examples": [{"url": "https://www.example.com"}], "category": "general"}, {"name": "browser_close_tab", "description": "\u5173\u95ed\u6307\u5b9a\u6807\u7b7e", "parameters": {"page_id": {"type": "integer", "description": "\u8981\u5173\u95ed\u7684\u6807\u7b7eID", "required": true}}, "examples": [{"page_id": 1}], "category": "general"}, {"name": "browser_extract_content", "description": "\u4ece\u9875\u9762\u63d0\u53d6\u7279\u5b9a\u5185\u5bb9", "parameters": {"goal": {"type": "string", "description": "\u63d0\u53d6\u76ee\u6807\u63cf\u8ff0", "required": true}, "include_links": {"type": "boolean", "description": "\u662f\u5426\u5305\u542b\u94fe\u63a5\uff0c\u9ed8\u8ba4false", "required": false}}, "examples": [{"goal": "\u63d0\u53d6\u6240\u6709\u516c\u53f8\u540d\u79f0"}, {"goal": "\u83b7\u53d6\u4ea7\u54c1\u4ef7\u683c\u4fe1\u606f", "include_links": true}], "category": "general"}, {"name": "browser_get_content", "description": "\u83b7\u53d6\u9875\u9762\u5185\u5bb9", "parameters": {"selector": {"type": "string", "description": "CSS\u9009\u62e9\u5668\uff0c\u7a7a\u5219\u83b7\u53d6\u5168\u90e8\u5185\u5bb9", "required": false}}, "examples": [{"selector": "h1, p"}, {}], "category": "general"}, {"name": "browser_get_ax_tree", "description": "\u83b7\u53d6\u9875\u9762\u7684\u53ef\u8bbf\u95ee\u6027\u6811\u7ed3\u6784", "parameters": {"number_of_elements": {"type": "integer", "description": "\u8fd4\u56de\u7684\u5143\u7d20\u6570\u91cf", "required": true}}, "examples": [{"number_of_elements": 50}], "category": "general"}, {"name": "browser_get_dropdown_options", "description": "\u83b7\u53d6\u4e0b\u62c9\u83dc\u5355\u7684\u6240\u6709\u9009\u9879", "parameters": {"index": {"type": "integer", "description": "\u4e0b\u62c9\u83dc\u5355\u5143\u7d20\u7684\u7d22\u5f15", "required": true}}, "examples": [{"index": 3}], "category": "general"}, {"name": "browser_select_dropdown_option", "description": "\u9009\u62e9\u4e0b\u62c9\u83dc\u5355\u4e2d\u7684\u9009\u9879", "parameters": {"index": {"type": "integer", "description": "\u4e0b\u62c9\u83dc\u5355\u5143\u7d20\u7684\u7d22\u5f15", "required": true}, "text": {"type": "string", "description": "\u8981\u9009\u62e9\u7684\u9009\u9879\u6587\u672c", "required": true}}, "examples": [{"index": 3, "text": "Option 1"}], "category": "general"}, {"name": "browser_drag_drop", "description": "\u6267\u884c\u62d6\u62fd\u64cd\u4f5c", "parameters": {"element_source": {"type": "string", "description": "\u6e90\u5143\u7d20\u9009\u62e9\u5668", "required": false}, "element_target": {"type": "string", "description": "\u76ee\u6807\u5143\u7d20\u9009\u62e9\u5668", "required": false}, "coord_source_x": {"type": "integer", "description": "\u6e90\u5750\u6807X", "required": false}, "coord_source_y": {"type": "integer", "description": "\u6e90\u5750\u6807Y", "required": false}, "coord_target_x": {"type": "integer", "description": "\u76ee\u6807\u5750\u6807X", "required": false}, "coord_target_y": {"type": "integer", "description": "\u76ee\u6807\u5750\u6807Y", "required": false}, "steps": {"type": "integer", "description": "\u62d6\u62fd\u6b65\u9aa4\u6570\uff0c\u9ed8\u8ba410", "required": false}}, "examples": [{"element_source": ".item1", "element_target": ".dropzone"}], "category": "general"}, {"name": "browser_save_pdf", "description": "\u5c06\u5f53\u524d\u9875\u9762\u4fdd\u5b58\u4e3aPDF", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_screenshot", "description": "\u622a\u53d6\u5f53\u524d\u9875\u9762\u622a\u56fe", "parameters": {"filename": {"type": "string", "description": "\u622a\u56fe\u6587\u4ef6\u540d\uff0c\u53ef\u9009", "required": false}}, "examples": [{"filename": "current_page.png"}, {}], "category": "general"}, {"name": "browser_wait", "description": "\u7b49\u5f85\u6307\u5b9a\u79d2\u6570", "parameters": {"seconds": {"type": "number", "description": "\u7b49\u5f85\u7684\u79d2\u6570\uff0c\u9ed8\u8ba43", "required": false}}, "examples": [{"seconds": 5}, {}], "category": "general"}, {"name": "browser_done", "description": "\u6807\u8bb0\u4efb\u52a1\u5b8c\u6210", "parameters": {"text": {"type": "string", "description": "\u5b8c\u6210\u63cf\u8ff0", "required": true}, "success": {"type": "boolean", "description": "\u662f\u5426\u6210\u529f\u5b8c\u6210", "required": true}}, "examples": [{"text": "\u4efb\u52a1\u5df2\u5b8c\u6210", "success": true}], "category": "general"}, {"name": "browser_get_page_info", "description": "\u83b7\u53d6\u5f53\u524d\u9875\u9762\u4fe1\u606f", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_get_current_url", "description": "\u83b7\u53d6\u5f53\u524d\u9875\u9762URL", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_close_session", "description": "\u5173\u95ed\u6d4f\u89c8\u5668\u4f1a\u8bdd", "parameters": {}, "examples": [{}], "category": "general"}], "endpoint": "ws://localhost:8084", "connection_params": {}}}
2025-06-28 11:03:27,787 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Waiting for registration response from toolscore...
2025-06-28 11:03:27,787 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "4f320b...onnection_params": {}}}' [9625 bytes]
2025-06-28 11:03:27,788 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: browser_use_server (ID: browser_use)
2025-06-28 11:03:27,788 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: browser_use_server
2025-06-28 11:03:27,788 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: browser_use -> ws://localhost:8084
2025-06-28 11:03:27,788 - core.toolscore.core_manager - INFO - 工具立即可用: browser_use
2025-06-28 11:03:27,788 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 11:03:27,789 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Received registration response: {"type": "register_tool_response", "request_id": "4f320bbd-0660-4832-97e4-6149eb1dac5c", "success": true, "message": null}
2025-06-28 11:03:27,789 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Successfully registered with toolscore.
2025-06-28 11:03:27,789 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:03:27,789 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 11:03:27,789 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:03:27,790 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 11:03:27,790 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 11:03:27,790 - websockets.server - INFO - connection closed
2025-06-28 11:03:29,693 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:03:29,694 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:03:32,225 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第4次, 5s间隔)
2025-06-28 11:03:32,696 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:03:32,697 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:03:35,699 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:03:35,700 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:03:37,226 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第5次, 5s间隔)
2025-06-28 11:03:38,701 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:03:38,702 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:03:41,703 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:03:41,703 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:03:42,228 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第6次, 5s间隔)
2025-06-28 11:03:44,704 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:03:44,705 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:03:47,204 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:03:47,219 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:03:47,221 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:03:47,221 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:03:47,221 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:03:47,228 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第7次, 5s间隔)
2025-06-28 11:03:47,706 - services.mcp_server_launcher - DEBUG - ⏱️ microsandbox_server 就绪检测超时 (30秒)
2025-06-28 11:03:47,706 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:03:47,706 - services.mcp_server_launcher - INFO - ✅ 成功启动 4/4 个MCP服务器: ['microsandbox_server', 'search_tool_server', 'browser_use_server', 'deepsearch_server']
2025-06-28 11:03:47,706 - services.service_manager - INFO - 启动服务: task_api
2025-06-28 11:03:47,706 - services.task_api_service - INFO - 正在启动任务API服务...
2025-06-28 11:03:47,724 - services.task_api_service - INFO - 任务API服务已启动于 0.0.0.0:8000
2025-06-28 11:03:47,724 - services.service_manager - INFO - 启动服务: runtime
2025-06-28 11:03:47,724 - services.runtime_service - INFO - 正在启动推理运行时服务...
2025-06-28 11:03:47,724 - services.service_manager - INFO - 启动服务: synthesis
2025-06-28 11:03:47,724 - services.synthesis_service - INFO - 正在启动合成服务...
2025-06-28 11:03:47,724 - services.synthesis_service - INFO - 合成服务工作线程已启动
2025-06-28 11:03:47,724 - services.synthesis_service - INFO - 开始处理轨迹数据...
2025-06-28 11:03:47,724 - services.synthesis_service - INFO - SynthesisCore v2.0监控器工作线程已启动
2025-06-28 11:03:47,725 - services.synthesis_service - INFO - 🚀 启动SynthesisCore v2.0监控器
2025-06-28 11:03:47,725 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:03:47,725 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:03:47,725 - services.synthesis_service - INFO - 合成服务已启动
2025-06-28 11:03:47,725 - core.synthesiscore.synthesis - INFO - 🔄 Processing only unprocessed trajectories...
2025-06-28 11:03:47,726 - services.service_manager - INFO - 所有服务已启动
2025-06-28 11:03:47,726 - __main__ - DEBUG - ✅ 所有服务启动完成
2025-06-28 11:03:47,726 - __main__ - INFO - 🎉 所有服务已启动，系统运行中...
2025-06-28 11:03:47,726 - __main__ - INFO - 📊 系统状态监控已启用，按 Ctrl+C 停止
2025-06-28 11:03:47,726 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:03:47,726 - services.runtime_service - INFO - 启动运行时实例: enhanced-reasoning-1
2025-06-28 11:03:47,727 - runtimes.reasoning.enhanced_runtime - INFO - 🚀 初始化Enhanced Reasoning Runtime - 简化版本
2025-06-28 11:03:47,727 - core.synthesiscore.synthesis - INFO - 🎯 Unprocessed trajectories completed: 0 new trajectories processed
2025-06-28 11:03:47,727 - core.llm.response_parsers.reasoning_response_parser - DEBUG - ✅ 响应解析器已连接工具Schema管理器
2025-06-28 11:03:47,727 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 工具Schema管理器已注入到响应解析器
2025-06-28 11:03:47,727 - runtimes.reasoning.enhanced_runtime - INFO - ⏳ 等待ToolScore服务就绪...
2025-06-28 11:03:47,727 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ Redis连接初始化成功
2025-06-28 11:03:47,728 - services.synthesis_service - DEBUG - 等待 300 秒后再次处理...
2025-06-28 11:03:47,728 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:corpus_queue
2025-06-28 11:03:47,728 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:atomic_tasks
2025-06-28 11:03:47,729 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:extended_tasks
2025-06-28 11:03:47,729 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:verification_queue
2025-06-28 11:03:47,730 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:training_data
2025-06-28 11:03:47,730 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:11:03:47 +0800] "GET /health HTTP/1.1" 200 231 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 11:03:47,730 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:quality_reports
2025-06-28 11:03:47,730 - runtimes.reasoning.toolscore_client - INFO - ✅ ToolScore服务已就绪
2025-06-28 11:03:47,731 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ Redis配置键初始化完成
2025-06-28 11:03:47,731 - runtimes.reasoning.enhanced_runtime - INFO - ✅ ToolScore HTTP服务已就绪
2025-06-28 11:03:47,731 - runtimes.reasoning.enhanced_runtime - INFO - 🔌 正在连接WebSocket端点: ws://localhost:8081/websocket
2025-06-28 11:03:47,731 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ 增强合成Redis管理器初始化完成
2025-06-28 11:03:47,731 - runtimes.reasoning.real_time_tool_client - INFO - 🔌 连接到ToolScore实时更新: ws://localhost:8081/websocket
2025-06-28 11:03:47,731 - core.synthesiscore.enhanced_synthesis_engine - INFO - ✅ Enhanced Synthesis Engine 初始化完成
2025-06-28 11:03:47,732 - core.synthesiscore.enhanced_synthesis_engine - INFO - 🚀 SynthesisCore v2.0 已启动
2025-06-28 11:03:47,732 - core.synthesiscore.trajectory_monitor - INFO - 🔄 检查并处理现有轨迹...
2025-06-28 11:03:47,732 - core.synthesiscore.trajectory_monitor - INFO - 📝 没有现有轨迹文件
2025-06-28 11:03:47,732 - core.synthesiscore.trajectory_monitor - INFO - ✅ TrajectoryMonitor初始化完成
2025-06-28 11:03:47,732 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:03:47,732 - core.synthesiscore.trajectory_monitor - DEBUG - ✅ 获取主事件循环引用成功
2025-06-28 11:03:47,732 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:03:47,733 - websockets.client - DEBUG - > GET /websocket HTTP/1.1
2025-06-28 11:03:47,734 - websockets.client - DEBUG - > Host: localhost:8081
2025-06-28 11:03:47,734 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:03:47,734 - core.synthesiscore.trajectory_monitor - INFO - 👁️ 开始监控轨迹文件变化: output/trajectories
2025-06-28 11:03:47,735 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:03:47,735 - services.synthesis_service - INFO - ✅ SynthesisCore v2.0监控器已启动
2025-06-28 11:03:47,735 - websockets.client - DEBUG - > Sec-WebSocket-Key: Jz9A8GMvlBQRyzZq3j+shw==
2025-06-28 11:03:47,735 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:03:47,735 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:03:47,735 - websockets.client - DEBUG - > User-Agent: Enhanced-Reasoning-Runtime/1.0
2025-06-28 11:03:47,735 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:03:47,735 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:03:47,735 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:03:47,735 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:03:47,735 - websockets.server - DEBUG - < Sec-WebSocket-Key: Jz9A8GMvlBQRyzZq3j+shw==
[2025-06-28 11:03:47] [32mINFO[0m:     Started server process [[36m72484[0m]
2025-06-28 11:03:47,735 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
[2025-06-28 11:03:47] [32mINFO[0m:     Waiting for application startup.
2025-06-28 11:03:47,735 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:03:47,735 - websockets.server - DEBUG - < User-Agent: Enhanced-Reasoning-Runtime/1.0
2025-06-28 11:03:47,736 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:03:47,736 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:03:47,736 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:03:47,736 - websockets.server - DEBUG - > Sec-WebSocket-Accept: 5d6xiExGWgJ2yubelXPUiIo45w8=
2025-06-28 11:03:47,736 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:03:47,736 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:03:47 GMT
2025-06-28 11:03:47,736 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:03:47,736 - websockets.server - INFO - connection open
2025-06-28 11:03:47,736 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:03:47,736 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:03:47,736 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 61329)
2025-06-28 11:03:47,736 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:03:47,736 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:03:47,736 - websockets.client - DEBUG - < Sec-WebSocket-Accept: 5d6xiExGWgJ2yubelXPUiIo45w8=
2025-06-28 11:03:47,736 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:03:47,736 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:03:47 GMT
2025-06-28 11:03:47,737 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:03:47,737 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:03:47,737 - runtimes.reasoning.real_time_tool_client - INFO - ✅ 已连接到ToolScore实时更新流
2025-06-28 11:03:47,737 - runtimes.reasoning.enhanced_runtime - INFO - ✅ WebSocket实时更新连接成功
2025-06-28 11:03:47,737 - runtimes.reasoning.real_time_tool_client - DEBUG - 已注册工具更新回调，当前回调数量: 1
2025-06-28 11:03:47,737 - runtimes.reasoning.enhanced_runtime - INFO - ⏳ 等待关键工具完全就绪...
2025-06-28 11:03:47,737 - runtimes.reasoning.enhanced_runtime - WARNING - 🚀 临时跳过详细工具等待，快速启动模式
2025-06-28 11:03:47,737 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 使用快速启动模式，工具将在后台异步就绪
2025-06-28 11:03:47,737 - runtimes.reasoning.enhanced_runtime - INFO - 🔍 开始MCP服务器同步验证...
2025-06-28 11:03:47,737 - core.tool_schema_manager - INFO - 正在执行MCP同步验证...
2025-06-28 11:03:47,737 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=False)，当前缓存: 0 个工具
2025-06-28 11:03:47,737 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 11:03:47,737 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
2025-06-28 11:03:47,737 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 11:03:47,737 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
2025-06-28 11:03:47,737 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
2025-06-28 11:03:47,737 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 11:03:47,737 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 11:03:47,737 - core.task_api - INFO - Connected to Redis: redis://localhost:6379
2025-06-28 11:03:47,737 - core.tool_schema_manager - INFO - 🔄 检测到 4 个工具需要更新: ['deepsearch', 'microsandbox', 'browser_use', 'mcp-search-tool']
[2025-06-28 11:03:47] [32mINFO[0m:     Application startup complete.
2025-06-28 11:03:47,737 - core.tool_schema_manager - INFO - 🔄 执行增量更新: 4 个工具
2025-06-28 11:03:47,737 - core.tool_schema_manager - INFO - 🔄 缓存为空，转为全量刷新模式
2025-06-28 11:03:47,737 - core.tool_schema_manager - DEBUG - 🔄 开始增强刷新工具Schemas...
2025-06-28 11:03:47,738 - core.tool_schema_manager - DEBUG - 🔍 工具注册表状态检查: _tools 字典包含 4 个条目
2025-06-28 11:03:47,738 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: deepsearch
2025-06-28 11:03:47,738 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: microsandbox
2025-06-28 11:03:47,738 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: browser_use
2025-06-28 11:03:47,738 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: mcp-search-tool
2025-06-28 11:03:47,738 - core.tool_schema_manager - INFO - 🔧 选项1: 从工具注册表获取到 4 个工具
[2025-06-28 11:03:47] [32mINFO[0m:     Uvicorn running on [1mhttp://0.0.0.0:8000[0m (Press CTRL+C to quit)
2025-06-28 11:03:47,738 - core.tool_schema_manager - DEBUG -   工具 0: id=deepsearch, name=网络信息研究工具, actions=3
2025-06-28 11:03:47,738 - core.tool_schema_manager - DEBUG -   工具 1: id=microsandbox, name=MicroSandbox安全代码执行器, actions=7
2025-06-28 11:03:47,738 - core.tool_schema_manager - DEBUG -   工具 2: id=browser_use, name=智能浏览器操作工具, actions=6
2025-06-28 11:03:47,738 - core.tool_schema_manager - DEBUG -   工具 3: id=mcp-search-tool, name=工具管理和项目文件搜索器, actions=4
2025-06-28 11:03:47,738 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: deepsearch
2025-06-28 11:03:47,738 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: comprehensive_research
2025-06-28 11:03:47,739 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: quick_research
2025-06-28 11:03:47,739 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: research
2025-06-28 11:03:47,739 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 deepsearch (包含 3 个动作)
2025-06-28 11:03:47,740 - core.tool_schema_manager - DEBUG -    当前缓存大小: 1 个工具
2025-06-28 11:03:47,740 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: microsandbox
2025-06-28 11:03:47,740 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_cleanup_expired
2025-06-28 11:03:47,740 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_close_session
2025-06-28 11:03:47,740 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_execute
2025-06-28 11:03:47,740 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_health_status
2025-06-28 11:03:47,740 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_performance_stats
2025-06-28 11:03:47,740 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_install_package
2025-06-28 11:03:47,741 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_list_sessions
2025-06-28 11:03:47,741 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 microsandbox (包含 7 个动作)
2025-06-28 11:03:47,741 - core.tool_schema_manager - DEBUG -    当前缓存大小: 2 个工具
2025-06-28 11:03:47,741 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: browser_use
2025-06-28 11:03:47,741 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_click_element
2025-06-28 11:03:47,741 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_use_execute_task
2025-06-28 11:03:47,741 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_extract_content
2025-06-28 11:03:47,741 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_input_text
2025-06-28 11:03:47,741 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_navigate
2025-06-28 11:03:47,742 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_search_google
2025-06-28 11:03:47,742 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 browser_use (包含 6 个动作)
2025-06-28 11:03:47,742 - core.tool_schema_manager - DEBUG -    当前缓存大小: 3 个工具
2025-06-28 11:03:47,742 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: mcp-search-tool
2025-06-28 11:03:47,742 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: analyze_tool_needs
2025-06-28 11:03:47,742 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: list_code_definitions
2025-06-28 11:03:47,742 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_and_install_tools
2025-06-28 11:03:47,742 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_file_content
2025-06-28 11:03:47,742 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 mcp-search-tool (包含 4 个动作)
2025-06-28 11:03:47,742 - core.tool_schema_manager - DEBUG -    当前缓存大小: 4 个工具
2025-06-28 11:03:47,742 - core.tool_schema_manager - INFO - 🔧 选项1: 成功处理 4/4 个工具，当前缓存 4 个工具
2025-06-28 11:03:47,743 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: mcp-search-tool
2025-06-28 11:03:47,743 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: microsandbox
2025-06-28 11:03:47,743 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: browser_use
2025-06-28 11:03:47,743 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: deepsearch
2025-06-28 11:03:47,743 - core.tool_schema_manager - INFO - ✅ 增强刷新完成，当前可用工具: 4个
2025-06-28 11:03:47,744 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:03:47,744 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:03:47,745 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:03:47,745 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:03:47,745 - core.tool_schema_manager - INFO - ✅ Schema安全刷新完成，备份 4 个工具
2025-06-28 11:03:47,745 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:03:47,746 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:03:47,746 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:03:47,746 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:03:47,746 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 11:03:47,746 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 11:03:47,746 - core.tool_schema_manager - INFO - 🔍 同步验证完成: unhealthy (0/4 工具Schema一致)
2025-06-28 11:03:47,747 - runtimes.reasoning.enhanced_runtime - ERROR - ❌ MCP服务器同步验证失败: 未知错误
2025-06-28 11:03:47,747 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔧 开始获取可用工具ID列表...
2025-06-28 11:03:47,747 - runtimes.reasoning.real_time_tool_client - DEBUG - 可用工具ID列表: ['microsandbox', 'deepsearch', 'mcp-search-tool', 'browser_use']
2025-06-28 11:03:47,747 - runtimes.reasoning.enhanced_runtime - DEBUG - 📋 获取到的工具列表: ['microsandbox', 'deepsearch', 'mcp-search-tool', 'browser_use']
2025-06-28 11:03:47,747 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 工具Schema管理器已初始化
2025-06-28 11:03:47,747 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔧 更新Guardrails和ValidationCritic工具配置...
2025-06-28 11:03:47,747 - core.llm.guardrails_middleware - INFO - 🔧 初始化输入验证Guard...
2025-06-28 11:03:47,748 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:03:47,749 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:03:47,749 - core.llm.guardrails_middleware - INFO - 🔧 初始化输出验证Guard...
2025-06-28 11:03:47,749 - core.llm.guardrails_middleware - INFO - 🔧 使用本地LLM客户端初始化Guard...
2025-06-28 11:03:47,751 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:03:47,751 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:03:47,751 - core.llm.guardrails_middleware - INFO - ✅ 使用LLM的Guard创建成功
2025-06-28 11:03:47,751 - core.llm.guardrails_middleware - INFO - ✅ Guardrails Guards初始化成功
2025-06-28 11:03:47,751 - core.llm.guardrails_middleware - INFO -    - 输入Guard: ✅
2025-06-28 11:03:47,751 - core.llm.guardrails_middleware - INFO -    - 输出Guard: ✅
2025-06-28 11:03:47,751 - core.llm.guardrails_middleware - INFO - 🔄 Guardrails工具列表已更新: 4个工具
2025-06-28 11:03:47,751 - core.agents.validation_critic - INFO - 🔄 ValidationCritic工具列表已更新: 4个工具
2025-06-28 11:03:47,751 - runtimes.reasoning.enhanced_runtime - INFO - ✅ Guardrails和ValidationCritic已配置4个工具: microsandbox, deepsearch, mcp-search-tool, browser_use
2025-06-28 11:03:47,751 - runtimes.reasoning.enhanced_runtime - INFO - ✅ Enhanced Reasoning Runtime 已成功初始化为纯推理引擎（集成Guardrails + ValidationCritic）
2025-06-28 11:03:47,752 - services.runtime_service - INFO - 启动运行时任务消费: enhanced-reasoning-1
2025-06-28 11:03:47,752 - services.runtime_service - INFO - 推理运行时服务已启动 1 个实例和 1 个任务消费协程
2025-06-28 11:03:47,752 - core.tool_schema_manager - INFO - 🔍 启动MCP服务器配置监控...
2025-06-28 11:03:47,752 - core.task_manager - INFO - Runtime enhanced-reasoning-1 starting to consume from queue: tasks:reasoning
2025-06-28 11:03:47,752 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/search_tool_server/service.json
2025-06-28 11:03:47,753 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/microsandbox_server/service.json
2025-06-28 11:03:47,753 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/browser_use_server/service.json
2025-06-28 11:03:47,753 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/deepsearch_server/service.json
2025-06-28 11:03:47,753 - core.tool_schema_manager - INFO - 🔄 MCP配置变化，强制刷新schema...
2025-06-28 11:03:47,753 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=True)，当前缓存: 0 个工具
2025-06-28 11:03:47,753 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 11:03:47,754 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
2025-06-28 11:03:47,754 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 11:03:47,754 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
2025-06-28 11:03:47,754 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
2025-06-28 11:03:47,754 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 11:03:47,754 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 11:03:47,754 - core.tool_schema_manager - INFO - 🔄 检测到 4 个工具需要更新: ['deepsearch', 'microsandbox', 'browser_use', 'mcp-search-tool']
2025-06-28 11:03:47,754 - core.tool_schema_manager - INFO - 🔄 执行增量更新: 4 个工具
2025-06-28 11:03:47,754 - core.tool_schema_manager - INFO - 🔄 缓存为空，转为全量刷新模式
2025-06-28 11:03:47,754 - core.tool_schema_manager - DEBUG - 🔄 开始增强刷新工具Schemas...
2025-06-28 11:03:47,754 - core.tool_schema_manager - DEBUG - 🔍 工具注册表状态检查: _tools 字典包含 4 个条目
2025-06-28 11:03:47,754 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: deepsearch
2025-06-28 11:03:47,754 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: microsandbox
2025-06-28 11:03:47,754 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: browser_use
2025-06-28 11:03:47,754 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: mcp-search-tool
2025-06-28 11:03:47,754 - core.tool_schema_manager - INFO - 🔧 选项1: 从工具注册表获取到 4 个工具
2025-06-28 11:03:47,754 - core.tool_schema_manager - DEBUG -   工具 0: id=deepsearch, name=网络信息研究工具, actions=3
2025-06-28 11:03:47,754 - core.tool_schema_manager - DEBUG -   工具 1: id=microsandbox, name=MicroSandbox安全代码执行器, actions=7
2025-06-28 11:03:47,754 - core.tool_schema_manager - DEBUG -   工具 2: id=browser_use, name=智能浏览器操作工具, actions=6
2025-06-28 11:03:47,754 - core.tool_schema_manager - DEBUG -   工具 3: id=mcp-search-tool, name=工具管理和项目文件搜索器, actions=4
2025-06-28 11:03:47,754 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: deepsearch
2025-06-28 11:03:47,754 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: comprehensive_research
2025-06-28 11:03:47,755 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: quick_research
2025-06-28 11:03:47,755 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: research
2025-06-28 11:03:47,755 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 deepsearch (包含 3 个动作)
2025-06-28 11:03:47,755 - core.tool_schema_manager - DEBUG -    当前缓存大小: 1 个工具
2025-06-28 11:03:47,755 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: microsandbox
2025-06-28 11:03:47,755 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_cleanup_expired
2025-06-28 11:03:47,756 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_close_session
2025-06-28 11:03:47,756 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_execute
2025-06-28 11:03:47,756 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_health_status
2025-06-28 11:03:47,756 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_performance_stats
2025-06-28 11:03:47,756 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_install_package
2025-06-28 11:03:47,756 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_list_sessions
2025-06-28 11:03:47,756 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 microsandbox (包含 7 个动作)
2025-06-28 11:03:47,756 - core.tool_schema_manager - DEBUG -    当前缓存大小: 2 个工具
2025-06-28 11:03:47,756 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: browser_use
2025-06-28 11:03:47,756 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_click_element
2025-06-28 11:03:47,756 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_use_execute_task
2025-06-28 11:03:47,757 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-48' coro=<start.<locals>.start_all_runtimes() running at /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/services/runtime_service.py:94> wait_for=<_GatheringFuture pending cb=[Task.task_wakeup()]>>
2025-06-28 11:03:47,757 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='runtime-enhanced-reasoning-1' coro=<start_runtime_service() running at /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/core/task_manager.py:388> wait_for=<Future pending cb=[Task.task_wakeup()]> cb=[gather.<locals>._done_callback() at /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/tasks.py:764]>
2025-06-28 11:03:47,757 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_extract_content
2025-06-28 11:03:47,757 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_input_text
2025-06-28 11:03:47,758 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_navigate
2025-06-28 11:03:47,758 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_search_google
2025-06-28 11:03:47,758 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 browser_use (包含 6 个动作)
2025-06-28 11:03:47,758 - core.tool_schema_manager - DEBUG -    当前缓存大小: 3 个工具
2025-06-28 11:03:47,758 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: mcp-search-tool
2025-06-28 11:03:47,758 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: analyze_tool_needs
2025-06-28 11:03:47,758 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: list_code_definitions
2025-06-28 11:03:47,758 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_and_install_tools
2025-06-28 11:03:47,758 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_file_content
2025-06-28 11:03:47,758 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 mcp-search-tool (包含 4 个动作)
2025-06-28 11:03:47,758 - core.tool_schema_manager - DEBUG -    当前缓存大小: 4 个工具
2025-06-28 11:03:47,758 - core.tool_schema_manager - INFO - 🔧 选项1: 成功处理 4/4 个工具，当前缓存 4 个工具
2025-06-28 11:03:47,758 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: mcp-search-tool
2025-06-28 11:03:47,758 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: microsandbox
2025-06-28 11:03:47,759 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: browser_use
2025-06-28 11:03:47,759 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: deepsearch
2025-06-28 11:03:47,759 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:11:03:47 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13991 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 11:03:47,759 - core.tool_schema_manager - DEBUG - 🔍 从ToolScore获取到工具列表: ['mcp-search-tool', 'microsandbox', 'browser_use', 'deepsearch']
2025-06-28 11:03:47,759 - core.tool_schema_manager - DEBUG - 🔧 映射后的工具列表: ['mcp-search-tool', 'microsandbox', 'browser_use', 'deepsearch']
2025-06-28 11:03:47,759 - core.tool_schema_manager - DEBUG - ⏭️ 工具 mcp-search-tool 已在缓存中，跳过ToolScore获取
2025-06-28 11:03:47,759 - core.tool_schema_manager - DEBUG - ⏭️ 工具 microsandbox 已在缓存中，跳过ToolScore获取
2025-06-28 11:03:47,759 - core.tool_schema_manager - DEBUG - ⏭️ 工具 browser_use 已在缓存中，跳过ToolScore获取
2025-06-28 11:03:47,759 - core.tool_schema_manager - DEBUG - ⏭️ 工具 deepsearch 已在缓存中，跳过ToolScore获取
2025-06-28 11:03:47,759 - core.tool_schema_manager - INFO - ✅ 增强刷新完成，当前可用工具: 4个
2025-06-28 11:03:47,760 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:03:47,760 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:03:47,760 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:03:47,760 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:03:47,760 - core.tool_schema_manager - INFO - ✅ Schema安全刷新完成，备份 4 个工具
2025-06-28 11:03:47,761 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:03:47,761 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:03:47,761 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:03:47,761 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:03:47,762 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 11:03:47,762 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 11:03:52,229 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第8次, 5s间隔)
2025-06-28 11:03:57,231 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第9次, 5s间隔)
2025-06-28 11:04:02,233 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第10次, 5s间隔)
2025-06-28 11:04:07,234 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第11次, 5s间隔)
2025-06-28 11:04:07,745 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:04:07,745 - websockets.client - DEBUG - > PING 2b 6d 1d de [binary, 4 bytes]
2025-06-28 11:04:07,746 - websockets.server - DEBUG - < PING 2b 6d 1d de [binary, 4 bytes]
2025-06-28 11:04:07,746 - websockets.server - DEBUG - > PONG 2b 6d 1d de [binary, 4 bytes]
2025-06-28 11:04:07,746 - websockets.client - DEBUG - < PONG 2b 6d 1d de [binary, 4 bytes]
2025-06-28 11:04:07,747 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:04:12,236 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第12次, 5s间隔)
2025-06-28 11:04:17,210 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:04:17,223 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:04:17,225 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:04:17,226 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:04:17,226 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:04:17,237 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第13次, 30s间隔)
2025-06-28 11:04:17,737 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:04:17,738 - websockets.server - DEBUG - > PING 00 2c 3d d9 [binary, 4 bytes]
2025-06-28 11:04:17,738 - websockets.client - DEBUG - < PING 00 2c 3d d9 [binary, 4 bytes]
2025-06-28 11:04:17,739 - websockets.client - DEBUG - > PONG 00 2c 3d d9 [binary, 4 bytes]
2025-06-28 11:04:17,739 - websockets.server - DEBUG - < PONG 00 2c 3d d9 [binary, 4 bytes]
2025-06-28 11:04:17,739 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:04:27,748 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:04:27,748 - websockets.client - DEBUG - > PING 83 a2 f1 46 [binary, 4 bytes]
2025-06-28 11:04:27,749 - websockets.server - DEBUG - < PING 83 a2 f1 46 [binary, 4 bytes]
2025-06-28 11:04:27,749 - websockets.server - DEBUG - > PONG 83 a2 f1 46 [binary, 4 bytes]
2025-06-28 11:04:27,750 - websockets.client - DEBUG - < PONG 83 a2 f1 46 [binary, 4 bytes]
2025-06-28 11:04:27,750 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:04:47,215 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:04:47,230 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:04:47,231 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:04:47,235 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:04:47,235 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:04:47,238 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第14次, 30s间隔)
2025-06-28 11:04:47,727 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 1m 0s
2025-06-28 11:04:47,742 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:04:47,742 - websockets.server - DEBUG - > PING de a2 bd 0c [binary, 4 bytes]
2025-06-28 11:04:47,746 - websockets.client - DEBUG - < PING de a2 bd 0c [binary, 4 bytes]
2025-06-28 11:04:47,746 - websockets.client - DEBUG - > PONG de a2 bd 0c [binary, 4 bytes]
2025-06-28 11:04:47,747 - websockets.server - DEBUG - < PONG de a2 bd 0c [binary, 4 bytes]
2025-06-28 11:04:47,747 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:04:47,750 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:04:47,751 - websockets.client - DEBUG - > PING c8 62 7a a0 [binary, 4 bytes]
2025-06-28 11:04:47,751 - websockets.server - DEBUG - < PING c8 62 7a a0 [binary, 4 bytes]
2025-06-28 11:04:47,752 - websockets.server - DEBUG - > PONG c8 62 7a a0 [binary, 4 bytes]
2025-06-28 11:04:47,752 - websockets.client - DEBUG - < PONG c8 62 7a a0 [binary, 4 bytes]
2025-06-28 11:04:47,752 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:05:07,753 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:05:07,754 - websockets.client - DEBUG - > PING 8b 83 48 20 [binary, 4 bytes]
2025-06-28 11:05:07,754 - websockets.server - DEBUG - < PING 8b 83 48 20 [binary, 4 bytes]
2025-06-28 11:05:07,755 - websockets.server - DEBUG - > PONG 8b 83 48 20 [binary, 4 bytes]
2025-06-28 11:05:07,755 - websockets.client - DEBUG - < PONG 8b 83 48 20 [binary, 4 bytes]
2025-06-28 11:05:07,755 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:05:16,796 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:05:16,796 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:05:16,796 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:05:16,796 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:05:16,796 - services.synthesis_service - INFO - 🛑 SynthesisCore v2.0监控器已停止
2025-06-28 11:05:16,796 - services.synthesis_service - INFO - 等待合成服务线程结束...
2025-06-28 11:05:16,831 - core.synthesiscore.trajectory_monitor - INFO - 🛑 轨迹文件监控已停止
2025-06-28 11:05:16,831 - core.synthesiscore.enhanced_synthesis_engine - ERROR - ❌ Enhanced Synthesis Engine 关闭失败: object NoneType can't be used in 'await' expression
2025-06-28 11:05:16,831 - core.synthesiscore.enhanced_synthesis_engine - INFO - 🔒 SynthesisCore v2.0 已关闭
2025-06-28 11:05:16,831 - core.synthesiscore.trajectory_monitor - INFO - 🔒 SynthesisCore已关闭
2025-06-28 11:05:16,831 - services.synthesis_service - INFO - SynthesisCore v2.0监控器工作线程已停止
2025-06-28 11:05:17,068 - services.synthesis_service - INFO - 合成服务工作线程已停止
2025-06-28 11:05:17,071 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:05:17,071 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:05:17,071 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:05:17,071 - services.runtime_service - INFO - 停止运行时实例: enhanced-reasoning-1
2025-06-28 11:05:17,071 - services.runtime_service - WARNING - 运行时清理失败: asyncio.run() cannot be called from a running event loop
[2025-06-28 11:05:17] /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/services/runtime_service.py:117: RuntimeWarning: coroutine 'EnhancedReasoningRuntime.cleanup' was never awaited
  logger.warning(f"运行时清理失败: {e}")
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
2025-06-28 11:05:17,073 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:05:17,073 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:05:17,073 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:05:17,073 - services.task_api_service - INFO - 已发送停止信号给任务API服务器
[2025-06-28 11:05:17] [32mINFO[0m:     Shutting down
[2025-06-28 11:05:17] [32mINFO[0m:     Waiting for application shutdown.
[2025-06-28 11:05:17] [32mINFO[0m:     Application shutdown complete.
[2025-06-28 11:05:17] [32mINFO[0m:     Finished server process [[36m72484[0m]
2025-06-28 11:05:17,213 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:05:17,213 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:05:17,213 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:05:17,213 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:05:17,216 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:05:17,216 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:03:17,457 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:03:17,457 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:03:17,457 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:03:17,457 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:03:17,457 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:03:17,457 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:03:17,457 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:03:17,457 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:03:17,457 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:03:17,457 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:03:17,457 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:03:17,457 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:03:17,457 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:03:17,457 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:03:17,460 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:03:17,460 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:03:17,460 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:03:17,460 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:03:27,461 - core.toolscore.mcp_server - INFO - [microsandbox_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 11:03:27,467 - core.toolscore.mcp_server - INFO - [microsandbox_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 11:03:27,467 - core.toolscore.mcp_server - INFO - [microsandbox_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "00b194e8-ab00-474b-8b5c-fc6131c83f6b", "tool_spec": {"tool_id": "microsandbox", "name": "microsandbox_server", "description": "\u57fa\u4e8eMicroSandbox\u7684\u5b89\u5168Python\u4ee3\u7801\u6267\u884c\u670d\u52a1\u5668", "tool_type": "mcp_server", "capabilities": [{"name": "microsandbox_execute", "description": "\u5728MicroSandbox\u5b89\u5168\u73af\u5883\u4e2d\u6267\u884cPython\u4ee3\u7801", "parameters": {"code": {"type": "string", "description": "\u8981\u6267\u884c\u7684Python\u4ee3\u7801", "required": true}, "session_id": {"type": "string", "description": "\u4f1a\u8bddID\uff0c\u7528\u4e8e\u591a\u8f6e\u6267\u884c\u548c\u72b6\u6001\u4fdd\u6301", "required": false}, "timeout": {"type": "integer", "description": "\u6267\u884c\u8d85\u65f6\u65f6\u95f4\uff08\u79d2\uff09\uff0c\u9ed8\u8ba430\u79d2\uff0c\u6700\u5927300\u79d2\u3002\u6ce8\u610f\uff1aMicroSandbox\u5185\u90e8\u6709\u81ea\u5df1\u7684\u8d85\u65f6\u673a\u5236\uff0c\u6b64\u53c2\u6570\u4e3b\u8981\u7528\u4e8e\u6587\u6863\u8bf4\u660e", "required": false}}, "examples": [{"code": "print('Hello from MicroSandbox!')"}, {"code": "import math\\nresult = math.sqrt(16)\\nprint(f'\u5e73\u65b9\u6839: {result}')", "timeout": 10}, {"code": "x = 42", "session_id": "my-session"}, {"code": "print(f'x = {x}')", "session_id": "my-session"}], "category": "general"}, {"name": "microsandbox_install_package", "description": "\u5728MicroSandbox\u73af\u5883\u4e2d\u5b89\u88c5Python\u5305", "parameters": {"package_name": {"type": "string", "description": "\u8981\u5b89\u88c5\u7684\u5305\u540d", "required": true}, "version": {"type": "string", "description": "\u6307\u5b9a\u7248\u672c\u53f7", "required": false}, "session_id": {"type": "string", "description": "\u4f1a\u8bddID", "required": false}}, "examples": [{"package_name": "requests"}, {"package_name": "numpy", "version": "1.21.0"}, {"package_name": "pandas", "session_id": "data-analysis"}], "category": "general"}, {"name": "microsandbox_list_sessions", "description": "\u5217\u51fa\u5f53\u524d\u6d3b\u8dc3\u7684\u6c99\u7bb1\u4f1a\u8bdd", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "microsandbox_close_session", "description": "\u5173\u95ed\u6307\u5b9a\u7684\u6c99\u7bb1\u4f1a\u8bdd", "parameters": {"session_id": {"type": "string", "description": "\u8981\u5173\u95ed\u7684\u4f1a\u8bddID", "required": true}}, "examples": [{"session_id": "my-session"}], "category": "general"}, {"name": "microsandbox_cleanup_expired", "description": "\u6e05\u7406\u8fc7\u671f\u7684\u6c99\u7bb1\u4f1a\u8bdd", "parameters": {"max_age": {"type": "integer", "description": "\u6700\u5927\u4f1a\u8bdd\u5e74\u9f84\uff08\u79d2\uff09\uff0c\u9ed8\u8ba4\u4e3a\u914d\u7f6e\u7684\u8d85\u65f6\u65f6\u95f4", "required": false}}, "examples": [{}, {"max_age": 1800}], "category": "general"}, {"name": "microsandbox_get_performance_stats", "description": "\u83b7\u53d6\u670d\u52a1\u5668\u6027\u80fd\u7edf\u8ba1\u4fe1\u606f", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "microsandbox_get_health_status", "description": "\u83b7\u53d6\u670d\u52a1\u5668\u5065\u5eb7\u72b6\u6001", "parameters": {}, "examples": [{}], "category": "general"}], "endpoint": "ws://localhost:8090", "connection_params": {}}}
2025-06-28 11:03:27,467 - core.toolscore.mcp_server - INFO - [microsandbox_server] Waiting for registration response from toolscore...
2025-06-28 11:03:27,469 - core.toolscore.mcp_server - INFO - [microsandbox_server] Received registration response: {"type": "register_tool_response", "request_id": "00b194e8-ab00-474b-8b5c-fc6131c83f6b", "success": true, "message": null}
2025-06-28 11:03:27,469 - core.toolscore.mcp_server - INFO - [microsandbox_server] Successfully registered with toolscore.

2025-06-28 11:05:17,216 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:05:17,217 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:05:17,217 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:05:17,219 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:05:17,219 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:03:17,356 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:03:17,356 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:03:17,356 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:03:17,356 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:03:17,359 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:03:17,359 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:03:17,359 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:03:17,359 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:03:17,830 - websockets.server - INFO - connection open
2025-06-28 11:03:17,830 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 61257)
2025-06-28 11:03:17,831 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:03:17,831 - websockets.server - INFO - connection closed
2025-06-28 11:03:27,360 - core.toolscore.mcp_server - INFO - [search_tool_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 11:03:27,366 - core.toolscore.mcp_server - INFO - [search_tool_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 11:03:27,366 - core.toolscore.mcp_server - INFO - [search_tool_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "ba43a33d-174f-4a92-b0be-d637c2783818", "tool_spec": {"tool_id": "mcp-search-tool", "name": "search_tool_server", "description": "\u6587\u4ef6\u5185\u5bb9\u641c\u7d22\u548c\u4ee3\u7801\u5b9a\u4e49\u641c\u7d22\u5de5\u5177\u670d\u52a1\u5668", "tool_type": "mcp_server", "capabilities": [{"name": "search_file_content", "description": "\u5728\u6307\u5b9a\u6587\u4ef6\u4e2d\u641c\u7d22\u5339\u914d\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5185\u5bb9", "parameters": {"file_path": {"type": "string", "description": "\u8981\u641c\u7d22\u7684\u6587\u4ef6\u8def\u5f84", "required": true}, "regex_pattern": {"type": "string", "description": "\u8981\u5339\u914d\u7684\u6b63\u5219\u8868\u8fbe\u5f0f", "required": true}}, "examples": [{"file_path": "src/main.py", "regex_pattern": "def\\s+\\w+"}], "category": "general"}, {"name": "list_code_definitions", "description": "\u5217\u51fa\u6307\u5b9a\u6587\u4ef6\u6216\u76ee\u5f55\u4e2dPython\u4ee3\u7801\u7684\u7c7b\u3001\u51fd\u6570\u548c\u65b9\u6cd5\u5b9a\u4e49", "parameters": {"file_path": {"type": "string", "description": "\u8981\u89e3\u6790\u7684Python\u6587\u4ef6\u8def\u5f84", "required": false}, "directory_path": {"type": "string", "description": "\u8981\u89e3\u6790\u7684\u76ee\u5f55\u8def\u5f84", "required": false}}, "examples": [{"file_path": "src/utils.py"}, {"directory_path": "src/models"}], "category": "general"}, {"name": "analyze_tool_needs", "description": "\u5206\u6790\u4efb\u52a1\u9700\u6c42\uff0c\u786e\u5b9a\u662f\u5426\u9700\u8981\u989d\u5916\u7684\u5de5\u5177", "parameters": {"task_description": {"type": "string", "description": "\u8981\u5206\u6790\u7684\u4efb\u52a1\u63cf\u8ff0", "required": true}}, "examples": [{"task_description": "Create a chart showing sales data trends"}], "category": "general"}, {"name": "search_and_install_tools", "description": "\u641c\u7d22\u5e76\u5b89\u88c5\u65b0\u7684\u5de5\u5177\u4ee5\u6ee1\u8db3\u4efb\u52a1\u9700\u6c42", "parameters": {"task_description": {"type": "string", "description": "\u4efb\u52a1\u63cf\u8ff0", "required": true}, "reason": {"type": "string", "description": "\u9700\u8981\u65b0\u5de5\u5177\u7684\u539f\u56e0", "required": false}}, "examples": [{"task_description": "Create a chart", "reason": "Need charting capabilities"}], "category": "general"}], "endpoint": "ws://localhost:8080/mcp", "connection_params": {}}}
2025-06-28 11:03:27,367 - core.toolscore.mcp_server - INFO - [search_tool_server] Waiting for registration response from toolscore...
2025-06-28 11:03:27,369 - core.toolscore.mcp_server - INFO - [search_tool_server] Received registration response: {"type": "register_tool_response", "request_id": "ba43a33d-174f-4a92-b0be-d637c2783818", "success": true, "message": null}
2025-06-28 11:03:27,369 - core.toolscore.mcp_server - INFO - [search_tool_server] Successfully registered with toolscore.
2025-06-28 11:03:47,205 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:03:47,205 - websockets.server - INFO - connection closed
2025-06-28 11:04:17,211 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:04:17,211 - websockets.server - INFO - connection closed
2025-06-28 11:04:47,218 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:04:47,218 - websockets.server - INFO - connection closed

2025-06-28 11:05:17,219 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:05:17,221 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:05:17,221 - services.mcp_server_launcher - INFO - 停止MCP服务器: browser_use_server
2025-06-28 11:05:17,221 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 收到停止信号，正在清理资源...
2025-06-28 11:05:17,236 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:05:17,236 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:05:17,236 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Browser Use服务器已完全停止
2025-06-28 11:05:17,240 - services.mcp_server_launcher - INFO - ✅ MCP服务器正常退出: browser_use_server
2025-06-28 11:05:17,260 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: browser_use_server
2025-06-28 11:05:17,260 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:05:17,263 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:05:17,263 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:03:17,507 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:03:17,507 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:03:17,507 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:03:17,507 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:03:17,507 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:03:17,507 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:03:17,508 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:03:17,508 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:03:17,508 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:03:17,508 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:03:17,831 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:03:17,831 - websockets.server - INFO - connection closed
2025-06-28 11:03:17,832 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:03:17,832 - websockets.server - INFO - connection closed
2025-06-28 11:03:27,510 - core.toolscore.mcp_server - INFO - [deepsearch_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 11:03:27,514 - core.toolscore.mcp_server - INFO - [deepsearch_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 11:03:27,514 - core.toolscore.mcp_server - INFO - [deepsearch_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "44db19d8-b223-4693-b533-b67f4e907b1a", "tool_spec": {"tool_id": "deepsearch", "name": "deepsearch_server", "description": "\u4e13\u4e1a\u7ea7\u6df1\u5ea6\u641c\u7d22\u548c\u7814\u7a76\u5de5\u5177\u670d\u52a1\u5668\uff0c\u57fa\u4e8eLangGraph\u5b9e\u73b0\u7684\u591a\u8f6e\u8fed\u4ee3\u641c\u7d22\u4ee3\u7406", "tool_type": "mcp_server", "capabilities": [{"name": "research", "description": "\u6267\u884c\u4e13\u4e1a\u7ea7\u6df1\u5ea6\u7814\u7a76\uff0c\u83b7\u53d6\u8be6\u7ec6\u8c03\u7814\u4fe1\u606f", "parameters": {"question": {"type": "string", "description": "\u8981\u7814\u7a76\u7684\u95ee\u9898\u6216\u4e3b\u9898", "required": true}, "research_depth": {"type": "string", "description": "\u7814\u7a76\u6df1\u5ea6: quick/standard/comprehensive", "required": false}, "max_iterations": {"type": "integer", "description": "\u6700\u5927\u8fed\u4ee3\u6b21\u6570", "required": false}}, "examples": [], "category": "general"}, {"name": "quick_research", "description": "\u6267\u884c\u5feb\u901f\u7814\u7a76\uff0c\u9002\u7528\u4e8e\u9700\u8981\u5feb\u901f\u83b7\u53d6\u57fa\u7840\u4fe1\u606f\u7684\u573a\u666f", "parameters": {"question": {"type": "string", "description": "\u8981\u7814\u7a76\u7684\u95ee\u9898\u6216\u4e3b\u9898", "required": true}}, "examples": [], "category": "general"}, {"name": "comprehensive_research", "description": "\u6267\u884c\u5168\u9762\u6df1\u5ea6\u7814\u7a76\uff0c\u9002\u7528\u4e8e\u9700\u8981\u8be6\u7ec6\u3001\u4e13\u4e1a\u7ea7\u8c03\u7814\u4fe1\u606f\u7684\u573a\u666f", "parameters": {"question": {"type": "string", "description": "\u8981\u7814\u7a76\u7684\u95ee\u9898\u6216\u4e3b\u9898", "required": true}, "topic_focus": {"type": "string", "description": "\u53ef\u9009\u7684\u4e3b\u9898\u7126\u70b9\uff0c\u7528\u4e8e\u5f15\u5bfc\u7814\u7a76\u65b9\u5411", "required": false}}, "examples": [], "category": "general"}, {"name": "get_health_status", "description": "\u83b7\u53d6\u7cfb\u7edf\u5065\u5eb7\u72b6\u6001\u548c\u6027\u80fd\u6307\u6807", "parameters": {}, "examples": [], "category": "general"}, {"name": "get_optimization_stats", "description": "\u83b7\u53d6\u8bf7\u6c42\u4f18\u5316\u7edf\u8ba1\u4fe1\u606f", "parameters": {}, "examples": [], "category": "general"}], "endpoint": "ws://localhost:8086/mcp", "connection_params": {}}}
2025-06-28 11:03:27,515 - core.toolscore.mcp_server - INFO - [deepsearch_server] Waiting for registration response from toolscore...
2025-06-28 11:03:27,516 - core.toolscore.mcp_server - INFO - [deepsearch_server] Received registration response: {"type": "register_tool_response", "request_id": "44db19d8-b223-4693-b533-b67f4e907b1a", "success": true, "message": null}
2025-06-28 11:03:27,516 - core.toolscore.mcp_server - INFO - [deepsearch_server] Successfully registered with toolscore.
2025-06-28 11:03:47,222 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:03:47,222 - websockets.server - INFO - connection closed
2025-06-28 11:04:17,224 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:04:17,224 - websockets.server - INFO - connection closed
2025-06-28 11:04:47,234 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:04:47,235 - websockets.server - INFO - connection closed
2025-06-28 11:05:17,237 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:05:17,237 - websockets.server - INFO - connection closed

2025-06-28 11:05:17,263 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:05:17,264 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:05:17,342 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:17,343 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:17,343 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:05:17,343 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:05:17,343 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:05:17,343 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:05:17,343 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:05:17,343 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:05:17,343 - services.toolscore_service - INFO - 等待 ToolScore MCP 线程停止...
2025-06-28 11:05:17,748 - websockets.server - INFO - server closing
2025-06-28 11:05:17,748 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:05:17,748 - websockets.server - DEBUG - > PING 87 59 f3 80 [binary, 4 bytes]
2025-06-28 11:05:17,748 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 11:05:17,748 - websockets.server - DEBUG - > CLOSE 1001 (going away) [2 bytes]
2025-06-28 11:05:20,347 - services.toolscore_service - WARNING - ToolScore MCP 线程未能正常结束，尝试强制停止...
2025-06-28 11:05:20,348 - services.toolscore_service - INFO - 强制终止 ToolScore MCP 线程
2025-06-28 11:05:20,348 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:05:23,353 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:05:23,353 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:05:23,428 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:05:23,429 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:05:23,429 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:05:23,429 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:05:23,429 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:05:23,429 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:05:23,429 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:05:23,429 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:05:23,429 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:05:23,429 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:05:23,429 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:05:23,429 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:05:23,429 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:05:23,505 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:23,505 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:23,505 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:05:23,505 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:05:23,505 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:05:23,505 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:05:23,505 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:05:23,506 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:05:23,506 - services.toolscore_service - INFO - 等待 ToolScore MCP 线程停止...
2025-06-28 11:05:26,511 - services.toolscore_service - WARNING - ToolScore MCP 线程未能正常结束，尝试强制停止...
2025-06-28 11:05:26,511 - services.toolscore_service - INFO - 强制终止 ToolScore MCP 线程
2025-06-28 11:05:26,511 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:05:27,221 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:05:27,222 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:05:27,222 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:05:27,222 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:05:27,222 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:05:27,222 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:27,222 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:05:27,222 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:05:27,222 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:05:27,222 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:05:27,222 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:27,222 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:05:27,222 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:05:27,222 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:05:27,222 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:05:27,222 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:05:27,223 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:05:27,223 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:05:27,223 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:05:27,223 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:05:27,223 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:27,223 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:05:27,223 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:05:27,223 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:27,223 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:05:27,223 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:27,224 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:05:27,225 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 72715)
2025-06-28 11:05:27,225 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:05:27,225 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:05:27,225 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:05:27,225 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:05:27,225 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:05:27,226 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:27,227 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:05:27,229 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 72716)
2025-06-28 11:05:27,229 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:05:27,231 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:05:27,231 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:05:27,231 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:05:27,231 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:05:27,231 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:05:27,231 - websockets.client - DEBUG - > Sec-WebSocket-Key: nbB/Ph2l6J+J+/lnQnOKuA==
2025-06-28 11:05:27,231 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:05:27,231 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:05:27,231 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:05:27,231 - websockets.client - DEBUG - > EOF
2025-06-28 11:05:27,231 - websockets.client - DEBUG - < EOF
2025-06-28 11:05:27,231 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:05:27,232 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:05:27,264 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:05:27,265 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:05:27,265 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:05:27,265 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:27,265 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:05:27,265 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:05:27,265 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:05:27,265 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:05:27,265 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:05:27,265 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:05:27,265 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:27,265 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:05:27,265 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:05:27,265 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:05:27,266 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:05:27,266 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:27,269 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 72717)
2025-06-28 11:05:27,269 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:05:27,273 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:05:27,829 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.

================================================================================
[系统启动] 2025-06-28 11:05:27
================================================================================
2025-06-28 11:05:27,829 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
[2025-06-28 11:05:27] 🚀 Agent Data Platform 启动中... (所有日志将统一记录到 logs/System.log)
2025-06-28 11:05:27,830 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:05:27,835 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:05:27,835 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:05:27,835 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:05:27,835 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:05:27,835 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:05:27,835 - websockets.client - DEBUG - > Sec-WebSocket-Key: /HwJYXM5vydFW0UPlKQD6A==
2025-06-28 11:05:27,835 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:05:27,835 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:05:27,835 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:05:27,836 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:05:27,836 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:05:27,836 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:05:27,836 - websockets.client - DEBUG - < Sec-WebSocket-Accept: XZ7ZWy2DjnfQ6ThlaUJUXdH+7w8=
2025-06-28 11:05:27,836 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:05:27,836 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:05:27 GMT
2025-06-28 11:05:27,836 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:05:27,836 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:05:27,836 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:05:27,836 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:05:27,836 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:05:27,837 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:05:27,837 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:05:27,837 - websockets.client - DEBUG - < EOF
2025-06-28 11:05:27,837 - websockets.client - DEBUG - > EOF
2025-06-28 11:05:27,837 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:05:27,837 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:05:27,837 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:05:27,837 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:05:27,837 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:05:27,877 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:05:27,877 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:05:28,551 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:05:28,551 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:05:28,878 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:05:28,878 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:05:29,416 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:05:29,416 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:05:29,516 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:05:29,516 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:05:29,592 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:05:29,592 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:05:29,592 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:05:29,592 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:05:29,592 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:05:29,592 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:05:29,592 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:05:29,592 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:05:29,592 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:05:29,592 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:05:29,592 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:05:29,592 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:05:29,592 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:05:29,592 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:05:29,594 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:05:29,594 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:05:27,515 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:05:27,516 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:05:27,516 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:05:27,516 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:05:27,516 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:05:27,516 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:05:27,516 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:05:27,516 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:05:27,516 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:05:27,516 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:05:27,516 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:05:27,516 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:05:27,516 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:05:27,516 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:05:27,519 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:05:27,519 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:05:27,519 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:05:27,519 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:05:29,594 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:05:29,596 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:05:29,596 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:05:29,598 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:05:29,599 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:05:27,389 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:05:27,389 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:05:27,389 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:05:27,389 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:05:27,393 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:05:27,393 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:05:27,393 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:05:27,393 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:05:27,836 - websockets.server - INFO - connection open
2025-06-28 11:05:27,836 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 61502)
2025-06-28 11:05:27,836 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:05:27,837 - websockets.server - INFO - connection closed

2025-06-28 11:05:29,599 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:05:29,600 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:05:29,600 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:05:29,602 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:05:29,602 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:05:27,594 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:05:27,594 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:05:27,594 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:05:27,594 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:05:27,594 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:05:27,595 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:05:27,596 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:05:27,596 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:05:27,596 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:05:27,596 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:05:27,876 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:05:27,876 - websockets.server - INFO - connection closed
2025-06-28 11:05:27,877 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:05:27,877 - websockets.server - INFO - connection closed

2025-06-28 11:05:29,602 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:05:29,604 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:05:29,682 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:29,682 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:29,682 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:05:29,682 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:05:29,682 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:05:29,682 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:05:29,682 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:05:29,682 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:05:29,682 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:05:30,454 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:05:30,454 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:05:30,454 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:05:30,454 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:05:32,687 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:05:32,687 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:05:32,761 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:05:32,762 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:05:32,762 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:05:32,762 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:05:32,762 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:05:32,762 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:05:32,762 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:05:32,762 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:05:32,762 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:05:32,762 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:05:32,762 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:05:32,762 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:05:32,762 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:05:32,838 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:32,838 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:32,838 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:05:32,838 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:05:32,838 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:05:32,838 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:05:32,838 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:05:32,838 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:05:32,838 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:05:35,843 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:05:35,844 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:05:35,919 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:05:35,919 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:05:35,919 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:05:35,919 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:05:35,919 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:05:35,919 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:05:35,919 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:05:35,919 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:05:35,919 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:05:35,919 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:05:35,919 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:05:35,919 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:05:35,919 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:05:35,995 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:35,995 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:35,995 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:05:35,995 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:05:35,995 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:05:35,995 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:05:35,995 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:05:35,995 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:05:35,995 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:05:38,997 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:05:38,997 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:05:39,071 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:05:39,071 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:05:39,072 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:05:39,072 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:05:39,072 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:05:39,072 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:05:39,072 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:05:39,072 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:05:39,072 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:05:39,072 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:05:39,072 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:05:39,072 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:05:39,072 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:05:39,148 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:39,148 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:39,148 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:05:39,148 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:05:39,148 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:05:39,148 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:05:39,148 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:05:39,148 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:05:39,148 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:05:39,595 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:05:39,596 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:05:39,596 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:05:39,596 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:39,596 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:05:39,596 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:05:39,596 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:05:39,596 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:05:39,596 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:05:39,596 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:05:39,596 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:05:39,596 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:39,596 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:05:39,596 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:05:39,596 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:39,598 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 72794)
2025-06-28 11:05:39,598 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:05:39,599 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:05:39,599 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:05:39,599 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:05:39,599 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:05:39,599 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:05:39,599 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:39,599 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:05:39,599 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:05:39,599 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:05:39,599 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:05:39,599 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:05:39,599 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:05:39,599 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:39,599 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:05:39,600 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:05:39,600 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:05:39,600 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:05:39,600 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:39,601 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 72795)
2025-06-28 11:05:39,601 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:05:39,603 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:05:39,603 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:05:39,603 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:05:39,603 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:05:39,603 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:05:39,603 - websockets.client - DEBUG - > Sec-WebSocket-Key: pvEdaRhGRGVtBQ05RKRfIg==
2025-06-28 11:05:39,603 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:05:39,603 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:05:39,603 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:05:39,603 - websockets.client - DEBUG - > EOF
2025-06-28 11:05:39,603 - websockets.client - DEBUG - < EOF
2025-06-28 11:05:39,604 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:05:39,604 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:05:39,607 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:05:39,607 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:05:39,607 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:05:39,607 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:39,608 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:05:39,608 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:05:39,608 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:05:39,608 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:05:39,608 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:05:39,608 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:05:39,608 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:39,608 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:05:39,608 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:05:39,608 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:05:39,608 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:05:39,608 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:39,611 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 72796)
2025-06-28 11:05:39,611 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:05:39,614 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:05:40,200 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:05:40,200 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:05:40,207 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:05:40,207 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:05:40,207 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:05:40,207 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:05:40,207 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:05:40,207 - websockets.client - DEBUG - > Sec-WebSocket-Key: 7OKazPv6N48/pncyI4nUuw==
2025-06-28 11:05:40,207 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:05:40,207 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:05:40,207 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:05:40,207 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:05:40,207 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:05:40,207 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:05:40,207 - websockets.client - DEBUG - < Sec-WebSocket-Accept: lP7V5w29pAV1J4p2U7U1rBeLfls=
2025-06-28 11:05:40,207 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:05:40,207 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:05:40 GMT
2025-06-28 11:05:40,207 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:05:40,207 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:05:40,207 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:05:40,208 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:05:40,208 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:05:40,208 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:05:40,208 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:05:40,208 - websockets.client - DEBUG - < EOF
2025-06-28 11:05:40,208 - websockets.client - DEBUG - > EOF
2025-06-28 11:05:40,208 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:05:40,208 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:05:40,208 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:05:40,208 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:05:40,208 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:05:40,218 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:05:40,218 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:05:40,921 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:05:40,922 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:05:41,219 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:05:41,219 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:05:41,787 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:05:41,787 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:05:42,153 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:05:42,153 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:05:42,229 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:05:42,229 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:05:42,229 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:05:42,229 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:05:42,229 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:05:42,229 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:05:42,229 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:05:42,229 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:05:42,229 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:05:42,229 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:05:42,229 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:05:42,229 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:05:42,229 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:05:42,229 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:05:42,230 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:05:42,230 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:05:39,840 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:05:39,840 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:05:39,840 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:05:39,840 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:05:39,840 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:05:39,840 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:05:39,840 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:05:39,840 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:05:39,840 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:05:39,840 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:05:39,840 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:05:39,841 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:05:39,841 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:05:39,841 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:05:39,845 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:05:39,845 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:05:39,845 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:05:39,845 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:05:42,231 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:05:42,231 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:05:42,231 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:05:42,232 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:05:42,232 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:05:39,733 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:05:39,734 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:05:39,734 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:05:39,734 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:05:39,736 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:05:39,736 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:05:39,736 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:05:39,736 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:05:40,207 - websockets.server - INFO - connection open
2025-06-28 11:05:40,207 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 61529)
2025-06-28 11:05:40,208 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:05:40,208 - websockets.server - INFO - connection closed

2025-06-28 11:05:42,232 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:05:42,232 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:05:42,232 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:05:42,233 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:05:42,233 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:05:39,903 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:05:39,903 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:05:39,903 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:05:39,903 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:05:39,903 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:05:39,904 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:05:39,905 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:05:39,905 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:05:39,905 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:05:39,905 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:05:40,217 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:05:40,217 - websockets.server - INFO - connection closed
2025-06-28 11:05:40,218 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:05:40,218 - websockets.server - INFO - connection closed

2025-06-28 11:05:42,233 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:05:42,233 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:05:42,311 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:42,311 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:42,311 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:05:42,311 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:05:42,311 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:05:42,311 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:05:42,311 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:05:42,311 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:05:42,311 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:05:42,825 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:05:42,825 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:05:42,825 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:05:42,826 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:05:45,316 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:05:45,316 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:05:45,392 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:05:45,392 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:05:45,392 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:05:45,392 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:05:45,392 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:05:45,392 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:05:45,392 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:05:45,392 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:05:45,392 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:05:45,392 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:05:45,392 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:05:45,392 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:05:45,392 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:05:45,470 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:45,470 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:45,470 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:05:45,470 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:05:45,470 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:05:45,470 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:05:45,470 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:05:45,470 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:05:45,470 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:05:48,475 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:05:48,475 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:05:48,550 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:05:48,550 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:05:48,551 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:05:48,551 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:05:48,551 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:05:48,551 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:05:48,551 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:05:48,551 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:05:48,551 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:05:48,551 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:05:48,551 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:05:48,551 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:05:48,551 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:05:48,627 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:48,628 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:48,628 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:05:48,628 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:05:48,628 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:05:48,628 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:05:48,628 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:05:48,628 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:05:48,628 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:05:51,633 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:05:51,633 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:05:51,708 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:05:51,708 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:05:51,708 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:05:51,708 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:05:51,708 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:05:51,708 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:05:51,708 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:05:51,708 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:05:51,708 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:05:51,708 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:05:51,708 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:05:51,708 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:05:51,708 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:05:51,785 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:51,785 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:51,785 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:05:51,785 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:05:51,785 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:05:51,785 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:05:51,785 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:05:51,785 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:05:51,785 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:05:52,233 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:05:52,233 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:05:52,233 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:05:52,233 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:05:52,233 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:05:52,233 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:05:52,233 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:52,233 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:52,233 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:05:52,233 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:05:52,233 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:05:52,234 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:05:52,234 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:05:52,234 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:05:52,234 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:05:52,234 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:05:52,234 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:05:52,234 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:05:52,234 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:05:52,234 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:05:52,234 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:52,234 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:05:52,234 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:52,234 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:05:52,234 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:05:52,234 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:05:52,234 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:52,235 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:05:52,236 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:05:52,236 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:05:52,236 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:52,237 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 72865)
2025-06-28 11:05:52,237 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:05:52,238 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 72866)
2025-06-28 11:05:52,238 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:05:52,238 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:05:52,239 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:05:52,239 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:05:52,239 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:05:52,239 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:05:52,240 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:05:52,240 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:05:52,240 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:05:52,240 - websockets.client - DEBUG - > Sec-WebSocket-Key: e1+RputulGWR6QhcqjdqJw==
2025-06-28 11:05:52,240 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:05:52,240 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:05:52,240 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:05:52,240 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:05:52,240 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:05:52,240 - websockets.client - DEBUG - > EOF
2025-06-28 11:05:52,240 - websockets.client - DEBUG - < EOF
2025-06-28 11:05:52,240 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:05:52,241 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:52,241 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:05:52,241 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:05:52,241 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:05:52,241 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:05:52,241 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:05:52,241 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:05:52,241 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:52,242 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:05:52,242 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:05:52,242 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:05:52,242 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:05:52,242 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:05:52,242 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:05:52,245 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 72867)
2025-06-28 11:05:52,245 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:05:52,248 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:05:52,840 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:05:52,840 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:05:52,844 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:05:52,844 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:05:52,844 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:05:52,844 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:05:52,844 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:05:52,844 - websockets.client - DEBUG - > Sec-WebSocket-Key: JzAnYD3c/U9BBj54eEsEHw==
2025-06-28 11:05:52,844 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:05:52,844 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:05:52,844 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:05:52,845 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:05:52,845 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:05:52,845 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:05:52,845 - websockets.client - DEBUG - < Sec-WebSocket-Accept: UVwNrUIDFMbw0dlSm/UIXVr0g1o=
2025-06-28 11:05:52,845 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:05:52,845 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:05:52 GMT
2025-06-28 11:05:52,845 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:05:52,845 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:05:52,845 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:05:52,845 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:05:52,845 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:05:52,845 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:05:52,845 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:05:52,845 - websockets.client - DEBUG - < EOF
2025-06-28 11:05:52,845 - websockets.client - DEBUG - > EOF
2025-06-28 11:05:52,845 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:05:52,846 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:05:52,846 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:05:52,846 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:05:52,846 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:05:52,851 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:05:52,851 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:05:53,561 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:05:53,561 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:05:53,852 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:05:53,852 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:05:54,427 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:05:54,427 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:05:54,790 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:05:54,791 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:05:54,871 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:05:54,871 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:05:54,871 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:05:54,871 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:05:54,871 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:05:54,871 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:05:54,871 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:05:54,871 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:05:54,871 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:05:54,871 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:05:54,871 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:05:54,871 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:05:54,871 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:05:54,871 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:05:54,872 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:05:54,873 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:05:54,873 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:05:52,486 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:05:52,486 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:05:52,486 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:05:52,486 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:05:52,486 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:05:52,486 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:05:52,486 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:05:52,486 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:05:52,486 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:05:52,486 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:05:52,486 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:05:52,486 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:05:52,487 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:05:52,487 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:05:52,489 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:05:52,489 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:05:52,489 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:05:52,489 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:05:54,873 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:05:54,873 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:05:54,874 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:05:54,874 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:05:52,384 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:05:52,385 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:05:52,385 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:05:52,385 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:05:52,390 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:05:52,390 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:05:52,390 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:05:52,390 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:05:52,845 - websockets.server - INFO - connection open
2025-06-28 11:05:52,845 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 61556)
2025-06-28 11:05:52,845 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:05:52,846 - websockets.server - INFO - connection closed

2025-06-28 11:05:54,874 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:05:54,874 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:05:54,874 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:05:54,875 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:05:54,875 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:05:52,533 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:05:52,533 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:05:52,533 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:05:52,533 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:05:52,533 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:05:52,533 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:05:52,535 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:05:52,535 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:05:52,535 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:05:52,535 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:05:52,850 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:05:52,850 - websockets.server - INFO - connection closed
2025-06-28 11:05:52,851 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:05:52,851 - websockets.server - INFO - connection closed

2025-06-28 11:05:54,876 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:05:54,878 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:05:54,955 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:54,956 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:54,956 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:05:54,956 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:05:54,956 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:05:54,956 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:05:54,956 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:05:54,956 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:05:54,956 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:05:55,465 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:05:55,465 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:05:55,465 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:05:55,465 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:05:57,961 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:05:57,961 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:05:58,035 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:05:58,035 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:05:58,035 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:05:58,036 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:05:58,036 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:05:58,036 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:05:58,036 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:05:58,036 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:05:58,036 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:05:58,036 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:05:58,036 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:05:58,036 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:05:58,036 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:05:58,112 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:58,112 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:05:58,112 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:05:58,112 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:05:58,112 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:05:58,112 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:05:58,112 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:05:58,112 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:05:58,112 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:06:01,117 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:06:01,118 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:06:01,203 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:06:01,203 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:06:01,203 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:06:01,203 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:06:01,203 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:06:01,203 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:06:01,203 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:06:01,203 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:06:01,203 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:06:01,203 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:06:01,203 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:06:01,203 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:06:01,203 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:06:01,280 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:01,280 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:01,280 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:06:01,280 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:06:01,280 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:06:01,280 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:06:01,280 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:06:01,280 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:06:01,280 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:06:04,285 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:06:04,286 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:06:04,361 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:06:04,361 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:06:04,361 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:06:04,361 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:06:04,361 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:06:04,361 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:06:04,361 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:06:04,361 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:06:04,361 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:06:04,361 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:06:04,361 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:06:04,361 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:06:04,361 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:06:04,437 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:04,437 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:04,437 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:06:04,437 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:06:04,437 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:06:04,437 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:06:04,438 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:06:04,438 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:06:04,438 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:06:04,878 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:06:04,878 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:06:04,878 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:06:04,879 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:04,879 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:06:04,879 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:06:04,879 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:06:04,879 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:06:04,879 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:06:04,879 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:06:04,879 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:06:04,879 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:06:04,879 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:06:04,879 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:06:04,879 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:06:04,879 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:04,879 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:06:04,879 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:06:04,879 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:06:04,879 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:06:04,879 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:04,879 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:04,880 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:06:04,880 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:04,881 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:06:04,881 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:06:04,881 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:06:04,881 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:06:04,881 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:06:04,881 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:06:04,881 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:06:04,881 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:06:04,881 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:06:04,882 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:04,882 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:06:04,882 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 72942)
2025-06-28 11:06:04,882 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:06:04,882 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:06:04,882 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:06:04,882 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:04,882 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:06:04,882 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:06:04,882 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:06:04,882 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:06:04,882 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:04,884 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:06:04,884 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:06:04,884 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 72943)
2025-06-28 11:06:04,884 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:06:04,885 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:06:04,885 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:06:04,885 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:06:04,885 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:04,888 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:06:04,888 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 72944)
2025-06-28 11:06:04,888 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:06:04,888 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:06:04,888 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:06:04,889 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:06:04,889 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:06:04,889 - websockets.client - DEBUG - > Sec-WebSocket-Key: Hc+i1avJITVqRx/FdfdjJQ==
2025-06-28 11:06:04,890 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:06:04,890 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:06:04,890 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:06:04,890 - websockets.client - DEBUG - > EOF
2025-06-28 11:06:04,890 - websockets.client - DEBUG - < EOF
2025-06-28 11:06:04,890 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:06:04,892 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:06:04,892 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:06:05,485 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:06:05,485 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:06:05,494 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:06:05,494 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:06:05,494 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:06:05,494 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:06:05,494 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:06:05,495 - websockets.client - DEBUG - > Sec-WebSocket-Key: ux+XynjrhYWKlHaVqXSliQ==
2025-06-28 11:06:05,495 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:06:05,495 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:06:05,495 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:06:05,495 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:06:05,495 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:06:05,495 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:06:05,495 - websockets.client - DEBUG - < Sec-WebSocket-Accept: vYQfFjMWgImJ4qkTy7xWk2mgLtA=
2025-06-28 11:06:05,495 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:06:05,495 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:06:05 GMT
2025-06-28 11:06:05,496 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:06:05,496 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:06:05,496 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:06:05,496 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:06:05,496 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:06:05,496 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:06:05,496 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:06:05,496 - websockets.client - DEBUG - < EOF
2025-06-28 11:06:05,496 - websockets.client - DEBUG - > EOF
2025-06-28 11:06:05,496 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:06:05,496 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:06:05,496 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:06:05,496 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:06:05,497 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:06:05,497 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:06:05,497 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:06:06,206 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:06:06,207 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:06:06,498 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:06:06,498 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:06:07,072 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:06:07,072 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:06:07,442 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:06:07,443 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:06:07,519 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:06:07,519 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:06:07,519 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:06:07,519 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:06:07,519 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:06:07,519 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:06:07,519 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:06:07,520 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:06:07,520 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:06:07,520 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:06:07,520 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:06:07,520 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:06:07,520 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:06:07,520 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:06:07,522 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:06:07,522 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:06:05,134 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:06:05,134 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:06:05,134 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:06:05,134 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:06:05,135 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:06:05,135 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:06:05,135 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:06:05,135 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:06:05,135 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:06:05,135 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:06:05,135 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:06:05,135 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:06:05,135 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:06:05,135 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:06:05,140 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:06:05,140 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:06:05,140 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:06:05,140 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:06:07,522 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:06:07,523 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:06:07,523 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:06:07,524 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:06:07,524 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:06:05,017 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:06:05,017 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:06:05,017 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:06:05,017 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:06:05,020 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:06:05,020 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:06:05,020 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:06:05,020 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:06:05,495 - websockets.server - INFO - connection open
2025-06-28 11:06:05,495 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 61579)
2025-06-28 11:06:05,496 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:06:05,496 - websockets.server - INFO - connection closed

2025-06-28 11:06:07,525 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:06:07,525 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:06:07,525 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:06:07,527 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:06:07,527 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:06:05,161 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:06:05,161 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:06:05,161 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:06:05,161 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:06:05,161 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:06:05,162 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:06:05,163 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:06:05,163 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:06:05,163 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:06:05,163 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:06:05,495 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:06:05,495 - websockets.server - INFO - connection closed
2025-06-28 11:06:05,497 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:06:05,497 - websockets.server - INFO - connection closed

2025-06-28 11:06:07,527 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:06:07,528 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:06:07,607 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:07,607 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:07,607 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:06:07,607 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:06:07,607 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:06:07,607 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:06:07,607 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:06:07,607 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:06:07,607 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:06:08,110 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:06:08,110 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:06:08,111 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:06:08,111 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:06:10,612 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:06:10,613 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:06:10,688 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:06:10,688 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:06:10,688 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:06:10,688 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:06:10,688 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:06:10,688 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:06:10,688 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:06:10,688 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:06:10,688 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:06:10,688 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:06:10,688 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:06:10,688 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:06:10,688 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:06:10,765 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:10,765 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:10,765 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:06:10,765 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:06:10,765 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:06:10,765 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:06:10,765 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:06:10,765 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:06:10,765 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:06:13,770 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:06:13,770 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:06:13,845 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:06:13,845 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:06:13,845 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:06:13,845 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:06:13,845 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:06:13,845 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:06:13,845 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:06:13,845 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:06:13,845 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:06:13,845 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:06:13,845 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:06:13,845 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:06:13,845 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:06:13,921 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:13,922 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:13,922 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:06:13,922 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:06:13,922 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:06:13,922 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:06:13,922 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:06:13,922 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:06:13,922 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:06:16,927 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:06:16,927 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:06:17,001 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:06:17,001 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:06:17,001 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:06:17,001 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:06:17,001 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:06:17,001 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:06:17,002 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:06:17,002 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:06:17,002 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:06:17,002 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:06:17,002 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:06:17,002 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:06:17,002 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:06:17,080 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:17,080 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:17,080 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:06:17,080 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:06:17,080 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:06:17,080 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:06:17,080 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:06:17,080 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:06:17,080 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:06:17,524 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:06:17,524 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:06:17,524 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:06:17,524 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:17,524 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:06:17,524 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:06:17,524 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:06:17,524 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:06:17,525 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:06:17,525 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:06:17,525 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:06:17,525 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:17,525 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:06:17,525 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:06:17,525 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:17,527 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 73018)
2025-06-28 11:06:17,527 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:06:17,527 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:06:17,527 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:06:17,528 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:06:17,529 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:06:17,529 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:06:17,529 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:06:17,529 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:06:17,529 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:17,529 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:06:17,529 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:06:17,529 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:06:17,530 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:06:17,530 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:06:17,530 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:17,530 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:06:17,530 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:06:17,530 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:06:17,530 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:06:17,530 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:06:17,530 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:06:17,530 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:17,530 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:06:17,530 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:06:17,530 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:17,530 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:06:17,530 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:06:17,530 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:06:17,530 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:06:17,530 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:06:17,530 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:06:17,530 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:17,530 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:06:17,531 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:06:17,531 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:17,533 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 73019)
2025-06-28 11:06:17,533 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:06:17,534 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 73020)
2025-06-28 11:06:17,534 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:06:17,536 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:06:17,536 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:06:17,536 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:06:17,536 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:06:17,537 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:06:17,537 - websockets.client - DEBUG - > Sec-WebSocket-Key: MEzoWnLkefuCA2MP0Sk7ow==
2025-06-28 11:06:17,537 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:06:17,537 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:06:17,537 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:06:17,537 - websockets.client - DEBUG - > EOF
2025-06-28 11:06:17,537 - websockets.client - DEBUG - < EOF
2025-06-28 11:06:17,537 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:06:17,539 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:06:17,539 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:06:18,129 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:06:18,129 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:06:18,142 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:06:18,142 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:06:18,142 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:06:18,142 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:06:18,142 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:06:18,142 - websockets.client - DEBUG - > Sec-WebSocket-Key: Sm6wgFbXonnFeah815JXFw==
2025-06-28 11:06:18,143 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:06:18,143 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:06:18,143 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:06:18,143 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:06:18,143 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:06:18,143 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:06:18,143 - websockets.client - DEBUG - < Sec-WebSocket-Accept: K8b8IBD+BKrc/lFMpGA7rItVFGs=
2025-06-28 11:06:18,143 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:06:18,143 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:06:18,143 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:06:18,143 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:06:18 GMT
2025-06-28 11:06:18,143 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:06:18,143 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:06:18,144 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:06:18,144 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:06:18,144 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:06:18,144 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:06:18,144 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:06:18,144 - websockets.client - DEBUG - < EOF
2025-06-28 11:06:18,144 - websockets.client - DEBUG - > EOF
2025-06-28 11:06:18,144 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:06:18,144 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:06:18,144 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:06:18,144 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:06:18,144 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:06:18,850 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:06:18,850 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:06:19,144 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:06:19,145 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:06:19,716 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:06:19,716 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:06:20,085 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:06:20,085 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:06:20,168 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:06:20,169 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:06:20,169 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:06:20,169 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:06:20,169 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:06:20,169 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:06:20,169 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:06:20,169 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:06:20,169 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:06:20,169 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:06:20,169 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:06:20,169 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:06:20,169 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:06:20,169 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:06:20,170 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:06:20,170 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:06:17,791 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:06:17,791 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:06:17,791 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:06:17,791 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:06:17,791 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:06:17,791 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:06:17,791 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:06:17,791 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:06:17,791 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:06:17,791 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:06:17,791 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:06:17,792 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:06:17,792 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:06:17,792 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:06:17,795 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:06:17,795 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:06:17,795 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:06:17,795 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:06:20,171 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:06:20,173 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:06:20,173 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:06:20,174 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:06:20,174 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:06:17,669 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:06:17,670 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:06:17,670 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:06:17,670 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:06:17,672 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:06:17,672 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:06:17,672 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:06:17,673 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:06:18,143 - websockets.server - INFO - connection open
2025-06-28 11:06:18,143 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 61607)
2025-06-28 11:06:18,144 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:06:18,144 - websockets.server - INFO - connection closed

2025-06-28 11:06:20,174 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:06:20,174 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:06:20,174 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:06:20,177 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:06:20,177 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:06:17,842 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:06:17,842 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:06:17,842 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:06:17,842 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:06:17,842 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:06:17,843 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:06:17,844 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:06:17,844 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:06:17,844 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:06:17,844 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:06:18,142 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:06:18,142 - websockets.server - INFO - connection closed
2025-06-28 11:06:18,143 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:06:18,143 - websockets.server - INFO - connection closed

2025-06-28 11:06:20,177 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:06:20,178 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:06:20,257 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:20,257 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:20,257 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:06:20,257 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:06:20,257 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:06:20,257 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:06:20,257 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:06:20,257 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:06:20,257 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:06:20,754 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:06:20,754 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:06:20,754 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:06:20,754 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:06:23,262 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:06:23,262 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:06:23,348 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:06:23,348 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:06:23,349 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:06:23,349 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:06:23,349 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:06:23,349 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:06:23,349 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:06:23,349 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:06:23,349 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:06:23,349 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:06:23,349 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:06:23,349 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:06:23,349 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:06:23,445 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:23,446 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:23,446 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:06:23,446 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:06:23,446 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:06:23,446 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:06:23,446 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:06:23,446 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:06:23,446 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:06:26,451 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:06:26,451 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:06:26,525 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:06:26,525 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:06:26,525 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:06:26,525 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:06:26,526 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:06:26,526 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:06:26,526 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:06:26,526 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:06:26,526 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:06:26,526 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:06:26,526 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:06:26,526 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:06:26,526 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:06:26,603 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:26,603 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:26,603 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:06:26,603 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:06:26,603 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:06:26,603 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:06:26,603 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:06:26,603 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:06:26,603 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:06:29,608 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:06:29,608 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:06:29,683 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:06:29,684 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:06:29,684 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:06:29,684 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:06:29,684 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:06:29,684 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:06:29,684 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:06:29,684 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:06:29,684 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:06:29,684 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:06:29,684 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:06:29,684 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:06:29,684 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:06:29,761 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:29,761 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:29,761 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:06:29,761 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:06:29,761 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:06:29,761 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:06:29,761 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:06:29,761 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:06:29,761 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:06:30,176 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:06:30,176 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:06:30,176 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:06:30,176 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:30,176 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:06:30,176 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:06:30,176 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:06:30,176 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:06:30,176 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:06:30,176 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:06:30,177 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:06:30,177 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:30,177 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:06:30,177 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:06:30,177 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:30,178 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:06:30,178 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:06:30,179 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:06:30,179 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 73096)
2025-06-28 11:06:30,179 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:06:30,179 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:06:30,179 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:06:30,179 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:06:30,179 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:06:30,179 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:30,180 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:06:30,180 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:06:30,180 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:06:30,180 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:06:30,180 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:30,180 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:06:30,180 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:06:30,180 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:06:30,180 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:06:30,180 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:06:30,180 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:06:30,180 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:06:30,180 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:06:30,180 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:30,180 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:06:30,180 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:06:30,180 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:30,180 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:06:30,181 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:06:30,181 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:06:30,181 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:06:30,181 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:06:30,181 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:30,181 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:06:30,181 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:06:30,181 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:30,183 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 73097)
2025-06-28 11:06:30,184 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:06:30,184 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 73098)
2025-06-28 11:06:30,185 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:06:30,186 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:06:30,186 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:06:30,186 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:06:30,186 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:06:30,186 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:06:30,187 - websockets.client - DEBUG - > Sec-WebSocket-Key: 5uEfJzfKKQU4yQj8hcAiJA==
2025-06-28 11:06:30,187 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:06:30,187 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:06:30,187 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:06:30,187 - websockets.client - DEBUG - > EOF
2025-06-28 11:06:30,187 - websockets.client - DEBUG - < EOF
2025-06-28 11:06:30,187 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:06:30,189 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:06:30,189 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:06:30,781 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:06:30,781 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:06:30,792 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:06:30,792 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:06:30,792 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:06:30,792 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:06:30,792 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:06:30,792 - websockets.client - DEBUG - > Sec-WebSocket-Key: J9b5li+ysvQX3wpLdfi71g==
2025-06-28 11:06:30,792 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:06:30,792 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:06:30,792 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:06:30,793 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:06:30,793 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:06:30,793 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:06:30,793 - websockets.client - DEBUG - < Sec-WebSocket-Accept: O0SsX1OykPtwTyGQoon2dv3iNxs=
2025-06-28 11:06:30,793 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:06:30,793 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:06:30 GMT
2025-06-28 11:06:30,793 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:06:30,793 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:06:30,793 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:06:30,793 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:06:30,793 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:06:30,793 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:06:30,793 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:06:30,794 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:06:30,794 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:06:30,794 - websockets.client - DEBUG - < EOF
2025-06-28 11:06:30,794 - websockets.client - DEBUG - > EOF
2025-06-28 11:06:30,794 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:06:30,794 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:06:30,794 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:06:30,794 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:06:30,794 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:06:31,502 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:06:31,502 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:06:31,794 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:06:31,795 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:06:32,368 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:06:32,368 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:06:32,762 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:06:32,762 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:06:32,837 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:06:32,837 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:06:32,837 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:06:32,837 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:06:32,837 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:06:32,837 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:06:32,837 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:06:32,837 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:06:32,837 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:06:32,837 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:06:32,837 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:06:32,837 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:06:32,837 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:06:32,837 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:06:32,838 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:06:32,839 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:06:32,839 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:06:30,418 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:06:30,418 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:06:30,418 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:06:30,418 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:06:30,418 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:06:30,418 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:06:30,418 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:06:30,418 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:06:30,418 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:06:30,418 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:06:30,418 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:06:30,419 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:06:30,419 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:06:30,419 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:06:30,424 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:06:30,424 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:06:30,424 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:06:30,424 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:06:32,839 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:06:32,839 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:06:32,840 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:06:32,840 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:06:30,315 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:06:30,315 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:06:30,315 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:06:30,315 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:06:30,319 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:06:30,319 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:06:30,319 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:06:30,319 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:06:30,793 - websockets.server - INFO - connection open
2025-06-28 11:06:30,793 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 61627)
2025-06-28 11:06:30,793 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:06:30,794 - websockets.server - INFO - connection closed

2025-06-28 11:06:32,840 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:06:32,840 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:06:32,840 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:06:32,841 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:06:32,841 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:06:30,474 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:06:30,474 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:06:30,474 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:06:30,475 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:06:30,475 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:06:30,475 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:06:30,477 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:06:30,477 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:06:30,477 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:06:30,477 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:06:30,792 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:06:30,792 - websockets.server - INFO - connection closed
2025-06-28 11:06:30,793 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:06:30,793 - websockets.server - INFO - connection closed

2025-06-28 11:06:32,841 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:06:32,842 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:06:32,918 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:32,918 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:32,918 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:06:32,918 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:06:32,918 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:06:32,918 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:06:32,918 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:06:32,918 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:06:32,918 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:06:33,406 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:06:33,406 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:06:33,406 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:06:33,406 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:06:35,923 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:06:35,923 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:06:35,997 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:06:35,998 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:06:35,998 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:06:35,998 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:06:35,998 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:06:35,998 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:06:35,998 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:06:35,998 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:06:35,998 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:06:35,998 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:06:35,998 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:06:35,998 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:06:35,998 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:06:36,074 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:36,074 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:36,074 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:06:36,074 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:06:36,074 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:06:36,075 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:06:36,075 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:06:36,075 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:06:36,075 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:06:39,078 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:06:39,078 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:06:39,153 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:06:39,153 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:06:39,153 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:06:39,153 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:06:39,153 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:06:39,153 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:06:39,153 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:06:39,153 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:06:39,153 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:06:39,153 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:06:39,153 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:06:39,153 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:06:39,153 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:06:39,254 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:39,254 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:39,254 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:06:39,254 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:06:39,254 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:06:39,254 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:06:39,254 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:06:39,254 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:06:39,255 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:06:42,260 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:06:42,260 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:06:42,335 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:06:42,335 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:06:42,335 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:06:42,335 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:06:42,335 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:06:42,335 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:06:42,335 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:06:42,335 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:06:42,335 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:06:42,335 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:06:42,335 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:06:42,335 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:06:42,335 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:06:42,413 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:42,413 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:42,413 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:06:42,413 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:06:42,413 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:06:42,413 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:06:42,413 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:06:42,413 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:06:42,413 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:06:42,844 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:06:42,844 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:06:42,844 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:06:42,844 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:06:42,844 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:06:42,844 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:06:42,844 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:06:42,844 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:06:42,845 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:06:42,845 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:42,845 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:42,845 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:06:42,845 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:06:42,845 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:42,845 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:06:42,845 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:06:42,845 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:06:42,845 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:06:42,845 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:06:42,845 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:06:42,845 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:06:42,845 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:06:42,845 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:06:42,845 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:06:42,845 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:06:42,845 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:06:42,845 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:06:42,845 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:06:42,846 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:06:42,846 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:06:42,846 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:42,846 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:06:42,846 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:42,846 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:42,846 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:06:42,846 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:06:42,846 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:06:42,846 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:06:42,846 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:42,847 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:06:42,848 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:06:42,848 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:06:42,848 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:42,848 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:06:42,848 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:06:42,849 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:06:42,849 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:42,850 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 73168)
2025-06-28 11:06:42,851 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:06:42,851 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 73169)
2025-06-28 11:06:42,852 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:06:42,852 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 73170)
2025-06-28 11:06:42,852 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:06:42,852 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:06:42,854 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:06:42,855 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:06:42,855 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:06:42,855 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:06:42,855 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:06:42,855 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:06:42,855 - websockets.client - DEBUG - > Sec-WebSocket-Key: N/mdv7r42om27rVQIyp0kQ==
2025-06-28 11:06:42,856 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:06:42,856 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:06:42,856 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:06:42,856 - websockets.client - DEBUG - > EOF
2025-06-28 11:06:42,856 - websockets.client - DEBUG - < EOF
2025-06-28 11:06:42,856 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:06:42,858 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:06:42,858 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:06:43,455 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:06:43,455 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:06:43,460 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:06:43,461 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:06:43,461 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:06:43,461 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:06:43,461 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:06:43,461 - websockets.client - DEBUG - > Sec-WebSocket-Key: wjWYb/o8Sm1tcV9L9NOSPg==
2025-06-28 11:06:43,461 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:06:43,461 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:06:43,461 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:06:43,462 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:06:43,463 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:06:43,463 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:06:43,463 - websockets.client - DEBUG - < Sec-WebSocket-Accept: 60hjnX6B3q7vlhgvzCZhjCE/A9Y=
2025-06-28 11:06:43,463 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:06:43,463 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:06:43 GMT
2025-06-28 11:06:43,463 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:06:43,463 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:06:43,463 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:06:43,464 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:06:43,464 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:06:43,464 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:06:43,464 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:06:43,464 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:06:43,465 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:06:43,465 - websockets.client - DEBUG - < EOF
2025-06-28 11:06:43,465 - websockets.client - DEBUG - > EOF
2025-06-28 11:06:43,465 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:06:43,465 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:06:43,465 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:06:43,465 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:06:43,465 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:06:44,177 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:06:44,177 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:06:44,466 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:06:44,466 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:06:45,041 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:06:45,041 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:06:45,413 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:06:45,413 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:06:45,504 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:06:45,505 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:06:45,505 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:06:45,505 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:06:45,505 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:06:45,505 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:06:45,505 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:06:45,505 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:06:45,505 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:06:45,505 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:06:45,505 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:06:45,505 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:06:45,505 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:06:45,505 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:06:45,507 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:06:45,507 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:06:43,079 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:06:43,080 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:06:43,080 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:06:43,080 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:06:43,080 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:06:43,080 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:06:43,080 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:06:43,080 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:06:43,080 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:06:43,080 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:06:43,080 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:06:43,080 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:06:43,080 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:06:43,080 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:06:43,083 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:06:43,083 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:06:43,083 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:06:43,083 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:06:45,507 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:06:45,509 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:06:45,509 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:06:45,511 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:06:45,512 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:06:43,119 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:06:43,119 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:06:43,119 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:06:43,119 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:06:43,119 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:06:43,119 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:06:43,121 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:06:43,121 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:06:43,121 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:06:43,121 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:06:43,462 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:06:43,462 - websockets.server - INFO - connection closed
2025-06-28 11:06:43,464 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:06:43,465 - websockets.server - INFO - connection closed

2025-06-28 11:06:45,512 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:06:45,513 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:06:45,513 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:06:45,514 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:06:45,514 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:06:42,982 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:06:42,983 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:06:42,983 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:06:42,983 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:06:42,985 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:06:42,985 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:06:42,985 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:06:42,985 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:06:43,462 - websockets.server - INFO - connection open
2025-06-28 11:06:43,462 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 61643)
2025-06-28 11:06:43,464 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:06:43,465 - websockets.server - INFO - connection closed

2025-06-28 11:06:45,514 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:06:45,514 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:06:45,597 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:45,598 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:45,598 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:06:45,598 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:06:45,598 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:06:45,598 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:06:45,598 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:06:45,598 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:06:45,598 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:06:46,079 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:06:46,080 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:06:46,080 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:06:46,080 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:06:48,603 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:06:48,603 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:06:48,681 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:06:48,681 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:06:48,681 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:06:48,682 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:06:48,682 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:06:48,682 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:06:48,682 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:06:48,682 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:06:48,682 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:06:48,682 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:06:48,682 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:06:48,682 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:06:48,682 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:06:48,760 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:48,760 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:48,760 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:06:48,760 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:06:48,760 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:06:48,760 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:06:48,760 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:06:48,760 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:06:48,760 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:06:51,765 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:06:51,765 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:06:51,840 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:06:51,840 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:06:51,840 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:06:51,840 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:06:51,840 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:06:51,840 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:06:51,840 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:06:51,840 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:06:51,840 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:06:51,840 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:06:51,840 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:06:51,840 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:06:51,840 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:06:51,918 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:51,918 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:51,918 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:06:51,918 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:06:51,918 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:06:51,918 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:06:51,918 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:06:51,918 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:06:51,918 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:06:54,923 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:06:54,923 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:06:54,998 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:06:54,998 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:06:54,998 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:06:54,998 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:06:54,998 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:06:54,998 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:06:54,998 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:06:54,998 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:06:54,998 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:06:54,998 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:06:54,998 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:06:54,998 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:06:54,998 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:06:55,074 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:55,074 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:55,074 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:06:55,075 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:06:55,075 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:06:55,075 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:06:55,075 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:06:55,075 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:06:55,075 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:06:55,508 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:06:55,508 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:06:55,508 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:06:55,509 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:55,509 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:06:55,509 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:06:55,509 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:06:55,509 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:06:55,509 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:06:55,509 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:06:55,509 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:06:55,509 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:55,509 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:06:55,509 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:06:55,509 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:55,511 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 73251)
2025-06-28 11:06:55,512 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:06:55,512 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:06:55,512 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:06:55,512 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:06:55,512 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:06:55,512 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:06:55,512 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:55,512 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:06:55,512 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:06:55,512 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:06:55,512 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:06:55,512 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:06:55,512 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:06:55,512 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:55,513 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:06:55,513 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:06:55,513 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:06:55,513 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:06:55,513 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:55,515 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 73252)
2025-06-28 11:06:55,515 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:06:55,515 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:06:55,515 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:06:55,516 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:06:55,516 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:55,516 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:06:55,516 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:06:55,516 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:06:55,516 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:06:55,517 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:06:55,517 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:06:55,517 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:55,517 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:06:55,517 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:06:55,517 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:06:55,517 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:06:55,517 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:06:55,520 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 73253)
2025-06-28 11:06:55,521 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:06:55,521 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:06:55,522 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:06:55,523 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:06:55,523 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:06:55,523 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:06:55,523 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:06:55,523 - websockets.client - DEBUG - > Sec-WebSocket-Key: Kib/hfWquPmhXh+iC5rdgw==
2025-06-28 11:06:55,523 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:06:55,523 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:06:55,523 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:06:55,523 - websockets.client - DEBUG - > EOF
2025-06-28 11:06:55,523 - websockets.client - DEBUG - < EOF
2025-06-28 11:06:55,523 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:06:55,525 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:06:56,113 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:06:56,114 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:06:56,124 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:06:56,124 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:06:56,127 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:06:56,127 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:06:56,127 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:06:56,127 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:06:56,127 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:06:56,127 - websockets.client - DEBUG - > Sec-WebSocket-Key: qYP3+bNMZGYrTwR84OcUlA==
2025-06-28 11:06:56,127 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:06:56,127 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:06:56,127 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:06:56,128 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:06:56,128 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:06:56,128 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:06:56,128 - websockets.client - DEBUG - < Sec-WebSocket-Accept: /iB7cZE0q+ySNGoWwbOUTNkzfY0=
2025-06-28 11:06:56,128 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:06:56,128 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:06:56 GMT
2025-06-28 11:06:56,128 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:06:56,128 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:06:56,128 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:06:56,128 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:06:56,128 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:06:56,128 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:06:56,128 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:06:56,128 - websockets.client - DEBUG - < EOF
2025-06-28 11:06:56,128 - websockets.client - DEBUG - > EOF
2025-06-28 11:06:56,128 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:06:56,128 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:06:56,129 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:06:56,129 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:06:56,129 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:06:56,835 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:06:56,835 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:06:57,126 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:06:57,126 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:06:57,701 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:06:57,701 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:06:58,076 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:06:58,076 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:06:58,152 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:06:58,153 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:06:58,153 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:06:58,153 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:06:58,153 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:06:58,153 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:06:58,153 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:06:58,153 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:06:58,153 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:06:58,153 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:06:58,153 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:06:58,153 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:06:58,153 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:06:58,153 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:06:58,154 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:06:58,154 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:06:55,815 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:06:55,816 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:06:55,816 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:06:55,816 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:06:55,816 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:06:55,816 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:06:55,816 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:06:55,816 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:06:55,816 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:06:55,816 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:06:55,816 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:06:55,816 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:06:55,816 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:06:55,816 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:06:55,819 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:06:55,819 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:06:55,819 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:06:55,819 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:06:58,155 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:06:58,157 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:06:58,157 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:06:58,159 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:06:58,159 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:06:55,868 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:06:55,868 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:06:55,868 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:06:55,868 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:06:55,868 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:06:55,869 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:06:55,870 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:06:55,870 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:06:55,870 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:06:55,870 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:06:56,124 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:06:56,124 - websockets.server - INFO - connection closed
2025-06-28 11:06:56,125 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:06:56,125 - websockets.server - INFO - connection closed

2025-06-28 11:06:58,159 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:06:58,160 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:06:58,160 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:06:58,162 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:06:58,162 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:06:55,681 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:06:55,682 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:06:55,682 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:06:55,682 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:06:55,687 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:06:55,687 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:06:55,687 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:06:55,687 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:06:56,128 - websockets.server - INFO - connection open
2025-06-28 11:06:56,128 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 61670)
2025-06-28 11:06:56,128 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:06:56,128 - websockets.server - INFO - connection closed

2025-06-28 11:06:58,162 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:06:58,164 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:06:58,242 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:58,242 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:06:58,242 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:06:58,242 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:06:58,242 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:06:58,242 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:06:58,242 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:06:58,242 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:06:58,242 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:06:58,739 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:06:58,739 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:06:58,739 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:06:58,739 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:07:01,245 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:07:01,245 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:07:01,319 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:07:01,320 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:07:01,320 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:07:01,320 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:07:01,320 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:07:01,320 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:07:01,320 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:07:01,320 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:07:01,320 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:07:01,320 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:07:01,320 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:07:01,320 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:07:01,320 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:07:01,398 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:01,398 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:01,398 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:07:01,398 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:07:01,398 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:07:01,398 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:07:01,398 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:07:01,398 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:07:01,398 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:07:04,403 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:07:04,403 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:07:04,478 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:07:04,478 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:07:04,479 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:07:04,479 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:07:04,479 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:07:04,479 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:07:04,479 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:07:04,479 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:07:04,479 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:07:04,479 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:07:04,479 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:07:04,479 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:07:04,479 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:07:04,556 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:04,556 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:04,556 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:07:04,556 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:07:04,556 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:07:04,556 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:07:04,556 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:07:04,556 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:07:04,556 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:07:07,561 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:07:07,562 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:07:07,660 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:07:07,660 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:07:07,660 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:07:07,660 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:07:07,660 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:07:07,660 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:07:07,660 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:07:07,660 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:07:07,660 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:07:07,660 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:07:07,660 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:07:07,660 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:07:07,660 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:07:07,738 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:07,738 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:07,738 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:07:07,738 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:07:07,738 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:07:07,738 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:07:07,738 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:07:07,738 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:07:07,738 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:07:08,160 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:07:08,160 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:07:08,160 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:07:08,160 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:08,160 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:07:08,160 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:07:08,160 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:07:08,160 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:07:08,160 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:07:08,160 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:07:08,160 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:07:08,161 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:08,161 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:07:08,161 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:07:08,161 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:07:08,161 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:07:08,161 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:07:08,161 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:08,162 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:08,163 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:07:08,163 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:07:08,163 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:07:08,163 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:07:08,163 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:07:08,163 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:07:08,163 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:08,163 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 73338)
2025-06-28 11:07:08,163 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:07:08,163 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:07:08,163 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:07:08,164 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:07:08,164 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:07:08,164 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:07:08,164 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:07:08,164 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:08,165 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 73339)
2025-06-28 11:07:08,166 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:07:08,167 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:07:08,167 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:07:08,167 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:07:08,168 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:08,168 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:07:08,168 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:07:08,168 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:07:08,168 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:07:08,168 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:07:08,168 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:07:08,168 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:07:08,168 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:08,168 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:07:08,169 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:07:08,169 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:07:08,169 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:07:08,169 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:08,171 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 73340)
2025-06-28 11:07:08,171 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:07:08,173 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:07:08,173 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:07:08,173 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:07:08,173 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:07:08,173 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:07:08,173 - websockets.client - DEBUG - > Sec-WebSocket-Key: XKJFci1bSkWZxovQpj81QA==
2025-06-28 11:07:08,173 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:07:08,173 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:07:08,174 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:07:08,174 - websockets.client - DEBUG - > EOF
2025-06-28 11:07:08,174 - websockets.client - DEBUG - < EOF
2025-06-28 11:07:08,174 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:07:08,175 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:07:08,765 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:07:08,765 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:07:08,771 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:07:08,771 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:07:08,777 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:07:08,777 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:07:08,777 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:07:08,777 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:07:08,777 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:07:08,777 - websockets.client - DEBUG - > Sec-WebSocket-Key: mKsEIHtNATaQf5z3FzHuBQ==
2025-06-28 11:07:08,777 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:07:08,777 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:07:08,777 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:07:08,778 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:07:08,778 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:07:08,778 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:07:08,778 - websockets.client - DEBUG - < Sec-WebSocket-Accept: k+Y7JQHbErre6MlVMPPi2aPetjY=
2025-06-28 11:07:08,778 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:07:08,778 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:07:08 GMT
2025-06-28 11:07:08,778 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:07:08,778 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:07:08,778 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:07:08,778 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:07:08,778 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:07:08,778 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:07:08,778 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:07:08,778 - websockets.client - DEBUG - < EOF
2025-06-28 11:07:08,778 - websockets.client - DEBUG - > EOF
2025-06-28 11:07:08,778 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:07:08,778 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:07:08,779 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:07:08,779 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:07:08,779 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:07:09,486 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:07:09,487 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:07:09,772 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:07:09,773 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:07:10,352 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:07:10,352 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:07:10,743 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:07:10,743 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:07:10,819 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:07:10,819 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:07:10,819 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:07:10,819 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:07:10,819 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:07:10,819 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:07:10,819 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:07:10,819 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:07:10,819 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:07:10,820 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:07:10,820 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:07:10,820 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:07:10,820 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:07:10,820 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:07:10,821 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:07:10,821 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:07:08,405 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:07:08,405 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:07:08,405 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:07:08,405 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:07:08,405 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:07:08,405 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:07:08,405 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:07:08,405 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:07:08,405 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:07:08,405 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:07:08,405 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:07:08,405 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:07:08,405 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:07:08,405 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:07:08,408 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:07:08,408 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:07:08,408 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:07:08,408 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:07:10,821 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:07:10,821 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:07:10,821 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:07:10,823 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:07:10,823 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:07:08,446 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:07:08,446 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:07:08,446 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:07:08,446 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:07:08,446 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:07:08,446 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:07:08,448 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:07:08,448 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:07:08,448 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:07:08,448 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:07:08,771 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:07:08,771 - websockets.server - INFO - connection closed
2025-06-28 11:07:08,771 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:07:08,771 - websockets.server - INFO - connection closed

2025-06-28 11:07:10,823 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:07:10,825 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:07:10,825 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:07:10,826 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:07:10,826 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:07:08,303 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:07:08,303 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:07:08,303 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:07:08,303 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:07:08,306 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:07:08,306 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:07:08,306 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:07:08,306 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:07:08,778 - websockets.server - INFO - connection open
2025-06-28 11:07:08,778 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 61703)
2025-06-28 11:07:08,778 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:07:08,778 - websockets.server - INFO - connection closed

2025-06-28 11:07:10,826 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:07:10,829 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:07:10,905 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:10,905 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:10,906 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:07:10,906 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:07:10,906 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:07:10,906 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:07:10,906 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:07:10,906 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:07:10,906 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:07:11,390 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:07:11,390 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:07:11,390 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:07:11,391 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:07:13,911 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:07:13,911 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:07:13,986 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:07:13,986 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:07:13,986 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:07:13,986 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:07:13,986 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:07:13,986 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:07:13,986 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:07:13,986 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:07:13,986 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:07:13,986 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:07:13,986 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:07:13,986 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:07:13,986 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:07:14,065 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:14,066 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:14,066 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:07:14,066 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:07:14,066 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:07:14,066 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:07:14,066 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:07:14,066 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:07:14,066 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:07:17,070 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:07:17,070 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:07:17,144 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:07:17,144 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:07:17,144 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:07:17,145 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:07:17,145 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:07:17,145 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:07:17,145 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:07:17,145 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:07:17,145 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:07:17,145 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:07:17,145 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:07:17,145 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:07:17,145 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:07:17,222 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:17,222 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:17,222 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:07:17,222 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:07:17,222 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:07:17,222 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:07:17,222 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:07:17,222 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:07:17,222 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:07:20,227 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:07:20,227 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:07:20,302 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:07:20,303 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:07:20,303 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:07:20,303 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:07:20,303 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:07:20,303 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:07:20,303 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:07:20,303 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:07:20,303 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:07:20,303 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:07:20,303 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:07:20,303 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:07:20,303 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:07:20,381 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:20,381 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:20,381 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:07:20,381 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:07:20,381 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:07:20,381 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:07:20,381 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:07:20,381 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:07:20,381 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:07:20,826 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:07:20,826 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:07:20,826 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:07:20,826 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:07:20,827 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:07:20,827 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:07:20,827 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:20,827 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:20,827 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:07:20,827 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:07:20,827 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:07:20,827 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:07:20,827 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:07:20,827 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:07:20,827 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:07:20,827 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:07:20,827 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:07:20,827 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:07:20,827 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:07:20,827 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:07:20,828 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:07:20,828 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:20,828 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:20,828 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:07:20,828 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:07:20,828 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:20,828 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:07:20,830 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:07:20,830 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:07:20,830 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:07:20,830 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:20,831 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 73429)
2025-06-28 11:07:20,831 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:07:20,831 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:07:20,832 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:07:20,832 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 73430)
2025-06-28 11:07:20,832 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:07:20,832 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:07:20,833 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:07:20,833 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:07:20,833 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:20,833 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:07:20,833 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:07:20,833 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:07:20,833 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:07:20,834 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:07:20,834 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:07:20,834 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:20,834 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:07:20,834 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:07:20,834 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:07:20,834 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:07:20,834 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:20,838 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 73431)
2025-06-28 11:07:20,838 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:07:20,839 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:07:20,840 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:07:20,840 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:07:20,840 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:07:20,840 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:07:20,840 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:07:20,840 - websockets.client - DEBUG - > Sec-WebSocket-Key: ync6RTU+4X0LoFOwrRMfXQ==
2025-06-28 11:07:20,840 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:07:20,840 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:07:20,841 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:07:20,841 - websockets.client - DEBUG - > EOF
2025-06-28 11:07:20,841 - websockets.client - DEBUG - < EOF
2025-06-28 11:07:20,841 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:07:20,842 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:07:21,434 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:07:21,435 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:07:21,444 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:07:21,444 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:07:21,445 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:07:21,445 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:07:21,445 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:07:21,445 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:07:21,445 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:07:21,445 - websockets.client - DEBUG - > Sec-WebSocket-Key: iZt3cSbn6UF+1556GVSS8g==
2025-06-28 11:07:21,445 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:07:21,445 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:07:21,445 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:07:21,445 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:07:21,446 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:07:21,446 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:07:21,446 - websockets.client - DEBUG - < Sec-WebSocket-Accept: cqjU50FJKemQVXymZJGZ6Kttd7I=
2025-06-28 11:07:21,446 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:07:21,446 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:07:21 GMT
2025-06-28 11:07:21,446 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:07:21,446 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:07:21,446 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:07:21,446 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:07:21,446 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:07:21,446 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:07:21,447 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:07:21,447 - websockets.client - DEBUG - < EOF
2025-06-28 11:07:21,447 - websockets.client - DEBUG - > EOF
2025-06-28 11:07:21,447 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:07:21,447 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:07:21,447 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:07:21,447 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:07:21,447 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:07:22,156 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:07:22,156 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:07:22,445 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:07:22,445 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:07:23,021 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:07:23,021 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:07:23,386 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:07:23,386 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:07:23,485 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:07:23,485 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:07:23,485 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:07:23,486 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:07:23,486 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:07:23,486 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:07:23,486 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:07:23,486 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:07:23,486 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:07:23,486 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:07:23,486 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:07:23,486 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:07:23,486 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:07:23,486 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:07:23,487 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:07:23,487 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:07:21,065 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:07:21,065 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:07:21,065 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:07:21,065 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:07:21,065 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:07:21,065 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:07:21,065 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:07:21,065 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:07:21,065 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:07:21,065 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:07:21,065 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:07:21,065 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:07:21,065 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:07:21,065 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:07:21,068 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:07:21,068 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:07:21,068 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:07:21,068 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:07:23,487 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:07:23,487 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:07:23,487 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:07:23,490 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:07:23,490 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:07:21,104 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:07:21,104 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:07:21,104 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:07:21,104 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:07:21,104 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:07:21,104 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:07:21,106 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:07:21,106 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:07:21,106 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:07:21,106 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:07:21,443 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:07:21,443 - websockets.server - INFO - connection closed
2025-06-28 11:07:21,444 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:07:21,444 - websockets.server - INFO - connection closed

2025-06-28 11:07:23,490 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:07:23,491 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:07:23,491 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:07:23,493 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:07:23,493 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:07:20,969 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:07:20,970 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:07:20,970 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:07:20,970 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:07:20,973 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:07:20,973 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:07:20,973 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:07:20,973 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:07:21,445 - websockets.server - INFO - connection open
2025-06-28 11:07:21,445 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 61748)
2025-06-28 11:07:21,446 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:07:21,447 - websockets.server - INFO - connection closed

2025-06-28 11:07:23,493 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:07:23,495 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:07:23,574 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:23,574 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:23,574 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:07:23,574 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:07:23,574 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:07:23,574 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:07:23,574 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:07:23,574 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:07:23,574 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:07:24,059 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:07:24,060 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:07:24,060 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:07:24,060 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:07:26,578 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:07:26,578 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:07:26,654 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:07:26,654 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:07:26,654 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:07:26,654 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:07:26,654 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:07:26,654 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:07:26,654 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:07:26,654 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:07:26,654 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:07:26,654 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:07:26,654 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:07:26,654 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:07:26,654 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:07:26,731 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:26,731 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:26,731 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:07:26,731 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:07:26,731 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:07:26,731 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:07:26,731 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:07:26,731 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:07:26,731 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:07:29,736 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:07:29,736 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程

================================================================================
[系统启动] 2025-06-28 11:07:29
================================================================================
[2025-06-28 11:07:29] 🚀 Agent Data Platform 启动中... (所有日志将统一记录到 logs/System.log)
2025-06-28 11:07:29,777 - asyncio - DEBUG - Using selector: KqueueSelector
[2025-06-28 11:07:29] 🧹 开始增强端口清理...
[2025-06-28 11:07:29] 🔍 搜索并清理相关Python进程...
2025-06-28 11:07:29,790 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:07:29,791 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:07:29,791 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:07:29,791 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:07:29,791 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:07:29,791 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:07:29,791 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:07:29,791 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:07:29,791 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:07:29,791 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:07:29,791 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:07:29,791 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:07:29,791 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:07:29,869 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:29,869 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:29,869 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:07:29,869 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:07:29,869 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:07:29,869 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:07:29,869 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:07:29,869 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:07:29,869 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:07:32,874 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:07:32,874 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:07:32,949 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:07:32,949 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:07:32,949 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:07:32,949 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:07:32,949 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:07:32,949 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:07:32,949 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:07:32,949 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:07:32,949 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:07:32,949 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:07:32,949 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:07:32,949 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:07:32,949 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:07:33,026 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:33,026 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:33,026 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:07:33,026 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:07:33,026 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:07:33,026 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:07:33,026 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:07:33,026 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:07:33,026 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:07:33,492 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:07:33,492 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:07:33,493 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:07:33,493 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:07:33,493 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:07:33,493 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:07:33,493 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:33,493 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:33,493 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:07:33,493 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:07:33,493 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:07:33,493 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:07:33,493 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:07:33,493 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:07:33,493 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:07:33,493 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:07:33,493 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:07:33,493 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:07:33,493 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:07:33,493 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:07:33,494 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:33,494 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:07:33,494 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:33,494 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:07:33,494 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:07:33,494 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:07:33,494 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:33,494 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:07:33,494 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:07:33,495 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:07:33,496 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:07:33,496 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:07:33,496 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:07:33,496 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:33,496 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:33,496 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:07:33,496 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:07:33,496 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 73517)
2025-06-28 11:07:33,497 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:07:33,498 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:07:33,498 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 73518)
2025-06-28 11:07:33,498 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:07:33,499 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:07:33,499 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:07:33,499 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:07:33,499 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:07:33,499 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:33,500 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:07:33,500 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:07:33,500 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:07:33,500 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:07:33,500 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:07:33,500 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:33,503 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 73519)
2025-06-28 11:07:33,503 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:07:33,505 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:07:33,505 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:07:33,505 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:07:33,505 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:07:33,505 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:07:33,505 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:07:33,506 - websockets.client - DEBUG - > Sec-WebSocket-Key: ySkHt/+e6xE8Na8La1Wv7Q==
2025-06-28 11:07:33,506 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:07:33,506 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:07:33,506 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:07:33,506 - websockets.client - DEBUG - > EOF
2025-06-28 11:07:33,506 - websockets.client - DEBUG - < EOF
2025-06-28 11:07:33,506 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:07:33,508 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:07:34,101 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:07:34,101 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:07:34,109 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:07:34,109 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:07:34,109 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:07:34,109 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:07:34,109 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:07:34,109 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:07:34,109 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:07:34,109 - websockets.client - DEBUG - > Sec-WebSocket-Key: aFCCkZvj/7FDXEC7uYxiog==
2025-06-28 11:07:34,109 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:07:34,109 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:07:34,109 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:07:34,110 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:07:34,110 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:07:34,110 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:07:34,110 - websockets.client - DEBUG - < Sec-WebSocket-Accept: /AbTU2ZAUpS+H1a2pTIMzAtTz9U=
2025-06-28 11:07:34,110 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:07:34,110 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:07:34 GMT
2025-06-28 11:07:34,110 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:07:34,110 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:07:34,110 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:07:34,111 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:07:34,111 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:07:34,111 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:07:34,111 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:07:34,111 - websockets.client - DEBUG - < EOF
2025-06-28 11:07:34,111 - websockets.client - DEBUG - > EOF
2025-06-28 11:07:34,111 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:07:34,111 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:07:34,111 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:07:34,111 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:07:34,111 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:07:34,822 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:07:34,822 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:07:35,110 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:07:35,111 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:07:35,688 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:07:35,688 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:07:36,028 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:07:36,028 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:07:36,104 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:07:36,104 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:07:36,104 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:07:36,104 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:07:36,104 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:07:36,104 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:07:36,104 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:07:36,104 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:07:36,104 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:07:36,104 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:07:36,104 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:07:36,104 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:07:36,104 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:07:36,104 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:07:36,106 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:07:36,106 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:07:33,747 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:07:33,747 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:07:33,747 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:07:33,747 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:07:33,747 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:07:33,747 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:07:33,747 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:07:33,747 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:07:33,747 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:07:33,747 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:07:33,747 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:07:33,747 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:07:33,747 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:07:33,747 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:07:33,750 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:07:33,750 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:07:33,750 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:07:33,750 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:07:36,106 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:07:36,108 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:07:36,108 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:07:36,110 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:07:36,110 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:07:33,798 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:07:33,798 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:07:33,798 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:07:33,798 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:07:33,798 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:07:33,799 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:07:33,800 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:07:33,800 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:07:33,800 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:07:33,800 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:07:34,108 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:07:34,108 - websockets.server - INFO - connection closed
2025-06-28 11:07:34,109 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:07:34,109 - websockets.server - INFO - connection closed

2025-06-28 11:07:36,110 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:07:36,112 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:07:36,112 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:07:36,113 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:07:36,113 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:07:33,640 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:07:33,640 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:07:33,640 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:07:33,640 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:07:33,645 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:07:33,646 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:07:33,646 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:07:33,646 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:07:34,110 - websockets.server - INFO - connection open
2025-06-28 11:07:34,110 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 61780)
2025-06-28 11:07:34,111 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:07:34,111 - websockets.server - INFO - connection closed

2025-06-28 11:07:36,113 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:07:36,113 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:07:36,191 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:36,191 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:36,191 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:07:36,191 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:07:36,192 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:07:36,192 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:07:36,192 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:07:36,192 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:07:36,192 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:07:36,726 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:07:36,726 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:07:36,726 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:07:36,726 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:07:39,195 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:07:39,195 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:07:39,269 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:07:39,270 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:07:39,270 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:07:39,270 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:07:39,270 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:07:39,270 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:07:39,270 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:07:39,270 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:07:39,270 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:07:39,270 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:07:39,270 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:07:39,270 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:07:39,270 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:07:39,346 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:39,346 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:39,346 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:07:39,346 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:07:39,346 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:07:39,346 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:07:39,346 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:07:39,346 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:07:39,346 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:07:42,351 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:07:42,351 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:07:42,438 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:07:42,438 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:07:42,438 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:07:42,438 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:07:42,438 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:07:42,438 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:07:42,438 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:07:42,438 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:07:42,438 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:07:42,438 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:07:42,438 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:07:42,439 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:07:42,439 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:07:42,524 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:42,524 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:42,524 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:07:42,524 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:07:42,524 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:07:42,524 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:07:42,524 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:07:42,524 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:07:42,524 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:07:45,529 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:07:45,529 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:07:45,604 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:07:45,604 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:07:45,604 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:07:45,604 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:07:45,604 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:07:45,604 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:07:45,604 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:07:45,604 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:07:45,604 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:07:45,604 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:07:45,604 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:07:45,604 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:07:45,604 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:07:45,680 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:45,681 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:45,681 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:07:45,681 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:07:45,681 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:07:45,681 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:07:45,681 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:07:45,681 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:07:45,681 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:07:46,111 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:07:46,111 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:07:46,112 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:07:46,112 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:46,112 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:07:46,112 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:07:46,112 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:07:46,112 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:07:46,112 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:07:46,112 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:07:46,112 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:07:46,112 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:46,112 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:07:46,112 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:07:46,112 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:46,113 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:07:46,114 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:07:46,114 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:07:46,114 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 73590)
2025-06-28 11:07:46,114 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:07:46,114 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:46,115 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:07:46,115 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:07:46,115 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:07:46,115 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:07:46,115 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:07:46,115 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:07:46,115 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:07:46,115 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:07:46,115 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:46,115 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:07:46,115 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:07:46,115 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:07:46,115 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:07:46,115 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:46,117 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 73591)
2025-06-28 11:07:46,117 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:07:46,118 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:07:46,118 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:07:46,118 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:07:46,118 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:46,118 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:07:46,118 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:07:46,118 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:07:46,119 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:07:46,119 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:07:46,119 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:07:46,119 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:46,119 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:07:46,119 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:07:46,119 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:07:46,119 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:07:46,119 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:46,122 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 73592)
2025-06-28 11:07:46,122 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:07:46,123 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:07:46,124 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:07:46,124 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:07:46,124 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:07:46,124 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:07:46,124 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:07:46,124 - websockets.client - DEBUG - > Sec-WebSocket-Key: tlR5CIsAqTQC451ycbeLZQ==
2025-06-28 11:07:46,124 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:07:46,124 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:07:46,124 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:07:46,125 - websockets.client - DEBUG - > EOF
2025-06-28 11:07:46,125 - websockets.client - DEBUG - < EOF
2025-06-28 11:07:46,125 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:07:46,126 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:07:46,716 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:07:46,716 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:07:46,726 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:07:46,726 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:07:46,728 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:07:46,728 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:07:46,728 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:07:46,728 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:07:46,728 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:07:46,728 - websockets.client - DEBUG - > Sec-WebSocket-Key: yH9TqCwpgnvsE9C/s5a1SQ==
2025-06-28 11:07:46,728 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:07:46,728 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:07:46,728 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:07:46,729 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:07:46,729 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:07:46,729 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:07:46,729 - websockets.client - DEBUG - < Sec-WebSocket-Accept: BPlOD7LmyjElO1NFnXRf4Z+K5iw=
2025-06-28 11:07:46,729 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:07:46,729 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:07:46 GMT
2025-06-28 11:07:46,729 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:07:46,729 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:07:46,729 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:07:46,729 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:07:46,729 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:07:46,729 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:07:46,729 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:07:46,729 - websockets.client - DEBUG - < EOF
2025-06-28 11:07:46,729 - websockets.client - DEBUG - > EOF
2025-06-28 11:07:46,729 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:07:46,729 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:07:46,729 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:07:46,729 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:07:46,729 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:07:47,437 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:07:47,438 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:07:47,727 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:07:47,728 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:07:48,303 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:07:48,303 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:07:48,686 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:07:48,686 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:07:48,764 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:07:48,764 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:07:48,764 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:07:48,764 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:07:48,764 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:07:48,764 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:07:48,764 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:07:48,764 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:07:48,764 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:07:48,764 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:07:48,764 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:07:48,764 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:07:48,764 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:07:48,764 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:07:48,765 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:07:48,766 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:07:46,352 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:07:46,352 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:07:46,352 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:07:46,352 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:07:46,352 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:07:46,352 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:07:46,352 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:07:46,352 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:07:46,352 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:07:46,352 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:07:46,352 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:07:46,353 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:07:46,353 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:07:46,353 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:07:46,355 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:07:46,355 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:07:46,355 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:07:46,355 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:07:48,766 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:07:48,766 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:07:48,766 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:07:48,767 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:07:48,767 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:07:46,388 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:07:46,388 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:07:46,388 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:07:46,388 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:07:46,388 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:07:46,388 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:07:46,389 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:07:46,389 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:07:46,389 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:07:46,389 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:07:46,725 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:07:46,726 - websockets.server - INFO - connection closed
2025-06-28 11:07:46,726 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:07:46,726 - websockets.server - INFO - connection closed

2025-06-28 11:07:48,767 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:07:48,767 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:07:48,767 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:07:48,768 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:07:48,768 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:07:46,252 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:07:46,252 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:07:46,252 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:07:46,252 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:07:46,255 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:07:46,255 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:07:46,255 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:07:46,255 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:07:46,728 - websockets.server - INFO - connection open
2025-06-28 11:07:46,729 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 61799)
2025-06-28 11:07:46,729 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:07:46,729 - websockets.server - INFO - connection closed

2025-06-28 11:07:48,768 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:07:48,768 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:07:48,845 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:48,846 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:48,846 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:07:48,846 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:07:48,846 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:07:48,846 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:07:48,846 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:07:48,846 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:07:48,846 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:07:49,341 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:07:49,341 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:07:49,341 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:07:49,341 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:07:51,846 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:07:51,846 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:07:51,921 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:07:51,921 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:07:51,921 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:07:51,921 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:07:51,921 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:07:51,921 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:07:51,921 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:07:51,921 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:07:51,921 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:07:51,921 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:07:51,921 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:07:51,921 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:07:51,921 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:07:51,997 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:51,998 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:51,998 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:07:51,998 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:07:51,998 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:07:51,998 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:07:51,998 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:07:51,998 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:07:51,998 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:07:55,003 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:07:55,003 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:07:55,077 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:07:55,078 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:07:55,078 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:07:55,078 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:07:55,078 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:07:55,078 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:07:55,078 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:07:55,078 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:07:55,078 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:07:55,078 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:07:55,078 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:07:55,078 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:07:55,078 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:07:55,154 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:55,154 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:55,154 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:07:55,154 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:07:55,154 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:07:55,154 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:07:55,154 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:07:55,154 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:07:55,154 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:07:58,159 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:07:58,160 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:07:58,234 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:07:58,234 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:07:58,234 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:07:58,234 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:07:58,234 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:07:58,234 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:07:58,234 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:07:58,234 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:07:58,234 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:07:58,234 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:07:58,234 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:07:58,234 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:07:58,234 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:07:58,310 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:58,310 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:07:58,310 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:07:58,310 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:07:58,310 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:07:58,310 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:07:58,310 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:07:58,310 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:07:58,310 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:07:58,771 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:07:58,771 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:07:58,771 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:07:58,771 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:07:58,771 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:07:58,771 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:07:58,771 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:07:58,771 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:07:58,772 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:07:58,772 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:58,772 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:07:58,772 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:07:58,772 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:07:58,772 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:58,772 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:07:58,772 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:07:58,772 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:07:58,772 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:07:58,772 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:07:58,772 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:58,772 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:07:58,772 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:07:58,772 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:07:58,772 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:07:58,772 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:07:58,772 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:07:58,772 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:07:58,772 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:07:58,772 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:58,772 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:07:58,772 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:07:58,773 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:58,773 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:07:58,773 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:07:58,773 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:07:58,773 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:07:58,773 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:58,773 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:58,775 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:07:58,775 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:07:58,775 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:07:58,775 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 73660)
2025-06-28 11:07:58,775 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:07:58,775 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:07:58,775 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:58,775 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:07:58,776 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:07:58,777 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:07:58,777 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:07:58,777 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:07:58,777 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:07:58,779 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 73661)
2025-06-28 11:07:58,780 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:07:58,780 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 73662)
2025-06-28 11:07:58,780 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:07:58,782 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:07:58,782 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:07:58,782 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:07:58,782 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:07:58,783 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:07:58,783 - websockets.client - DEBUG - > Sec-WebSocket-Key: TMOGg2DXzB51p50pP1yh8A==
2025-06-28 11:07:58,783 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:07:58,783 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:07:58,783 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:07:58,783 - websockets.client - DEBUG - > EOF
2025-06-28 11:07:58,783 - websockets.client - DEBUG - < EOF
2025-06-28 11:07:58,783 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:07:58,785 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:07:58,785 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:07:59,380 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:07:59,380 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:07:59,387 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:07:59,387 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:07:59,387 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:07:59,387 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:07:59,387 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:07:59,387 - websockets.client - DEBUG - > Sec-WebSocket-Key: PEyZp0W1nPqani8663isbA==
2025-06-28 11:07:59,387 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:07:59,387 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:07:59,388 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:07:59,388 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:07:59,388 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:07:59,388 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:07:59,388 - websockets.client - DEBUG - < Sec-WebSocket-Accept: 36male9OH2I/Qb9BYOsZicBmdm4=
2025-06-28 11:07:59,388 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:07:59,388 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:07:59 GMT
2025-06-28 11:07:59,388 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:07:59,388 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:07:59,388 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:07:59,388 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:07:59,389 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:07:59,389 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:07:59,389 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:07:59,389 - websockets.client - DEBUG - < EOF
2025-06-28 11:07:59,389 - websockets.client - DEBUG - > EOF
2025-06-28 11:07:59,389 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:07:59,389 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:07:59,389 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:07:59,389 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:07:59,389 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:07:59,389 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:07:59,389 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:08:00,102 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:08:00,102 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:08:00,390 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:08:00,391 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:08:00,967 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:08:00,967 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:08:01,311 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:08:01,311 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:08:01,408 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:08:01,408 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:08:01,408 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:08:01,409 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:08:01,409 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:08:01,409 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:08:01,409 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:08:01,409 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:08:01,409 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:08:01,409 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:08:01,409 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:08:01,409 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:08:01,409 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:08:01,409 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:08:01,410 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:08:01,410 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:07:59,063 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:07:59,063 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:07:59,063 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:07:59,063 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:07:59,063 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:07:59,063 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:07:59,063 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:07:59,063 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:07:59,063 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:07:59,063 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:07:59,063 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:07:59,063 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:07:59,063 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:07:59,063 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:07:59,066 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:07:59,066 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:07:59,066 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:07:59,066 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:08:01,410 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:08:01,412 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:08:01,412 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:08:01,414 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:08:01,414 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:08:01,414 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:07:58,939 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:07:58,940 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:07:58,940 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:07:58,940 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:07:58,943 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:07:58,943 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:07:58,943 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:07:58,943 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:07:59,388 - websockets.server - INFO - connection open
2025-06-28 11:07:59,388 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 61822)
2025-06-28 11:07:59,389 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:07:59,389 - websockets.server - INFO - connection closed

2025-06-28 11:08:01,414 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:08:01,414 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:08:01,417 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:08:01,417 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:07:59,110 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:07:59,110 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:07:59,110 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:07:59,110 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:07:59,110 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:07:59,111 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:07:59,112 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:07:59,112 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:07:59,112 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:07:59,112 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:07:59,388 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:07:59,388 - websockets.server - INFO - connection closed
2025-06-28 11:07:59,389 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:07:59,389 - websockets.server - INFO - connection closed

2025-06-28 11:08:01,417 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:08:01,418 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:08:01,496 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:01,496 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:01,496 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:08:01,496 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:08:01,496 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:08:01,496 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:08:01,497 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:08:01,497 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:08:01,497 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:08:02,004 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:08:02,005 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:08:02,005 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:08:02,005 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:08:04,502 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:08:04,502 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:08:04,577 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:08:04,577 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:08:04,577 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:08:04,577 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:08:04,577 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:08:04,577 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:08:04,577 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:08:04,577 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:08:04,577 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:08:04,577 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:08:04,577 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:08:04,577 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:08:04,577 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:08:04,653 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:04,653 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:04,653 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:08:04,653 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:08:04,653 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:08:04,653 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:08:04,653 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:08:04,653 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:08:04,653 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:08:07,658 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:08:07,658 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:08:07,732 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:08:07,732 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:08:07,732 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:08:07,733 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:08:07,733 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:08:07,733 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:08:07,733 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:08:07,733 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:08:07,733 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:08:07,733 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:08:07,733 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:08:07,733 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:08:07,733 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:08:07,808 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:07,808 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:07,808 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:08:07,808 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:08:07,808 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:08:07,808 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:08:07,808 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:08:07,808 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:08:07,808 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:08:10,812 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:08:10,812 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:08:10,886 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:08:10,886 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:08:10,886 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:08:10,886 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:08:10,886 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:08:10,886 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:08:10,886 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:08:10,886 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:08:10,886 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:08:10,886 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:08:10,886 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:08:10,886 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:08:10,886 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:08:10,962 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:10,962 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:10,962 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:08:10,962 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:08:10,962 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:08:10,962 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:08:10,962 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:08:10,962 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:08:10,962 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:08:11,412 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:08:11,412 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:08:11,413 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:08:11,413 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:11,413 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:08:11,413 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:08:11,413 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:08:11,413 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:08:11,413 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:08:11,413 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:08:11,413 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:08:11,413 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:11,413 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:08:11,413 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:08:11,413 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:11,415 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 73733)
2025-06-28 11:08:11,415 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:08:11,416 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:08:11,416 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:08:11,419 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:08:11,419 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:08:11,419 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:08:11,420 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:11,420 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:08:11,420 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:08:11,420 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:08:11,420 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:08:11,420 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:08:11,420 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:08:11,420 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:11,420 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:08:11,420 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:08:11,420 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:08:11,420 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:08:11,420 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:11,422 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 73734)
2025-06-28 11:08:11,422 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:08:11,422 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:08:11,423 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:08:11,423 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:08:11,423 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:11,423 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:08:11,424 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:08:11,424 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:08:11,424 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:08:11,424 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:08:11,424 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:08:11,424 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:08:11,424 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:08:11,424 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:08:11,425 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:08:11,425 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:08:11,425 - websockets.client - DEBUG - > Sec-WebSocket-Key: I9e75pRsIQxRYxCUayDOkw==
2025-06-28 11:08:11,425 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:11,425 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:08:11,425 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:08:11,425 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:08:11,425 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:08:11,425 - websockets.client - DEBUG - > EOF
2025-06-28 11:08:11,425 - websockets.client - DEBUG - < EOF
2025-06-28 11:08:11,425 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:08:11,425 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:08:11,425 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:08:11,426 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:08:11,426 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:11,428 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 73735)
2025-06-28 11:08:11,429 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:08:11,430 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:08:11,431 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:08:12,017 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:08:12,017 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:08:12,032 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:08:12,032 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:08:12,032 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:08:12,032 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:08:12,032 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:08:12,032 - websockets.client - DEBUG - > Sec-WebSocket-Key: DJ3CmXY+Kb07503G0roOIA==
2025-06-28 11:08:12,032 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:08:12,032 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:08:12,032 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:08:12,033 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:08:12,033 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:08:12,033 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:08:12,033 - websockets.client - DEBUG - < Sec-WebSocket-Accept: F0SgccYGh5Nj90BRf1CrstsfX/o=
2025-06-28 11:08:12,033 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:08:12,033 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:08:12 GMT
2025-06-28 11:08:12,033 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:08:12,033 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:08:12,033 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:08:12,033 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:08:12,033 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:08:12,033 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:08:12,034 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:08:12,034 - websockets.client - DEBUG - < EOF
2025-06-28 11:08:12,034 - websockets.client - DEBUG - > EOF
2025-06-28 11:08:12,034 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:08:12,034 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:08:12,034 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:08:12,034 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:08:12,034 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:08:12,035 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:08:12,035 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:08:12,738 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:08:12,738 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:08:13,036 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:08:13,036 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:08:13,604 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:08:13,604 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:08:13,967 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:08:13,967 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:08:14,041 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:08:14,041 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:08:14,041 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:08:14,041 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:08:14,041 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:08:14,041 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:08:14,041 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:08:14,041 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:08:14,041 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:08:14,041 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:08:14,042 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:08:14,042 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:08:14,042 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:08:14,042 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:08:14,043 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:08:14,043 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:08:11,658 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:08:11,659 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:08:11,659 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:08:11,659 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:08:11,659 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:08:11,659 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:08:11,659 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:08:11,659 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:08:11,659 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:08:11,659 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:08:11,659 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:08:11,659 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:08:11,659 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:08:11,659 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:08:11,662 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:08:11,662 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:08:11,662 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:08:11,662 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:08:14,043 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:08:14,045 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:08:14,045 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:08:14,047 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:08:14,047 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:08:14,047 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:08:11,567 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:08:11,567 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:08:11,567 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:08:11,567 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:08:11,572 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:08:11,572 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:08:11,572 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:08:11,572 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:08:12,033 - websockets.server - INFO - connection open
2025-06-28 11:08:12,033 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 61843)
2025-06-28 11:08:12,033 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:08:12,034 - websockets.server - INFO - connection closed

2025-06-28 11:08:14,047 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:08:14,047 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:08:14,049 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:08:14,049 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:08:11,729 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:08:11,729 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:08:11,729 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:08:11,729 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:08:11,729 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:08:11,729 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:08:11,731 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:08:11,731 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:08:11,731 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:08:11,731 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:08:12,034 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:08:12,034 - websockets.server - INFO - connection closed
2025-06-28 11:08:12,035 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:08:12,035 - websockets.server - INFO - connection closed

2025-06-28 11:08:14,049 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:08:14,051 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:08:14,128 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:14,128 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:14,128 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:08:14,128 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:08:14,128 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:08:14,128 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:08:14,128 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:08:14,128 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:08:14,128 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:08:14,642 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:08:14,642 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:08:14,642 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:08:14,642 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:08:17,133 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:08:17,134 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:08:17,207 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:08:17,208 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:08:17,208 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:08:17,208 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:08:17,208 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:08:17,208 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:08:17,208 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:08:17,208 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:08:17,208 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:08:17,208 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:08:17,208 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:08:17,208 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:08:17,208 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:08:17,283 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:17,283 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:17,283 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:08:17,284 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:08:17,284 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:08:17,284 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:08:17,284 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:08:17,284 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:08:17,284 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:08:20,289 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:08:20,289 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:08:20,363 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:08:20,363 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:08:20,363 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:08:20,363 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:08:20,363 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:08:20,363 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:08:20,363 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:08:20,363 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:08:20,363 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:08:20,363 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:08:20,363 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:08:20,363 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:08:20,363 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:08:20,439 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:20,439 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:20,439 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:08:20,439 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:08:20,439 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:08:20,439 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:08:20,439 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:08:20,439 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:08:20,439 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:08:23,444 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:08:23,444 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:08:23,518 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:08:23,518 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:08:23,518 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:08:23,518 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:08:23,518 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:08:23,519 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:08:23,519 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:08:23,519 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:08:23,519 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:08:23,519 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:08:23,519 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:08:23,519 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:08:23,519 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:08:23,593 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:23,593 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:23,593 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:08:23,593 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:08:23,593 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:08:23,593 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:08:23,593 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:08:23,593 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:08:23,593 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:08:24,045 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:08:24,046 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:08:24,046 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:08:24,046 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:24,046 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:08:24,046 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:08:24,046 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:08:24,046 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:08:24,046 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:08:24,046 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:08:24,046 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:08:24,046 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:24,046 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:08:24,046 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:08:24,046 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:24,048 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 73803)
2025-06-28 11:08:24,048 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:08:24,049 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:08:24,049 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:08:24,052 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:08:24,052 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:08:24,052 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:08:24,052 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:08:24,053 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:08:24,053 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:24,053 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:08:24,053 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:08:24,053 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:08:24,053 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:08:24,053 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:08:24,053 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:24,053 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:08:24,053 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:08:24,053 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:08:24,053 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:08:24,053 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:08:24,053 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:08:24,053 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:24,053 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:08:24,053 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:08:24,053 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:08:24,053 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:24,054 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:08:24,054 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:08:24,054 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:08:24,054 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:08:24,054 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:08:24,054 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:24,054 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:08:24,055 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:08:24,055 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:24,057 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 73804)
2025-06-28 11:08:24,057 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:08:24,058 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 73805)
2025-06-28 11:08:24,058 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:08:24,060 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:08:24,060 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:08:24,060 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:08:24,060 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:08:24,060 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:08:24,060 - websockets.client - DEBUG - > Sec-WebSocket-Key: zNEnDg+wLdi4oIlWJwQDIg==
2025-06-28 11:08:24,061 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:08:24,061 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:08:24,061 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:08:24,061 - websockets.client - DEBUG - > EOF
2025-06-28 11:08:24,061 - websockets.client - DEBUG - < EOF
2025-06-28 11:08:24,061 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:08:24,062 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:08:24,063 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:08:24,650 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:08:24,650 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:08:24,665 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:08:24,665 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:08:24,665 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:08:24,665 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:08:24,665 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:08:24,665 - websockets.client - DEBUG - > Sec-WebSocket-Key: iSsuin8T2J2TctUZitgl1Q==
2025-06-28 11:08:24,665 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:08:24,665 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:08:24,665 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:08:24,665 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:08:24,665 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:08:24,665 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:08:24,665 - websockets.client - DEBUG - < Sec-WebSocket-Accept: S2NLPntElbx/bEDJn7qPHTl+83g=
2025-06-28 11:08:24,665 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:08:24,665 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:08:24 GMT
2025-06-28 11:08:24,665 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:08:24,666 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:08:24,666 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:08:24,666 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:08:24,666 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:08:24,666 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:08:24,666 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:08:24,666 - websockets.client - DEBUG - < EOF
2025-06-28 11:08:24,666 - websockets.client - DEBUG - > EOF
2025-06-28 11:08:24,666 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:08:24,666 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:08:24,666 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:08:24,666 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:08:24,667 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:08:24,667 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:08:24,667 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:08:25,371 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:08:25,372 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:08:25,668 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:08:25,668 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:08:26,237 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:08:26,237 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:08:26,594 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:08:26,594 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:08:26,677 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:08:26,677 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:08:26,677 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:08:26,677 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:08:26,677 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:08:26,677 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:08:26,677 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:08:26,677 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:08:26,677 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:08:26,677 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:08:26,677 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:08:26,677 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:08:26,677 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:08:26,677 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:08:26,679 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:08:26,679 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:08:26,679 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:08:24,280 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:08:24,280 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:08:24,280 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:08:24,280 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:08:24,280 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:08:24,280 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:08:24,280 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:08:24,280 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:08:24,280 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:08:24,280 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:08:24,280 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:08:24,280 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:08:24,280 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:08:24,280 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:08:24,283 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:08:24,283 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:08:24,283 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:08:24,283 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:08:26,679 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:08:26,679 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:08:26,680 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:08:26,680 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:08:24,324 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:08:24,324 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:08:24,324 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:08:24,324 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:08:24,324 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:08:24,324 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:08:24,325 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:08:24,325 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:08:24,325 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:08:24,325 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:08:24,666 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:08:24,666 - websockets.server - INFO - connection closed
2025-06-28 11:08:24,667 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:08:24,667 - websockets.server - INFO - connection closed

2025-06-28 11:08:26,680 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:08:26,680 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:08:26,680 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:08:26,681 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:08:26,681 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:08:24,186 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:08:24,186 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:08:24,186 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:08:24,186 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:08:24,189 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:08:24,189 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:08:24,189 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:08:24,189 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:08:24,665 - websockets.server - INFO - connection open
2025-06-28 11:08:24,665 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 61870)
2025-06-28 11:08:24,666 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:08:24,666 - websockets.server - INFO - connection closed

2025-06-28 11:08:26,681 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:08:26,682 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:08:26,758 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:26,758 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:26,758 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:08:26,758 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:08:26,758 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:08:26,758 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:08:26,758 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:08:26,758 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:08:26,758 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:08:27,275 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:08:27,275 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:08:27,275 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:08:27,275 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:08:29,761 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:08:29,761 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:08:29,834 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:08:29,834 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:08:29,834 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:08:29,834 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:08:29,834 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:08:29,834 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:08:29,834 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:08:29,834 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:08:29,834 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:08:29,834 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:08:29,834 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:08:29,834 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:08:29,834 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:08:29,913 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:29,913 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:29,913 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:08:29,913 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:08:29,913 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:08:29,913 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:08:29,913 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:08:29,913 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:08:29,914 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:08:32,919 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:08:32,919 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:08:33,000 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:08:33,001 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:08:33,001 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:08:33,001 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:08:33,001 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:08:33,001 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:08:33,001 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:08:33,001 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:08:33,001 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:08:33,001 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:08:33,001 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:08:33,001 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:08:33,001 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:08:33,090 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:33,090 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:33,090 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:08:33,090 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:08:33,090 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:08:33,090 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:08:33,090 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:08:33,090 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:08:33,090 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:08:36,094 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:08:36,094 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:08:36,168 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:08:36,168 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:08:36,168 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:08:36,168 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:08:36,168 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:08:36,168 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:08:36,168 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:08:36,168 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:08:36,168 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:08:36,168 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:08:36,168 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:08:36,168 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:08:36,168 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:08:36,267 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:36,267 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:36,267 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:08:36,267 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:08:36,267 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:08:36,267 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:08:36,267 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:08:36,267 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:08:36,267 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:08:36,684 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:08:36,684 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:08:36,684 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:08:36,684 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:08:36,684 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:08:36,685 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:08:36,685 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:08:36,685 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:08:36,685 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:08:36,685 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:36,685 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:36,685 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:08:36,685 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:36,685 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:08:36,685 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:08:36,685 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:08:36,685 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:08:36,685 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:08:36,685 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:08:36,685 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:08:36,685 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:08:36,685 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:08:36,685 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:08:36,685 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:08:36,685 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:08:36,686 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:08:36,686 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:08:36,686 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:08:36,686 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:08:36,686 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:08:36,686 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:36,686 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:08:36,686 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:36,686 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:36,686 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:08:36,686 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:08:36,686 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:08:36,686 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:08:36,686 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:36,688 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:08:36,688 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:08:36,688 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:08:36,688 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:08:36,688 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:36,688 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:08:36,688 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:08:36,689 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:36,690 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 73873)
2025-06-28 11:08:36,691 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:08:36,692 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 73874)
2025-06-28 11:08:36,692 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:08:36,692 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:08:36,693 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:08:36,693 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 73875)
2025-06-28 11:08:36,693 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:08:36,694 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:08:36,695 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:08:36,695 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:08:36,695 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:08:36,695 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:08:36,695 - websockets.client - DEBUG - > Sec-WebSocket-Key: NHOCT3Ioe2Cf94NmlzcBGw==
2025-06-28 11:08:36,695 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:08:36,695 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:08:36,695 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:08:36,696 - websockets.client - DEBUG - > EOF
2025-06-28 11:08:36,696 - websockets.client - DEBUG - < EOF
2025-06-28 11:08:36,696 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:08:36,698 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:08:36,698 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:08:37,294 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:08:37,294 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:08:37,300 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:08:37,300 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:08:37,300 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:08:37,300 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:08:37,300 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:08:37,301 - websockets.client - DEBUG - > Sec-WebSocket-Key: QX5tdZ5fTGFVk5W54vwQLg==
2025-06-28 11:08:37,301 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:08:37,301 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:08:37,301 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:08:37,301 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:08:37,301 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:08:37,301 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:08:37,301 - websockets.client - DEBUG - < Sec-WebSocket-Accept: uasNh+iSF7H0GdOu8/q0H2gHhLU=
2025-06-28 11:08:37,301 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:08:37,301 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:08:37 GMT
2025-06-28 11:08:37,301 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:08:37,301 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:08:37,301 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:08:37,302 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:08:37,302 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:08:37,302 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:08:37,302 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:08:37,302 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:08:37,302 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:08:37,302 - websockets.client - DEBUG - < EOF
2025-06-28 11:08:37,302 - websockets.client - DEBUG - > EOF
2025-06-28 11:08:37,302 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:08:37,302 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:08:37,302 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:08:37,302 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:08:37,302 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:08:38,016 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:08:38,016 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:08:38,303 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:08:38,303 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:08:38,881 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:08:38,881 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:08:39,272 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:08:39,273 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:08:39,346 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:08:39,346 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:08:39,346 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:08:39,346 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:08:39,346 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:08:39,346 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:08:39,346 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:08:39,346 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:08:39,346 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:08:39,346 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:08:39,346 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:08:39,346 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:08:39,346 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:08:39,346 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:08:39,348 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:08:39,348 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:08:39,348 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:08:36,916 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:08:36,917 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:08:36,917 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:08:36,917 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:08:36,917 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:08:36,917 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:08:36,917 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:08:36,917 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:08:36,917 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:08:36,917 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:08:36,917 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:08:36,917 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:08:36,917 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:08:36,917 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:08:36,920 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:08:36,920 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:08:36,920 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:08:36,920 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:08:39,348 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:08:39,348 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:08:39,350 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:08:39,350 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:08:36,821 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:08:36,821 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:08:36,821 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:08:36,821 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:08:36,823 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:08:36,823 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:08:36,823 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:08:36,823 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:08:37,301 - websockets.server - INFO - connection open
2025-06-28 11:08:37,301 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 61890)
2025-06-28 11:08:37,302 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:08:37,302 - websockets.server - INFO - connection closed

2025-06-28 11:08:39,350 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:08:39,352 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:08:39,352 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:08:39,354 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:08:39,355 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:08:36,958 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:08:36,958 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:08:36,958 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:08:36,958 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:08:36,958 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:08:36,959 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:08:36,960 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:08:36,960 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:08:36,960 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:08:36,960 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:08:37,301 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:08:37,301 - websockets.server - INFO - connection closed
2025-06-28 11:08:37,302 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:08:37,302 - websockets.server - INFO - connection closed

2025-06-28 11:08:39,355 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:08:39,356 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:08:39,457 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:39,457 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:39,457 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:08:39,457 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:08:39,457 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:08:39,457 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:08:39,457 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:08:39,457 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:08:39,457 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:08:39,919 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:08:39,919 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:08:39,919 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:08:39,919 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:08:42,462 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:08:42,462 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:08:42,535 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:08:42,535 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:08:42,535 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:08:42,535 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:08:42,535 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:08:42,535 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:08:42,535 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:08:42,535 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:08:42,535 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:08:42,535 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:08:42,535 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:08:42,535 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:08:42,536 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:08:42,610 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:42,610 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:42,610 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:08:42,610 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:08:42,610 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:08:42,610 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:08:42,610 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:08:42,610 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:08:42,610 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:08:45,612 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:08:45,612 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:08:45,685 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:08:45,685 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:08:45,685 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:08:45,685 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:08:45,685 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:08:45,685 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:08:45,685 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:08:45,686 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:08:45,686 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:08:45,686 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:08:45,686 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:08:45,686 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:08:45,686 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:08:45,761 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:45,761 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:45,761 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:08:45,761 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:08:45,761 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:08:45,761 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:08:45,762 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:08:45,762 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:08:45,762 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:08:48,762 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:08:48,762 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:08:48,835 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:08:48,835 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:08:48,836 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:08:48,836 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:08:48,836 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:08:48,836 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:08:48,836 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:08:48,836 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:08:48,836 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:08:48,836 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:08:48,836 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:08:48,836 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:08:48,836 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:08:48,911 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:48,911 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:48,911 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:08:48,911 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:08:48,911 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:08:48,911 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:08:48,911 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:08:48,911 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:08:48,911 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:08:49,352 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:08:49,352 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:08:49,352 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:08:49,352 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:49,352 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:08:49,352 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:08:49,352 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:08:49,352 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:08:49,352 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:08:49,352 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:08:49,352 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:49,353 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:08:49,353 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:08:49,353 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:08:49,353 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:08:49,353 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:49,354 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:08:49,355 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:08:49,355 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:08:49,355 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 73951)
2025-06-28 11:08:49,355 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:08:49,356 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:49,356 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:08:49,356 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:08:49,356 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:08:49,356 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:08:49,356 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:08:49,356 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:08:49,356 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:08:49,356 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:49,356 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:08:49,356 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:08:49,356 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:49,358 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 73952)
2025-06-28 11:08:49,358 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:08:49,358 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:08:49,358 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:08:49,359 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:08:49,359 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:08:49,359 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:08:49,359 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:08:49,359 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:08:49,359 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:49,359 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:08:49,359 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:08:49,359 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:08:49,359 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:08:49,360 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:08:49,360 - websockets.client - DEBUG - > Sec-WebSocket-Key: U+qGeOGokHNq1w2ZywY5zw==
2025-06-28 11:08:49,360 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:08:49,360 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:08:49,360 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:08:49,360 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:08:49,360 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:08:49,360 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:08:49,360 - websockets.client - DEBUG - > EOF
2025-06-28 11:08:49,360 - websockets.client - DEBUG - < EOF
2025-06-28 11:08:49,360 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:08:49,360 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:08:49,361 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:49,361 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:08:49,362 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:08:49,362 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:08:49,362 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:08:49,362 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:08:49,364 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:08:49,365 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 73953)
2025-06-28 11:08:49,365 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:08:49,368 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:08:49,960 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:08:49,961 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:08:49,967 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:08:49,967 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:08:49,967 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:08:49,967 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:08:49,967 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:08:49,967 - websockets.client - DEBUG - > Sec-WebSocket-Key: seB/M35k10x5Gdp6tmMT1g==
2025-06-28 11:08:49,967 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:08:49,967 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:08:49,967 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:08:49,968 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:08:49,968 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:08:49,968 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:08:49,968 - websockets.client - DEBUG - < Sec-WebSocket-Accept: SFr4N+fASRg8co6hYNt5c5H0Wec=
2025-06-28 11:08:49,968 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:08:49,968 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:08:49 GMT
2025-06-28 11:08:49,968 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:08:49,968 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:08:49,968 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:08:49,968 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:08:49,968 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:08:49,968 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:08:49,968 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:08:49,968 - websockets.client - DEBUG - < EOF
2025-06-28 11:08:49,969 - websockets.client - DEBUG - > EOF
2025-06-28 11:08:49,969 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:08:49,969 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:08:49,969 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:08:49,969 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:08:49,969 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:08:49,970 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:08:49,970 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:08:50,682 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:08:50,682 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:08:50,972 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:08:50,972 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:08:51,547 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:08:51,548 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:08:51,912 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:08:51,912 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:08:51,987 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:08:51,987 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:08:51,987 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:08:51,987 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:08:51,987 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:08:51,987 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:08:51,987 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:08:51,987 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:08:51,987 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:08:51,987 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:08:51,987 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:08:51,987 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:08:51,987 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:08:51,987 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:08:51,988 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:08:51,988 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:08:49,506 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:08:49,506 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:08:49,506 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:08:49,506 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:08:49,509 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:08:49,509 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:08:49,509 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:08:49,509 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:08:49,968 - websockets.server - INFO - connection open
2025-06-28 11:08:49,968 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 61910)
2025-06-28 11:08:49,968 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:08:49,969 - websockets.server - INFO - connection closed

2025-06-28 11:08:51,989 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:08:51,989 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:08:51,989 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:08:51,990 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:08:51,990 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:08:51,990 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:08:49,628 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:08:49,628 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:08:49,628 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:08:49,628 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:08:49,628 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:08:49,628 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:08:49,628 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:08:49,628 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:08:49,628 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:08:49,628 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:08:49,628 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:08:49,628 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:08:49,629 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:08:49,629 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:08:49,631 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:08:49,631 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:08:49,631 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:08:49,631 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:08:51,990 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:08:51,990 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:08:51,992 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:08:51,992 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:08:49,676 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:08:49,676 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:08:49,676 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:08:49,676 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:08:49,676 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:08:49,677 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:08:49,678 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:08:49,678 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:08:49,678 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:08:49,678 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:08:49,970 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:08:49,970 - websockets.server - INFO - connection closed
2025-06-28 11:08:49,970 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:08:49,971 - websockets.server - INFO - connection closed

2025-06-28 11:08:51,992 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:08:51,994 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:08:52,070 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:52,070 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:52,070 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:08:52,070 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:08:52,070 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:08:52,070 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:08:52,070 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:08:52,070 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:08:52,070 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:08:52,586 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:08:52,586 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:08:52,586 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:08:52,586 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:08:55,075 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:08:55,076 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:08:55,149 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:08:55,149 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:08:55,149 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:08:55,149 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:08:55,149 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:08:55,149 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:08:55,149 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:08:55,149 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:08:55,149 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:08:55,149 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:08:55,149 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:08:55,149 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:08:55,149 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:08:55,224 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:55,224 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:55,224 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:08:55,224 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:08:55,224 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:08:55,224 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:08:55,224 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:08:55,224 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:08:55,224 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:08:58,229 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:08:58,230 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:08:58,320 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:08:58,320 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:08:58,320 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:08:58,320 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:08:58,320 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:08:58,320 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:08:58,320 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:08:58,320 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:08:58,320 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:08:58,320 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:08:58,320 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:08:58,320 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:08:58,320 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:08:58,391 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:58,391 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:08:58,391 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:08:58,391 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:08:58,391 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:08:58,391 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:08:58,391 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:08:58,391 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:08:58,391 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:09:01,396 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:09:01,397 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:09:01,492 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:09:01,492 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:09:01,492 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:09:01,492 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:09:01,492 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:09:01,492 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:09:01,493 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:09:01,493 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:09:01,493 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:09:01,493 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:09:01,493 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:09:01,493 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:09:01,493 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:09:01,562 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:01,562 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:01,563 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:09:01,563 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:09:01,563 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:09:01,563 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:09:01,563 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:09:01,563 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:09:01,563 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:09:01,994 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:09:01,994 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:09:01,995 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:09:01,995 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:09:01,995 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:09:01,996 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:09:01,996 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:09:01,996 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:09:01,997 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:09:01,997 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:01,997 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:01,997 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:09:01,998 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:09:01,998 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:01,998 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:09:01,998 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:09:01,998 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:09:01,998 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:09:01,998 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:09:01,998 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:09:01,998 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:09:01,998 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:09:01,998 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:09:01,998 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:09:01,999 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:09:01,999 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:09:01,999 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:09:01,999 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:09:01,999 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:09:01,999 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:01,999 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:01,999 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:09:02,000 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:09:02,000 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:09:02,000 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:09:02,000 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:02,001 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:09:02,001 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:09:02,001 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:02,001 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:09:02,001 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:09:02,001 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:09:02,006 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:09:02,007 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:09:02,007 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:09:02,007 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:02,007 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:02,013 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 74025)
2025-06-28 11:09:02,016 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 74026)
2025-06-28 11:09:02,017 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:09:02,017 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:09:02,018 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 74027)
2025-06-28 11:09:02,019 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:09:02,019 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:09:02,020 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:09:02,021 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:09:02,022 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:09:02,022 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:09:02,022 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:09:02,022 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:09:02,022 - websockets.client - DEBUG - > Sec-WebSocket-Key: w/sO/A1bclMP2/RSD22/Pw==
2025-06-28 11:09:02,022 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:09:02,022 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:09:02,023 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:09:02,023 - websockets.client - DEBUG - > EOF
2025-06-28 11:09:02,023 - websockets.client - DEBUG - < EOF
2025-06-28 11:09:02,023 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:09:02,024 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:09:02,025 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:09:02,622 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:09:02,623 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:09:02,628 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:09:02,629 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:09:02,629 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:09:02,630 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:09:02,630 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:09:02,630 - websockets.client - DEBUG - > Sec-WebSocket-Key: EwCM8H1IFMi3J1ZJcUJEZQ==
2025-06-28 11:09:02,630 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:09:02,630 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:09:02,630 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:09:02,631 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:09:02,632 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:09:02,632 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:09:02,632 - websockets.client - DEBUG - < Sec-WebSocket-Accept: k8p+g6Pd5gCrtQdix6j7jd+8Xh0=
2025-06-28 11:09:02,632 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:09:02,632 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:09:02 GMT
2025-06-28 11:09:02,632 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:09:02,632 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:09:02,633 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:09:02,633 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:09:02,633 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:09:02,633 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:09:02,633 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:09:02,634 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:09:02,634 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:09:02,634 - websockets.client - DEBUG - < EOF
2025-06-28 11:09:02,634 - websockets.client - DEBUG - > EOF
2025-06-28 11:09:02,634 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:09:02,634 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:09:02,634 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:09:02,634 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:09:02,635 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:09:03,345 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:09:03,345 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:09:03,635 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:09:03,635 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:09:04,211 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:09:04,212 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:09:04,568 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:09:04,568 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:09:04,676 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:09:04,676 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:09:04,676 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:09:04,676 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:09:04,676 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:09:04,676 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:09:04,676 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:09:04,676 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:09:04,676 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:09:04,676 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:09:04,676 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:09:04,676 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:09:04,676 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:09:04,676 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:09:04,677 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:09:04,677 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:09:02,256 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:09:02,256 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:09:02,256 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:09:02,256 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:09:02,256 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:09:02,256 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:09:02,256 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:09:02,256 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:09:02,256 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:09:02,256 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:09:02,256 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:09:02,256 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:09:02,256 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:09:02,256 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:09:02,259 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:09:02,259 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:09:02,259 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:09:02,259 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:09:04,677 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:09:04,677 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:09:04,677 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:09:04,679 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:09:04,679 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:09:02,308 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:09:02,308 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:09:02,309 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:09:02,309 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:09:02,309 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:09:02,309 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:09:02,310 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:09:02,310 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:09:02,310 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:09:02,310 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:09:02,631 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:09:02,631 - websockets.server - INFO - connection closed
2025-06-28 11:09:02,634 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:09:02,634 - websockets.server - INFO - connection closed

2025-06-28 11:09:04,679 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:09:04,679 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:09:04,679 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:09:04,680 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:09:04,680 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:09:02,158 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:09:02,158 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:09:02,158 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:09:02,158 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:09:02,161 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:09:02,161 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:09:02,161 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:09:02,161 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:09:02,631 - websockets.server - INFO - connection open
2025-06-28 11:09:02,632 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 61929)
2025-06-28 11:09:02,633 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:09:02,634 - websockets.server - INFO - connection closed

2025-06-28 11:09:04,680 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:09:04,680 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:09:04,752 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:04,752 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:04,752 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:09:04,752 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:09:04,752 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:09:04,752 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:09:04,752 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:09:04,752 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:09:04,752 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:09:05,250 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:09:05,250 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:09:05,251 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:09:05,251 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:09:07,757 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:09:07,758 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:09:07,846 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:09:07,846 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:09:07,846 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:09:07,846 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:09:07,846 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:09:07,847 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:09:07,847 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:09:07,847 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:09:07,847 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:09:07,847 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:09:07,847 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:09:07,847 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:09:07,847 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:09:07,915 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:07,915 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:07,915 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:09:07,915 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:09:07,915 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:09:07,915 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:09:07,915 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:09:07,915 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:09:07,915 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:09:10,920 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:09:10,921 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:09:11,010 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:09:11,011 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:09:11,011 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:09:11,011 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:09:11,011 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:09:11,011 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:09:11,011 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:09:11,011 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:09:11,011 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:09:11,011 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:09:11,011 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:09:11,011 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:09:11,011 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:09:11,079 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:11,079 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:11,079 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:09:11,079 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:09:11,079 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:09:11,079 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:09:11,079 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:09:11,079 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:09:11,079 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:09:14,084 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:09:14,085 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:09:14,183 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:09:14,183 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:09:14,183 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:09:14,183 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:09:14,183 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:09:14,183 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:09:14,183 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:09:14,183 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:09:14,183 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:09:14,183 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:09:14,183 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:09:14,183 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:09:14,183 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:09:14,250 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:14,250 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:14,250 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:09:14,250 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:09:14,250 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:09:14,250 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:09:14,250 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:09:14,250 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:09:14,250 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:09:14,683 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:09:14,683 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:09:14,684 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:09:14,684 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:09:14,685 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:09:14,685 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:09:14,685 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:09:14,685 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:09:14,686 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:14,686 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:09:14,686 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:09:14,686 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:14,686 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:09:14,686 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:09:14,687 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:14,687 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:09:14,687 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:09:14,687 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:09:14,687 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:09:14,687 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:09:14,687 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:09:14,687 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:09:14,687 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:09:14,687 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:09:14,687 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:09:14,688 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:09:14,688 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:09:14,688 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:09:14,688 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:14,688 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:09:14,688 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:09:14,688 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:09:14,688 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:14,689 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:14,689 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:09:14,689 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:09:14,689 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:09:14,689 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:09:14,689 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:14,695 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:09:14,696 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:09:14,696 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:09:14,696 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:09:14,697 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 74098)
2025-06-28 11:09:14,697 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:09:14,697 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:09:14,697 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:09:14,697 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:14,697 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:14,704 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:09:14,705 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 74099)
2025-06-28 11:09:14,705 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 74100)
2025-06-28 11:09:14,706 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:09:14,706 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:09:14,706 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:09:14,709 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:09:14,709 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:09:14,709 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:09:14,709 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:09:14,710 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:09:14,710 - websockets.client - DEBUG - > Sec-WebSocket-Key: Ak0C2f5tXiONWwOu0mF7dw==
2025-06-28 11:09:14,710 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:09:14,710 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:09:14,710 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:09:14,710 - websockets.client - DEBUG - > EOF
2025-06-28 11:09:14,711 - websockets.client - DEBUG - < EOF
2025-06-28 11:09:14,711 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:09:14,711 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:09:14,712 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:09:15,308 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:09:15,309 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:09:15,316 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:09:15,316 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:09:15,316 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:09:15,317 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:09:15,317 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:09:15,317 - websockets.client - DEBUG - > Sec-WebSocket-Key: xmIKV+UuifIOs7U2+yckkQ==
2025-06-28 11:09:15,317 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:09:15,317 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:09:15,317 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:09:15,318 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:09:15,318 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:09:15,319 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:09:15,319 - websockets.client - DEBUG - < Sec-WebSocket-Accept: kgHrNYjCDDx7XCBelnfW6mLVoso=
2025-06-28 11:09:15,319 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:09:15,319 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:09:15 GMT
2025-06-28 11:09:15,319 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:09:15,319 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:09:15,319 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:09:15,319 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:09:15,320 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:09:15,320 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:09:15,320 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:09:15,320 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:09:15,321 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:09:15,321 - websockets.client - DEBUG - < EOF
2025-06-28 11:09:15,321 - websockets.client - DEBUG - > EOF
2025-06-28 11:09:15,321 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:09:15,321 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:09:15,321 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:09:15,321 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:09:15,322 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:09:16,031 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:09:16,032 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:09:16,321 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:09:16,322 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:09:16,897 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:09:16,897 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:09:17,255 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:09:17,256 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:09:17,351 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:09:17,351 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:09:17,351 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:09:17,351 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:09:17,351 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:09:17,351 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:09:17,351 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:09:17,351 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:09:17,351 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:09:17,352 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:09:17,352 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:09:17,352 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:09:17,352 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:09:17,352 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:09:17,353 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:09:17,353 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:09:14,951 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:09:14,952 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:09:14,952 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:09:14,952 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:09:14,952 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:09:14,952 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:09:14,952 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:09:14,952 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:09:14,952 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:09:14,952 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:09:14,952 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:09:14,952 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:09:14,952 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:09:14,952 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:09:14,955 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:09:14,955 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:09:14,955 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:09:14,955 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:09:17,353 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:09:17,355 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:09:17,355 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:09:17,357 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:09:17,357 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:09:15,004 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:09:15,004 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:09:15,004 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:09:15,004 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:09:15,004 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:09:15,004 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:09:15,005 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:09:15,005 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:09:15,005 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:09:15,005 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:09:15,317 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:09:15,318 - websockets.server - INFO - connection closed
2025-06-28 11:09:15,320 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:09:15,320 - websockets.server - INFO - connection closed

2025-06-28 11:09:17,358 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:09:17,359 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:09:17,359 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:09:17,361 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:09:17,361 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:09:17,361 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:09:14,845 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:09:14,846 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:09:14,846 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:09:14,846 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:09:14,848 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:09:14,848 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:09:14,848 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:09:14,848 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:09:15,318 - websockets.server - INFO - connection open
2025-06-28 11:09:15,318 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 61949)
2025-06-28 11:09:15,320 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:09:15,321 - websockets.server - INFO - connection closed

2025-06-28 11:09:17,362 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:09:17,430 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:17,431 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:17,431 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:09:17,431 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:09:17,431 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:09:17,431 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:09:17,431 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:09:17,431 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:09:17,431 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:09:17,936 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:09:17,936 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:09:17,937 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:09:17,937 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:09:20,436 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:09:20,436 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:09:20,528 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:09:20,528 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:09:20,528 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:09:20,528 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:09:20,528 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:09:20,528 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:09:20,528 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:09:20,528 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:09:20,528 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:09:20,528 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:09:20,528 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:09:20,528 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:09:20,528 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:09:20,602 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:20,603 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:20,603 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:09:20,603 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:09:20,603 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:09:20,603 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:09:20,603 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:09:20,603 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:09:20,603 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:09:23,608 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:09:23,610 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:09:23,712 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:09:23,712 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:09:23,712 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:09:23,712 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:09:23,712 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:09:23,712 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:09:23,712 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:09:23,712 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:09:23,712 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:09:23,712 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:09:23,712 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:09:23,712 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:09:23,712 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:09:23,779 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:23,779 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:23,779 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:09:23,779 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:09:23,780 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:09:23,780 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:09:23,780 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:09:23,780 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:09:23,780 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:09:26,785 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:09:26,785 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:09:26,879 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:09:26,879 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:09:26,879 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:09:26,879 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:09:26,879 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:09:26,879 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:09:26,879 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:09:26,879 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:09:26,880 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:09:26,880 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:09:26,880 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:09:26,880 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:09:26,880 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:09:26,946 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:26,946 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:26,946 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:09:26,946 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:09:26,946 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:09:26,946 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:09:26,946 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:09:26,946 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:09:26,946 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:09:27,359 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:09:27,359 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:09:27,361 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:09:27,361 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:09:27,362 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:09:27,362 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:09:27,363 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:27,363 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:27,363 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:09:27,363 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:09:27,363 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:09:27,363 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:09:27,363 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:09:27,363 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:09:27,364 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:09:27,364 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:09:27,364 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:09:27,364 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:09:27,364 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:09:27,364 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:09:27,365 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:27,365 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:09:27,365 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:27,365 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:09:27,365 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:09:27,365 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:09:27,366 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:27,371 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:09:27,373 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:09:27,374 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:09:27,374 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 74176)
2025-06-28 11:09:27,375 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:09:27,375 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:09:27,375 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:09:27,375 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:09:27,375 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:27,375 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:27,375 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:09:27,376 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:09:27,381 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:09:27,381 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 74177)
2025-06-28 11:09:27,381 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:09:27,382 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:09:27,382 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:09:27,383 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:09:27,383 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:09:27,383 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:09:27,383 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:27,384 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:09:27,384 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:09:27,384 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:09:27,385 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:09:27,385 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:27,388 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 74178)
2025-06-28 11:09:27,389 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:09:27,390 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:09:27,391 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:09:27,391 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:09:27,391 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:09:27,391 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:09:27,391 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:09:27,391 - websockets.client - DEBUG - > Sec-WebSocket-Key: mIY99DD5TIOlWv9DDPuQ+w==
2025-06-28 11:09:27,391 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:09:27,391 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:09:27,391 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:09:27,391 - websockets.client - DEBUG - > EOF
2025-06-28 11:09:27,391 - websockets.client - DEBUG - < EOF
2025-06-28 11:09:27,391 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:09:27,392 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:09:27,984 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:09:27,984 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:09:27,996 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:09:27,996 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:09:27,996 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:09:27,996 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:09:27,997 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:09:27,997 - websockets.client - DEBUG - > Sec-WebSocket-Key: Nl+oC24WLbLQNh6oa1seIA==
2025-06-28 11:09:27,997 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:09:27,997 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:09:27,997 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:09:27,998 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:09:27,998 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:09:27,998 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:09:27,998 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:09:27,998 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:09:27,998 - websockets.client - DEBUG - < Sec-WebSocket-Accept: ZI3OUo9qUC4eFZjcaZOx8p8a+Ns=
2025-06-28 11:09:27,998 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:09:27,998 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:09:27 GMT
2025-06-28 11:09:27,999 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:09:27,999 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:09:27,999 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:09:27,999 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:09:27,999 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:09:28,000 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:09:28,000 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:09:28,000 - websockets.client - DEBUG - < EOF
2025-06-28 11:09:28,000 - websockets.client - DEBUG - > EOF
2025-06-28 11:09:28,000 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:09:28,000 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:09:28,001 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:09:28,001 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:09:28,001 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:09:28,706 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:09:28,707 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:09:28,999 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:09:28,999 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:09:29,572 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:09:29,573 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:09:29,951 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:09:29,952 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:09:30,047 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:09:30,048 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:09:30,048 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:09:30,048 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:09:30,048 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:09:30,048 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:09:30,048 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:09:30,048 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:09:30,048 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:09:30,048 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:09:30,048 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:09:30,048 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:09:30,048 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:09:30,048 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:09:30,049 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:09:30,049 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:09:27,713 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:09:27,713 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:09:27,713 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:09:27,713 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:09:27,713 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:09:27,713 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:09:27,713 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:09:27,713 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:09:27,713 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:09:27,713 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:09:27,713 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:09:27,713 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:09:27,713 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:09:27,713 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:09:27,716 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:09:27,716 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:09:27,716 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:09:27,716 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:09:30,049 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:09:30,052 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:09:30,052 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:09:30,054 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:09:30,054 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:09:27,758 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:09:27,758 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:09:27,759 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:09:27,759 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:09:27,759 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:09:27,759 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:09:27,760 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:09:27,760 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:09:27,760 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:09:27,760 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:09:27,995 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:09:27,996 - websockets.server - INFO - connection closed
2025-06-28 11:09:27,998 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:09:27,998 - websockets.server - INFO - connection closed

2025-06-28 11:09:30,054 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:09:30,056 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:09:30,056 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:09:30,057 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:09:30,057 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:09:27,589 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:09:27,589 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:09:27,589 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:09:27,589 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:09:27,592 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:09:27,592 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:09:27,592 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:09:27,592 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:09:27,998 - websockets.server - INFO - connection open
2025-06-28 11:09:27,998 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 61984)
2025-06-28 11:09:28,000 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:09:28,000 - websockets.server - INFO - connection closed

2025-06-28 11:09:30,057 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:09:30,059 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:09:30,126 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:30,127 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:30,127 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:09:30,127 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:09:30,127 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:09:30,127 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:09:30,127 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:09:30,127 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:09:30,127 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:09:30,611 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:09:30,612 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:09:30,612 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:09:30,612 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:09:33,132 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:09:33,132 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:09:33,219 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:09:33,219 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:09:33,219 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:09:33,219 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:09:33,219 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:09:33,219 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:09:33,219 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:09:33,219 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:09:33,219 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:09:33,219 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:09:33,219 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:09:33,219 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:09:33,219 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:09:33,285 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:33,285 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:33,285 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:09:33,285 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:09:33,285 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:09:33,285 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:09:33,285 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:09:33,285 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:09:33,285 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:09:36,290 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:09:36,291 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:09:36,393 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:09:36,393 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:09:36,393 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:09:36,393 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:09:36,393 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:09:36,393 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:09:36,393 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:09:36,393 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:09:36,393 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:09:36,393 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:09:36,393 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:09:36,393 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:09:36,393 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:09:36,458 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:36,458 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:36,458 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:09:36,458 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:09:36,458 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:09:36,458 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:09:36,458 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:09:36,458 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:09:36,458 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:09:39,464 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:09:39,464 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:09:39,565 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:09:39,565 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:09:39,565 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:09:39,565 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:09:39,565 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:09:39,565 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:09:39,565 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:09:39,565 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:09:39,565 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:09:39,565 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:09:39,565 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:09:39,566 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:09:39,566 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:09:39,631 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:39,631 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:39,631 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:09:39,631 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:09:39,631 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:09:39,631 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:09:39,631 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:09:39,631 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:09:39,631 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:09:40,055 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:09:40,055 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:09:40,055 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:09:40,056 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:09:40,056 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:09:40,057 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:09:40,058 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:40,058 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:40,058 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:09:40,058 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:09:40,058 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:09:40,058 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:09:40,058 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:09:40,058 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:09:40,058 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:09:40,058 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:09:40,059 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:09:40,059 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:09:40,059 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:09:40,059 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:09:40,059 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:09:40,059 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:40,059 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:40,060 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:09:40,060 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:09:40,060 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:09:40,060 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:40,065 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:09:40,066 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:09:40,067 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:09:40,067 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 74246)
2025-06-28 11:09:40,067 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:09:40,068 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:09:40,068 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:09:40,068 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:09:40,068 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:40,072 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:40,073 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:09:40,074 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:09:40,074 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 74247)
2025-06-28 11:09:40,074 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:09:40,074 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:09:40,075 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:09:40,075 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:09:40,075 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:09:40,076 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:09:40,076 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:09:40,077 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:40,077 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:09:40,078 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:09:40,078 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:09:40,078 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:09:40,078 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:40,083 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 74248)
2025-06-28 11:09:40,083 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:09:40,084 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:09:40,085 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:09:40,085 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:09:40,085 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:09:40,085 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:09:40,085 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:09:40,085 - websockets.client - DEBUG - > Sec-WebSocket-Key: muFyqm1/sEKoPGk2RH20FQ==
2025-06-28 11:09:40,085 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:09:40,085 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:09:40,085 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:09:40,086 - websockets.client - DEBUG - > EOF
2025-06-28 11:09:40,086 - websockets.client - DEBUG - < EOF
2025-06-28 11:09:40,086 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:09:40,087 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:09:40,677 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:09:40,678 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:09:40,690 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:09:40,691 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:09:40,691 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:09:40,691 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:09:40,691 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:09:40,691 - websockets.client - DEBUG - > Sec-WebSocket-Key: IUfH9Icy2FAztQZv+T4N2Q==
2025-06-28 11:09:40,691 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:09:40,691 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:09:40,692 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:09:40,693 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:09:40,693 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:09:40,693 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:09:40,693 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:09:40,693 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:09:40,693 - websockets.client - DEBUG - < Sec-WebSocket-Accept: VPGZqy1EbiLsGwsY+rYMPeed3WU=
2025-06-28 11:09:40,693 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:09:40,693 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:09:40 GMT
2025-06-28 11:09:40,693 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:09:40,693 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:09:40,694 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:09:40,694 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:09:40,694 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:09:40,694 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:09:40,695 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:09:40,695 - websockets.client - DEBUG - < EOF
2025-06-28 11:09:40,695 - websockets.client - DEBUG - > EOF
2025-06-28 11:09:40,695 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:09:40,695 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:09:40,695 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:09:40,695 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:09:40,695 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:09:41,401 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:09:41,401 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:09:41,694 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:09:41,695 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:09:42,267 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:09:42,268 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:09:42,636 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:09:42,637 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:09:42,725 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:09:42,725 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:09:42,725 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:09:42,725 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:09:42,725 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:09:42,725 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:09:42,725 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:09:42,725 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:09:42,725 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:09:42,725 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:09:42,725 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:09:42,725 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:09:42,725 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:09:42,725 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:09:42,726 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:09:42,726 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:09:40,331 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:09:40,332 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:09:40,332 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:09:40,332 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:09:40,332 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:09:40,332 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:09:40,332 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:09:40,332 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:09:40,332 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:09:40,332 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:09:40,332 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:09:40,332 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:09:40,332 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:09:40,332 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:09:40,335 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:09:40,335 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:09:40,335 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:09:40,335 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:09:42,726 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:09:42,729 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:09:42,729 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:09:42,730 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:09:42,730 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:09:40,391 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:09:40,391 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:09:40,391 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:09:40,391 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:09:40,391 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:09:40,392 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:09:40,393 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:09:40,393 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:09:40,393 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:09:40,393 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:09:40,690 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:09:40,690 - websockets.server - INFO - connection closed
2025-06-28 11:09:40,693 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:09:40,694 - websockets.server - INFO - connection closed

2025-06-28 11:09:42,730 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:09:42,733 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:09:42,733 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:09:42,734 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:09:42,734 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:09:40,218 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:09:40,218 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:09:40,218 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:09:40,218 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:09:40,221 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:09:40,221 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:09:40,221 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:09:40,221 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:09:40,693 - websockets.server - INFO - connection open
2025-06-28 11:09:40,693 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 62001)
2025-06-28 11:09:40,694 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:09:40,695 - websockets.server - INFO - connection closed

2025-06-28 11:09:42,734 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:09:42,734 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:09:42,801 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:42,801 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:42,801 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:09:42,801 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:09:42,801 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:09:42,801 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:09:42,801 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:09:42,801 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:09:42,801 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:09:43,306 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:09:43,306 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:09:43,307 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:09:43,308 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:09:45,807 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:09:45,807 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:09:45,905 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:09:45,905 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:09:45,905 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:09:45,905 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:09:45,905 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:09:45,905 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:09:45,905 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:09:45,905 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:09:45,905 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:09:45,905 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:09:45,905 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:09:45,905 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:09:45,905 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:09:45,971 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:45,971 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:45,971 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:09:45,971 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:09:45,971 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:09:45,971 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:09:45,971 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:09:45,971 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:09:45,971 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:09:48,976 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:09:48,977 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:09:49,050 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:09:49,050 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:09:49,050 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:09:49,050 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:09:49,050 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:09:49,050 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:09:49,050 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:09:49,050 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:09:49,050 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:09:49,050 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:09:49,050 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:09:49,050 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:09:49,050 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:09:49,115 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:49,116 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:49,116 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:09:49,116 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:09:49,116 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:09:49,116 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:09:49,116 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:09:49,116 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:09:49,116 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:09:52,126 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:09:52,126 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:09:52,249 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:09:52,249 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:09:52,249 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:09:52,249 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:09:52,249 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:09:52,249 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:09:52,249 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:09:52,249 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:09:52,249 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:09:52,249 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:09:52,249 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:09:52,249 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:09:52,249 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:09:52,325 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:52,326 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:52,326 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:09:52,326 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:09:52,326 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:09:52,326 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:09:52,326 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:09:52,326 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:09:52,326 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:09:52,732 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:09:52,732 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:09:52,732 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:09:52,733 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:52,733 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:09:52,733 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:09:52,733 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:09:52,733 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:09:52,734 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:09:52,734 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:09:52,734 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:09:52,734 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:52,734 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:09:52,734 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:09:52,734 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:52,738 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:09:52,739 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:09:52,740 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:09:52,740 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:09:52,741 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:09:52,741 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:09:52,742 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:52,742 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:09:52,743 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:09:52,742 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 74386)
2025-06-28 11:09:52,743 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:09:52,743 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:52,743 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:09:52,743 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:09:52,743 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:09:52,743 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:09:52,743 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:09:52,744 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:09:52,744 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:09:52,743 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:09:52,744 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:09:52,744 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:09:52,744 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:09:52,744 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:52,744 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:09:52,744 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:52,745 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:09:52,745 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:09:52,745 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:09:52,745 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:09:52,746 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:09:52,745 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:09:52,746 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:09:52,746 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:52,746 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:09:52,746 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:09:52,799 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 74387)
2025-06-28 11:09:52,799 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 74388)
2025-06-28 11:09:52,799 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:09:52,800 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:09:52,803 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:09:52,804 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:09:52,804 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:09:52,804 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:09:52,804 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:09:52,809 - websockets.client - DEBUG - > Sec-WebSocket-Key: 0Pii0UWEspOstW7wY9mAxQ==
2025-06-28 11:09:52,809 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:09:52,809 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:09:52,809 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:09:52,812 - websockets.client - DEBUG - > EOF
2025-06-28 11:09:52,813 - websockets.client - DEBUG - < EOF
2025-06-28 11:09:52,813 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:09:52,816 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:09:52,816 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:09:53,345 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:09:53,346 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:09:53,421 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:09:53,422 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:09:53,422 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:09:53,422 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:09:53,422 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:09:53,422 - websockets.client - DEBUG - > Sec-WebSocket-Key: GaqzG3WYA4u3inXMBP3IKQ==
2025-06-28 11:09:53,422 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:09:53,422 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:09:53,422 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:09:53,423 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:09:53,423 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:09:53,424 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:09:53,424 - websockets.client - DEBUG - < Sec-WebSocket-Accept: umgfqYMyK5jM0llZsR8+VDk2hyo=
2025-06-28 11:09:53,424 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:09:53,424 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:09:53 GMT
2025-06-28 11:09:53,424 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:09:53,424 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:09:53,424 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:09:53,425 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:09:53,425 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:09:53,425 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:09:53,425 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:09:53,425 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:09:53,426 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:09:53,426 - websockets.client - DEBUG - < EOF
2025-06-28 11:09:53,426 - websockets.client - DEBUG - > EOF
2025-06-28 11:09:53,426 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:09:53,426 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:09:53,426 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:09:53,426 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:09:53,426 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:09:54,067 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:09:54,067 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:09:54,428 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:09:54,428 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:09:54,934 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:09:54,934 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:09:55,336 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:09:55,336 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:09:55,437 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:09:55,437 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:09:55,437 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:09:55,437 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:09:55,437 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:09:55,437 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:09:55,437 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:09:55,437 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:09:55,437 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:09:55,437 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:09:55,437 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:09:55,437 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:09:55,437 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:09:55,437 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:09:55,439 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:09:55,439 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:09:53,106 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:09:53,107 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:09:53,107 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:09:53,107 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:09:53,107 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:09:53,107 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:09:53,107 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:09:53,107 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:09:53,107 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:09:53,107 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:09:53,107 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:09:53,107 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:09:53,107 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:09:53,107 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:09:53,110 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:09:53,110 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:09:53,110 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:09:53,110 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:09:55,439 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:09:55,439 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:09:55,439 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:09:55,440 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:09:55,440 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:09:52,986 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:09:52,986 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:09:52,987 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:09:52,987 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:09:52,990 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:09:52,990 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:09:52,990 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:09:52,990 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:09:53,423 - websockets.server - INFO - connection open
2025-06-28 11:09:53,423 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 62096)
2025-06-28 11:09:53,425 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:09:53,426 - websockets.server - INFO - connection closed

2025-06-28 11:09:55,440 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:09:55,440 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:09:55,440 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:09:55,442 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:09:55,442 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:09:53,152 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:09:53,152 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:09:53,152 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:09:53,152 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:09:53,152 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:09:53,152 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:09:53,153 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:09:53,153 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:09:53,153 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:09:53,153 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:09:53,422 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:09:53,423 - websockets.server - INFO - connection closed
2025-06-28 11:09:53,425 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:09:53,426 - websockets.server - INFO - connection closed

2025-06-28 11:09:55,442 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:09:55,442 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:09:55,509 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:55,509 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:55,509 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:09:55,509 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:09:55,509 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:09:55,509 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:09:55,509 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:09:55,509 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:09:55,509 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:09:55,974 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:09:55,974 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:09:55,975 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:09:55,975 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:09:58,519 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:09:58,520 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:09:58,622 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:09:58,622 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:09:58,622 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:09:58,622 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:09:58,622 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:09:58,622 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:09:58,622 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:09:58,622 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:09:58,622 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:09:58,622 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:09:58,622 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:09:58,622 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:09:58,622 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:09:58,688 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:58,688 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:09:58,688 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:09:58,688 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:09:58,688 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:09:58,688 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:09:58,689 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:09:58,689 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:09:58,689 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:10:01,699 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:10:01,699 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:10:01,804 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:10:01,804 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:10:01,804 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:10:01,804 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:10:01,804 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:10:01,804 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:10:01,804 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:10:01,804 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:10:01,804 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:10:01,804 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:10:01,804 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:10:01,804 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:10:01,804 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:10:01,869 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:10:01,869 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:10:01,869 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:10:01,869 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:10:01,869 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:10:01,869 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:10:01,870 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:10:01,870 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:10:01,870 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:10:04,880 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:10:04,880 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:10:04,980 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:10:04,980 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:10:04,980 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:10:04,980 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:10:04,980 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:10:04,980 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:10:04,980 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:10:04,980 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:10:04,980 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:10:04,980 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:10:04,980 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:10:04,980 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:10:04,980 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:10:05,046 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:10:05,046 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:10:05,046 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:10:05,046 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:10:05,046 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:10:05,046 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:10:05,046 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:10:05,046 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:10:05,046 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:10:05,449 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:10:05,449 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:10:05,449 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:10:05,450 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:10:05,450 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:10:05,450 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:10:05,451 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:10:05,451 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:10:05,451 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:10:05,452 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:05,453 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:05,453 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:05,453 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:10:05,453 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:10:05,453 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:10:05,453 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:10:05,453 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:10:05,453 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:10:05,453 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:10:05,453 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:10:05,453 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:10:05,453 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:10:05,454 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:10:05,454 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:10:05,454 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:10:05,454 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:10:05,454 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:10:05,454 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:10:05,454 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:10:05,454 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:05,454 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:05,455 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:10:05,455 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:10:05,455 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:10:05,455 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:10:05,456 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:05,456 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:10:05,456 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:10:05,456 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:05,456 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:10:05,456 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:10:05,457 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:10:05,457 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:10:05,461 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:10:05,462 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:10:05,462 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:05,463 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 74459)
2025-06-28 11:10:05,463 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:05,464 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:10:05,471 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:10:05,472 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 74460)
2025-06-28 11:10:05,472 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 74461)
2025-06-28 11:10:05,472 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:10:05,473 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:10:05,473 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:10:05,475 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:10:05,475 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:10:05,475 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:10:05,476 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:10:05,476 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:10:05,476 - websockets.client - DEBUG - > Sec-WebSocket-Key: h7i4H8l2GlamIw1L4/PR0Q==
2025-06-28 11:10:05,476 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:10:05,476 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:10:05,476 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:10:05,477 - websockets.client - DEBUG - > EOF
2025-06-28 11:10:05,477 - websockets.client - DEBUG - < EOF
2025-06-28 11:10:05,477 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:10:05,478 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:10:05,479 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:10:06,076 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:10:06,077 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:10:06,084 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:10:06,084 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:10:06,085 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:10:06,085 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:10:06,085 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:10:06,085 - websockets.client - DEBUG - > Sec-WebSocket-Key: 7h0vLB6Z78KVrqzEA9j08Q==
2025-06-28 11:10:06,085 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:10:06,085 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:10:06,085 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:10:06,086 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:10:06,087 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:10:06,087 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:10:06,087 - websockets.client - DEBUG - < Sec-WebSocket-Accept: WWNa06lyufipWPSSPbqQbGEZDQ8=
2025-06-28 11:10:06,087 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:10:06,087 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:10:06 GMT
2025-06-28 11:10:06,087 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:10:06,087 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:10:06,088 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:10:06,088 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:10:06,088 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:10:06,089 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:10:06,089 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:10:06,089 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:10:06,090 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:10:06,090 - websockets.client - DEBUG - < EOF
2025-06-28 11:10:06,091 - websockets.client - DEBUG - > EOF
2025-06-28 11:10:06,091 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:10:06,091 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:10:06,091 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:10:06,091 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:10:06,092 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:10:06,800 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:10:06,801 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:10:07,092 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:10:07,092 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:10:07,667 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:10:07,667 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:10:08,056 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:10:08,056 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:10:08,159 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:10:08,159 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:10:08,159 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:10:08,159 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:10:08,159 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:10:08,159 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:10:08,159 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:10:08,159 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:10:08,159 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:10:08,159 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:10:08,159 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:10:08,159 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:10:08,159 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:10:08,159 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:10:08,161 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:10:08,161 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:10:05,697 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:10:05,698 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:10:05,698 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:10:05,698 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:10:05,698 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:10:05,698 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:10:05,698 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:10:05,698 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:10:05,698 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:10:05,698 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:10:05,698 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:10:05,698 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:10:05,698 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:10:05,698 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:10:05,701 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:10:05,701 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:10:05,701 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:10:05,701 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:10:08,161 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:10:08,164 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:10:08,164 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:10:08,165 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:10:08,165 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:10:05,607 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:10:05,607 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:10:05,607 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:10:05,607 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:10:05,610 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:10:05,610 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:10:05,610 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:10:05,610 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:10:06,086 - websockets.server - INFO - connection open
2025-06-28 11:10:06,086 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 62135)
2025-06-28 11:10:06,088 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:10:06,091 - websockets.server - INFO - connection closed

2025-06-28 11:10:08,165 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:10:08,165 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:10:08,165 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:10:08,167 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:10:08,167 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:10:08,167 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:10:05,738 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:10:05,738 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:10:05,738 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:10:05,738 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:10:05,738 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:10:05,738 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:10:05,739 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:10:05,739 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:10:05,739 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:10:05,739 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:10:06,086 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:10:06,086 - websockets.server - INFO - connection closed
2025-06-28 11:10:06,089 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:10:06,090 - websockets.server - INFO - connection closed

2025-06-28 11:10:08,168 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:10:08,234 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:10:08,234 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:10:08,234 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:10:08,234 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:10:08,234 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:10:08,234 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:10:08,234 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:10:08,234 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:10:08,234 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:10:08,706 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:10:08,707 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:10:08,707 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:10:08,707 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:10:11,244 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:10:11,245 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:10:11,349 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:10:11,349 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:10:11,349 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:10:11,349 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:10:11,349 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:10:11,349 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:10:11,349 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:10:11,349 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:10:11,349 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:10:11,349 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:10:11,349 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:10:11,349 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:10:11,349 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:10:11,414 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:10:11,414 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:10:11,414 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:10:11,414 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:10:11,414 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:10:11,414 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:10:11,414 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:10:11,414 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:10:11,414 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:10:14,424 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:10:14,425 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:10:14,524 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:10:14,524 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:10:14,524 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:10:14,524 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:10:14,524 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:10:14,524 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:10:14,524 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:10:14,524 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:10:14,524 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:10:14,524 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:10:14,525 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:10:14,525 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:10:14,525 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:10:14,593 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:10:14,593 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:10:14,593 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:10:14,593 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:10:14,593 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:10:14,593 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:10:14,593 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:10:14,593 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:10:14,593 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:10:17,604 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:10:17,604 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:10:17,707 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:10:17,707 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:10:17,707 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:10:17,707 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:10:17,707 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:10:17,707 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:10:17,707 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:10:17,707 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:10:17,707 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:10:17,707 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:10:17,707 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:10:17,707 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:10:17,707 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:10:17,772 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:10:17,772 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:10:17,773 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:10:17,773 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:10:17,773 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:10:17,773 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:10:17,773 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:10:17,773 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:10:17,773 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:10:18,171 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:10:18,171 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:10:18,172 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:10:18,172 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:10:18,173 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:10:18,173 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:10:18,174 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:18,175 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:18,175 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:10:18,175 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:10:18,175 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:10:18,175 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:10:18,175 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:10:18,175 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:10:18,176 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:10:18,176 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:10:18,176 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:10:18,176 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:10:18,176 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:10:18,177 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:10:18,177 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:10:18,177 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:18,177 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:18,178 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:10:18,178 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:10:18,178 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:10:18,178 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:18,178 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:10:18,183 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:10:18,184 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:10:18,185 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 74542)
2025-06-28 11:10:18,185 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:10:18,186 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:10:18,186 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:10:18,186 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:10:18,186 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:18,190 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:10:18,191 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:18,192 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:10:18,192 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:10:18,192 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 74543)
2025-06-28 11:10:18,192 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:10:18,193 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:10:18,193 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:10:18,193 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:10:18,194 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:10:18,194 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:10:18,194 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:18,195 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:10:18,195 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:10:18,196 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:10:18,196 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:10:18,196 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:18,196 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:10:18,196 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:10:18,196 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:10:18,196 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:10:18,197 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:10:18,197 - websockets.client - DEBUG - > Sec-WebSocket-Key: 2F92BOAed6zqWR/4cQZJvw==
2025-06-28 11:10:18,197 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:10:18,199 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:10:18,199 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:10:18,200 - websockets.client - DEBUG - > EOF
2025-06-28 11:10:18,200 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 74544)
2025-06-28 11:10:18,200 - websockets.client - DEBUG - < EOF
2025-06-28 11:10:18,201 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:10:18,201 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:10:18,203 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:10:18,204 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:10:18,796 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:10:18,797 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:10:18,809 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:10:18,809 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:10:18,810 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:10:18,810 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:10:18,810 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:10:18,810 - websockets.client - DEBUG - > Sec-WebSocket-Key: z7IrB0s62ZTl8OqFPu1wJA==
2025-06-28 11:10:18,810 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:10:18,810 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:10:18,810 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:10:18,811 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:10:18,812 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:10:18,812 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:10:18,812 - websockets.client - DEBUG - < Sec-WebSocket-Accept: zL6r4cWgJh1k+iZxFlB24RIgB6A=
2025-06-28 11:10:18,812 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:10:18,812 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:10:18 GMT
2025-06-28 11:10:18,812 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:10:18,812 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:10:18,813 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:10:18,813 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:10:18,813 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:10:18,813 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:10:18,814 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:10:18,814 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:10:18,814 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:10:18,814 - websockets.client - DEBUG - < EOF
2025-06-28 11:10:18,814 - websockets.client - DEBUG - > EOF
2025-06-28 11:10:18,814 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:10:18,814 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:10:18,815 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:10:18,815 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:10:18,815 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:10:19,520 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:10:19,521 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:10:19,816 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:10:19,817 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:10:20,388 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:10:20,388 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:10:20,783 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:10:20,783 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:10:20,879 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:10:20,879 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:10:20,879 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:10:20,879 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:10:20,879 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:10:20,879 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:10:20,879 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:10:20,879 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:10:20,879 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:10:20,880 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:10:20,880 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:10:20,880 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:10:20,880 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:10:20,880 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:10:20,881 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:10:20,881 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:10:18,478 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:10:18,478 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:10:18,478 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:10:18,478 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:10:18,478 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:10:18,478 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:10:18,478 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:10:18,478 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:10:18,478 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:10:18,478 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:10:18,478 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:10:18,478 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:10:18,478 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:10:18,478 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:10:18,481 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:10:18,481 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:10:18,481 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:10:18,481 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:10:20,881 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:10:20,881 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:10:20,881 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:10:20,882 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:10:20,882 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:10:18,360 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:10:18,360 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:10:18,360 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:10:18,360 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:10:18,363 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:10:18,363 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:10:18,363 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:10:18,363 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:10:18,811 - websockets.server - INFO - connection open
2025-06-28 11:10:18,811 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 62161)
2025-06-28 11:10:18,813 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:10:18,814 - websockets.server - INFO - connection closed

2025-06-28 11:10:20,882 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:10:20,883 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:10:20,883 - services.mcp_server_launcher - INFO - 停止MCP服务器: deepsearch_server
2025-06-28 11:10:20,884 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:10:20,884 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:10:18,522 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:10:18,522 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:10:18,522 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:10:18,522 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:10:18,522 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:10:18,522 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:10:18,523 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:10:18,523 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:10:18,523 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:10:18,523 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:10:18,811 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:10:18,811 - websockets.server - INFO - connection closed
2025-06-28 11:10:18,814 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:10:18,814 - websockets.server - INFO - connection closed

2025-06-28 11:10:20,885 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:10:20,887 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: deepsearch_server
2025-06-28 11:10:20,955 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:10:20,955 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:10:20,955 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:10:20,955 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:10:20,955 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:10:20,955 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:10:20,955 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:10:20,955 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:10:20,955 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:10:21,428 - services.mcp_server_launcher - ERROR - ❌ microsandbox_server 进程意外退出 (退出码: -15)
2025-06-28 11:10:21,428 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:10:21,429 - services.mcp_server_launcher - ERROR - MCP服务器启动失败: microsandbox_server
输出: 
错误: 
2025-06-28 11:10:21,429 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: microsandbox_server
2025-06-28 11:10:23,965 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:10:23,966 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:10:24,069 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:10:24,069 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:10:24,069 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:10:24,069 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:10:24,069 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:10:24,069 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:10:24,069 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:10:24,069 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:10:24,069 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:10:24,069 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:10:24,069 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:10:24,069 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:10:24,069 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:10:24,134 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:10:24,134 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:10:24,134 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:10:24,134 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:10:24,134 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:10:24,134 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:10:24,134 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:10:24,134 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:10:24,134 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:10:27,145 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:10:27,146 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:10:27,251 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:10:27,251 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:10:27,251 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:10:27,251 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:10:27,251 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:10:27,251 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:10:27,251 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:10:27,251 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:10:27,252 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:10:27,252 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:10:27,252 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:10:27,252 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:10:27,252 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:10:27,317 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:10:27,318 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:10:27,318 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:10:27,318 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:10:27,318 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:10:27,318 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:10:27,318 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:10:27,318 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:10:27,318 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:10:30,328 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:10:30,328 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:10:30,418 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:10:30,419 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:10:30,419 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:10:30,419 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:10:30,419 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:10:30,419 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:10:30,419 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:10:30,419 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:10:30,419 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:10:30,419 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:10:30,419 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:10:30,419 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:10:30,419 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:10:30,483 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:10:30,483 - services.mcp_server_launcher - INFO - 所有MCP服务器已停止
2025-06-28 11:10:30,484 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:10:30,484 - __main__ - INFO - TaskProcessingCoordinator 停止中...
2025-06-28 11:10:30,484 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:10:30,484 - services.toolscore_service - INFO - 正在停止ToolScore服务...
2025-06-28 11:10:30,484 - services.toolscore_service - INFO - WebSocket服务器已关闭
2025-06-28 11:10:30,484 - services.toolscore_service - INFO - ToolScore MCP服务器已停止
2025-06-28 11:10:30,484 - services.toolscore_service - INFO - 等待 ToolScore HTTP API 线程停止...
2025-06-28 11:10:30,891 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: microsandbox_server
2025-06-28 11:10:30,892 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:10:30,893 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: search_tool_server
2025-06-28 11:10:30,893 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:10:30,893 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:10:30,894 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:10:30,894 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:30,894 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:30,894 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:10:30,894 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:10:30,895 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:10:30,895 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:10:30,895 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:10:30,895 - services.mcp_server_launcher - INFO - 🔄 开始自动重启 MCP 服务器: deepsearch_server
2025-06-28 11:10:30,895 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:10:30,895 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:10:30,895 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:10:30,895 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:10:30,896 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:10:30,896 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:10:30,896 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:10:30,896 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:10:30,896 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:10:30,897 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:10:30,897 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:30,897 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:30,897 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:30,897 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:10:30,897 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:10:30,897 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:10:30,897 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:10:30,897 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:10:30,898 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:10:30,898 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:30,898 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:10:30,902 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:10:30,904 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:10:30,904 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:10:30,905 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:10:30,905 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 74621)
2025-06-28 11:10:30,905 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:10:30,906 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:30,906 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:10:30,906 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:30,910 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:10:30,912 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 74622)
2025-06-28 11:10:30,912 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:10:30,912 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:10:30,912 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:10:30,912 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:10:30,912 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:10:30,912 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:10:30,916 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:10:30,918 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 74623)
2025-06-28 11:10:30,918 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:10:30,919 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:10:30,920 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:10:30,920 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:10:30,920 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:10:30,920 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:10:30,920 - websockets.client - DEBUG - > Sec-WebSocket-Key: FLnzUNffpRzs+IK2fzDJmA==
2025-06-28 11:10:30,920 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:10:30,921 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:10:30,921 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:10:30,921 - websockets.client - DEBUG - > EOF
2025-06-28 11:10:30,921 - websockets.client - DEBUG - < EOF
2025-06-28 11:10:30,921 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:10:30,923 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:10:30,923 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:10:31,521 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:10:31,521 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:10:31,529 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:10:31,530 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:10:31,530 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:10:31,530 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:10:31,530 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:10:31,530 - websockets.client - DEBUG - > Sec-WebSocket-Key: EZXsdpGEvwTdUBkgPmpIZw==
2025-06-28 11:10:31,531 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:10:31,531 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:10:31,531 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:10:31,532 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:10:31,532 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:10:31,532 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:10:31,532 - websockets.client - DEBUG - < Sec-WebSocket-Accept: kyCu43I/iS/lOZBN61qNQPcaVnA=
2025-06-28 11:10:31,532 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:10:31,532 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:10:31 GMT
2025-06-28 11:10:31,532 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:10:31,533 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:10:31,533 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:10:31,533 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:10:31,534 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:10:31,534 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:10:31,534 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:10:31,535 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:10:31,535 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:10:31,535 - websockets.client - DEBUG - < EOF
2025-06-28 11:10:31,535 - websockets.client - DEBUG - > EOF
2025-06-28 11:10:31,535 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:10:31,535 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:10:31,536 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:10:31,536 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:10:31,536 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: search_tool_server
2025-06-28 11:10:32,244 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:10:32,245 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:10:32,536 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:10:32,537 - services.mcp_server_launcher - INFO - ✅ 自动重启成功: deepsearch_server
2025-06-28 11:10:33,112 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:10:33,112 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:10:33,494 - services.toolscore_service - WARNING - ToolScore HTTP API 线程未能正常结束，尝试强制停止...
2025-06-28 11:10:33,494 - services.toolscore_service - INFO - 强制终止 ToolScore HTTP API 线程
2025-06-28 11:10:33,592 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:10:33,592 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:10:33,592 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:10:33,592 - services.service_manager - ERROR - 强制停止服务 synthesis 时出错: maximum recursion depth exceeded while calling a Python object
2025-06-28 11:10:33,592 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:10:33,592 - services.service_manager - ERROR - 强制停止服务 runtime 时出错: maximum recursion depth exceeded while calling a Python object
2025-06-28 11:10:33,592 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:10:33,592 - services.service_manager - ERROR - 强制停止服务 task_api 时出错: maximum recursion depth exceeded while calling a Python object
2025-06-28 11:10:33,592 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:10:33,592 - services.service_manager - ERROR - 强制停止服务 mcp_servers 时出错: maximum recursion depth exceeded while calling a Python object
2025-06-28 11:10:33,592 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:10:33,592 - services.service_manager - ERROR - 强制停止服务 task_processing_coordinator 时出错: maximum recursion depth exceeded while calling a Python object
2025-06-28 11:10:33,592 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:10:33,592 - services.service_manager - ERROR - 强制停止服务 toolscore 时出错: maximum recursion depth exceeded while calling a Python object
2025-06-28 11:10:33,592 - services.service_manager - INFO - 强制停止服务: redis
2025-06-28 11:10:33,592 - services.service_manager - ERROR - 强制停止服务 redis 时出错: maximum recursion depth exceeded while calling a Python object
2025-06-28 11:10:33,592 - services.service_manager - INFO - 强制停止完成
2025-06-28 11:10:33,592 - __main__ - INFO - 服务管理器强制停止完成
2025-06-28 11:10:33,592 - __main__ - INFO - 执行强制清理...
2025-06-28 11:10:33,607 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:10:33,607 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:10:33,607 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:10:33,607 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:10:31,274 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:10:31,274 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:10:31,274 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:10:31,274 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:10:31,274 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:10:31,275 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:10:31,276 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:10:31,276 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:10:31,276 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:10:31,276 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:10:31,531 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:10:31,531 - websockets.server - INFO - connection closed
2025-06-28 11:10:31,534 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:10:31,534 - websockets.server - INFO - connection closed

2025-06-28 11:10:33,607 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:10:31,111 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:10:31,111 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:10:31,111 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:10:31,111 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:10:31,114 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:10:31,114 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:10:31,114 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:10:31,114 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:10:31,532 - websockets.server - INFO - connection open
2025-06-28 11:10:31,532 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 62205)
2025-06-28 11:10:31,534 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:10:31,535 - websockets.server - INFO - connection closed

2025-06-28 11:10:33,607 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:10:31,229 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:10:31,229 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:10:31,229 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:10:31,229 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:10:31,229 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:10:31,229 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:10:31,229 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:10:31,229 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:10:31,229 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:10:31,229 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:10:31,229 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:10:31,229 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:10:31,229 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:10:31,229 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:10:31,232 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:10:31,232 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:10:31,232 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:10:31,232 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...

2025-06-28 11:10:33,607 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:10:33,608 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:10:33,608 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:10:33,642 - __main__ - INFO - 已尝试清理MCP服务器进程
2025-06-28 11:10:33,643 - services.toolscore_service - WARNING - 释放端口 8081 进程 72484 失败: maximum recursion depth exceeded
2025-06-28 11:10:33,666 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:10:33,666 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:10:33,666 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:10:33,666 - services.service_manager - ERROR - 强制停止服务 synthesis 时出错: maximum recursion depth exceeded while calling a Python object
2025-06-28 11:10:33,666 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:10:33,666 - services.service_manager - ERROR - 强制停止服务 runtime 时出错: maximum recursion depth exceeded while calling a Python object
2025-06-28 11:10:33,666 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:10:33,666 - services.service_manager - ERROR - 强制停止服务 task_api 时出错: maximum recursion depth exceeded while calling a Python object
2025-06-28 11:10:33,666 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:10:33,666 - services.service_manager - ERROR - 强制停止服务 mcp_servers 时出错: maximum recursion depth exceeded while calling a Python object
2025-06-28 11:10:33,666 - services.service_manager - INFO - 强制停止服务: task_processing_coordinator
2025-06-28 11:10:33,666 - services.service_manager - ERROR - 强制停止服务 task_processing_coordinator 时出错: maximum recursion depth exceeded while calling a Python object
2025-06-28 11:10:33,666 - services.service_manager - INFO - 强制停止服务: toolscore
2025-06-28 11:10:33,666 - services.service_manager - ERROR - 强制停止服务 toolscore 时出错: maximum recursion depth exceeded while calling a Python object
2025-06-28 11:10:33,666 - services.service_manager - INFO - 强制停止服务: redis
2025-06-28 11:10:33,666 - services.service_manager - ERROR - 强制停止服务 redis 时出错: maximum recursion depth exceeded while calling a Python object
2025-06-28 11:10:33,666 - services.service_manager - INFO - 强制停止完成
2025-06-28 11:10:33,666 - __main__ - INFO - 服务管理器强制停止完成
2025-06-28 11:10:33,666 - __main__ - INFO - 执行强制清理...
2025-06-28 11:10:33,714 - __main__ - INFO - 已尝试清理MCP服务器进程
2025-06-28 11:10:33,714 - services.toolscore_service - WARNING - 释放端口 8082 进程 72484 失败: maximum recursion depth exceeded
2025-06-28 11:10:33,735 - services.toolscore_service - INFO - ToolScore服务已停止
2025-06-28 11:10:33,735 - services.service_manager - INFO - 强制停止服务: redis
2025-06-28 11:10:33,735 - services.redis_service - INFO - 正在关闭Redis连接
2025-06-28 11:10:33,735 - services.service_manager - INFO - 强制停止完成
2025-06-28 11:10:33,735 - __main__ - INFO - 服务管理器强制停止完成
2025-06-28 11:10:33,735 - __main__ - INFO - 执行强制清理...
2025-06-28 11:10:33,783 - __main__ - INFO - 已尝试清理MCP服务器进程

================================================================================
[系统启动] 2025-06-28 11:32:37
================================================================================
[2025-06-28 11:32:37] 🚀 Agent Data Platform 启动中... (所有日志将统一记录到 logs/System.log)
2025-06-28 11:32:37,814 - asyncio - DEBUG - Using selector: KqueueSelector
[2025-06-28 11:32:37] 🧹 开始增强端口清理...
[2025-06-28 11:32:37] 🔍 搜索并清理相关Python进程...
[2025-06-28 11:32:37] ✅ 进程清理完成
[2025-06-28 11:32:40] ✅ 端口 8088 空闲
[2025-06-28 11:32:40] ✅ 端口 8089 空闲
[2025-06-28 11:32:40] ✅ 端口 8090 空闲
[2025-06-28 11:32:40] ✅ 端口 8091 空闲
[2025-06-28 11:32:40] ✅ 端口 8092 空闲
[2025-06-28 11:32:40] ✅ 端口 5555 空闲
[2025-06-28 11:32:40] ✅ 端口 8081 空闲
[2025-06-28 11:32:40] ✅ 端口 8082 空闲
[2025-06-28 11:32:40] ✅ 端口 8080 空闲
[2025-06-28 11:32:40] ✅ 端口 8084 空闲
[2025-06-28 11:32:40] ✅ 端口 8085 空闲
[2025-06-28 11:32:40] ✅ 端口 8086 空闲
[2025-06-28 11:32:40] ✅ 端口 8087 空闲
[2025-06-28 11:32:40] ✅ 端口 8000 空闲
[2025-06-28 11:32:41] ✅ 增强端口清理完成
2025-06-28 11:32:41,299 - __main__ - INFO - === Agent Data Platform 启动中 ===
2025-06-28 11:32:41,299 - __main__ - DEBUG - 🔧 开始系统初始化流程...
2025-06-28 11:32:41,301 - __main__ - DEBUG - 📝 命令行参数: {'config_dir': 'config', 'debug': False, 'start_services': False}
2025-06-28 11:32:41,302 - __main__ - DEBUG - 🔧 步骤1: 初始化ConfigManager...
2025-06-28 11:32:41,302 - __main__ - DEBUG - ✅ ConfigManager初始化完成，配置目录: config
2025-06-28 11:32:41,302 - __main__ - DEBUG - 🔧 步骤2: 加载系统配置...
2025-06-28 11:32:41,303 - __main__ - DEBUG - 📡 Redis URL: redis://localhost:6379
2025-06-28 11:32:41,303 - __main__ - DEBUG - 📋 任务文件路径: tasks.jsonl
2025-06-28 11:32:41,310 - core.config_manager - INFO - 路由配置加载成功
2025-06-28 11:32:41,310 - __main__ - DEBUG - 🚦 路由配置加载完成，任务类型映射: {'CODE': 'tasks:reasoning', 'WEB': 'tasks:reasoning', 'REASONING': 'tasks:reasoning', 'RESEARCH': 'tasks:reasoning'}
2025-06-28 11:32:41,310 - __main__ - DEBUG - 📋 队列映射: {<TaskType.CODE: 'code'>: 'tasks:reasoning', <TaskType.WEB: 'web'>: 'tasks:reasoning', <TaskType.REASONING: 'reasoning'>: 'tasks:reasoning', <TaskType.RESEARCH: 'research'>: 'tasks:reasoning'}
2025-06-28 11:32:41,310 - __main__ - DEBUG - 🔧 步骤3: 初始化核心组件...
2025-06-28 11:32:41,311 - __main__ - DEBUG - ✅ EnhancedMetrics初始化完成
2025-06-28 11:32:41,311 - __main__ - DEBUG - ✅ RedisManager初始化完成
2025-06-28 11:32:41,312 - core.toolscore.toolscore_client - INFO - ✅ 增强的ToolScoreClient初始化完成
2025-06-28 11:32:41,314 - core.llm_client - DEBUG - Enriched config with environment variables: ['default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:32:41,431 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:32:41,433 - core.config_manager - INFO - 路由配置加载成功
2025-06-28 11:32:41,433 - core.monitoring.queue_monitor - INFO - ✅ QueueMonitor 配置加载完成
2025-06-28 11:32:41,433 - core.system_monitor - INFO - ✅ SystemMonitor 配置加载完成
2025-06-28 11:32:41,433 - __main__ - DEBUG - 🔧 开始初始化所有服务...
2025-06-28 11:32:41,433 - services.service_manager - INFO - 正在初始化所有服务...
2025-06-28 11:32:41,433 - services.service_manager - INFO - 初始化服务: redis
2025-06-28 11:32:41,433 - services.redis_service - INFO - Redis服务初始化完成，使用注入的RedisManager实例
2025-06-28 11:32:41,433 - services.service_manager - INFO - 初始化服务: toolscore
2025-06-28 11:32:41,433 - services.toolscore_service - INFO - 正在初始化ToolScore服务...
2025-06-28 11:32:41,433 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 11:32:41,433 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 11:32:41,434 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 11:32:41,434 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:32:41,434 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 11:32:41,434 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 11:32:41,434 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 11:32:41,434 - services.toolscore_service - INFO - ToolScore服务初始化完成（异步初始化将在start()中进行）
2025-06-28 11:32:41,434 - services.service_manager - INFO - 初始化服务: task_processing_coordinator
2025-06-28 11:32:41,434 - services.service_manager - INFO - 初始化服务: mcp_servers
2025-06-28 11:32:41,434 - services.mcp_server_launcher - INFO - 正在初始化MCP服务器启动器...
2025-06-28 11:32:41,434 - services.mcp_server_launcher - INFO - MCP服务器启动器初始化完成，配置了 4 个服务器: ['microsandbox_server', 'search_tool_server', 'browser_use_server', 'deepsearch_server']
2025-06-28 11:32:41,434 - services.service_manager - INFO - 初始化服务: task_api
2025-06-28 11:32:41,434 - services.task_api_service - INFO - 正在初始化任务API服务...
2025-06-28 11:32:41,434 - services.task_api_service - INFO - 任务API服务初始化完成
2025-06-28 11:32:41,434 - services.service_manager - INFO - 初始化服务: runtime
2025-06-28 11:32:41,434 - services.runtime_service - INFO - 正在初始化推理运行时服务...
2025-06-28 11:32:41,434 - services.runtime_service - INFO - 创建运行时实例: enhanced-runtime-1
2025-06-28 11:32:41,434 - core.memory_manager - INFO - MemoryManager initialized: use_redis=True, max_entries=1000
2025-06-28 11:32:41,434 - core.step_planner - INFO - StepPlanner initialized with max_steps=10
2025-06-28 11:32:41,434 - runtimes.reasoning.enhanced_runtime - INFO - DEBUG: Loaded toolscore_http_port: 8082, toolscore_mcp_port: 8081
2025-06-28 11:32:41,434 - runtimes.reasoning.enhanced_runtime - INFO - DEBUG: Configured toolscore_websocket_endpoint (using mcp_port): ws://localhost:8081/websocket
2025-06-28 11:32:41,434 - core.toolscore.mcp_client - INFO - Enhanced MCPToolClient initialized for toolscore at ws://localhost:8081/websocket
2025-06-28 11:32:41,443 - core.config.unified_mapping_manager - INFO - ✅ 统一映射配置已加载: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/config/unified_tool_mappings.yaml
2025-06-28 11:32:41,443 - core.config.unified_mapping_manager - INFO - 🔒 配置哈希: 19cc9dfe
2025-06-28 11:32:41,443 - core.llm.guardrails_middleware - INFO - 🔧 初始化输入验证Guard...
2025-06-28 11:32:41,445 - root - DEBUG - Creating HubTelemetry instance...
2025-06-28 11:32:41,445 - root - DEBUG - Initializing HubTelemetry instance...
2025-06-28 11:32:41,446 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:32:41,446 - core.llm.guardrails_middleware - INFO - 🔧 初始化输出验证Guard...
2025-06-28 11:32:41,446 - core.llm.guardrails_middleware - INFO - 🔧 使用本地LLM客户端初始化Guard...
2025-06-28 11:32:41,447 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:32:41,447 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:32:41,447 - core.llm.guardrails_middleware - INFO - ✅ 使用LLM的Guard创建成功
2025-06-28 11:32:41,447 - core.llm.guardrails_middleware - INFO - ✅ Guardrails Guards初始化成功
2025-06-28 11:32:41,447 - core.llm.guardrails_middleware - INFO -    - 输入Guard: ✅
2025-06-28 11:32:41,447 - core.llm.guardrails_middleware - INFO -    - 输出Guard: ✅
2025-06-28 11:32:41,447 - core.agents.validation_critic - INFO - 🎯 ValidationCritic Agent初始化完成
2025-06-28 11:32:41,447 - services.runtime_service - INFO - 推理运行时服务初始化完成，创建了 1 个实例
2025-06-28 11:32:41,448 - services.service_manager - INFO - 初始化服务: synthesis
2025-06-28 11:32:41,448 - services.synthesis_service - INFO - 正在初始化合成服务...
2025-06-28 11:32:41,448 - core.llm_client - DEBUG - Enriched config with environment variables: ['redis_url', 'TRAJECTORIES_DIR', 'default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:32:41,478 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:32:41,478 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 11:32:41,478 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 11:32:41,478 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 11:32:41,478 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:32:41,478 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 11:32:41,478 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 11:32:41,478 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 11:32:41,478 - core.synthesiscore.synthesis - INFO - ✅ JSON文件存储初始化完成
2025-06-28 11:32:41,479 - core.synthesiscore.synthesis - INFO - 📋 未发现已处理轨迹记录，从空白状态开始
2025-06-28 11:32:41,479 - core.llm_client - DEBUG - Enriched config with environment variables: ['redis_url', 'TRAJECTORIES_DIR', 'default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:32:41,508 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:32:41,508 - core.toolscore.mcp_client - INFO - Enhanced MCPToolClient initialized for toolscore at ws://localhost:8089/websocket
2025-06-28 11:32:41,511 - core.synthesiscore.config_loader - INFO - ✅ SynthesisCore配置加载成功: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/config/synthesiscore_config.yaml
2025-06-28 11:32:41,511 - core.synthesiscore.trajectory_monitor - INFO - 🔧 TrajectoryMonitor初始化完成
2025-06-28 11:32:41,511 - core.synthesiscore.trajectory_monitor - INFO - 📂 监控目录: output/trajectories
2025-06-28 11:32:41,511 - core.synthesiscore.trajectory_monitor - INFO - 📝 种子文件: output/trajectories/../seed_tasks.jsonl
2025-06-28 11:32:41,511 - services.synthesis_service - INFO - ✅ TrajectoryMonitor v2.0 初始化完成
2025-06-28 11:32:41,511 - services.synthesis_service - INFO - 合成服务初始化完成，轨迹目录: output/trajectories
2025-06-28 11:32:41,511 - __main__ - DEBUG - ✅ 所有服务初始化完成
2025-06-28 11:32:41,511 - __main__ - DEBUG - 🚀 开始启动所有服务...
2025-06-28 11:32:41,511 - services.service_manager - INFO - 正在启动所有服务...
2025-06-28 11:32:41,511 - services.service_manager - INFO - 启动服务: redis
2025-06-28 11:32:41,511 - services.redis_service - INFO - Redis客户端已就绪
2025-06-28 11:32:41,511 - services.service_manager - INFO - 启动服务: toolscore
2025-06-28 11:32:41,511 - services.toolscore_service - INFO - 正在启动ToolScore服务...
2025-06-28 11:32:41,511 - services.toolscore_service - INFO - 正在初始化工具库...
2025-06-28 11:32:41,511 - services.toolscore_service - INFO - 工具库初始化将在ToolScore MCP服务器线程中进行。
2025-06-28 11:32:41,511 - services.toolscore_service - INFO - 正在启动ToolScore HTTP API...
2025-06-28 11:32:41,520 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:32:41,520 - services.toolscore_service - INFO - ToolScore HTTP API已启动于端口: 8082
2025-06-28 11:32:41,520 - services.toolscore_service - INFO - ToolScore MCP 服务器不进行端口自动检测，使用配置端口: 8081
2025-06-28 11:32:41,520 - services.toolscore_service - INFO - ToolScore MCP server configured to use host: 0.0.0.0, port: 8081, path: /websocket
2025-06-28 11:32:41,520 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 11:32:41,520 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 11:32:41,520 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 11:32:41,520 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:32:41,520 - core.toolscore.monitoring_api - INFO - ToolScore monitoring API started on port 8082
2025-06-28 11:32:41,520 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 11:32:41,520 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 11:32:41,520 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 11:32:41,520 - services.toolscore_service - INFO - Starting ToolScore MCP server thread...
2025-06-28 11:32:41,520 - services.toolscore_service - INFO - ToolScore MCP server thread started, is_alive: True
2025-06-28 11:32:41,520 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:32:41,520 - services.toolscore_service - INFO - ToolScore MCP服务器启动线程已启动，等待就绪信号...
2025-06-28 11:32:41,520 - services.service_manager - INFO - 启动服务: task_processing_coordinator
2025-06-28 11:32:41,520 - core.toolscore.mcp_server - INFO - Attempting to start toolscore MCP Server on 0.0.0.0:8081
2025-06-28 11:32:41,520 - core.dispatcher_enhanced - INFO - ✅ TaskProcessingCoordinator 配置加载完成 - 队列映射: {<TaskType.CODE: 'code'>: 'tasks:reasoning', <TaskType.WEB: 'web'>: 'tasks:reasoning', <TaskType.REASONING: 'reasoning'>: 'tasks:reasoning', <TaskType.RESEARCH: 'research'>: 'tasks:reasoning'}
2025-06-28 11:32:41,521 - services.service_manager - INFO - 启动服务: mcp_servers
2025-06-28 11:32:41,521 - services.mcp_server_launcher - INFO - 正在启动MCP服务器...
2025-06-28 11:32:41,521 - services.mcp_server_launcher - INFO - 正在并行启动 4 个MCP服务器...
2025-06-28 11:32:41,521 - core.dispatcher_enhanced - INFO - 启动任务处理协调器...
2025-06-28 11:32:41,521 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:32:41,521 - websockets.server - INFO - server listening on 0.0.0.0:8081
2025-06-28 11:32:41,521 - core.toolscore.mcp_server - INFO - [toolscore] Initializing UnifiedToolLibrary...
2025-06-28 11:32:41,521 - core.toolscore.core_manager - INFO - 🚀 正在初始化增强的CoreManager...
2025-06-28 11:32:41,521 - core.toolscore.core_manager - INFO - 🔄 使用v2.0服务容器架构初始化...
2025-06-28 11:32:41,521 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:32:41,521 - core.toolscore.enhanced_core_manager_v2 - INFO - 🚀 初始化增强核心管理器 v2.0...
2025-06-28 11:32:41,521 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:32:41,521 - core.toolscore.service_container.mcp_service_container - INFO - 🚀 开始初始化MCP服务容器...
2025-06-28 11:32:41,521 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:32:41,521 - core.toolscore.service_container.mcp_service_container - INFO - 🔍 发现内置MCP服务...
2025-06-28 11:32:41,521 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:32:41,521 - core.toolscore.service_container.builtin_discovery - INFO - 🔍 开始发现内置MCP服务: mcp_servers
2025-06-28 11:32:41,521 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:32:41,521 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:32:41,521 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:32:41,521 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:32:41,521 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:32:41,521 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:32:41,521 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:32:41,521 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:32:41,524 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: Search Tool MCP Server
2025-06-28 11:32:41,524 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 75029)
2025-06-28 11:32:41,524 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:32:41,524 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:32:41,524 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:32:41,524 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:32:41,524 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: MicroSandbox MCP Server
2025-06-28 11:32:41,524 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:32:41,524 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:32:41,524 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:32:41,524 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:32:41,524 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:32:41,524 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 跳过 __pycache__: 缺少main.py文件
2025-06-28 11:32:41,524 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:32:41,525 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:32:41,525 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:32:41,525 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:32:41,525 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: Browser Use MCP Server
2025-06-28 11:32:41,525 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: DeepSearch MCP Server
2025-06-28 11:32:41,525 - core.toolscore.service_container.builtin_discovery - INFO - 🎯 内置服务发现完成，共发现 4 个服务
2025-06-28 11:32:41,525 - core.toolscore.service_container.builtin_discovery - INFO - 📝 创建服务配置文件...
2025-06-28 11:32:41,525 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/search_tool_server/service.json
2025-06-28 11:32:41,525 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/microsandbox_server/service.json
2025-06-28 11:32:41,525 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/browser_use_server/service.json
2025-06-28 11:32:41,525 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/deepsearch_server/service.json
2025-06-28 11:32:41,525 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 发现 4 个内置服务
2025-06-28 11:32:41,525 - core.toolscore.service_container.mcp_service_container - INFO - 📂 加载已安装的外部服务...
2025-06-28 11:32:41,525 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:32:41,525 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:32:41,525 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 加载 0 个外部服务
2025-06-28 11:32:41,525 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:32:41,525 - core.toolscore.service_container.mcp_service_container - INFO - 📋 构建统一服务目录...
2025-06-28 11:32:41,525 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:32:41,525 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 服务目录构建完成，共 4 个服务
2025-06-28 11:32:41,525 - core.toolscore.service_container.mcp_service_container - INFO - 📋 标记内置服务为启动中状态...
2025-06-28 11:32:41,527 - core.toolscore.service_container.mcp_service_container - INFO - 📋 已标记 4 个内置服务为启动中状态
2025-06-28 11:32:41,527 - core.toolscore.service_container.service_monitor - INFO - 🔍 启动服务监控...
2025-06-28 11:32:41,527 - core.toolscore.service_container.mcp_service_container - INFO - ✅ MCP服务容器初始化完成
2025-06-28 11:32:41,527 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 75030)
2025-06-28 11:32:41,527 - core.toolscore.enhanced_core_manager_v2 - INFO - ✅ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:32:41,527 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:32:41,527 - core.toolscore.core_manager - INFO - ✅ v2.0架构初始化完成
2025-06-28 11:32:41,527 - core.toolscore.tool_registry - INFO - Tool registry initialized
2025-06-28 11:32:41,527 - core.llm_client - DEBUG - Enriched config with environment variables: ['provider', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:32:41,539 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: browser_use_server
2025-06-28 11:32:41,539 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:32:41,539 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: browser_use_server
2025-06-28 11:32:41,539 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server
2025-06-28 11:32:41,539 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) = True
2025-06-28 11:32:41,539 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) = True
2025-06-28 11:32:41,539 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) contents: ['service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:32:41,539 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server/main.py
2025-06-28 11:32:41,540 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:32:41,540 - services.mcp_server_launcher - INFO - [MCP启动器] 为 browser_use_server 使用配置文件指定端口: 8084
2025-06-28 11:32:41,540 - services.mcp_server_launcher - INFO - [MCP启动器] 为 browser_use_server 使用配置文件指定端口: 8084
2025-06-28 11:32:41,540 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 BROWSER_USE_SERVER_PORT=8084 给 browser_use_server
2025-06-28 11:32:41,540 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.browser_use_server.main
2025-06-28 11:32:41,540 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:32:41,544 - services.mcp_server_launcher - INFO - MCP服务器已启动: browser_use_server (PID: 75031)
2025-06-28 11:32:41,544 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 browser_use_server 就绪状态...
2025-06-28 11:32:41,545 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:32:41,545 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:32:41,545 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:32:41,545 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:32:41,545 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:32:41,545 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:32:41,546 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:32:41,546 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:32:41,546 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:32:41,546 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:32:41,546 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:32:41,546 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:32:41,546 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:32:41,546 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:32:41,550 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 75032)
2025-06-28 11:32:41,551 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:32:41,552 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第1次, 5s间隔)
2025-06-28 11:32:41,552 - core.monitoring.queue_monitor - INFO - 启动队列监控器...
2025-06-28 11:32:41,554 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:32:41,554 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:32:41,554 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:32:41,554 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:32:41,554 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:32:41,554 - websockets.client - DEBUG - > Sec-WebSocket-Key: ekjqV6ZYTlV7Tbqbk2GfJQ==
2025-06-28 11:32:41,554 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:32:41,554 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:32:41,554 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:32:41,555 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:32:41,555 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:32:41,555 - websockets.client - DEBUG - > Host: localhost:8084
2025-06-28 11:32:41,555 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:32:41,555 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:32:41,555 - websockets.client - DEBUG - > Sec-WebSocket-Key: J+TXfCtqcMQ8S5hw3Ylaxw==
2025-06-28 11:32:41,555 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:32:41,555 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:32:41,555 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:32:41,556 - websockets.client - DEBUG - > EOF
2025-06-28 11:32:41,556 - websockets.client - DEBUG - < EOF
2025-06-28 11:32:41,556 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:32:41,556 - websockets.client - DEBUG - > EOF
2025-06-28 11:32:41,556 - websockets.client - DEBUG - < EOF
2025-06-28 11:32:41,556 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:32:41,558 - services.mcp_server_launcher - DEBUG - 📋 browser_use_server 端口 8084 尚未就绪
2025-06-28 11:32:41,559 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:32:41,559 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:32:41,571 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:32:41,571 - core.toolscore.tool_gap_detector - INFO - 智能工具缺口检测器初始化 - 统一版本
2025-06-28 11:32:41,571 - core.toolscore.dynamic_mcp_manager - INFO - Dynamic MCP Manager initialized (ProcessRunner mode)
2025-06-28 11:32:41,571 - core.toolscore.dynamic_mcp_manager - INFO - 启动动态MCP管理器...
2025-06-28 11:32:41,571 - core.toolscore.dynamic_mcp_manager - INFO - 持久化配置为空，无需恢复外部MCP服务器
2025-06-28 11:32:41,571 - core.toolscore.dynamic_mcp_manager - INFO - 动态MCP管理器启动完成
2025-06-28 11:32:41,571 - core.toolscore.mcp_search_tool - INFO - ✅ MCP Search Tool initialized - 优化版本，包含失败工具跟踪
2025-06-28 11:32:41,571 - core.toolscore.unified_tool_library - INFO - Tool library initialization completed - 核心管理器模式
2025-06-28 11:32:41,571 - core.toolscore.mcp_server - INFO - [toolscore] UnifiedToolLibrary initialized.
2025-06-28 11:32:41,571 - core.toolscore.mcp_server - INFO - [toolscore] Auto-registering MCP servers...
2025-06-28 11:32:41,572 - core.toolscore.mcp_auto_registration - INFO - 🔍 开始自动发现和注册MCP服务器...
2025-06-28 11:32:41,572 - core.toolscore.mcp_auto_registration - DEBUG - ⚠️ 服务器目录 __pycache__ 缺少 service.json
2025-06-28 11:32:41,572 - core.toolscore.mcp_auto_registration - INFO - 🎯 发现 4 个MCP服务器
2025-06-28 11:32:41,585 - core.unified_tool_manager - DEBUG - ✅ 配置验证通过
2025-06-28 11:32:41,585 - core.unified_tool_manager - INFO - 🔄 成功加载工具配置: 4 个标准工具
2025-06-28 11:32:41,585 - core.unified_tool_manager - DEBUG -    - 标准工具ID: ['browser_use', 'deepsearch', 'mcp-search-tool', 'microsandbox']
2025-06-28 11:32:41,585 - core.unified_tool_manager - DEBUG -    - 兼容映射: 13 个变体
2025-06-28 11:32:41,585 - core.unified_tool_manager - INFO - ✅ 统一工具管理器初始化完成，管理 4 个工具
2025-06-28 11:32:41,585 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: mcp-search-tool
2025-06-28 11:32:41,585 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: Search Tool MCP Server (ID: mcp-search-tool)
2025-06-28 11:32:41,586 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: Search Tool MCP Server (ID: mcp-search-tool)
2025-06-28 11:32:41,586 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: Search Tool MCP Server
2025-06-28 11:32:41,586 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8080/websocket
2025-06-28 11:32:41,586 - core.toolscore.mcp_connector - INFO - Registered MCP server mcp-search-tool at ws://localhost:8080/websocket
2025-06-28 11:32:41,586 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: mcp-search-tool -> ws://localhost:8080/websocket
2025-06-28 11:32:41,586 - core.toolscore.core_manager - INFO - 工具立即可用: mcp-search-tool
2025-06-28 11:32:41,586 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: mcp-search-tool
2025-06-28 11:32:41,586 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: microsandbox
2025-06-28 11:32:41,586 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: MicroSandbox MCP Server (ID: microsandbox)
2025-06-28 11:32:41,586 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: MicroSandbox MCP Server (ID: microsandbox)
2025-06-28 11:32:41,586 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: MicroSandbox MCP Server
2025-06-28 11:32:41,586 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8090/websocket
2025-06-28 11:32:41,586 - core.toolscore.mcp_connector - INFO - Registered MCP server microsandbox at ws://localhost:8090/websocket
2025-06-28 11:32:41,586 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: microsandbox -> ws://localhost:8090/websocket
2025-06-28 11:32:41,586 - core.toolscore.core_manager - INFO - 工具立即可用: microsandbox
2025-06-28 11:32:41,586 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: microsandbox
2025-06-28 11:32:41,586 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: browser_use
2025-06-28 11:32:41,586 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: Browser Use MCP Server (ID: browser_use)
2025-06-28 11:32:41,586 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: Browser Use MCP Server (ID: browser_use)
2025-06-28 11:32:41,586 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: Browser Use MCP Server
2025-06-28 11:32:41,586 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8084/websocket
2025-06-28 11:32:41,586 - core.toolscore.mcp_connector - INFO - Registered MCP server browser_use at ws://localhost:8084/websocket
2025-06-28 11:32:41,586 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: browser_use -> ws://localhost:8084/websocket
2025-06-28 11:32:41,586 - core.toolscore.core_manager - INFO - 工具立即可用: browser_use
2025-06-28 11:32:41,586 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: browser_use
2025-06-28 11:32:41,586 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: deepsearch
2025-06-28 11:32:41,586 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: DeepSearch MCP Server (ID: deepsearch)
2025-06-28 11:32:41,586 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: DeepSearch MCP Server (ID: deepsearch)
2025-06-28 11:32:41,586 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: DeepSearch MCP Server
2025-06-28 11:32:41,586 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8086/websocket
2025-06-28 11:32:41,586 - core.toolscore.mcp_connector - INFO - Registered MCP server deepsearch at ws://localhost:8086/websocket
2025-06-28 11:32:41,586 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: deepsearch -> ws://localhost:8086/websocket
2025-06-28 11:32:41,586 - core.toolscore.core_manager - INFO - 工具立即可用: deepsearch
2025-06-28 11:32:41,586 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: deepsearch
2025-06-28 11:32:41,586 - core.toolscore.mcp_auto_registration - INFO - 📊 MCP服务器注册完成: 4/4 成功
2025-06-28 11:32:41,586 - core.toolscore.mcp_server - INFO - [toolscore] All MCP servers registered successfully.
2025-06-28 11:32:41,586 - core.toolscore.mcp_server - INFO - toolscore MCP Server started successfully on 0.0.0.0:8081 (Original endpoint: ws://0.0.0.0:8081/websocket) with ping_interval=30, ping_timeout=60
2025-06-28 11:32:41,586 - core.toolscore.mcp_server - INFO - toolscore MCP Server started event set.
2025-06-28 11:32:41,586 - core.toolscore.service_container.service_monitor - INFO - 🔄 开始服务监控循环，检查间隔: 30秒
2025-06-28 11:32:41,596 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [browser_use] BrowserUse logging setup complete with level info
2025-06-28 11:32:42,013 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [root] Anonymized telemetry enabled. See https://docs.browser-use.com/development/telemetry for more information.
2025-06-28 11:32:42,125 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:32:42,125 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:32:42,129 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.llm_client] Initialized LLM client with provider: gemini
2025-06-28 11:32:42,129 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Browser-Use server initialized with LLM provider: gemini
2025-06-28 11:32:42,129 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 使用动态分配端口: 8084
2025-06-28 11:32:42,130 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] BrowserUseMCPServer initialized:
2025-06-28 11:32:42,130 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Server Name: browser_use_server
2025-06-28 11:32:42,130 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Server ID: browser_use
2025-06-28 11:32:42,130 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Listen Host: 0.0.0.0
2025-06-28 11:32:42,130 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Listen Port: 8084
2025-06-28 11:32:42,130 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Public Endpoint: ws://localhost:8084
2025-06-28 11:32:42,130 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:32:42,130 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Starting browser_use_server...
2025-06-28 11:32:42,130 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Attempting to start MCPServer for browser_use_server at ws://localhost:8084...
2025-06-28 11:32:42,130 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Attempting to start browser_use_server MCP Server on localhost:8084
2025-06-28 11:32:42,130 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] server listening on 127.0.0.1:8084
2025-06-28 11:32:42,131 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] server listening on [::1]:8084
2025-06-28 11:32:42,131 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] browser_use_server MCP Server started successfully on localhost:8084 (Original endpoint: ws://localhost:8084) with ping_interval=30, ping_timeout=60
2025-06-28 11:32:42,131 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:32:42,161 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:32:42,161 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:32:42,161 - websockets.client - DEBUG - > Host: localhost:8084
2025-06-28 11:32:42,161 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:32:42,161 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:32:42,161 - websockets.client - DEBUG - > Sec-WebSocket-Key: ArpzRiJXB7fIVWnmsW8ilQ==
2025-06-28 11:32:42,161 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:32:42,161 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:32:42,161 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:32:42,161 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:32:42,161 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:32:42,161 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:32:42,161 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:32:42,161 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:32:42,161 - websockets.client - DEBUG - > Sec-WebSocket-Key: zkos/ruqaUi4qw3k3q1/RA==
2025-06-28 11:32:42,161 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:32:42,161 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:32:42,161 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:32:42,162 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection open
2025-06-28 11:32:42,162 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Client connected to browser_use_server MCP Server at path /: ('127.0.0.1', 63080)
2025-06-28 11:32:42,162 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:32:42,162 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:32:42,162 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:32:42,162 - websockets.client - DEBUG - < Sec-WebSocket-Accept: DK83jvoCh+W/oEfqvHriwHYPGNY=
2025-06-28 11:32:42,162 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:32:42,162 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:32:42 GMT
2025-06-28 11:32:42,162 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:32:42,162 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:32:42,162 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:32:42,162 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:32:42,162 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:32:42,162 - websockets.client - DEBUG - < Sec-WebSocket-Accept: IQtCOurb+Y13FIi/FDLzMSRzD7A=
2025-06-28 11:32:42,162 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:32:42,162 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:32:42 GMT
2025-06-28 11:32:42,162 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:32:42,162 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:32:42,164 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:32:42,164 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:32:42,164 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:32:42,164 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:32:42,164 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:32:42,164 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:32:42,164 - services.mcp_server_launcher - DEBUG - [browser_use_server] WARNING  [core.toolscore.mcp_server] Unknown request type or server role mismatch: ping
2025-06-28 11:32:42,164 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:32:42,164 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:32:42,164 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:32:42,164 - websockets.client - DEBUG - < EOF
2025-06-28 11:32:42,164 - websockets.client - DEBUG - > EOF
2025-06-28 11:32:42,164 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:32:42,164 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:32:42,164 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:32:42,165 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:32:42,165 - websockets.client - DEBUG - < EOF
2025-06-28 11:32:42,165 - websockets.client - DEBUG - > EOF
2025-06-28 11:32:42,165 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:32:42,165 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:32:42,165 - services.mcp_server_launcher - DEBUG - ✅ browser_use_server 特定就绪检查通过
2025-06-28 11:32:42,165 - services.mcp_server_launcher - INFO - ✅ browser_use_server 已就绪
2025-06-28 11:32:42,165 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:32:42,165 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:32:42,165 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:32:42,165 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:32:42,847 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:32:42,847 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:32:43,166 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:32:43,712 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:32:43,713 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:32:44,751 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:32:44,752 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:32:45,998 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:32:45,998 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:32:46,553 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第2次, 5s间隔)
2025-06-28 11:32:47,493 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:32:47,494 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:32:49,287 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:32:49,287 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:32:51,439 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:32:51,440 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:32:51,553 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第3次, 5s间隔)
2025-06-28 11:32:51,673 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:32:51,674 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:32:51,674 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:32:51,674 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:32:51,674 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:32:51,674 - websockets.server - DEBUG - < Sec-WebSocket-Key: iJOTebaRu+c+QTNwUKP+rw==
2025-06-28 11:32:51,674 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:32:51,674 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:32:51,675 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:32:51,675 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:32:51,675 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:32:51,675 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:32:51,675 - websockets.server - DEBUG - > Sec-WebSocket-Accept: SdeVo8kthzXkXBR2s+FSRHX3H50=
2025-06-28 11:32:51,675 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:32:51,675 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:32:51 GMT
2025-06-28 11:32:51,675 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:32:51,675 - websockets.server - INFO - connection open
2025-06-28 11:32:51,675 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:32:51,675 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 63107)
2025-06-28 11:32:51,676 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "9b2d43...onnection_params": {}}}' [2376 bytes]
2025-06-28 11:32:51,678 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: search_tool_server (ID: mcp-search-tool)
2025-06-28 11:32:51,678 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: search_tool_server
2025-06-28 11:32:51,678 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: mcp-search-tool -> ws://localhost:8080/mcp
2025-06-28 11:32:51,678 - core.toolscore.core_manager - INFO - 工具立即可用: mcp-search-tool
2025-06-28 11:32:51,678 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 11:32:51,679 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:32:51,679 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 11:32:51,679 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:32:51,679 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 11:32:51,679 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 11:32:51,679 - websockets.server - INFO - connection closed
2025-06-28 11:32:51,784 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:32:51,785 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:32:51,785 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:32:51,785 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:32:51,785 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:32:51,785 - websockets.server - DEBUG - < Sec-WebSocket-Key: gxeBm2yv75aqxFIjEum24Q==
2025-06-28 11:32:51,785 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:32:51,785 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:32:51,785 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:32:51,785 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:32:51,785 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:32:51,785 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:32:51,785 - websockets.server - DEBUG - > Sec-WebSocket-Accept: 0C3Y8dzhS17NPYzzkTMLPY4tQZk=
2025-06-28 11:32:51,786 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:32:51,786 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:32:51 GMT
2025-06-28 11:32:51,786 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:32:51,786 - websockets.server - INFO - connection open
2025-06-28 11:32:51,786 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:32:51,786 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 63109)
2025-06-28 11:32:51,787 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "e0c184...onnection_params": {}}}' [3263 bytes]
2025-06-28 11:32:51,787 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: microsandbox_server (ID: microsandbox)
2025-06-28 11:32:51,787 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: microsandbox_server
2025-06-28 11:32:51,787 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: microsandbox -> ws://localhost:8090
2025-06-28 11:32:51,787 - core.toolscore.core_manager - INFO - 工具立即可用: microsandbox
2025-06-28 11:32:51,787 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 11:32:51,788 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:32:51,788 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 11:32:51,788 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:32:51,788 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 11:32:51,789 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 11:32:51,789 - websockets.server - INFO - connection closed
2025-06-28 11:32:51,838 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:32:51,839 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:32:51,839 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:32:51,839 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:32:51,839 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:32:51,840 - websockets.server - DEBUG - < Sec-WebSocket-Key: sQCcesSr8DCLy9E7dL1ktA==
2025-06-28 11:32:51,840 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:32:51,840 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:32:51,840 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:32:51,840 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:32:51,840 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:32:51,840 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:32:51,840 - websockets.server - DEBUG - > Sec-WebSocket-Accept: UZnkODtVkvbAuWVu90qEK3SpLzg=
2025-06-28 11:32:51,840 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:32:51,840 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:32:51 GMT
2025-06-28 11:32:51,840 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:32:51,840 - websockets.server - INFO - connection open
2025-06-28 11:32:51,840 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:32:51,840 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 63111)
2025-06-28 11:32:51,841 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "39af33...onnection_params": {}}}' [2313 bytes]
2025-06-28 11:32:51,842 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: deepsearch_server (ID: deepsearch)
2025-06-28 11:32:51,842 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: deepsearch_server
2025-06-28 11:32:51,842 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: deepsearch -> ws://localhost:8086/mcp
2025-06-28 11:32:51,842 - core.toolscore.core_manager - INFO - 工具立即可用: deepsearch
2025-06-28 11:32:51,842 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 11:32:51,842 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:32:51,843 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 11:32:51,843 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:32:51,843 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 11:32:51,843 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 11:32:51,843 - websockets.server - INFO - connection closed
2025-06-28 11:32:52,132 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 11:32:52,134 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:32:52,135 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:32:52,135 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:32:52,135 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:32:52,135 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:32:52,135 - websockets.server - DEBUG - < Sec-WebSocket-Key: eAB142Wl90pf5AgHZIkJ0Q==
2025-06-28 11:32:52,135 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:32:52,135 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:32:52,135 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:32:52,136 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:32:52,136 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:32:52,136 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:32:52,136 - websockets.server - DEBUG - > Sec-WebSocket-Accept: OSrj1oS0YGUIwJYHgUr/YsD9YqY=
2025-06-28 11:32:52,136 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:32:52,136 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:32:52 GMT
2025-06-28 11:32:52,136 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:32:52,136 - websockets.server - INFO - connection open
2025-06-28 11:32:52,136 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:32:52,136 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 63113)
2025-06-28 11:32:52,137 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 11:32:52,137 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "808778e3-f8be-444f-aff8-0c22b1c1ba1d", "tool_spec": {"tool_id": "browser_use", "name": "browser_use_server", "description": "\u57fa\u4e8eBrowser-Use\u7684AI\u6d4f\u89c8\u5668\u81ea\u52a8\u5316\u670d\u52a1\u5668\uff0c\u5b8c\u6574\u5b9e\u73b0browser-use\u7684\u6240\u6709\u529f\u80fd", "tool_type": "mcp_server", "capabilities": [{"name": "browser_use_execute_task", "description": "\u4f7f\u7528AI\u6267\u884c\u590d\u6742\u7684\u6d4f\u89c8\u5668\u4efb\u52a1\uff0c\u652f\u6301\u81ea\u7136\u8bed\u8a00\u63cf\u8ff0", "parameters": {"task": {"type": "string", "description": "\u8981\u6267\u884c\u7684\u4efb\u52a1\u63cf\u8ff0\uff0c\u4f7f\u7528\u81ea\u7136\u8bed\u8a00", "required": true}, "max_steps": {"type": "integer", "description": "\u6700\u5927\u6267\u884c\u6b65\u9aa4\u6570\uff0c\u9ed8\u8ba450", "required": false}, "use_vision": {"type": "boolean", "description": "\u662f\u5426\u4f7f\u7528\u89c6\u89c9\u7406\u89e3\uff0c\u9ed8\u8ba4true", "required": false}}, "examples": [{"task": "\u641c\u7d22Python\u6559\u7a0b\u5e76\u6253\u5f00\u7b2c\u4e00\u4e2a\u7ed3\u679c"}, {"task": "\u5728GitHub\u4e0a\u641c\u7d22browser-use\u9879\u76ee\u5e76\u67e5\u770bREADME"}, {"task": "\u767b\u5f55\u7f51\u7ad9\u5e76\u586b\u5199\u8868\u5355", "use_vision": true}], "category": "general"}, {"name": "browser_navigate", "description": "\u5bfc\u822a\u5230\u6307\u5b9a\u7f51\u5740", "parameters": {"url": {"type": "string", "description": "\u8981\u8bbf\u95ee\u7684URL\u5730\u5740", "required": true}}, "examples": [{"url": "https://www.google.com"}, {"url": "https://github.com"}], "category": "general"}, {"name": "browser_search_google", "description": "\u5728Google\u4e2d\u641c\u7d22\u6307\u5b9a\u67e5\u8be2", "parameters": {"query": {"type": "string", "description": "\u641c\u7d22\u67e5\u8be2\u8bcd", "required": true}}, "examples": [{"query": "Python machine learning tutorial"}, {"query": "browser automation tools"}], "category": "general"}, {"name": "browser_go_back", "description": "\u8fd4\u56de\u4e0a\u4e00\u9875", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_click_element", "description": "\u901a\u8fc7\u7d22\u5f15\u70b9\u51fb\u9875\u9762\u5143\u7d20", "parameters": {"index": {"type": "integer", "description": "\u8981\u70b9\u51fb\u7684\u5143\u7d20\u7d22\u5f15", "required": true}}, "examples": [{"index": 1}, {"index": 5}], "category": "general"}, {"name": "browser_input_text", "description": "\u5728\u6307\u5b9a\u5143\u7d20\u4e2d\u8f93\u5165\u6587\u672c", "parameters": {"index": {"type": "integer", "description": "\u8981\u8f93\u5165\u6587\u672c\u7684\u5143\u7d20\u7d22\u5f15", "required": true}, "text": {"type": "string", "description": "\u8981\u8f93\u5165\u7684\u6587\u672c", "required": true}}, "examples": [{"index": 2, "text": "hello world"}, {"index": 0, "text": "test@example.com"}], "category": "general"}, {"name": "browser_send_keys", "description": "\u53d1\u9001\u7279\u6b8a\u952e\u6216\u5feb\u6377\u952e", "parameters": {"keys": {"type": "string", "description": "\u8981\u53d1\u9001\u7684\u952e\uff0c\u5982Enter\u3001Escape\u3001Control+c\u7b49", "required": true}}, "examples": [{"keys": "Enter"}, {"keys": "Control+c"}, {"keys": "Escape"}], "category": "general"}, {"name": "browser_scroll_down", "description": "\u5411\u4e0b\u6eda\u52a8\u9875\u9762", "parameters": {"amount": {"type": "integer", "description": "\u6eda\u52a8\u50cf\u7d20\u6570\uff0c\u4e0d\u6307\u5b9a\u5219\u6eda\u52a8\u4e00\u9875", "required": false}}, "examples": [{}, {"amount": 500}], "category": "general"}, {"name": "browser_scroll_up", "description": "\u5411\u4e0a\u6eda\u52a8\u9875\u9762", "parameters": {"amount": {"type": "integer", "description": "\u6eda\u52a8\u50cf\u7d20\u6570\uff0c\u4e0d\u6307\u5b9a\u5219\u6eda\u52a8\u4e00\u9875", "required": false}}, "examples": [{}, {"amount": 300}], "category": "general"}, {"name": "browser_scroll_to_text", "description": "\u6eda\u52a8\u5230\u5305\u542b\u6307\u5b9a\u6587\u672c\u7684\u5143\u7d20", "parameters": {"text": {"type": "string", "description": "\u8981\u6eda\u52a8\u5230\u7684\u6587\u672c\u5185\u5bb9", "required": true}}, "examples": [{"text": "Sign up"}, {"text": "Contact us"}], "category": "general"}, {"name": "browser_switch_tab", "description": "\u5207\u6362\u5230\u6307\u5b9a\u6807\u7b7e", "parameters": {"page_id": {"type": "integer", "description": "\u8981\u5207\u6362\u5230\u7684\u6807\u7b7eID", "required": true}}, "examples": [{"page_id": 0}, {"page_id": 1}], "category": "general"}, {"name": "browser_open_tab", "description": "\u5728\u65b0\u6807\u7b7e\u4e2d\u6253\u5f00URL", "parameters": {"url": {"type": "string", "description": "\u8981\u5728\u65b0\u6807\u7b7e\u4e2d\u6253\u5f00\u7684URL", "required": true}}, "examples": [{"url": "https://www.example.com"}], "category": "general"}, {"name": "browser_close_tab", "description": "\u5173\u95ed\u6307\u5b9a\u6807\u7b7e", "parameters": {"page_id": {"type": "integer", "description": "\u8981\u5173\u95ed\u7684\u6807\u7b7eID", "required": true}}, "examples": [{"page_id": 1}], "category": "general"}, {"name": "browser_extract_content", "description": "\u4ece\u9875\u9762\u63d0\u53d6\u7279\u5b9a\u5185\u5bb9", "parameters": {"goal": {"type": "string", "description": "\u63d0\u53d6\u76ee\u6807\u63cf\u8ff0", "required": true}, "include_links": {"type": "boolean", "description": "\u662f\u5426\u5305\u542b\u94fe\u63a5\uff0c\u9ed8\u8ba4false", "required": false}}, "examples": [{"goal": "\u63d0\u53d6\u6240\u6709\u516c\u53f8\u540d\u79f0"}, {"goal": "\u83b7\u53d6\u4ea7\u54c1\u4ef7\u683c\u4fe1\u606f", "include_links": true}], "category": "general"}, {"name": "browser_get_content", "description": "\u83b7\u53d6\u9875\u9762\u5185\u5bb9", "parameters": {"selector": {"type": "string", "description": "CSS\u9009\u62e9\u5668\uff0c\u7a7a\u5219\u83b7\u53d6\u5168\u90e8\u5185\u5bb9", "required": false}}, "examples": [{"selector": "h1, p"}, {}], "category": "general"}, {"name": "browser_get_ax_tree", "description": "\u83b7\u53d6\u9875\u9762\u7684\u53ef\u8bbf\u95ee\u6027\u6811\u7ed3\u6784", "parameters": {"number_of_elements": {"type": "integer", "description": "\u8fd4\u56de\u7684\u5143\u7d20\u6570\u91cf", "required": true}}, "examples": [{"number_of_elements": 50}], "category": "general"}, {"name": "browser_get_dropdown_options", "description": "\u83b7\u53d6\u4e0b\u62c9\u83dc\u5355\u7684\u6240\u6709\u9009\u9879", "parameters": {"index": {"type": "integer", "description": "\u4e0b\u62c9\u83dc\u5355\u5143\u7d20\u7684\u7d22\u5f15", "required": true}}, "examples": [{"index": 3}], "category": "general"}, {"name": "browser_select_dropdown_option", "description": "\u9009\u62e9\u4e0b\u62c9\u83dc\u5355\u4e2d\u7684\u9009\u9879", "parameters": {"index": {"type": "integer", "description": "\u4e0b\u62c9\u83dc\u5355\u5143\u7d20\u7684\u7d22\u5f15", "required": true}, "text": {"type": "string", "description": "\u8981\u9009\u62e9\u7684\u9009\u9879\u6587\u672c", "required": true}}, "examples": [{"index": 3, "text": "Option 1"}], "category": "general"}, {"name": "browser_drag_drop", "description": "\u6267\u884c\u62d6\u62fd\u64cd\u4f5c", "parameters": {"element_source": {"type": "string", "description": "\u6e90\u5143\u7d20\u9009\u62e9\u5668", "required": false}, "element_target": {"type": "string", "description": "\u76ee\u6807\u5143\u7d20\u9009\u62e9\u5668", "required": false}, "coord_source_x": {"type": "integer", "description": "\u6e90\u5750\u6807X", "required": false}, "coord_source_y": {"type": "integer", "description": "\u6e90\u5750\u6807Y", "required": false}, "coord_target_x": {"type": "integer", "description": "\u76ee\u6807\u5750\u6807X", "required": false}, "coord_target_y": {"type": "integer", "description": "\u76ee\u6807\u5750\u6807Y", "required": false}, "steps": {"type": "integer", "description": "\u62d6\u62fd\u6b65\u9aa4\u6570\uff0c\u9ed8\u8ba410", "required": false}}, "examples": [{"element_source": ".item1", "element_target": ".dropzone"}], "category": "general"}, {"name": "browser_save_pdf", "description": "\u5c06\u5f53\u524d\u9875\u9762\u4fdd\u5b58\u4e3aPDF", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_screenshot", "description": "\u622a\u53d6\u5f53\u524d\u9875\u9762\u622a\u56fe", "parameters": {"filename": {"type": "string", "description": "\u622a\u56fe\u6587\u4ef6\u540d\uff0c\u53ef\u9009", "required": false}}, "examples": [{"filename": "current_page.png"}, {}], "category": "general"}, {"name": "browser_wait", "description": "\u7b49\u5f85\u6307\u5b9a\u79d2\u6570", "parameters": {"seconds": {"type": "number", "description": "\u7b49\u5f85\u7684\u79d2\u6570\uff0c\u9ed8\u8ba43", "required": false}}, "examples": [{"seconds": 5}, {}], "category": "general"}, {"name": "browser_done", "description": "\u6807\u8bb0\u4efb\u52a1\u5b8c\u6210", "parameters": {"text": {"type": "string", "description": "\u5b8c\u6210\u63cf\u8ff0", "required": true}, "success": {"type": "boolean", "description": "\u662f\u5426\u6210\u529f\u5b8c\u6210", "required": true}}, "examples": [{"text": "\u4efb\u52a1\u5df2\u5b8c\u6210", "success": true}], "category": "general"}, {"name": "browser_get_page_info", "description": "\u83b7\u53d6\u5f53\u524d\u9875\u9762\u4fe1\u606f", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_get_current_url", "description": "\u83b7\u53d6\u5f53\u524d\u9875\u9762URL", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_close_session", "description": "\u5173\u95ed\u6d4f\u89c8\u5668\u4f1a\u8bdd", "parameters": {}, "examples": [{}], "category": "general"}], "endpoint": "ws://localhost:8084", "connection_params": {}}}
2025-06-28 11:32:52,138 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Waiting for registration response from toolscore...
2025-06-28 11:32:52,138 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "808778...onnection_params": {}}}' [9625 bytes]
2025-06-28 11:32:52,138 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: browser_use_server (ID: browser_use)
2025-06-28 11:32:52,139 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: browser_use_server
2025-06-28 11:32:52,139 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: browser_use -> ws://localhost:8084
2025-06-28 11:32:52,139 - core.toolscore.core_manager - INFO - 工具立即可用: browser_use
2025-06-28 11:32:52,139 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 11:32:52,139 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Received registration response: {"type": "register_tool_response", "request_id": "808778e3-f8be-444f-aff8-0c22b1c1ba1d", "success": true, "message": null}
2025-06-28 11:32:52,139 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Successfully registered with toolscore.
2025-06-28 11:32:52,140 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:32:52,140 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 11:32:52,140 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:32:52,140 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 11:32:52,140 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 11:32:52,141 - websockets.server - INFO - connection closed
2025-06-28 11:32:54,021 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:32:54,022 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:32:56,555 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第4次, 5s间隔)
2025-06-28 11:32:57,024 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:32:57,024 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:33:00,026 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:33:00,026 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:33:01,557 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第5次, 5s间隔)
2025-06-28 11:33:03,028 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:33:03,028 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:33:06,030 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:33:06,031 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:33:06,558 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第6次, 5s间隔)
2025-06-28 11:33:09,032 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:33:09,032 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:33:11,533 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:33:11,550 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:33:11,551 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:33:11,552 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:33:11,552 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:33:11,559 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第7次, 5s间隔)
2025-06-28 11:33:12,034 - services.mcp_server_launcher - DEBUG - ⏱️ microsandbox_server 就绪检测超时 (30秒)
2025-06-28 11:33:12,034 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:33:12,034 - services.mcp_server_launcher - INFO - ✅ 成功启动 4/4 个MCP服务器: ['microsandbox_server', 'search_tool_server', 'browser_use_server', 'deepsearch_server']
2025-06-28 11:33:12,034 - services.service_manager - INFO - 启动服务: task_api
2025-06-28 11:33:12,034 - services.task_api_service - INFO - 正在启动任务API服务...
2025-06-28 11:33:12,053 - services.task_api_service - INFO - 任务API服务已启动于 0.0.0.0:8000
2025-06-28 11:33:12,053 - services.service_manager - INFO - 启动服务: runtime
2025-06-28 11:33:12,053 - services.runtime_service - INFO - 正在启动推理运行时服务...
2025-06-28 11:33:12,053 - services.service_manager - INFO - 启动服务: synthesis
2025-06-28 11:33:12,053 - services.synthesis_service - INFO - 正在启动合成服务...
2025-06-28 11:33:12,053 - services.synthesis_service - INFO - 合成服务工作线程已启动
2025-06-28 11:33:12,053 - services.synthesis_service - INFO - 开始处理轨迹数据...
2025-06-28 11:33:12,053 - services.synthesis_service - INFO - SynthesisCore v2.0监控器工作线程已启动
2025-06-28 11:33:12,053 - services.synthesis_service - INFO - 🚀 启动SynthesisCore v2.0监控器
2025-06-28 11:33:12,053 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:33:12,054 - services.synthesis_service - INFO - 合成服务已启动
2025-06-28 11:33:12,054 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:33:12,054 - services.service_manager - INFO - 所有服务已启动
2025-06-28 11:33:12,054 - core.synthesiscore.synthesis - INFO - 🔄 Processing only unprocessed trajectories...
2025-06-28 11:33:12,054 - __main__ - DEBUG - ✅ 所有服务启动完成
2025-06-28 11:33:12,055 - __main__ - INFO - 🎉 所有服务已启动，系统运行中...
2025-06-28 11:33:12,055 - __main__ - INFO - 📊 系统状态监控已启用，按 Ctrl+C 停止
2025-06-28 11:33:12,055 - services.runtime_service - INFO - 启动运行时实例: enhanced-reasoning-1
2025-06-28 11:33:12,055 - runtimes.reasoning.enhanced_runtime - INFO - 🚀 初始化Enhanced Reasoning Runtime - 简化版本
2025-06-28 11:33:12,055 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:33:12,055 - core.llm.response_parsers.reasoning_response_parser - DEBUG - ✅ 响应解析器已连接工具Schema管理器
2025-06-28 11:33:12,056 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 工具Schema管理器已注入到响应解析器
2025-06-28 11:33:12,056 - runtimes.reasoning.enhanced_runtime - INFO - ⏳ 等待ToolScore服务就绪...
2025-06-28 11:33:12,056 - core.synthesiscore.synthesis - INFO - 🎯 Unprocessed trajectories completed: 0 new trajectories processed
2025-06-28 11:33:12,057 - services.synthesis_service - DEBUG - 等待 300 秒后再次处理...
2025-06-28 11:33:12,057 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ Redis连接初始化成功
2025-06-28 11:33:12,058 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:11:33:12 +0800] "GET /health HTTP/1.1" 200 231 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 11:33:12,058 - runtimes.reasoning.toolscore_client - INFO - ✅ ToolScore服务已就绪
2025-06-28 11:33:12,059 - runtimes.reasoning.enhanced_runtime - INFO - ✅ ToolScore HTTP服务已就绪
2025-06-28 11:33:12,059 - runtimes.reasoning.enhanced_runtime - INFO - 🔌 正在连接WebSocket端点: ws://localhost:8081/websocket
2025-06-28 11:33:12,059 - runtimes.reasoning.real_time_tool_client - INFO - 🔌 连接到ToolScore实时更新: ws://localhost:8081/websocket
2025-06-28 11:33:12,059 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:corpus_queue
2025-06-28 11:33:12,060 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:33:12,060 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:atomic_tasks
2025-06-28 11:33:12,060 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:33:12,061 - websockets.client - DEBUG - > GET /websocket HTTP/1.1
2025-06-28 11:33:12,061 - websockets.client - DEBUG - > Host: localhost:8081
2025-06-28 11:33:12,061 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:33:12,061 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:33:12,061 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:extended_tasks
2025-06-28 11:33:12,061 - websockets.client - DEBUG - > Sec-WebSocket-Key: jD0URs1MIqkEnHcPzla2Hg==
2025-06-28 11:33:12,061 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:33:12,061 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:33:12,061 - websockets.client - DEBUG - > User-Agent: Enhanced-Reasoning-Runtime/1.0
2025-06-28 11:33:12,061 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:33:12,061 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:verification_queue
2025-06-28 11:33:12,062 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:33:12,062 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:33:12,062 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:33:12,062 - websockets.server - DEBUG - < Sec-WebSocket-Key: jD0URs1MIqkEnHcPzla2Hg==
2025-06-28 11:33:12,062 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:33:12,062 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:33:12,062 - websockets.server - DEBUG - < User-Agent: Enhanced-Reasoning-Runtime/1.0
2025-06-28 11:33:12,062 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:33:12,062 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:training_data
2025-06-28 11:33:12,062 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:33:12,063 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:33:12,063 - websockets.server - DEBUG - > Sec-WebSocket-Accept: PC6H5o1ggD0cT10Djc52b6Zjw40=
2025-06-28 11:33:12,063 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:33:12,063 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:33:12 GMT
2025-06-28 11:33:12,063 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:33:12,063 - websockets.server - INFO - connection open
2025-06-28 11:33:12,063 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:33:12,063 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:quality_reports
2025-06-28 11:33:12,063 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:33:12,063 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 63139)
2025-06-28 11:33:12,063 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:33:12,063 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:33:12,063 - websockets.client - DEBUG - < Sec-WebSocket-Accept: PC6H5o1ggD0cT10Djc52b6Zjw40=
2025-06-28 11:33:12,063 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
[2025-06-28 11:33:12] INFO:     Started server process [74982]
2025-06-28 11:33:12,063 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:33:12 GMT
[2025-06-28 11:33:12] INFO:     Waiting for application startup.
2025-06-28 11:33:12,064 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:33:12,064 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:33:12,064 - runtimes.reasoning.real_time_tool_client - INFO - ✅ 已连接到ToolScore实时更新流
2025-06-28 11:33:12,064 - runtimes.reasoning.enhanced_runtime - INFO - ✅ WebSocket实时更新连接成功
2025-06-28 11:33:12,064 - runtimes.reasoning.real_time_tool_client - DEBUG - 已注册工具更新回调，当前回调数量: 1
2025-06-28 11:33:12,064 - runtimes.reasoning.enhanced_runtime - INFO - ⏳ 等待关键工具完全就绪...
2025-06-28 11:33:12,064 - runtimes.reasoning.enhanced_runtime - WARNING - 🚀 临时跳过详细工具等待，快速启动模式
2025-06-28 11:33:12,064 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 使用快速启动模式，工具将在后台异步就绪
2025-06-28 11:33:12,064 - runtimes.reasoning.enhanced_runtime - INFO - 🔍 开始MCP服务器同步验证...
2025-06-28 11:33:12,064 - core.tool_schema_manager - INFO - 正在执行MCP同步验证...
2025-06-28 11:33:12,064 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=False)，当前缓存: 0 个工具
2025-06-28 11:33:12,064 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 11:33:12,064 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
2025-06-28 11:33:12,065 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 11:33:12,065 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
2025-06-28 11:33:12,065 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
2025-06-28 11:33:12,065 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 11:33:12,065 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 11:33:12,065 - core.tool_schema_manager - INFO - 🔄 检测到 4 个工具需要更新: ['deepsearch', 'microsandbox', 'browser_use', 'mcp-search-tool']
2025-06-28 11:33:12,065 - core.tool_schema_manager - INFO - 🔄 执行增量更新: 4 个工具
2025-06-28 11:33:12,065 - core.tool_schema_manager - INFO - 🔄 缓存为空，转为全量刷新模式
2025-06-28 11:33:12,065 - core.tool_schema_manager - DEBUG - 🔄 开始增强刷新工具Schemas...
2025-06-28 11:33:12,065 - core.tool_schema_manager - DEBUG - 🔍 工具注册表状态检查: _tools 字典包含 4 个条目
2025-06-28 11:33:12,065 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: deepsearch
2025-06-28 11:33:12,065 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: microsandbox
2025-06-28 11:33:12,065 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: browser_use
2025-06-28 11:33:12,065 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: mcp-search-tool
2025-06-28 11:33:12,065 - core.tool_schema_manager - INFO - 🔧 选项1: 从工具注册表获取到 4 个工具
2025-06-28 11:33:12,065 - core.tool_schema_manager - DEBUG -   工具 0: id=deepsearch, name=网络信息研究工具, actions=3
2025-06-28 11:33:12,065 - core.tool_schema_manager - DEBUG -   工具 1: id=microsandbox, name=MicroSandbox安全代码执行器, actions=7
2025-06-28 11:33:12,065 - core.tool_schema_manager - DEBUG -   工具 2: id=browser_use, name=智能浏览器操作工具, actions=6
2025-06-28 11:33:12,065 - core.tool_schema_manager - DEBUG -   工具 3: id=mcp-search-tool, name=工具管理和项目文件搜索器, actions=4
2025-06-28 11:33:12,065 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: deepsearch
2025-06-28 11:33:12,066 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: comprehensive_research
2025-06-28 11:33:12,066 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ Redis配置键初始化完成
2025-06-28 11:33:12,067 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: quick_research
2025-06-28 11:33:12,067 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ 增强合成Redis管理器初始化完成
2025-06-28 11:33:12,067 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: research
2025-06-28 11:33:12,067 - core.synthesiscore.enhanced_synthesis_engine - INFO - ✅ Enhanced Synthesis Engine 初始化完成
2025-06-28 11:33:12,067 - core.task_api - INFO - Connected to Redis: redis://localhost:6379
2025-06-28 11:33:12,067 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 deepsearch (包含 3 个动作)
[2025-06-28 11:33:12] INFO:     Application startup complete.
2025-06-28 11:33:12,067 - core.synthesiscore.enhanced_synthesis_engine - INFO - 🚀 SynthesisCore v2.0 已启动
2025-06-28 11:33:12,068 - core.tool_schema_manager - DEBUG -    当前缓存大小: 1 个工具
2025-06-28 11:33:12,068 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: microsandbox
2025-06-28 11:33:12,068 - core.synthesiscore.trajectory_monitor - INFO - 🔄 检查并处理现有轨迹...
2025-06-28 11:33:12,068 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_cleanup_expired
[2025-06-28 11:33:12] INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-06-28 11:33:12,068 - core.synthesiscore.trajectory_monitor - INFO - 📝 没有现有轨迹文件
2025-06-28 11:33:12,068 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_close_session
2025-06-28 11:33:12,068 - core.synthesiscore.trajectory_monitor - INFO - ✅ TrajectoryMonitor初始化完成
2025-06-28 11:33:12,068 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_execute
2025-06-28 11:33:12,069 - core.synthesiscore.trajectory_monitor - DEBUG - ✅ 获取主事件循环引用成功
2025-06-28 11:33:12,069 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_health_status
2025-06-28 11:33:12,069 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_performance_stats
2025-06-28 11:33:12,069 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_install_package
2025-06-28 11:33:12,069 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_list_sessions
2025-06-28 11:33:12,070 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 microsandbox (包含 7 个动作)
2025-06-28 11:33:12,070 - core.synthesiscore.trajectory_monitor - INFO - 👁️ 开始监控轨迹文件变化: output/trajectories
2025-06-28 11:33:12,070 - core.tool_schema_manager - DEBUG -    当前缓存大小: 2 个工具
2025-06-28 11:33:12,070 - services.synthesis_service - INFO - ✅ SynthesisCore v2.0监控器已启动
2025-06-28 11:33:12,070 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: browser_use
2025-06-28 11:33:12,071 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_click_element
2025-06-28 11:33:12,071 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_use_execute_task
2025-06-28 11:33:12,071 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_extract_content
2025-06-28 11:33:12,071 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_input_text
2025-06-28 11:33:12,071 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_navigate
2025-06-28 11:33:12,072 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_search_google
2025-06-28 11:33:12,072 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 browser_use (包含 6 个动作)
2025-06-28 11:33:12,072 - core.tool_schema_manager - DEBUG -    当前缓存大小: 3 个工具
2025-06-28 11:33:12,072 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: mcp-search-tool
2025-06-28 11:33:12,072 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: analyze_tool_needs
2025-06-28 11:33:12,072 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: list_code_definitions
2025-06-28 11:33:12,072 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_and_install_tools
2025-06-28 11:33:12,072 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_file_content
2025-06-28 11:33:12,072 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 mcp-search-tool (包含 4 个动作)
2025-06-28 11:33:12,072 - core.tool_schema_manager - DEBUG -    当前缓存大小: 4 个工具
2025-06-28 11:33:12,072 - core.tool_schema_manager - INFO - 🔧 选项1: 成功处理 4/4 个工具，当前缓存 4 个工具
2025-06-28 11:33:12,073 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: mcp-search-tool
2025-06-28 11:33:12,073 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: microsandbox
2025-06-28 11:33:12,073 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: browser_use
2025-06-28 11:33:12,073 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: deepsearch
2025-06-28 11:33:12,073 - core.tool_schema_manager - INFO - ✅ 增强刷新完成，当前可用工具: 4个
2025-06-28 11:33:12,074 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:33:12,074 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:33:12,074 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:33:12,075 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:33:12,075 - core.tool_schema_manager - INFO - ✅ Schema安全刷新完成，备份 4 个工具
2025-06-28 11:33:12,075 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:33:12,075 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:33:12,076 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:33:12,076 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:33:12,076 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 11:33:12,076 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 11:33:12,076 - core.tool_schema_manager - INFO - 🔍 同步验证完成: unhealthy (0/4 工具Schema一致)
2025-06-28 11:33:12,076 - runtimes.reasoning.enhanced_runtime - ERROR - ❌ MCP服务器同步验证失败: 未知错误
2025-06-28 11:33:12,076 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔧 开始获取可用工具ID列表...
2025-06-28 11:33:12,076 - runtimes.reasoning.real_time_tool_client - DEBUG - 可用工具ID列表: ['browser_use', 'deepsearch', 'microsandbox', 'mcp-search-tool']
2025-06-28 11:33:12,076 - runtimes.reasoning.enhanced_runtime - DEBUG - 📋 获取到的工具列表: ['browser_use', 'deepsearch', 'microsandbox', 'mcp-search-tool']
2025-06-28 11:33:12,076 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 工具Schema管理器已初始化
2025-06-28 11:33:12,076 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔧 更新Guardrails和ValidationCritic工具配置...
2025-06-28 11:33:12,076 - core.llm.guardrails_middleware - INFO - 🔧 初始化输入验证Guard...
2025-06-28 11:33:12,078 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:33:12,079 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:33:12,079 - core.llm.guardrails_middleware - INFO - 🔧 初始化输出验证Guard...
2025-06-28 11:33:12,079 - core.llm.guardrails_middleware - INFO - 🔧 使用本地LLM客户端初始化Guard...
2025-06-28 11:33:12,081 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:33:12,081 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:33:12,081 - core.llm.guardrails_middleware - INFO - ✅ 使用LLM的Guard创建成功
2025-06-28 11:33:12,081 - core.llm.guardrails_middleware - INFO - ✅ Guardrails Guards初始化成功
2025-06-28 11:33:12,081 - core.llm.guardrails_middleware - INFO -    - 输入Guard: ✅
2025-06-28 11:33:12,081 - core.llm.guardrails_middleware - INFO -    - 输出Guard: ✅
2025-06-28 11:33:12,081 - core.llm.guardrails_middleware - INFO - 🔄 Guardrails工具列表已更新: 4个工具
2025-06-28 11:33:12,081 - core.agents.validation_critic - INFO - 🔄 ValidationCritic工具列表已更新: 4个工具
2025-06-28 11:33:12,081 - runtimes.reasoning.enhanced_runtime - INFO - ✅ Guardrails和ValidationCritic已配置4个工具: browser_use, deepsearch, microsandbox, mcp-search-tool
2025-06-28 11:33:12,081 - runtimes.reasoning.enhanced_runtime - INFO - ✅ Enhanced Reasoning Runtime 已成功初始化为纯推理引擎（集成Guardrails + ValidationCritic）
2025-06-28 11:33:12,081 - services.runtime_service - INFO - 启动运行时任务消费: enhanced-reasoning-1
2025-06-28 11:33:12,081 - services.runtime_service - INFO - 推理运行时服务已启动 1 个实例和 1 个任务消费协程
2025-06-28 11:33:12,081 - core.tool_schema_manager - INFO - 🔍 启动MCP服务器配置监控...
2025-06-28 11:33:12,081 - core.task_manager - INFO - Runtime enhanced-reasoning-1 starting to consume from queue: tasks:reasoning
2025-06-28 11:33:12,082 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/search_tool_server/service.json
2025-06-28 11:33:12,082 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/microsandbox_server/service.json
2025-06-28 11:33:12,083 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/browser_use_server/service.json
2025-06-28 11:33:12,083 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/deepsearch_server/service.json
2025-06-28 11:33:12,083 - core.tool_schema_manager - INFO - 🔄 MCP配置变化，强制刷新schema...
2025-06-28 11:33:12,083 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=True)，当前缓存: 0 个工具
2025-06-28 11:33:12,083 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 11:33:12,083 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
2025-06-28 11:33:12,083 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 11:33:12,083 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
2025-06-28 11:33:12,083 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
2025-06-28 11:33:12,083 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 11:33:12,083 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 11:33:12,083 - core.tool_schema_manager - INFO - 🔄 检测到 4 个工具需要更新: ['deepsearch', 'microsandbox', 'browser_use', 'mcp-search-tool']
2025-06-28 11:33:12,083 - core.tool_schema_manager - INFO - 🔄 执行增量更新: 4 个工具
2025-06-28 11:33:12,083 - core.tool_schema_manager - INFO - 🔄 缓存为空，转为全量刷新模式
2025-06-28 11:33:12,083 - core.tool_schema_manager - DEBUG - 🔄 开始增强刷新工具Schemas...
2025-06-28 11:33:12,083 - core.tool_schema_manager - DEBUG - 🔍 工具注册表状态检查: _tools 字典包含 4 个条目
2025-06-28 11:33:12,083 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: deepsearch
2025-06-28 11:33:12,083 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: microsandbox
2025-06-28 11:33:12,083 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: browser_use
2025-06-28 11:33:12,083 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: mcp-search-tool
2025-06-28 11:33:12,083 - core.tool_schema_manager - INFO - 🔧 选项1: 从工具注册表获取到 4 个工具
2025-06-28 11:33:12,083 - core.tool_schema_manager - DEBUG -   工具 0: id=deepsearch, name=网络信息研究工具, actions=3
2025-06-28 11:33:12,083 - core.tool_schema_manager - DEBUG -   工具 1: id=microsandbox, name=MicroSandbox安全代码执行器, actions=7
2025-06-28 11:33:12,083 - core.tool_schema_manager - DEBUG -   工具 2: id=browser_use, name=智能浏览器操作工具, actions=6
2025-06-28 11:33:12,083 - core.tool_schema_manager - DEBUG -   工具 3: id=mcp-search-tool, name=工具管理和项目文件搜索器, actions=4
2025-06-28 11:33:12,083 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: deepsearch
2025-06-28 11:33:12,084 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: comprehensive_research
2025-06-28 11:33:12,084 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: quick_research
2025-06-28 11:33:12,085 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: research
2025-06-28 11:33:12,085 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 deepsearch (包含 3 个动作)
2025-06-28 11:33:12,085 - core.tool_schema_manager - DEBUG -    当前缓存大小: 1 个工具
2025-06-28 11:33:12,085 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: microsandbox
2025-06-28 11:33:12,085 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_cleanup_expired
2025-06-28 11:33:12,085 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_close_session
2025-06-28 11:33:12,085 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_execute
2025-06-28 11:33:12,085 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_health_status
2025-06-28 11:33:12,085 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_performance_stats
2025-06-28 11:33:12,085 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_install_package
2025-06-28 11:33:12,085 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_list_sessions
2025-06-28 11:33:12,085 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 microsandbox (包含 7 个动作)
2025-06-28 11:33:12,085 - core.tool_schema_manager - DEBUG -    当前缓存大小: 2 个工具
2025-06-28 11:33:12,086 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: browser_use
2025-06-28 11:33:12,086 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_click_element
2025-06-28 11:33:12,086 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_use_execute_task
2025-06-28 11:33:12,086 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_extract_content
2025-06-28 11:33:12,086 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_input_text
2025-06-28 11:33:12,086 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_navigate
2025-06-28 11:33:12,086 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_search_google
2025-06-28 11:33:12,086 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 browser_use (包含 6 个动作)
2025-06-28 11:33:12,086 - core.tool_schema_manager - DEBUG -    当前缓存大小: 3 个工具
2025-06-28 11:33:12,086 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: mcp-search-tool
2025-06-28 11:33:12,086 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: analyze_tool_needs
2025-06-28 11:33:12,087 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: list_code_definitions
2025-06-28 11:33:12,087 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_and_install_tools
2025-06-28 11:33:12,087 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_file_content
2025-06-28 11:33:12,087 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 mcp-search-tool (包含 4 个动作)
2025-06-28 11:33:12,087 - core.tool_schema_manager - DEBUG -    当前缓存大小: 4 个工具
2025-06-28 11:33:12,087 - core.tool_schema_manager - INFO - 🔧 选项1: 成功处理 4/4 个工具，当前缓存 4 个工具
2025-06-28 11:33:12,087 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: mcp-search-tool
2025-06-28 11:33:12,087 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: microsandbox
2025-06-28 11:33:12,088 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-48' coro=<start.<locals>.start_all_runtimes() running at /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/services/runtime_service.py:94> wait_for=<_GatheringFuture pending cb=[Task.task_wakeup()]>>
2025-06-28 11:33:12,088 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='runtime-enhanced-reasoning-1' coro=<start_runtime_service() running at /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/core/task_manager.py:388> wait_for=<Future pending cb=[Task.task_wakeup()]> cb=[gather.<locals>._done_callback() at /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/tasks.py:764]>
2025-06-28 11:33:12,088 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: browser_use
2025-06-28 11:33:12,088 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: deepsearch
2025-06-28 11:33:12,088 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:11:33:12 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 11:33:12,088 - core.tool_schema_manager - DEBUG - 🔍 从ToolScore获取到工具列表: ['mcp-search-tool', 'microsandbox', 'browser_use', 'deepsearch']
2025-06-28 11:33:12,088 - core.tool_schema_manager - DEBUG - 🔧 映射后的工具列表: ['mcp-search-tool', 'microsandbox', 'browser_use', 'deepsearch']
2025-06-28 11:33:12,088 - core.tool_schema_manager - DEBUG - ⏭️ 工具 mcp-search-tool 已在缓存中，跳过ToolScore获取
2025-06-28 11:33:12,088 - core.tool_schema_manager - DEBUG - ⏭️ 工具 microsandbox 已在缓存中，跳过ToolScore获取
2025-06-28 11:33:12,088 - core.tool_schema_manager - DEBUG - ⏭️ 工具 browser_use 已在缓存中，跳过ToolScore获取
2025-06-28 11:33:12,088 - core.tool_schema_manager - DEBUG - ⏭️ 工具 deepsearch 已在缓存中，跳过ToolScore获取
2025-06-28 11:33:12,088 - core.tool_schema_manager - INFO - ✅ 增强刷新完成，当前可用工具: 4个
2025-06-28 11:33:12,089 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:33:12,089 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:33:12,089 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:33:12,089 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:33:12,090 - core.tool_schema_manager - INFO - ✅ Schema安全刷新完成，备份 4 个工具
2025-06-28 11:33:12,090 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:33:12,090 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:33:12,090 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:33:12,090 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:33:12,091 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 11:33:12,091 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 11:33:16,561 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第8次, 5s间隔)
2025-06-28 11:33:21,562 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第9次, 5s间隔)
2025-06-28 11:33:26,565 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第10次, 5s间隔)
2025-06-28 11:33:31,567 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第11次, 5s间隔)
2025-06-28 11:33:32,074 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:33:32,074 - websockets.client - DEBUG - > PING b2 9f 9c 67 [binary, 4 bytes]
2025-06-28 11:33:32,075 - websockets.server - DEBUG - < PING b2 9f 9c 67 [binary, 4 bytes]
2025-06-28 11:33:32,075 - websockets.server - DEBUG - > PONG b2 9f 9c 67 [binary, 4 bytes]
2025-06-28 11:33:32,075 - websockets.client - DEBUG - < PONG b2 9f 9c 67 [binary, 4 bytes]
2025-06-28 11:33:32,075 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:33:36,569 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第12次, 5s间隔)
2025-06-28 11:33:41,538 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:33:41,551 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:33:41,553 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:33:41,553 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:33:41,554 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:33:41,569 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第13次, 30s间隔)
2025-06-28 11:33:42,064 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:33:42,064 - websockets.server - DEBUG - > PING 9b 85 96 d1 [binary, 4 bytes]
2025-06-28 11:33:42,065 - websockets.client - DEBUG - < PING 9b 85 96 d1 [binary, 4 bytes]
2025-06-28 11:33:42,065 - websockets.client - DEBUG - > PONG 9b 85 96 d1 [binary, 4 bytes]
2025-06-28 11:33:42,065 - websockets.server - DEBUG - < PONG 9b 85 96 d1 [binary, 4 bytes]
2025-06-28 11:33:42,065 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:33:52,077 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:33:52,077 - websockets.client - DEBUG - > PING ea 60 0a af [binary, 4 bytes]
2025-06-28 11:33:52,078 - websockets.server - DEBUG - < PING ea 60 0a af [binary, 4 bytes]
2025-06-28 11:33:52,078 - websockets.server - DEBUG - > PONG ea 60 0a af [binary, 4 bytes]
2025-06-28 11:33:52,079 - websockets.client - DEBUG - < PONG ea 60 0a af [binary, 4 bytes]
2025-06-28 11:33:52,079 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:34:11,544 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:34:11,555 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:34:11,558 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:34:11,564 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:34:11,564 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:34:11,570 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第14次, 30s间隔)
2025-06-28 11:34:12,056 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 1m 0s
2025-06-28 11:34:12,066 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:34:12,066 - websockets.server - DEBUG - > PING 4d dd a6 e9 [binary, 4 bytes]
2025-06-28 11:34:12,066 - websockets.client - DEBUG - < PING 4d dd a6 e9 [binary, 4 bytes]
2025-06-28 11:34:12,067 - websockets.client - DEBUG - > PONG 4d dd a6 e9 [binary, 4 bytes]
2025-06-28 11:34:12,067 - websockets.server - DEBUG - < PONG 4d dd a6 e9 [binary, 4 bytes]
2025-06-28 11:34:12,067 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:34:12,079 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:34:12,080 - websockets.client - DEBUG - > PING 7e 5c 8a 11 [binary, 4 bytes]
2025-06-28 11:34:12,080 - websockets.server - DEBUG - < PING 7e 5c 8a 11 [binary, 4 bytes]
2025-06-28 11:34:12,080 - websockets.server - DEBUG - > PONG 7e 5c 8a 11 [binary, 4 bytes]
2025-06-28 11:34:12,080 - websockets.client - DEBUG - < PONG 7e 5c 8a 11 [binary, 4 bytes]
2025-06-28 11:34:12,080 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:34:32,081 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:34:32,083 - websockets.client - DEBUG - > PING b7 7a 34 30 [binary, 4 bytes]
2025-06-28 11:34:32,083 - websockets.server - DEBUG - < PING b7 7a 34 30 [binary, 4 bytes]
2025-06-28 11:34:32,083 - websockets.server - DEBUG - > PONG b7 7a 34 30 [binary, 4 bytes]
2025-06-28 11:34:32,084 - websockets.client - DEBUG - < PONG b7 7a 34 30 [binary, 4 bytes]
2025-06-28 11:34:32,084 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:34:41,551 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:34:41,556 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:34:41,558 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:34:41,558 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:34:41,562 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:34:41,571 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第15次, 30s间隔)
2025-06-28 11:34:42,068 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:34:42,068 - websockets.server - DEBUG - > PING 53 45 92 ea [binary, 4 bytes]
2025-06-28 11:34:42,069 - websockets.client - DEBUG - < PING 53 45 92 ea [binary, 4 bytes]
2025-06-28 11:34:42,069 - websockets.client - DEBUG - > PONG 53 45 92 ea [binary, 4 bytes]
2025-06-28 11:34:42,069 - websockets.server - DEBUG - < PONG 53 45 92 ea [binary, 4 bytes]
2025-06-28 11:34:42,069 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:34:52,085 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:34:52,087 - websockets.client - DEBUG - > PING a8 89 73 41 [binary, 4 bytes]
2025-06-28 11:34:52,087 - websockets.server - DEBUG - < PING a8 89 73 41 [binary, 4 bytes]
2025-06-28 11:34:52,087 - websockets.server - DEBUG - > PONG a8 89 73 41 [binary, 4 bytes]
2025-06-28 11:34:52,087 - websockets.client - DEBUG - < PONG a8 89 73 41 [binary, 4 bytes]
2025-06-28 11:34:52,088 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:35:11,557 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:35:11,560 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:35:11,561 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:35:11,561 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:35:11,567 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:35:11,572 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第16次, 30s间隔)
2025-06-28 11:35:12,057 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 2m 0s
2025-06-28 11:35:12,070 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:35:12,071 - websockets.server - DEBUG - > PING cf 49 1e 13 [binary, 4 bytes]
2025-06-28 11:35:12,072 - websockets.client - DEBUG - < PING cf 49 1e 13 [binary, 4 bytes]
2025-06-28 11:35:12,072 - websockets.client - DEBUG - > PONG cf 49 1e 13 [binary, 4 bytes]
2025-06-28 11:35:12,072 - websockets.server - DEBUG - < PONG cf 49 1e 13 [binary, 4 bytes]
2025-06-28 11:35:12,072 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:35:12,088 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:35:12,088 - websockets.client - DEBUG - > PING 98 01 e3 66 [binary, 4 bytes]
2025-06-28 11:35:12,089 - websockets.server - DEBUG - < PING 98 01 e3 66 [binary, 4 bytes]
2025-06-28 11:35:12,089 - websockets.server - DEBUG - > PONG 98 01 e3 66 [binary, 4 bytes]
2025-06-28 11:35:12,089 - websockets.client - DEBUG - < PONG 98 01 e3 66 [binary, 4 bytes]
2025-06-28 11:35:12,089 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:35:15,834 - core.task_api - INFO - Task e80adcc3-20a6-4874-9592-7ca7492dee94 submitted successfully
[2025-06-28 11:35:15] INFO:     127.0.0.1:63297 - "POST /api/v1/tasks HTTP/1.1" 200 OK
2025-06-28 11:35:32,090 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:35:32,092 - websockets.client - DEBUG - > PING 91 14 c5 c9 [binary, 4 bytes]
2025-06-28 11:35:32,092 - websockets.server - DEBUG - < PING 91 14 c5 c9 [binary, 4 bytes]
2025-06-28 11:35:32,093 - websockets.server - DEBUG - > PONG 91 14 c5 c9 [binary, 4 bytes]
2025-06-28 11:35:32,093 - websockets.client - DEBUG - < PONG 91 14 c5 c9 [binary, 4 bytes]
2025-06-28 11:35:32,093 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:35:41,564 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:35:41,564 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:35:41,565 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:35:41,565 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:35:41,572 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第17次, 30s间隔)
2025-06-28 11:35:41,573 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:35:42,073 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:35:42,074 - websockets.server - DEBUG - > PING 7f 94 73 71 [binary, 4 bytes]
2025-06-28 11:35:42,074 - websockets.client - DEBUG - < PING 7f 94 73 71 [binary, 4 bytes]
2025-06-28 11:35:42,074 - websockets.client - DEBUG - > PONG 7f 94 73 71 [binary, 4 bytes]
2025-06-28 11:35:42,075 - websockets.server - DEBUG - < PONG 7f 94 73 71 [binary, 4 bytes]
2025-06-28 11:35:42,075 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:35:52,094 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:35:52,095 - websockets.client - DEBUG - > PING 0b 0f dc 2c [binary, 4 bytes]
2025-06-28 11:35:52,096 - websockets.server - DEBUG - < PING 0b 0f dc 2c [binary, 4 bytes]
2025-06-28 11:35:52,096 - websockets.server - DEBUG - > PONG 0b 0f dc 2c [binary, 4 bytes]
2025-06-28 11:35:52,096 - websockets.client - DEBUG - < PONG 0b 0f dc 2c [binary, 4 bytes]
2025-06-28 11:35:52,097 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:36:11,570 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:36:11,570 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:36:11,571 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:36:11,571 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:36:11,573 - core.task_processing.task_loader - INFO - 📋 任务文件 tasks.jsonl 不存在，等待... (第18次, 30s间隔) - 建议通过API提交任务
2025-06-28 11:36:11,574 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:36:12,058 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 3m 0s
2025-06-28 11:36:12,076 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:36:12,076 - websockets.server - DEBUG - > PING 0d 07 0e 90 [binary, 4 bytes]
2025-06-28 11:36:12,077 - websockets.client - DEBUG - < PING 0d 07 0e 90 [binary, 4 bytes]
2025-06-28 11:36:12,077 - websockets.client - DEBUG - > PONG 0d 07 0e 90 [binary, 4 bytes]
2025-06-28 11:36:12,077 - websockets.server - DEBUG - < PONG 0d 07 0e 90 [binary, 4 bytes]
2025-06-28 11:36:12,077 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:36:12,098 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:36:12,098 - websockets.client - DEBUG - > PING 91 be ce f7 [binary, 4 bytes]
2025-06-28 11:36:12,099 - websockets.server - DEBUG - < PING 91 be ce f7 [binary, 4 bytes]
2025-06-28 11:36:12,099 - websockets.server - DEBUG - > PONG 91 be ce f7 [binary, 4 bytes]
2025-06-28 11:36:12,099 - websockets.client - DEBUG - < PONG 91 be ce f7 [binary, 4 bytes]
2025-06-28 11:36:12,100 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:36:32,101 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:36:32,101 - websockets.client - DEBUG - > PING 87 47 fa e3 [binary, 4 bytes]
2025-06-28 11:36:32,101 - websockets.server - DEBUG - < PING 87 47 fa e3 [binary, 4 bytes]
2025-06-28 11:36:32,101 - websockets.server - DEBUG - > PONG 87 47 fa e3 [binary, 4 bytes]
2025-06-28 11:36:32,101 - websockets.client - DEBUG - < PONG 87 47 fa e3 [binary, 4 bytes]
2025-06-28 11:36:32,101 - websockets.client - DEBUG - % received keepalive pong

================================================================================
[系统启动] 2025-06-28 11:36:32
================================================================================
[2025-06-28 11:36:32] 🚀 Agent Data Platform 启动中... (所有日志将统一记录到 logs/System.log)
2025-06-28 11:36:32,318 - asyncio - DEBUG - Using selector: KqueueSelector
[2025-06-28 11:36:32] 🧹 开始增强端口清理...
[2025-06-28 11:36:32] 🔍 搜索并清理相关Python进程...
2025-06-28 11:36:32,331 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:36:32,331 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:36:32,331 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:36:32,331 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:36:32,331 - services.synthesis_service - INFO - 🛑 SynthesisCore v2.0监控器已停止
2025-06-28 11:36:32,331 - services.synthesis_service - INFO - 等待合成服务线程结束...
2025-06-28 11:36:32,351 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 收到停止信号，正在清理资源...
2025-06-28 11:36:32,354 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:36:32,354 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:32:41,667 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:32:41,667 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:32:41,667 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:32:41,667 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:32:41,669 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:32:41,669 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:32:41,669 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:32:41,669 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:32:42,162 - websockets.server - INFO - connection open
2025-06-28 11:32:42,162 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 63081)
2025-06-28 11:32:42,164 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:32:42,164 - websockets.server - INFO - connection closed
2025-06-28 11:32:51,671 - core.toolscore.mcp_server - INFO - [search_tool_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 11:32:51,676 - core.toolscore.mcp_server - INFO - [search_tool_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 11:32:51,676 - core.toolscore.mcp_server - INFO - [search_tool_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "9b2d4380-07f7-4947-ad03-ea7f630aa7b4", "tool_spec": {"tool_id": "mcp-search-tool", "name": "search_tool_server", "description": "\u6587\u4ef6\u5185\u5bb9\u641c\u7d22\u548c\u4ee3\u7801\u5b9a\u4e49\u641c\u7d22\u5de5\u5177\u670d\u52a1\u5668", "tool_type": "mcp_server", "capabilities": [{"name": "search_file_content", "description": "\u5728\u6307\u5b9a\u6587\u4ef6\u4e2d\u641c\u7d22\u5339\u914d\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5185\u5bb9", "parameters": {"file_path": {"type": "string", "description": "\u8981\u641c\u7d22\u7684\u6587\u4ef6\u8def\u5f84", "required": true}, "regex_pattern": {"type": "string", "description": "\u8981\u5339\u914d\u7684\u6b63\u5219\u8868\u8fbe\u5f0f", "required": true}}, "examples": [{"file_path": "src/main.py", "regex_pattern": "def\\s+\\w+"}], "category": "general"}, {"name": "list_code_definitions", "description": "\u5217\u51fa\u6307\u5b9a\u6587\u4ef6\u6216\u76ee\u5f55\u4e2dPython\u4ee3\u7801\u7684\u7c7b\u3001\u51fd\u6570\u548c\u65b9\u6cd5\u5b9a\u4e49", "parameters": {"file_path": {"type": "string", "description": "\u8981\u89e3\u6790\u7684Python\u6587\u4ef6\u8def\u5f84", "required": false}, "directory_path": {"type": "string", "description": "\u8981\u89e3\u6790\u7684\u76ee\u5f55\u8def\u5f84", "required": false}}, "examples": [{"file_path": "src/utils.py"}, {"directory_path": "src/models"}], "category": "general"}, {"name": "analyze_tool_needs", "description": "\u5206\u6790\u4efb\u52a1\u9700\u6c42\uff0c\u786e\u5b9a\u662f\u5426\u9700\u8981\u989d\u5916\u7684\u5de5\u5177", "parameters": {"task_description": {"type": "string", "description": "\u8981\u5206\u6790\u7684\u4efb\u52a1\u63cf\u8ff0", "required": true}}, "examples": [{"task_description": "Create a chart showing sales data trends"}], "category": "general"}, {"name": "search_and_install_tools", "description": "\u641c\u7d22\u5e76\u5b89\u88c5\u65b0\u7684\u5de5\u5177\u4ee5\u6ee1\u8db3\u4efb\u52a1\u9700\u6c42", "parameters": {"task_description": {"type": "string", "description": "\u4efb\u52a1\u63cf\u8ff0", "required": true}, "reason": {"type": "string", "description": "\u9700\u8981\u65b0\u5de5\u5177\u7684\u539f\u56e0", "required": false}}, "examples": [{"task_description": "Create a chart", "reason": "Need charting capabilities"}], "category": "general"}], "endpoint": "ws://localhost:8080/mcp", "connection_params": {}}}
2025-06-28 11:32:51,676 - core.toolscore.mcp_server - INFO - [search_tool_server] Waiting for registration response from toolscore...
2025-06-28 11:32:51,678 - core.toolscore.mcp_server - INFO - [search_tool_server] Received registration response: {"type": "register_tool_response", "request_id": "9b2d4380-07f7-4947-ad03-ea7f630aa7b4", "success": true, "message": null}
2025-06-28 11:32:51,678 - core.toolscore.mcp_server - INFO - [search_tool_server] Successfully registered with toolscore.
2025-06-28 11:33:11,534 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:33:11,534 - websockets.server - INFO - connection closed
2025-06-28 11:33:41,540 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:33:41,541 - websockets.server - INFO - connection closed
2025-06-28 11:34:11,547 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:34:11,547 - websockets.server - INFO - connection closed
2025-06-28 11:34:41,552 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:34:41,552 - websockets.server - INFO - connection closed
2025-06-28 11:35:11,558 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:35:11,558 - websockets.server - INFO - connection closed
2025-06-28 11:35:41,565 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:35:41,565 - websockets.server - INFO - connection closed
2025-06-28 11:36:11,571 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:36:11,571 - websockets.server - INFO - connection closed

2025-06-28 11:36:32,354 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:36:32,355 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:36:32,355 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:32:41,776 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:32:41,777 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:32:41,777 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:32:41,777 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:32:41,777 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:32:41,777 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:32:41,777 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:32:41,777 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:32:41,777 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:32:41,777 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:32:41,777 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:32:41,777 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:32:41,777 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:32:41,777 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:32:41,780 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:32:41,780 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:32:41,780 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:32:41,780 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:32:51,781 - core.toolscore.mcp_server - INFO - [microsandbox_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 11:32:51,786 - core.toolscore.mcp_server - INFO - [microsandbox_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 11:32:51,786 - core.toolscore.mcp_server - INFO - [microsandbox_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "e0c18459-e6b5-44b8-baaf-814feec5c33d", "tool_spec": {"tool_id": "microsandbox", "name": "microsandbox_server", "description": "\u57fa\u4e8eMicroSandbox\u7684\u5b89\u5168Python\u4ee3\u7801\u6267\u884c\u670d\u52a1\u5668", "tool_type": "mcp_server", "capabilities": [{"name": "microsandbox_execute", "description": "\u5728MicroSandbox\u5b89\u5168\u73af\u5883\u4e2d\u6267\u884cPython\u4ee3\u7801", "parameters": {"code": {"type": "string", "description": "\u8981\u6267\u884c\u7684Python\u4ee3\u7801", "required": true}, "session_id": {"type": "string", "description": "\u4f1a\u8bddID\uff0c\u7528\u4e8e\u591a\u8f6e\u6267\u884c\u548c\u72b6\u6001\u4fdd\u6301", "required": false}, "timeout": {"type": "integer", "description": "\u6267\u884c\u8d85\u65f6\u65f6\u95f4\uff08\u79d2\uff09\uff0c\u9ed8\u8ba430\u79d2\uff0c\u6700\u5927300\u79d2\u3002\u6ce8\u610f\uff1aMicroSandbox\u5185\u90e8\u6709\u81ea\u5df1\u7684\u8d85\u65f6\u673a\u5236\uff0c\u6b64\u53c2\u6570\u4e3b\u8981\u7528\u4e8e\u6587\u6863\u8bf4\u660e", "required": false}}, "examples": [{"code": "print('Hello from MicroSandbox!')"}, {"code": "import math\\nresult = math.sqrt(16)\\nprint(f'\u5e73\u65b9\u6839: {result}')", "timeout": 10}, {"code": "x = 42", "session_id": "my-session"}, {"code": "print(f'x = {x}')", "session_id": "my-session"}], "category": "general"}, {"name": "microsandbox_install_package", "description": "\u5728MicroSandbox\u73af\u5883\u4e2d\u5b89\u88c5Python\u5305", "parameters": {"package_name": {"type": "string", "description": "\u8981\u5b89\u88c5\u7684\u5305\u540d", "required": true}, "version": {"type": "string", "description": "\u6307\u5b9a\u7248\u672c\u53f7", "required": false}, "session_id": {"type": "string", "description": "\u4f1a\u8bddID", "required": false}}, "examples": [{"package_name": "requests"}, {"package_name": "numpy", "version": "1.21.0"}, {"package_name": "pandas", "session_id": "data-analysis"}], "category": "general"}, {"name": "microsandbox_list_sessions", "description": "\u5217\u51fa\u5f53\u524d\u6d3b\u8dc3\u7684\u6c99\u7bb1\u4f1a\u8bdd", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "microsandbox_close_session", "description": "\u5173\u95ed\u6307\u5b9a\u7684\u6c99\u7bb1\u4f1a\u8bdd", "parameters": {"session_id": {"type": "string", "description": "\u8981\u5173\u95ed\u7684\u4f1a\u8bddID", "required": true}}, "examples": [{"session_id": "my-session"}], "category": "general"}, {"name": "microsandbox_cleanup_expired", "description": "\u6e05\u7406\u8fc7\u671f\u7684\u6c99\u7bb1\u4f1a\u8bdd", "parameters": {"max_age": {"type": "integer", "description": "\u6700\u5927\u4f1a\u8bdd\u5e74\u9f84\uff08\u79d2\uff09\uff0c\u9ed8\u8ba4\u4e3a\u914d\u7f6e\u7684\u8d85\u65f6\u65f6\u95f4", "required": false}}, "examples": [{}, {"max_age": 1800}], "category": "general"}, {"name": "microsandbox_get_performance_stats", "description": "\u83b7\u53d6\u670d\u52a1\u5668\u6027\u80fd\u7edf\u8ba1\u4fe1\u606f", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "microsandbox_get_health_status", "description": "\u83b7\u53d6\u670d\u52a1\u5668\u5065\u5eb7\u72b6\u6001", "parameters": {}, "examples": [{}], "category": "general"}], "endpoint": "ws://localhost:8090", "connection_params": {}}}
2025-06-28 11:32:51,787 - core.toolscore.mcp_server - INFO - [microsandbox_server] Waiting for registration response from toolscore...
2025-06-28 11:32:51,788 - core.toolscore.mcp_server - INFO - [microsandbox_server] Received registration response: {"type": "register_tool_response", "request_id": "e0c18459-e6b5-44b8-baaf-814feec5c33d", "success": true, "message": null}
2025-06-28 11:32:51,788 - core.toolscore.mcp_server - INFO - [microsandbox_server] Successfully registered with toolscore.

2025-06-28 11:36:32,355 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:36:32,355 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:36:32,355 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:32:41,833 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:32:41,833 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:32:41,833 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:32:41,833 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:32:41,833 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:32:41,833 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:32:41,835 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:32:41,835 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:32:41,835 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:32:41,835 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:32:42,164 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:32:42,164 - websockets.server - INFO - connection closed
2025-06-28 11:32:42,165 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:32:42,165 - websockets.server - INFO - connection closed
2025-06-28 11:32:51,836 - core.toolscore.mcp_server - INFO - [deepsearch_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 11:32:51,841 - core.toolscore.mcp_server - INFO - [deepsearch_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 11:32:51,841 - core.toolscore.mcp_server - INFO - [deepsearch_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "39af33e5-8b34-44b9-b003-5e28eabd7375", "tool_spec": {"tool_id": "deepsearch", "name": "deepsearch_server", "description": "\u4e13\u4e1a\u7ea7\u6df1\u5ea6\u641c\u7d22\u548c\u7814\u7a76\u5de5\u5177\u670d\u52a1\u5668\uff0c\u57fa\u4e8eLangGraph\u5b9e\u73b0\u7684\u591a\u8f6e\u8fed\u4ee3\u641c\u7d22\u4ee3\u7406", "tool_type": "mcp_server", "capabilities": [{"name": "research", "description": "\u6267\u884c\u4e13\u4e1a\u7ea7\u6df1\u5ea6\u7814\u7a76\uff0c\u83b7\u53d6\u8be6\u7ec6\u8c03\u7814\u4fe1\u606f", "parameters": {"question": {"type": "string", "description": "\u8981\u7814\u7a76\u7684\u95ee\u9898\u6216\u4e3b\u9898", "required": true}, "research_depth": {"type": "string", "description": "\u7814\u7a76\u6df1\u5ea6: quick/standard/comprehensive", "required": false}, "max_iterations": {"type": "integer", "description": "\u6700\u5927\u8fed\u4ee3\u6b21\u6570", "required": false}}, "examples": [], "category": "general"}, {"name": "quick_research", "description": "\u6267\u884c\u5feb\u901f\u7814\u7a76\uff0c\u9002\u7528\u4e8e\u9700\u8981\u5feb\u901f\u83b7\u53d6\u57fa\u7840\u4fe1\u606f\u7684\u573a\u666f", "parameters": {"question": {"type": "string", "description": "\u8981\u7814\u7a76\u7684\u95ee\u9898\u6216\u4e3b\u9898", "required": true}}, "examples": [], "category": "general"}, {"name": "comprehensive_research", "description": "\u6267\u884c\u5168\u9762\u6df1\u5ea6\u7814\u7a76\uff0c\u9002\u7528\u4e8e\u9700\u8981\u8be6\u7ec6\u3001\u4e13\u4e1a\u7ea7\u8c03\u7814\u4fe1\u606f\u7684\u573a\u666f", "parameters": {"question": {"type": "string", "description": "\u8981\u7814\u7a76\u7684\u95ee\u9898\u6216\u4e3b\u9898", "required": true}, "topic_focus": {"type": "string", "description": "\u53ef\u9009\u7684\u4e3b\u9898\u7126\u70b9\uff0c\u7528\u4e8e\u5f15\u5bfc\u7814\u7a76\u65b9\u5411", "required": false}}, "examples": [], "category": "general"}, {"name": "get_health_status", "description": "\u83b7\u53d6\u7cfb\u7edf\u5065\u5eb7\u72b6\u6001\u548c\u6027\u80fd\u6307\u6807", "parameters": {}, "examples": [], "category": "general"}, {"name": "get_optimization_stats", "description": "\u83b7\u53d6\u8bf7\u6c42\u4f18\u5316\u7edf\u8ba1\u4fe1\u606f", "parameters": {}, "examples": [], "category": "general"}], "endpoint": "ws://localhost:8086/mcp", "connection_params": {}}}
2025-06-28 11:32:51,841 - core.toolscore.mcp_server - INFO - [deepsearch_server] Waiting for registration response from toolscore...
2025-06-28 11:32:51,842 - core.toolscore.mcp_server - INFO - [deepsearch_server] Received registration response: {"type": "register_tool_response", "request_id": "39af33e5-8b34-44b9-b003-5e28eabd7375", "success": true, "message": null}
2025-06-28 11:32:51,842 - core.toolscore.mcp_server - INFO - [deepsearch_server] Successfully registered with toolscore.
2025-06-28 11:33:11,553 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:33:11,554 - websockets.server - INFO - connection closed
2025-06-28 11:33:41,556 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:33:41,556 - websockets.server - INFO - connection closed
2025-06-28 11:34:11,567 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:34:11,567 - websockets.server - INFO - connection closed
2025-06-28 11:34:41,563 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:34:41,563 - websockets.server - INFO - connection closed
2025-06-28 11:35:11,568 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:35:11,568 - websockets.server - INFO - connection closed
2025-06-28 11:35:41,574 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:35:41,574 - websockets.server - INFO - connection closed
2025-06-28 11:36:11,575 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:36:11,575 - websockets.server - INFO - connection closed

2025-06-28 11:36:32,355 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:36:32,390 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 收到停止信号，正在清理资源...
[2025-06-28 11:36:32] ✅ 进程清理完成
2025-06-28 11:36:32,864 - services.synthesis_service - INFO - 合成服务工作线程已停止
2025-06-28 11:36:32,874 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:36:32,874 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:36:32,874 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:36:32,874 - services.runtime_service - INFO - 停止运行时实例: enhanced-reasoning-1
2025-06-28 11:36:32,874 - services.runtime_service - WARNING - 运行时清理失败: asyncio.run() cannot be called from a running event loop
[2025-06-28 11:36:32] /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/services/runtime_service.py:117: RuntimeWarning: coroutine 'EnhancedReasoningRuntime.cleanup' was never awaited
  logger.warning(f"运行时清理失败: {e}")
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
2025-06-28 11:36:32,878 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:36:32,878 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:36:32,878 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:36:32,878 - services.task_api_service - INFO - 已发送停止信号给任务API服务器
[2025-06-28 11:36:32] INFO:     Shutting down
[2025-06-28 11:36:32] INFO:     Waiting for application shutdown.
[2025-06-28 11:36:32] INFO:     Application shutdown complete.
[2025-06-28 11:36:32] INFO:     Finished server process [74982]
2025-06-28 11:36:32,984 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:36:32,984 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:36:32,984 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:36:32,984 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:36:32,984 - services.mcp_server_launcher - INFO - MCP服务器已经停止: microsandbox_server
2025-06-28 11:36:32,984 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:36:32,984 - services.mcp_server_launcher - INFO - MCP服务器已经停止: search_tool_server
2025-06-28 11:36:32,984 - services.mcp_server_launcher - INFO - 停止MCP服务器: browser_use_server
2025-06-28 11:36:32,985 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 收到停止信号，正在清理资源...
2025-06-28 11:36:33,291 - services.synthesis_service - ERROR - ❌ SynthesisCore v2.0监控器启动失败: 'NoneType' object has no attribute 'stop_monitoring'
2025-06-28 11:36:33,292 - services.synthesis_service - INFO - SynthesisCore v2.0监控器工作线程已停止
[2025-06-28 11:36:34] ✅ 端口 8088 空闲
[2025-06-28 11:36:34] ✅ 端口 8089 空闲
[2025-06-28 11:36:34] ✅ 端口 8090 空闲
[2025-06-28 11:36:34] ✅ 端口 8091 空闲
[2025-06-28 11:36:34] ✅ 端口 8092 空闲
[2025-06-28 11:36:34] ✅ 端口 5555 空闲
[2025-06-28 11:36:34] 🔥 强制清理端口 8081 的进程 74982
[2025-06-28 11:36:34] ✅ 端口 8082 空闲
[2025-06-28 11:36:34] ✅ 端口 8080 空闲
[2025-06-28 11:36:34] 🔥 强制清理端口 8084 的进程 75031
[2025-06-28 11:36:34] ✅ 端口 8085 空闲
[2025-06-28 11:36:34] ✅ 端口 8086 空闲
[2025-06-28 11:36:34] ✅ 端口 8087 空闲
[2025-06-28 11:36:34] ✅ 端口 8000 空闲
[2025-06-28 11:36:35] ✅ 增强端口清理完成
2025-06-28 11:36:35,785 - __main__ - INFO - === Agent Data Platform 启动中 ===
2025-06-28 11:36:35,785 - __main__ - DEBUG - 🔧 开始系统初始化流程...
2025-06-28 11:36:35,787 - __main__ - DEBUG - 📝 命令行参数: {'config_dir': 'config', 'debug': False, 'start_services': False}
2025-06-28 11:36:35,787 - __main__ - DEBUG - 🔧 步骤1: 初始化ConfigManager...
2025-06-28 11:36:35,788 - __main__ - DEBUG - ✅ ConfigManager初始化完成，配置目录: config
2025-06-28 11:36:35,788 - __main__ - DEBUG - 🔧 步骤2: 加载系统配置...
2025-06-28 11:36:35,789 - __main__ - DEBUG - 📡 Redis URL: redis://localhost:6379
2025-06-28 11:36:35,789 - __main__ - DEBUG - 📋 任务文件路径: tasks.jsonl
2025-06-28 11:36:35,809 - core.config_manager - INFO - 路由配置加载成功
2025-06-28 11:36:35,810 - __main__ - DEBUG - 🚦 路由配置加载完成，任务类型映射: {'CODE': 'tasks:reasoning', 'WEB': 'tasks:reasoning', 'REASONING': 'tasks:reasoning', 'RESEARCH': 'tasks:reasoning'}
2025-06-28 11:36:35,810 - __main__ - DEBUG - 📋 队列映射: {<TaskType.CODE: 'code'>: 'tasks:reasoning', <TaskType.WEB: 'web'>: 'tasks:reasoning', <TaskType.REASONING: 'reasoning'>: 'tasks:reasoning', <TaskType.RESEARCH: 'research'>: 'tasks:reasoning'}
2025-06-28 11:36:35,810 - __main__ - DEBUG - 🔧 步骤3: 初始化核心组件...
2025-06-28 11:36:35,810 - __main__ - DEBUG - ✅ EnhancedMetrics初始化完成
2025-06-28 11:36:35,810 - __main__ - DEBUG - ✅ RedisManager初始化完成
2025-06-28 11:36:35,811 - core.toolscore.toolscore_client - INFO - ✅ 增强的ToolScoreClient初始化完成
2025-06-28 11:36:35,812 - core.llm_client - DEBUG - Enriched config with environment variables: ['default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:36:35,925 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:36:35,927 - core.config_manager - INFO - 路由配置加载成功
2025-06-28 11:36:35,927 - core.monitoring.queue_monitor - INFO - ✅ QueueMonitor 配置加载完成
2025-06-28 11:36:35,927 - core.system_monitor - INFO - ✅ SystemMonitor 配置加载完成
2025-06-28 11:36:35,927 - __main__ - DEBUG - 🔧 开始初始化所有服务...
2025-06-28 11:36:35,927 - services.service_manager - INFO - 正在初始化所有服务...
2025-06-28 11:36:35,927 - services.service_manager - INFO - 初始化服务: redis
2025-06-28 11:36:35,927 - services.redis_service - INFO - Redis服务初始化完成，使用注入的RedisManager实例
2025-06-28 11:36:35,927 - services.service_manager - INFO - 初始化服务: toolscore
2025-06-28 11:36:35,927 - services.toolscore_service - INFO - 正在初始化ToolScore服务...
2025-06-28 11:36:35,927 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 11:36:35,927 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 11:36:35,927 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 11:36:35,927 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:36:35,927 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 11:36:35,928 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 11:36:35,928 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 11:36:35,928 - services.toolscore_service - INFO - ToolScore服务初始化完成（异步初始化将在start()中进行）
2025-06-28 11:36:35,928 - services.service_manager - INFO - 初始化服务: task_processing_coordinator
2025-06-28 11:36:35,928 - services.service_manager - INFO - 初始化服务: mcp_servers
2025-06-28 11:36:35,928 - services.mcp_server_launcher - INFO - 正在初始化MCP服务器启动器...
2025-06-28 11:36:35,928 - services.mcp_server_launcher - INFO - MCP服务器启动器初始化完成，配置了 4 个服务器: ['microsandbox_server', 'search_tool_server', 'browser_use_server', 'deepsearch_server']
2025-06-28 11:36:35,928 - services.service_manager - INFO - 初始化服务: task_api
2025-06-28 11:36:35,928 - services.task_api_service - INFO - 正在初始化任务API服务...
2025-06-28 11:36:35,928 - services.task_api_service - INFO - 任务API服务初始化完成
2025-06-28 11:36:35,928 - services.service_manager - INFO - 初始化服务: runtime
2025-06-28 11:36:35,928 - services.runtime_service - INFO - 正在初始化推理运行时服务...
2025-06-28 11:36:35,928 - services.runtime_service - INFO - 创建运行时实例: enhanced-runtime-1
2025-06-28 11:36:35,928 - core.memory_manager - INFO - MemoryManager initialized: use_redis=True, max_entries=1000
2025-06-28 11:36:35,928 - core.step_planner - INFO - StepPlanner initialized with max_steps=10
2025-06-28 11:36:35,928 - runtimes.reasoning.enhanced_runtime - INFO - DEBUG: Loaded toolscore_http_port: 8082, toolscore_mcp_port: 8081
2025-06-28 11:36:35,928 - runtimes.reasoning.enhanced_runtime - INFO - DEBUG: Configured toolscore_websocket_endpoint (using mcp_port): ws://localhost:8081/websocket
2025-06-28 11:36:35,928 - core.toolscore.mcp_client - INFO - Enhanced MCPToolClient initialized for toolscore at ws://localhost:8081/websocket
2025-06-28 11:36:35,938 - core.config.unified_mapping_manager - INFO - ✅ 统一映射配置已加载: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/config/unified_tool_mappings.yaml
2025-06-28 11:36:35,938 - core.config.unified_mapping_manager - INFO - 🔒 配置哈希: 19cc9dfe
2025-06-28 11:36:35,938 - core.llm.guardrails_middleware - INFO - 🔧 初始化输入验证Guard...
2025-06-28 11:36:35,940 - root - DEBUG - Creating HubTelemetry instance...
2025-06-28 11:36:35,940 - root - DEBUG - Initializing HubTelemetry instance...
2025-06-28 11:36:35,940 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:36:35,940 - core.llm.guardrails_middleware - INFO - 🔧 初始化输出验证Guard...
2025-06-28 11:36:35,940 - core.llm.guardrails_middleware - INFO - 🔧 使用本地LLM客户端初始化Guard...
2025-06-28 11:36:35,942 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:36:35,942 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:36:35,942 - core.llm.guardrails_middleware - INFO - ✅ 使用LLM的Guard创建成功
2025-06-28 11:36:35,942 - core.llm.guardrails_middleware - INFO - ✅ Guardrails Guards初始化成功
2025-06-28 11:36:35,942 - core.llm.guardrails_middleware - INFO -    - 输入Guard: ✅
2025-06-28 11:36:35,942 - core.llm.guardrails_middleware - INFO -    - 输出Guard: ✅
2025-06-28 11:36:35,942 - core.agents.validation_critic - INFO - 🎯 ValidationCritic Agent初始化完成
2025-06-28 11:36:35,942 - services.runtime_service - INFO - 推理运行时服务初始化完成，创建了 1 个实例
2025-06-28 11:36:35,942 - services.service_manager - INFO - 初始化服务: synthesis
2025-06-28 11:36:35,942 - services.synthesis_service - INFO - 正在初始化合成服务...
2025-06-28 11:36:35,942 - core.llm_client - DEBUG - Enriched config with environment variables: ['redis_url', 'TRAJECTORIES_DIR', 'default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:36:35,973 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:36:35,973 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 11:36:35,973 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 11:36:35,973 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 11:36:35,973 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:36:35,973 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 11:36:35,973 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 11:36:35,973 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 11:36:35,973 - core.synthesiscore.synthesis - INFO - ✅ JSON文件存储初始化完成
2025-06-28 11:36:35,973 - core.synthesiscore.synthesis - INFO - 📋 未发现已处理轨迹记录，从空白状态开始
2025-06-28 11:36:35,974 - core.llm_client - DEBUG - Enriched config with environment variables: ['redis_url', 'TRAJECTORIES_DIR', 'default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:36:36,004 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:36:36,004 - core.toolscore.mcp_client - INFO - Enhanced MCPToolClient initialized for toolscore at ws://localhost:8089/websocket
2025-06-28 11:36:36,007 - core.synthesiscore.config_loader - INFO - ✅ SynthesisCore配置加载成功: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/config/synthesiscore_config.yaml
2025-06-28 11:36:36,007 - core.synthesiscore.trajectory_monitor - INFO - 🔧 TrajectoryMonitor初始化完成
2025-06-28 11:36:36,007 - core.synthesiscore.trajectory_monitor - INFO - 📂 监控目录: output/trajectories
2025-06-28 11:36:36,007 - core.synthesiscore.trajectory_monitor - INFO - 📝 种子文件: output/trajectories/../seed_tasks.jsonl
2025-06-28 11:36:36,007 - services.synthesis_service - INFO - ✅ TrajectoryMonitor v2.0 初始化完成
2025-06-28 11:36:36,007 - services.synthesis_service - INFO - 合成服务初始化完成，轨迹目录: output/trajectories
2025-06-28 11:36:36,007 - __main__ - DEBUG - ✅ 所有服务初始化完成
2025-06-28 11:36:36,007 - __main__ - DEBUG - 🚀 开始启动所有服务...
2025-06-28 11:36:36,007 - services.service_manager - INFO - 正在启动所有服务...
2025-06-28 11:36:36,007 - services.service_manager - INFO - 启动服务: redis
2025-06-28 11:36:36,007 - services.redis_service - INFO - Redis客户端已就绪
2025-06-28 11:36:36,007 - services.service_manager - INFO - 启动服务: toolscore
2025-06-28 11:36:36,007 - services.toolscore_service - INFO - 正在启动ToolScore服务...
2025-06-28 11:36:36,007 - services.toolscore_service - INFO - 正在初始化工具库...
2025-06-28 11:36:36,007 - services.toolscore_service - INFO - 工具库初始化将在ToolScore MCP服务器线程中进行。
2025-06-28 11:36:36,007 - services.toolscore_service - INFO - 正在启动ToolScore HTTP API...
2025-06-28 11:36:36,016 - services.toolscore_service - INFO - ToolScore HTTP API已启动于端口: 8082
2025-06-28 11:36:36,016 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:36:36,016 - services.toolscore_service - INFO - ToolScore MCP 服务器不进行端口自动检测，使用配置端口: 8081
2025-06-28 11:36:36,016 - services.toolscore_service - INFO - ToolScore MCP server configured to use host: 0.0.0.0, port: 8081, path: /websocket
2025-06-28 11:36:36,016 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 11:36:36,016 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 11:36:36,016 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 11:36:36,016 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:36:36,016 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 11:36:36,016 - core.toolscore.monitoring_api - INFO - ToolScore monitoring API started on port 8082
2025-06-28 11:36:36,016 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 11:36:36,016 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 11:36:36,016 - services.toolscore_service - INFO - Starting ToolScore MCP server thread...
2025-06-28 11:36:36,016 - services.toolscore_service - INFO - ToolScore MCP server thread started, is_alive: True
2025-06-28 11:36:36,016 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:36:36,017 - services.toolscore_service - INFO - ToolScore MCP服务器启动线程已启动，等待就绪信号...
2025-06-28 11:36:36,017 - services.service_manager - INFO - 启动服务: task_processing_coordinator
2025-06-28 11:36:36,017 - core.dispatcher_enhanced - INFO - ✅ TaskProcessingCoordinator 配置加载完成 - 队列映射: {<TaskType.CODE: 'code'>: 'tasks:reasoning', <TaskType.WEB: 'web'>: 'tasks:reasoning', <TaskType.REASONING: 'reasoning'>: 'tasks:reasoning', <TaskType.RESEARCH: 'research'>: 'tasks:reasoning'}
2025-06-28 11:36:36,017 - core.toolscore.mcp_server - INFO - Attempting to start toolscore MCP Server on 0.0.0.0:8081
2025-06-28 11:36:36,017 - services.service_manager - INFO - 启动服务: mcp_servers
2025-06-28 11:36:36,017 - services.mcp_server_launcher - INFO - 正在启动MCP服务器...
2025-06-28 11:36:36,017 - services.mcp_server_launcher - INFO - 正在并行启动 4 个MCP服务器...
2025-06-28 11:36:36,017 - core.dispatcher_enhanced - INFO - 启动任务处理协调器...
2025-06-28 11:36:36,017 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:36:36,017 - websockets.server - INFO - server listening on 0.0.0.0:8081
2025-06-28 11:36:36,017 - core.toolscore.mcp_server - INFO - [toolscore] Initializing UnifiedToolLibrary...
2025-06-28 11:36:36,017 - core.toolscore.core_manager - INFO - 🚀 正在初始化增强的CoreManager...
2025-06-28 11:36:36,017 - core.toolscore.core_manager - INFO - 🔄 使用v2.0服务容器架构初始化...
2025-06-28 11:36:36,017 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:36:36,017 - core.toolscore.enhanced_core_manager_v2 - INFO - 🚀 初始化增强核心管理器 v2.0...
2025-06-28 11:36:36,017 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:36:36,017 - core.toolscore.service_container.mcp_service_container - INFO - 🚀 开始初始化MCP服务容器...
2025-06-28 11:36:36,017 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:36:36,017 - core.toolscore.service_container.mcp_service_container - INFO - 🔍 发现内置MCP服务...
2025-06-28 11:36:36,017 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:36:36,017 - core.toolscore.service_container.builtin_discovery - INFO - 🔍 开始发现内置MCP服务: mcp_servers
2025-06-28 11:36:36,017 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:36:36,017 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:36:36,017 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:36:36,017 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:36:36,017 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:36:36,017 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:36:36,018 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: Search Tool MCP Server
2025-06-28 11:36:36,018 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:36:36,018 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:36:36,020 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: MicroSandbox MCP Server
2025-06-28 11:36:36,020 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 75461)
2025-06-28 11:36:36,021 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 跳过 __pycache__: 缺少main.py文件
2025-06-28 11:36:36,021 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:36:36,021 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:36:36,021 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:36:36,021 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:36:36,021 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: Browser Use MCP Server
2025-06-28 11:36:36,021 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:36:36,021 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:36:36,021 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:36:36,021 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:36:36,021 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:36:36,021 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: DeepSearch MCP Server
2025-06-28 11:36:36,021 - core.toolscore.service_container.builtin_discovery - INFO - 🎯 内置服务发现完成，共发现 4 个服务
2025-06-28 11:36:36,021 - core.toolscore.service_container.builtin_discovery - INFO - 📝 创建服务配置文件...
2025-06-28 11:36:36,021 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:36:36,021 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/search_tool_server/service.json
2025-06-28 11:36:36,022 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/microsandbox_server/service.json
2025-06-28 11:36:36,022 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:36:36,022 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/browser_use_server/service.json
2025-06-28 11:36:36,022 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:36:36,022 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/deepsearch_server/service.json
2025-06-28 11:36:36,022 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 发现 4 个内置服务
2025-06-28 11:36:36,022 - core.toolscore.service_container.mcp_service_container - INFO - 📂 加载已安装的外部服务...
2025-06-28 11:36:36,022 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:36:36,022 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 加载 0 个外部服务
2025-06-28 11:36:36,022 - core.toolscore.service_container.mcp_service_container - INFO - 📋 构建统一服务目录...
2025-06-28 11:36:36,022 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 服务目录构建完成，共 4 个服务
2025-06-28 11:36:36,022 - core.toolscore.service_container.mcp_service_container - INFO - 📋 标记内置服务为启动中状态...
2025-06-28 11:36:36,022 - core.toolscore.service_container.mcp_service_container - INFO - 📋 已标记 4 个内置服务为启动中状态
2025-06-28 11:36:36,022 - core.toolscore.service_container.service_monitor - INFO - 🔍 启动服务监控...
2025-06-28 11:36:36,022 - core.toolscore.service_container.mcp_service_container - INFO - ✅ MCP服务容器初始化完成
2025-06-28 11:36:36,022 - core.toolscore.enhanced_core_manager_v2 - INFO - ✅ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:36:36,023 - core.toolscore.core_manager - INFO - ✅ v2.0架构初始化完成
2025-06-28 11:36:36,023 - core.toolscore.tool_registry - INFO - Tool registry initialized
2025-06-28 11:36:36,023 - core.llm_client - DEBUG - Enriched config with environment variables: ['provider', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:36:36,023 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:36:36,023 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:36:36,023 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:36:36,023 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:36:36,026 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 75462)
2025-06-28 11:36:36,026 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:36:36,035 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: browser_use_server
2025-06-28 11:36:36,035 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:36:36,036 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: browser_use_server
2025-06-28 11:36:36,036 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server
2025-06-28 11:36:36,036 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) = True
2025-06-28 11:36:36,036 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) = True
2025-06-28 11:36:36,036 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) contents: ['service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:36:36,036 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server/main.py
2025-06-28 11:36:36,036 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:36:36,036 - services.mcp_server_launcher - INFO - [MCP启动器] 为 browser_use_server 使用配置文件指定端口: 8084
2025-06-28 11:36:36,036 - services.mcp_server_launcher - INFO - [MCP启动器] 为 browser_use_server 使用配置文件指定端口: 8084
2025-06-28 11:36:36,036 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 BROWSER_USE_SERVER_PORT=8084 给 browser_use_server
2025-06-28 11:36:36,036 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.browser_use_server.main
2025-06-28 11:36:36,036 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:36:36,040 - services.mcp_server_launcher - INFO - MCP服务器已启动: browser_use_server (PID: 75463)
2025-06-28 11:36:36,040 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 browser_use_server 就绪状态...
2025-06-28 11:36:36,041 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:36:36,042 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:36:36,042 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:36:36,042 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:36:36,042 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:36:36,042 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:36:36,042 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:36:36,042 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:36:36,042 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:36:36,042 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:36:36,042 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:36:36,042 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:36:36,043 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:36:36,043 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:36:36,046 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 75464)
2025-06-28 11:36:36,046 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:36:36,047 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第1次, 5s间隔)
2025-06-28 11:36:36,047 - core.monitoring.queue_monitor - INFO - 启动队列监控器...
2025-06-28 11:36:36,050 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:36:36,050 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:36:36,050 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:36:36,050 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:36:36,050 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:36:36,050 - websockets.client - DEBUG - > Sec-WebSocket-Key: tEaBolku6Sw9H2pehWDAYg==
2025-06-28 11:36:36,050 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:36:36,050 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:36:36,050 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:36:36,051 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:36:36,051 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:36:36,051 - websockets.client - DEBUG - > Host: localhost:8084
2025-06-28 11:36:36,051 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:36:36,051 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:36:36,051 - websockets.client - DEBUG - > Sec-WebSocket-Key: fAFN4D+9WiyCYHx9T8R8xA==
2025-06-28 11:36:36,051 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:36:36,051 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:36:36,051 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:36:36,051 - websockets.client - DEBUG - > EOF
2025-06-28 11:36:36,051 - websockets.client - DEBUG - < EOF
2025-06-28 11:36:36,051 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:36:36,051 - websockets.client - DEBUG - > EOF
2025-06-28 11:36:36,051 - websockets.client - DEBUG - < EOF
2025-06-28 11:36:36,051 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:36:36,053 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:36:36,054 - services.mcp_server_launcher - DEBUG - 📋 browser_use_server 端口 8084 尚未就绪
2025-06-28 11:36:36,055 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:36:36,069 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:36:36,069 - core.toolscore.tool_gap_detector - INFO - 智能工具缺口检测器初始化 - 统一版本
2025-06-28 11:36:36,069 - core.toolscore.dynamic_mcp_manager - INFO - Dynamic MCP Manager initialized (ProcessRunner mode)
2025-06-28 11:36:36,069 - core.toolscore.dynamic_mcp_manager - INFO - 启动动态MCP管理器...
2025-06-28 11:36:36,069 - core.toolscore.dynamic_mcp_manager - INFO - 持久化配置为空，无需恢复外部MCP服务器
2025-06-28 11:36:36,069 - core.toolscore.dynamic_mcp_manager - INFO - 动态MCP管理器启动完成
2025-06-28 11:36:36,070 - core.toolscore.mcp_search_tool - INFO - ✅ MCP Search Tool initialized - 优化版本，包含失败工具跟踪
2025-06-28 11:36:36,070 - core.toolscore.unified_tool_library - INFO - Tool library initialization completed - 核心管理器模式
2025-06-28 11:36:36,070 - core.toolscore.mcp_server - INFO - [toolscore] UnifiedToolLibrary initialized.
2025-06-28 11:36:36,070 - core.toolscore.mcp_server - INFO - [toolscore] Auto-registering MCP servers...
2025-06-28 11:36:36,070 - core.toolscore.mcp_auto_registration - INFO - 🔍 开始自动发现和注册MCP服务器...
2025-06-28 11:36:36,070 - core.toolscore.mcp_auto_registration - DEBUG - ⚠️ 服务器目录 __pycache__ 缺少 service.json
2025-06-28 11:36:36,070 - core.toolscore.mcp_auto_registration - INFO - 🎯 发现 4 个MCP服务器
2025-06-28 11:36:36,085 - core.unified_tool_manager - DEBUG - ✅ 配置验证通过
2025-06-28 11:36:36,086 - core.unified_tool_manager - INFO - 🔄 成功加载工具配置: 4 个标准工具
2025-06-28 11:36:36,086 - core.unified_tool_manager - DEBUG -    - 标准工具ID: ['browser_use', 'deepsearch', 'mcp-search-tool', 'microsandbox']
2025-06-28 11:36:36,086 - core.unified_tool_manager - DEBUG -    - 兼容映射: 13 个变体
2025-06-28 11:36:36,086 - core.unified_tool_manager - INFO - ✅ 统一工具管理器初始化完成，管理 4 个工具
2025-06-28 11:36:36,086 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: mcp-search-tool
2025-06-28 11:36:36,086 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: Search Tool MCP Server (ID: mcp-search-tool)
2025-06-28 11:36:36,086 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: Search Tool MCP Server (ID: mcp-search-tool)
2025-06-28 11:36:36,086 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: Search Tool MCP Server
2025-06-28 11:36:36,086 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8080/websocket
2025-06-28 11:36:36,086 - core.toolscore.mcp_connector - INFO - Registered MCP server mcp-search-tool at ws://localhost:8080/websocket
2025-06-28 11:36:36,086 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: mcp-search-tool -> ws://localhost:8080/websocket
2025-06-28 11:36:36,086 - core.toolscore.core_manager - INFO - 工具立即可用: mcp-search-tool
2025-06-28 11:36:36,086 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: mcp-search-tool
2025-06-28 11:36:36,086 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: microsandbox
2025-06-28 11:36:36,086 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: MicroSandbox MCP Server (ID: microsandbox)
2025-06-28 11:36:36,086 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: MicroSandbox MCP Server (ID: microsandbox)
2025-06-28 11:36:36,086 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: MicroSandbox MCP Server
2025-06-28 11:36:36,086 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8090/websocket
2025-06-28 11:36:36,086 - core.toolscore.mcp_connector - INFO - Registered MCP server microsandbox at ws://localhost:8090/websocket
2025-06-28 11:36:36,086 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: microsandbox -> ws://localhost:8090/websocket
2025-06-28 11:36:36,086 - core.toolscore.core_manager - INFO - 工具立即可用: microsandbox
2025-06-28 11:36:36,086 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: microsandbox
2025-06-28 11:36:36,086 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: browser_use
2025-06-28 11:36:36,086 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: Browser Use MCP Server (ID: browser_use)
2025-06-28 11:36:36,086 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: Browser Use MCP Server (ID: browser_use)
2025-06-28 11:36:36,086 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: Browser Use MCP Server
2025-06-28 11:36:36,086 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8084/websocket
2025-06-28 11:36:36,086 - core.toolscore.mcp_connector - INFO - Registered MCP server browser_use at ws://localhost:8084/websocket
2025-06-28 11:36:36,087 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: browser_use -> ws://localhost:8084/websocket
2025-06-28 11:36:36,087 - core.toolscore.core_manager - INFO - 工具立即可用: browser_use
2025-06-28 11:36:36,087 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: browser_use
2025-06-28 11:36:36,087 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: deepsearch
2025-06-28 11:36:36,087 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: DeepSearch MCP Server (ID: deepsearch)
2025-06-28 11:36:36,087 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: DeepSearch MCP Server (ID: deepsearch)
2025-06-28 11:36:36,087 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: DeepSearch MCP Server
2025-06-28 11:36:36,087 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8086/websocket
2025-06-28 11:36:36,087 - core.toolscore.mcp_connector - INFO - Registered MCP server deepsearch at ws://localhost:8086/websocket
2025-06-28 11:36:36,087 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: deepsearch -> ws://localhost:8086/websocket
2025-06-28 11:36:36,087 - core.toolscore.core_manager - INFO - 工具立即可用: deepsearch
2025-06-28 11:36:36,087 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: deepsearch
2025-06-28 11:36:36,087 - core.toolscore.mcp_auto_registration - INFO - 📊 MCP服务器注册完成: 4/4 成功
2025-06-28 11:36:36,088 - core.toolscore.mcp_server - INFO - [toolscore] All MCP servers registered successfully.
2025-06-28 11:36:36,088 - core.toolscore.mcp_server - INFO - toolscore MCP Server started successfully on 0.0.0.0:8081 (Original endpoint: ws://0.0.0.0:8081/websocket) with ping_interval=30, ping_timeout=60
2025-06-28 11:36:36,088 - core.toolscore.mcp_server - INFO - toolscore MCP Server started event set.
2025-06-28 11:36:36,088 - core.toolscore.service_container.service_monitor - INFO - 🔄 开始服务监控循环，检查间隔: 30秒
2025-06-28 11:36:36,092 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [browser_use] BrowserUse logging setup complete with level info
2025-06-28 11:36:36,443 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [root] Anonymized telemetry enabled. See https://docs.browser-use.com/development/telemetry for more information.
2025-06-28 11:36:36,560 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.llm_client] Initialized LLM client with provider: gemini
2025-06-28 11:36:36,560 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Browser-Use server initialized with LLM provider: gemini
2025-06-28 11:36:36,560 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 使用动态分配端口: 8084
2025-06-28 11:36:36,560 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] BrowserUseMCPServer initialized:
2025-06-28 11:36:36,560 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Server Name: browser_use_server
2025-06-28 11:36:36,560 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Server ID: browser_use
2025-06-28 11:36:36,560 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Listen Host: 0.0.0.0
2025-06-28 11:36:36,561 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Listen Port: 8084
2025-06-28 11:36:36,561 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Public Endpoint: ws://localhost:8084
2025-06-28 11:36:36,561 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:36:36,561 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Starting browser_use_server...
2025-06-28 11:36:36,561 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Attempting to start MCPServer for browser_use_server at ws://localhost:8084...
2025-06-28 11:36:36,561 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Attempting to start browser_use_server MCP Server on localhost:8084
2025-06-28 11:36:36,561 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] server listening on 127.0.0.1:8084
2025-06-28 11:36:36,561 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] server listening on [::1]:8084
2025-06-28 11:36:36,562 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] browser_use_server MCP Server started successfully on localhost:8084 (Original endpoint: ws://localhost:8084) with ping_interval=30, ping_timeout=60
2025-06-28 11:36:36,562 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:36:36,622 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:36:36,622 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:36:36,656 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:36:36,656 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:36:36,656 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:36:36,656 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:36:36,656 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:36:36,656 - websockets.client - DEBUG - > Sec-WebSocket-Key: fXEPRZpt/5aqaivEQ9jFJg==
2025-06-28 11:36:36,656 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:36:36,656 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:36:36,656 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:36:36,657 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:36:36,657 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:36:36,657 - websockets.client - DEBUG - > Host: localhost:8084
2025-06-28 11:36:36,657 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:36:36,657 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:36:36,657 - websockets.client - DEBUG - > Sec-WebSocket-Key: E2uFvxSbAFnMm1V97XECMQ==
2025-06-28 11:36:36,657 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:36:36,657 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:36:36,657 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:36:36,657 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:36:36,657 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:36:36,657 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:36:36,657 - websockets.client - DEBUG - < Sec-WebSocket-Accept: hosqAefc87Kk14qSmm2t7T2q02k=
2025-06-28 11:36:36,657 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:36:36,657 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:36:36 GMT
2025-06-28 11:36:36,657 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:36:36,657 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection open
2025-06-28 11:36:36,658 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:36:36,658 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Client connected to browser_use_server MCP Server at path /: ('127.0.0.1', 63451)
2025-06-28 11:36:36,658 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:36:36,658 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:36:36,658 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:36:36,658 - websockets.client - DEBUG - < Sec-WebSocket-Accept: T2uMRhKoHfdRp6IeXazTyX5Mtzg=
2025-06-28 11:36:36,658 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:36:36,658 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:36:36 GMT
2025-06-28 11:36:36,658 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:36:36,658 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:36:36,658 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:36:36,658 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:36:36,658 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:36:36,659 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:36:36,659 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:36:36,659 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:36:36,659 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:36:36,659 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:36:36,659 - websockets.client - DEBUG - < EOF
2025-06-28 11:36:36,659 - websockets.client - DEBUG - > EOF
2025-06-28 11:36:36,659 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:36:36,659 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:36:36,659 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:36:36,659 - websockets.client - DEBUG - < EOF
2025-06-28 11:36:36,659 - services.mcp_server_launcher - DEBUG - [browser_use_server] WARNING  [core.toolscore.mcp_server] Unknown request type or server role mismatch: ping
2025-06-28 11:36:36,659 - websockets.client - DEBUG - > EOF
2025-06-28 11:36:36,659 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:36:36,659 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:36:36,659 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:36:36,659 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:36:36,660 - services.mcp_server_launcher - DEBUG - ✅ browser_use_server 特定就绪检查通过
2025-06-28 11:36:36,660 - services.mcp_server_launcher - INFO - ✅ browser_use_server 已就绪
2025-06-28 11:36:36,660 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:36:36,660 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:36:36,661 - services.mcp_server_launcher - DEBUG - [browser_use_server] ERROR    [core.toolscore.mcp_server] Error handling message: received 1000 (OK); then sent 1000 (OK)
2025-06-28 11:36:36,661 - services.mcp_server_launcher - WARNING - ⚠️ [browser_use_server] 检测到错误日志: ERROR    [core.toolscore.mcp_server] Error handling message: received 1000 (OK); then sent 1000 (OK)
2025-06-28 11:36:36,661 - services.mcp_server_launcher - DEBUG - [browser_use_server] Traceback (most recent call last):
2025-06-28 11:36:36,661 - services.mcp_server_launcher - DEBUG - [browser_use_server] File "/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/core/toolscore/mcp_server.py", line 324, in _handle_message
2025-06-28 11:36:36,661 - services.mcp_server_launcher - DEBUG - [browser_use_server] await websocket.send(json.dumps(response))
2025-06-28 11:36:36,661 - services.mcp_server_launcher - DEBUG - [browser_use_server] File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 620, in send
2025-06-28 11:36:36,661 - services.mcp_server_launcher - DEBUG - [browser_use_server] await self.ensure_open()
2025-06-28 11:36:36,661 - services.mcp_server_launcher - DEBUG - [browser_use_server] File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/websockets/legacy/protocol.py", line 930, in ensure_open
2025-06-28 11:36:36,661 - services.mcp_server_launcher - DEBUG - [browser_use_server] raise self.connection_closed_exc()
2025-06-28 11:36:36,661 - services.mcp_server_launcher - DEBUG - [browser_use_server] websockets.exceptions.ConnectionClosedOK: received 1000 (OK); then sent 1000 (OK)
2025-06-28 11:36:36,661 - services.mcp_server_launcher - WARNING - ⚠️ [browser_use_server] 检测到错误日志: websockets.exceptions.ConnectionClosedOK: received 1000 (OK); then sent 1000 (OK)
2025-06-28 11:36:36,661 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Client disconnected from browser_use_server MCP Server: ('127.0.0.1', 63451)
2025-06-28 11:36:36,661 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:36:37,344 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:36:37,345 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:36:37,661 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:36:38,211 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:36:38,211 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:36:39,250 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:36:39,250 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:36:40,496 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:36:40,497 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:36:41,049 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第2次, 5s间隔)
2025-06-28 11:36:41,992 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:36:41,992 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:36:43,785 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:36:43,786 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:36:45,937 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:36:45,938 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:36:46,050 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第3次, 5s间隔)
2025-06-28 11:36:46,181 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:36:46,182 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:36:46,182 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:36:46,182 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:36:46,182 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:36:46,182 - websockets.server - DEBUG - < Sec-WebSocket-Key: lHF2eVmPRegVYTjWy/pNVQ==
2025-06-28 11:36:46,182 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:36:46,182 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:36:46,182 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:36:46,183 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:36:46,183 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:36:46,183 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:36:46,183 - websockets.server - DEBUG - > Sec-WebSocket-Accept: VfupmPkLRs6iUNlknrYUorxPDBU=
2025-06-28 11:36:46,183 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:36:46,183 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:36:46 GMT
2025-06-28 11:36:46,183 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:36:46,183 - websockets.server - INFO - connection open
2025-06-28 11:36:46,183 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:36:46,183 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 63460)
2025-06-28 11:36:46,185 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "ff7223...onnection_params": {}}}' [2376 bytes]
2025-06-28 11:36:46,186 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: search_tool_server (ID: mcp-search-tool)
2025-06-28 11:36:46,186 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: search_tool_server
2025-06-28 11:36:46,186 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: mcp-search-tool -> ws://localhost:8080/mcp
2025-06-28 11:36:46,186 - core.toolscore.core_manager - INFO - 工具立即可用: mcp-search-tool
2025-06-28 11:36:46,186 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 11:36:46,187 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:36:46,187 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 11:36:46,187 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:36:46,188 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 11:36:46,188 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 11:36:46,188 - websockets.server - INFO - connection closed
2025-06-28 11:36:46,273 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:36:46,274 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:36:46,274 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:36:46,274 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:36:46,274 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:36:46,274 - websockets.server - DEBUG - < Sec-WebSocket-Key: wfUjkQA8uMUvGCVYwspOSA==
2025-06-28 11:36:46,274 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:36:46,274 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:36:46,274 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:36:46,275 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:36:46,275 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:36:46,275 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:36:46,275 - websockets.server - DEBUG - > Sec-WebSocket-Accept: 7IUuaT/mEP34B3Zi6V/Tocw4g3w=
2025-06-28 11:36:46,275 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:36:46,275 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:36:46 GMT
2025-06-28 11:36:46,275 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:36:46,275 - websockets.server - INFO - connection open
2025-06-28 11:36:46,275 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:36:46,275 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 63462)
2025-06-28 11:36:46,276 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "38db33...onnection_params": {}}}' [3263 bytes]
2025-06-28 11:36:46,276 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: microsandbox_server (ID: microsandbox)
2025-06-28 11:36:46,276 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: microsandbox_server
2025-06-28 11:36:46,276 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: microsandbox -> ws://localhost:8090
2025-06-28 11:36:46,276 - core.toolscore.core_manager - INFO - 工具立即可用: microsandbox
2025-06-28 11:36:46,276 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 11:36:46,277 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:36:46,277 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 11:36:46,277 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:36:46,277 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 11:36:46,277 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 11:36:46,278 - websockets.server - INFO - connection closed
2025-06-28 11:36:46,330 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:36:46,330 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:36:46,330 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:36:46,330 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:36:46,330 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:36:46,330 - websockets.server - DEBUG - < Sec-WebSocket-Key: v/pHf3zm5U3/S9QFffAhYQ==
2025-06-28 11:36:46,330 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:36:46,330 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:36:46,330 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:36:46,331 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:36:46,331 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:36:46,331 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:36:46,331 - websockets.server - DEBUG - > Sec-WebSocket-Accept: gzaY3SmzKCrIK6YTtfkUYTxWoZk=
2025-06-28 11:36:46,331 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:36:46,331 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:36:46 GMT
2025-06-28 11:36:46,331 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:36:46,331 - websockets.server - INFO - connection open
2025-06-28 11:36:46,331 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:36:46,331 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 63464)
2025-06-28 11:36:46,332 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "9f5a1a...onnection_params": {}}}' [2313 bytes]
2025-06-28 11:36:46,332 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: deepsearch_server (ID: deepsearch)
2025-06-28 11:36:46,332 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: deepsearch_server
2025-06-28 11:36:46,332 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: deepsearch -> ws://localhost:8086/mcp
2025-06-28 11:36:46,332 - core.toolscore.core_manager - INFO - 工具立即可用: deepsearch
2025-06-28 11:36:46,332 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 11:36:46,333 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:36:46,333 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 11:36:46,333 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:36:46,333 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 11:36:46,334 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 11:36:46,334 - websockets.server - INFO - connection closed
2025-06-28 11:36:46,563 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 11:36:46,566 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:36:46,567 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:36:46,567 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:36:46,567 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:36:46,567 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:36:46,567 - websockets.server - DEBUG - < Sec-WebSocket-Key: 872P/1pjlNtPJkjJ3gVCyA==
2025-06-28 11:36:46,567 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:36:46,567 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:36:46,567 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:36:46,568 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:36:46,568 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:36:46,568 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:36:46,568 - websockets.server - DEBUG - > Sec-WebSocket-Accept: WhU43obg5IxT+qGnA8Hgt/9pvJU=
2025-06-28 11:36:46,568 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:36:46,568 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:36:46 GMT
2025-06-28 11:36:46,568 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:36:46,568 - websockets.server - INFO - connection open
2025-06-28 11:36:46,568 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:36:46,568 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 63466)
2025-06-28 11:36:46,569 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 11:36:46,569 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "6a7c9f09-d0ea-4a6b-831d-bd4600ed88c4", "tool_spec": {"tool_id": "browser_use", "name": "browser_use_server", "description": "\u57fa\u4e8eBrowser-Use\u7684AI\u6d4f\u89c8\u5668\u81ea\u52a8\u5316\u670d\u52a1\u5668\uff0c\u5b8c\u6574\u5b9e\u73b0browser-use\u7684\u6240\u6709\u529f\u80fd", "tool_type": "mcp_server", "capabilities": [{"name": "browser_use_execute_task", "description": "\u4f7f\u7528AI\u6267\u884c\u590d\u6742\u7684\u6d4f\u89c8\u5668\u4efb\u52a1\uff0c\u652f\u6301\u81ea\u7136\u8bed\u8a00\u63cf\u8ff0", "parameters": {"task": {"type": "string", "description": "\u8981\u6267\u884c\u7684\u4efb\u52a1\u63cf\u8ff0\uff0c\u4f7f\u7528\u81ea\u7136\u8bed\u8a00", "required": true}, "max_steps": {"type": "integer", "description": "\u6700\u5927\u6267\u884c\u6b65\u9aa4\u6570\uff0c\u9ed8\u8ba450", "required": false}, "use_vision": {"type": "boolean", "description": "\u662f\u5426\u4f7f\u7528\u89c6\u89c9\u7406\u89e3\uff0c\u9ed8\u8ba4true", "required": false}}, "examples": [{"task": "\u641c\u7d22Python\u6559\u7a0b\u5e76\u6253\u5f00\u7b2c\u4e00\u4e2a\u7ed3\u679c"}, {"task": "\u5728GitHub\u4e0a\u641c\u7d22browser-use\u9879\u76ee\u5e76\u67e5\u770bREADME"}, {"task": "\u767b\u5f55\u7f51\u7ad9\u5e76\u586b\u5199\u8868\u5355", "use_vision": true}], "category": "general"}, {"name": "browser_navigate", "description": "\u5bfc\u822a\u5230\u6307\u5b9a\u7f51\u5740", "parameters": {"url": {"type": "string", "description": "\u8981\u8bbf\u95ee\u7684URL\u5730\u5740", "required": true}}, "examples": [{"url": "https://www.google.com"}, {"url": "https://github.com"}], "category": "general"}, {"name": "browser_search_google", "description": "\u5728Google\u4e2d\u641c\u7d22\u6307\u5b9a\u67e5\u8be2", "parameters": {"query": {"type": "string", "description": "\u641c\u7d22\u67e5\u8be2\u8bcd", "required": true}}, "examples": [{"query": "Python machine learning tutorial"}, {"query": "browser automation tools"}], "category": "general"}, {"name": "browser_go_back", "description": "\u8fd4\u56de\u4e0a\u4e00\u9875", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_click_element", "description": "\u901a\u8fc7\u7d22\u5f15\u70b9\u51fb\u9875\u9762\u5143\u7d20", "parameters": {"index": {"type": "integer", "description": "\u8981\u70b9\u51fb\u7684\u5143\u7d20\u7d22\u5f15", "required": true}}, "examples": [{"index": 1}, {"index": 5}], "category": "general"}, {"name": "browser_input_text", "description": "\u5728\u6307\u5b9a\u5143\u7d20\u4e2d\u8f93\u5165\u6587\u672c", "parameters": {"index": {"type": "integer", "description": "\u8981\u8f93\u5165\u6587\u672c\u7684\u5143\u7d20\u7d22\u5f15", "required": true}, "text": {"type": "string", "description": "\u8981\u8f93\u5165\u7684\u6587\u672c", "required": true}}, "examples": [{"index": 2, "text": "hello world"}, {"index": 0, "text": "test@example.com"}], "category": "general"}, {"name": "browser_send_keys", "description": "\u53d1\u9001\u7279\u6b8a\u952e\u6216\u5feb\u6377\u952e", "parameters": {"keys": {"type": "string", "description": "\u8981\u53d1\u9001\u7684\u952e\uff0c\u5982Enter\u3001Escape\u3001Control+c\u7b49", "required": true}}, "examples": [{"keys": "Enter"}, {"keys": "Control+c"}, {"keys": "Escape"}], "category": "general"}, {"name": "browser_scroll_down", "description": "\u5411\u4e0b\u6eda\u52a8\u9875\u9762", "parameters": {"amount": {"type": "integer", "description": "\u6eda\u52a8\u50cf\u7d20\u6570\uff0c\u4e0d\u6307\u5b9a\u5219\u6eda\u52a8\u4e00\u9875", "required": false}}, "examples": [{}, {"amount": 500}], "category": "general"}, {"name": "browser_scroll_up", "description": "\u5411\u4e0a\u6eda\u52a8\u9875\u9762", "parameters": {"amount": {"type": "integer", "description": "\u6eda\u52a8\u50cf\u7d20\u6570\uff0c\u4e0d\u6307\u5b9a\u5219\u6eda\u52a8\u4e00\u9875", "required": false}}, "examples": [{}, {"amount": 300}], "category": "general"}, {"name": "browser_scroll_to_text", "description": "\u6eda\u52a8\u5230\u5305\u542b\u6307\u5b9a\u6587\u672c\u7684\u5143\u7d20", "parameters": {"text": {"type": "string", "description": "\u8981\u6eda\u52a8\u5230\u7684\u6587\u672c\u5185\u5bb9", "required": true}}, "examples": [{"text": "Sign up"}, {"text": "Contact us"}], "category": "general"}, {"name": "browser_switch_tab", "description": "\u5207\u6362\u5230\u6307\u5b9a\u6807\u7b7e", "parameters": {"page_id": {"type": "integer", "description": "\u8981\u5207\u6362\u5230\u7684\u6807\u7b7eID", "required": true}}, "examples": [{"page_id": 0}, {"page_id": 1}], "category": "general"}, {"name": "browser_open_tab", "description": "\u5728\u65b0\u6807\u7b7e\u4e2d\u6253\u5f00URL", "parameters": {"url": {"type": "string", "description": "\u8981\u5728\u65b0\u6807\u7b7e\u4e2d\u6253\u5f00\u7684URL", "required": true}}, "examples": [{"url": "https://www.example.com"}], "category": "general"}, {"name": "browser_close_tab", "description": "\u5173\u95ed\u6307\u5b9a\u6807\u7b7e", "parameters": {"page_id": {"type": "integer", "description": "\u8981\u5173\u95ed\u7684\u6807\u7b7eID", "required": true}}, "examples": [{"page_id": 1}], "category": "general"}, {"name": "browser_extract_content", "description": "\u4ece\u9875\u9762\u63d0\u53d6\u7279\u5b9a\u5185\u5bb9", "parameters": {"goal": {"type": "string", "description": "\u63d0\u53d6\u76ee\u6807\u63cf\u8ff0", "required": true}, "include_links": {"type": "boolean", "description": "\u662f\u5426\u5305\u542b\u94fe\u63a5\uff0c\u9ed8\u8ba4false", "required": false}}, "examples": [{"goal": "\u63d0\u53d6\u6240\u6709\u516c\u53f8\u540d\u79f0"}, {"goal": "\u83b7\u53d6\u4ea7\u54c1\u4ef7\u683c\u4fe1\u606f", "include_links": true}], "category": "general"}, {"name": "browser_get_content", "description": "\u83b7\u53d6\u9875\u9762\u5185\u5bb9", "parameters": {"selector": {"type": "string", "description": "CSS\u9009\u62e9\u5668\uff0c\u7a7a\u5219\u83b7\u53d6\u5168\u90e8\u5185\u5bb9", "required": false}}, "examples": [{"selector": "h1, p"}, {}], "category": "general"}, {"name": "browser_get_ax_tree", "description": "\u83b7\u53d6\u9875\u9762\u7684\u53ef\u8bbf\u95ee\u6027\u6811\u7ed3\u6784", "parameters": {"number_of_elements": {"type": "integer", "description": "\u8fd4\u56de\u7684\u5143\u7d20\u6570\u91cf", "required": true}}, "examples": [{"number_of_elements": 50}], "category": "general"}, {"name": "browser_get_dropdown_options", "description": "\u83b7\u53d6\u4e0b\u62c9\u83dc\u5355\u7684\u6240\u6709\u9009\u9879", "parameters": {"index": {"type": "integer", "description": "\u4e0b\u62c9\u83dc\u5355\u5143\u7d20\u7684\u7d22\u5f15", "required": true}}, "examples": [{"index": 3}], "category": "general"}, {"name": "browser_select_dropdown_option", "description": "\u9009\u62e9\u4e0b\u62c9\u83dc\u5355\u4e2d\u7684\u9009\u9879", "parameters": {"index": {"type": "integer", "description": "\u4e0b\u62c9\u83dc\u5355\u5143\u7d20\u7684\u7d22\u5f15", "required": true}, "text": {"type": "string", "description": "\u8981\u9009\u62e9\u7684\u9009\u9879\u6587\u672c", "required": true}}, "examples": [{"index": 3, "text": "Option 1"}], "category": "general"}, {"name": "browser_drag_drop", "description": "\u6267\u884c\u62d6\u62fd\u64cd\u4f5c", "parameters": {"element_source": {"type": "string", "description": "\u6e90\u5143\u7d20\u9009\u62e9\u5668", "required": false}, "element_target": {"type": "string", "description": "\u76ee\u6807\u5143\u7d20\u9009\u62e9\u5668", "required": false}, "coord_source_x": {"type": "integer", "description": "\u6e90\u5750\u6807X", "required": false}, "coord_source_y": {"type": "integer", "description": "\u6e90\u5750\u6807Y", "required": false}, "coord_target_x": {"type": "integer", "description": "\u76ee\u6807\u5750\u6807X", "required": false}, "coord_target_y": {"type": "integer", "description": "\u76ee\u6807\u5750\u6807Y", "required": false}, "steps": {"type": "integer", "description": "\u62d6\u62fd\u6b65\u9aa4\u6570\uff0c\u9ed8\u8ba410", "required": false}}, "examples": [{"element_source": ".item1", "element_target": ".dropzone"}], "category": "general"}, {"name": "browser_save_pdf", "description": "\u5c06\u5f53\u524d\u9875\u9762\u4fdd\u5b58\u4e3aPDF", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_screenshot", "description": "\u622a\u53d6\u5f53\u524d\u9875\u9762\u622a\u56fe", "parameters": {"filename": {"type": "string", "description": "\u622a\u56fe\u6587\u4ef6\u540d\uff0c\u53ef\u9009", "required": false}}, "examples": [{"filename": "current_page.png"}, {}], "category": "general"}, {"name": "browser_wait", "description": "\u7b49\u5f85\u6307\u5b9a\u79d2\u6570", "parameters": {"seconds": {"type": "number", "description": "\u7b49\u5f85\u7684\u79d2\u6570\uff0c\u9ed8\u8ba43", "required": false}}, "examples": [{"seconds": 5}, {}], "category": "general"}, {"name": "browser_done", "description": "\u6807\u8bb0\u4efb\u52a1\u5b8c\u6210", "parameters": {"text": {"type": "string", "description": "\u5b8c\u6210\u63cf\u8ff0", "required": true}, "success": {"type": "boolean", "description": "\u662f\u5426\u6210\u529f\u5b8c\u6210", "required": true}}, "examples": [{"text": "\u4efb\u52a1\u5df2\u5b8c\u6210", "success": true}], "category": "general"}, {"name": "browser_get_page_info", "description": "\u83b7\u53d6\u5f53\u524d\u9875\u9762\u4fe1\u606f", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_get_current_url", "description": "\u83b7\u53d6\u5f53\u524d\u9875\u9762URL", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_close_session", "description": "\u5173\u95ed\u6d4f\u89c8\u5668\u4f1a\u8bdd", "parameters": {}, "examples": [{}], "category": "general"}], "endpoint": "ws://localhost:8084", "connection_params": {}}}
2025-06-28 11:36:46,570 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "6a7c9f...onnection_params": {}}}' [9625 bytes]
2025-06-28 11:36:46,570 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Waiting for registration response from toolscore...
2025-06-28 11:36:46,571 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: browser_use_server (ID: browser_use)
2025-06-28 11:36:46,571 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: browser_use_server
2025-06-28 11:36:46,571 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: browser_use -> ws://localhost:8084
2025-06-28 11:36:46,571 - core.toolscore.core_manager - INFO - 工具立即可用: browser_use
2025-06-28 11:36:46,571 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 11:36:46,572 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Received registration response: {"type": "register_tool_response", "request_id": "6a7c9f09-d0ea-4a6b-831d-bd4600ed88c4", "success": true, "message": null}
2025-06-28 11:36:46,572 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Successfully registered with toolscore.
2025-06-28 11:36:46,572 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:36:46,572 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 11:36:46,573 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:36:46,573 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 11:36:46,573 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 11:36:46,574 - websockets.server - INFO - connection closed
2025-06-28 11:36:48,519 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:36:48,519 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:36:51,052 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第4次, 5s间隔)
2025-06-28 11:36:51,521 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:36:51,522 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:36:54,523 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:36:54,523 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:36:56,053 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第5次, 5s间隔)
2025-06-28 11:36:57,525 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:36:57,526 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:37:00,528 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:37:00,528 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:37:01,055 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第6次, 5s间隔)
2025-06-28 11:37:03,530 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:37:03,530 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:37:06,032 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:37:06,042 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:37:06,044 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:37:06,045 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:37:06,052 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:37:06,056 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第7次, 5s间隔)
2025-06-28 11:37:06,532 - services.mcp_server_launcher - DEBUG - ⏱️ microsandbox_server 就绪检测超时 (30秒)
2025-06-28 11:37:06,532 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:37:06,533 - services.mcp_server_launcher - INFO - ✅ 成功启动 4/4 个MCP服务器: ['microsandbox_server', 'search_tool_server', 'browser_use_server', 'deepsearch_server']
2025-06-28 11:37:06,533 - services.service_manager - INFO - 启动服务: task_api
2025-06-28 11:37:06,533 - services.task_api_service - INFO - 正在启动任务API服务...
2025-06-28 11:37:06,555 - services.task_api_service - INFO - 任务API服务已启动于 0.0.0.0:8000
2025-06-28 11:37:06,555 - services.service_manager - INFO - 启动服务: runtime
2025-06-28 11:37:06,555 - services.runtime_service - INFO - 正在启动推理运行时服务...
2025-06-28 11:37:06,555 - services.service_manager - INFO - 启动服务: synthesis
2025-06-28 11:37:06,555 - services.synthesis_service - INFO - 正在启动合成服务...
2025-06-28 11:37:06,555 - services.synthesis_service - INFO - 合成服务工作线程已启动
2025-06-28 11:37:06,556 - services.synthesis_service - INFO - 开始处理轨迹数据...
2025-06-28 11:37:06,556 - services.synthesis_service - INFO - SynthesisCore v2.0监控器工作线程已启动
2025-06-28 11:37:06,556 - services.synthesis_service - INFO - 🚀 启动SynthesisCore v2.0监控器
2025-06-28 11:37:06,556 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:37:06,556 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:37:06,556 - services.synthesis_service - INFO - 合成服务已启动
2025-06-28 11:37:06,556 - core.synthesiscore.synthesis - INFO - 🔄 Processing only unprocessed trajectories...
2025-06-28 11:37:06,557 - services.service_manager - INFO - 所有服务已启动
2025-06-28 11:37:06,558 - __main__ - DEBUG - ✅ 所有服务启动完成
2025-06-28 11:37:06,558 - __main__ - INFO - 🎉 所有服务已启动，系统运行中...
2025-06-28 11:37:06,558 - __main__ - INFO - 📊 系统状态监控已启用，按 Ctrl+C 停止
2025-06-28 11:37:06,558 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:37:06,559 - services.runtime_service - INFO - 启动运行时实例: enhanced-reasoning-1
2025-06-28 11:37:06,559 - core.synthesiscore.synthesis - INFO - 🎯 Unprocessed trajectories completed: 0 new trajectories processed
2025-06-28 11:37:06,559 - runtimes.reasoning.enhanced_runtime - INFO - 🚀 初始化Enhanced Reasoning Runtime - 简化版本
2025-06-28 11:37:06,559 - core.llm.response_parsers.reasoning_response_parser - DEBUG - ✅ 响应解析器已连接工具Schema管理器
2025-06-28 11:37:06,559 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ Redis连接初始化成功
2025-06-28 11:37:06,559 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 工具Schema管理器已注入到响应解析器
2025-06-28 11:37:06,560 - services.synthesis_service - DEBUG - 等待 300 秒后再次处理...
2025-06-28 11:37:06,560 - runtimes.reasoning.enhanced_runtime - INFO - ⏳ 等待ToolScore服务就绪...
2025-06-28 11:37:06,560 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:corpus_queue
2025-06-28 11:37:06,561 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:atomic_tasks
2025-06-28 11:37:06,561 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:extended_tasks
2025-06-28 11:37:06,561 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:verification_queue
2025-06-28 11:37:06,562 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:training_data
2025-06-28 11:37:06,562 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:quality_reports
2025-06-28 11:37:06,563 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:11:37:06 +0800] "GET /health HTTP/1.1" 200 231 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 11:37:06,563 - runtimes.reasoning.toolscore_client - INFO - ✅ ToolScore服务已就绪
2025-06-28 11:37:06,563 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ Redis配置键初始化完成
2025-06-28 11:37:06,563 - runtimes.reasoning.enhanced_runtime - INFO - ✅ ToolScore HTTP服务已就绪
2025-06-28 11:37:06,563 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ 增强合成Redis管理器初始化完成
2025-06-28 11:37:06,563 - runtimes.reasoning.enhanced_runtime - INFO - 🔌 正在连接WebSocket端点: ws://localhost:8081/websocket
2025-06-28 11:37:06,563 - core.synthesiscore.enhanced_synthesis_engine - INFO - ✅ Enhanced Synthesis Engine 初始化完成
2025-06-28 11:37:06,564 - runtimes.reasoning.real_time_tool_client - INFO - 🔌 连接到ToolScore实时更新: ws://localhost:8081/websocket
2025-06-28 11:37:06,564 - core.synthesiscore.enhanced_synthesis_engine - INFO - 🚀 SynthesisCore v2.0 已启动
2025-06-28 11:37:06,565 - core.synthesiscore.trajectory_monitor - INFO - 🔄 检查并处理现有轨迹...
2025-06-28 11:37:06,565 - core.synthesiscore.trajectory_monitor - INFO - 📝 没有现有轨迹文件
2025-06-28 11:37:06,565 - core.synthesiscore.trajectory_monitor - INFO - ✅ TrajectoryMonitor初始化完成
2025-06-28 11:37:06,565 - core.synthesiscore.trajectory_monitor - DEBUG - ✅ 获取主事件循环引用成功
2025-06-28 11:37:06,567 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:37:06,567 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:37:06,567 - core.synthesiscore.trajectory_monitor - INFO - 👁️ 开始监控轨迹文件变化: output/trajectories
2025-06-28 11:37:06,568 - websockets.client - DEBUG - > GET /websocket HTTP/1.1
2025-06-28 11:37:06,568 - services.synthesis_service - INFO - ✅ SynthesisCore v2.0监控器已启动
2025-06-28 11:37:06,568 - websockets.client - DEBUG - > Host: localhost:8081
2025-06-28 11:37:06,569 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:37:06,569 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:37:06,569 - websockets.client - DEBUG - > Sec-WebSocket-Key: CTfr6upewfrB10P5DWryCw==
2025-06-28 11:37:06,569 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:37:06,569 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:37:06,569 - websockets.client - DEBUG - > User-Agent: Enhanced-Reasoning-Runtime/1.0
2025-06-28 11:37:06,569 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
[2025-06-28 11:37:06] [32mINFO[0m:     Started server process [[36m75413[0m]
2025-06-28 11:37:06,569 - websockets.server - DEBUG - < Host: localhost:8081
[2025-06-28 11:37:06] [32mINFO[0m:     Waiting for application startup.
2025-06-28 11:37:06,569 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:37:06,569 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:37:06,570 - websockets.server - DEBUG - < Sec-WebSocket-Key: CTfr6upewfrB10P5DWryCw==
2025-06-28 11:37:06,570 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:37:06,570 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:37:06,570 - websockets.server - DEBUG - < User-Agent: Enhanced-Reasoning-Runtime/1.0
2025-06-28 11:37:06,570 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:37:06,570 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:37:06,570 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:37:06,570 - websockets.server - DEBUG - > Sec-WebSocket-Accept: MKGJ2/5buBzqUrbDenzRhllW1io=
2025-06-28 11:37:06,570 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:37:06,570 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:37:06 GMT
2025-06-28 11:37:06,570 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:37:06,570 - websockets.server - INFO - connection open
2025-06-28 11:37:06,571 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:37:06,571 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:37:06,571 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:37:06,571 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 63516)
2025-06-28 11:37:06,571 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:37:06,571 - websockets.client - DEBUG - < Sec-WebSocket-Accept: MKGJ2/5buBzqUrbDenzRhllW1io=
2025-06-28 11:37:06,571 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:37:06,571 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:37:06 GMT
2025-06-28 11:37:06,571 - core.task_api - INFO - Connected to Redis: redis://localhost:6379
2025-06-28 11:37:06,571 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
[2025-06-28 11:37:06] [32mINFO[0m:     Application startup complete.
2025-06-28 11:37:06,571 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:37:06,571 - runtimes.reasoning.real_time_tool_client - INFO - ✅ 已连接到ToolScore实时更新流
2025-06-28 11:37:06,571 - runtimes.reasoning.enhanced_runtime - INFO - ✅ WebSocket实时更新连接成功
2025-06-28 11:37:06,571 - runtimes.reasoning.real_time_tool_client - DEBUG - 已注册工具更新回调，当前回调数量: 1
2025-06-28 11:37:06,571 - runtimes.reasoning.enhanced_runtime - INFO - ⏳ 等待关键工具完全就绪...
2025-06-28 11:37:06,571 - runtimes.reasoning.enhanced_runtime - WARNING - 🚀 临时跳过详细工具等待，快速启动模式
2025-06-28 11:37:06,572 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 使用快速启动模式，工具将在后台异步就绪
2025-06-28 11:37:06,572 - runtimes.reasoning.enhanced_runtime - INFO - 🔍 开始MCP服务器同步验证...
2025-06-28 11:37:06,572 - core.tool_schema_manager - INFO - 正在执行MCP同步验证...
2025-06-28 11:37:06,572 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=False)，当前缓存: 0 个工具
2025-06-28 11:37:06,572 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 11:37:06,572 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
[2025-06-28 11:37:06] [32mINFO[0m:     Uvicorn running on [1mhttp://0.0.0.0:8000[0m (Press CTRL+C to quit)
2025-06-28 11:37:06,572 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 11:37:06,572 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
2025-06-28 11:37:06,573 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
2025-06-28 11:37:06,573 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 11:37:06,573 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 11:37:06,573 - core.tool_schema_manager - INFO - 🔄 检测到 4 个工具需要更新: ['deepsearch', 'microsandbox', 'browser_use', 'mcp-search-tool']
2025-06-28 11:37:06,573 - core.tool_schema_manager - INFO - 🔄 执行增量更新: 4 个工具
2025-06-28 11:37:06,573 - core.tool_schema_manager - INFO - 🔄 缓存为空，转为全量刷新模式
2025-06-28 11:37:06,573 - core.tool_schema_manager - DEBUG - 🔄 开始增强刷新工具Schemas...
2025-06-28 11:37:06,573 - core.tool_schema_manager - DEBUG - 🔍 工具注册表状态检查: _tools 字典包含 4 个条目
2025-06-28 11:37:06,573 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: deepsearch
2025-06-28 11:37:06,573 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: microsandbox
2025-06-28 11:37:06,573 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: browser_use
2025-06-28 11:37:06,573 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: mcp-search-tool
2025-06-28 11:37:06,573 - core.tool_schema_manager - INFO - 🔧 选项1: 从工具注册表获取到 4 个工具
2025-06-28 11:37:06,573 - core.tool_schema_manager - DEBUG -   工具 0: id=deepsearch, name=网络信息研究工具, actions=3
2025-06-28 11:37:06,573 - core.tool_schema_manager - DEBUG -   工具 1: id=microsandbox, name=MicroSandbox安全代码执行器, actions=7
2025-06-28 11:37:06,573 - core.tool_schema_manager - DEBUG -   工具 2: id=browser_use, name=智能浏览器操作工具, actions=6
2025-06-28 11:37:06,573 - core.tool_schema_manager - DEBUG -   工具 3: id=mcp-search-tool, name=工具管理和项目文件搜索器, actions=4
2025-06-28 11:37:06,573 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: deepsearch
2025-06-28 11:37:06,574 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: comprehensive_research
2025-06-28 11:37:06,574 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: quick_research
2025-06-28 11:37:06,575 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: research
2025-06-28 11:37:06,575 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 deepsearch (包含 3 个动作)
2025-06-28 11:37:06,575 - core.tool_schema_manager - DEBUG -    当前缓存大小: 1 个工具
2025-06-28 11:37:06,575 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: microsandbox
2025-06-28 11:37:06,575 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_cleanup_expired
2025-06-28 11:37:06,575 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_close_session
2025-06-28 11:37:06,576 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_execute
2025-06-28 11:37:06,576 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_health_status
2025-06-28 11:37:06,576 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_performance_stats
2025-06-28 11:37:06,576 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_install_package
2025-06-28 11:37:06,576 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_list_sessions
2025-06-28 11:37:06,576 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 microsandbox (包含 7 个动作)
2025-06-28 11:37:06,576 - core.tool_schema_manager - DEBUG -    当前缓存大小: 2 个工具
2025-06-28 11:37:06,576 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: browser_use
2025-06-28 11:37:06,576 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_click_element
2025-06-28 11:37:06,577 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_use_execute_task
2025-06-28 11:37:06,577 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_extract_content
2025-06-28 11:37:06,577 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_input_text
2025-06-28 11:37:06,577 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_navigate
2025-06-28 11:37:06,577 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_search_google
2025-06-28 11:37:06,577 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 browser_use (包含 6 个动作)
2025-06-28 11:37:06,577 - core.tool_schema_manager - DEBUG -    当前缓存大小: 3 个工具
2025-06-28 11:37:06,577 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: mcp-search-tool
2025-06-28 11:37:06,578 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: analyze_tool_needs
2025-06-28 11:37:06,578 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: list_code_definitions
2025-06-28 11:37:06,578 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_and_install_tools
2025-06-28 11:37:06,578 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_file_content
2025-06-28 11:37:06,578 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 mcp-search-tool (包含 4 个动作)
2025-06-28 11:37:06,578 - core.tool_schema_manager - DEBUG -    当前缓存大小: 4 个工具
2025-06-28 11:37:06,578 - core.tool_schema_manager - INFO - 🔧 选项1: 成功处理 4/4 个工具，当前缓存 4 个工具
2025-06-28 11:37:06,578 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: mcp-search-tool
2025-06-28 11:37:06,579 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: microsandbox
2025-06-28 11:37:06,579 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: browser_use
2025-06-28 11:37:06,579 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: deepsearch
2025-06-28 11:37:06,579 - core.tool_schema_manager - INFO - ✅ 增强刷新完成，当前可用工具: 4个
2025-06-28 11:37:06,580 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:37:06,580 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:37:06,580 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:37:06,581 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:37:06,581 - core.tool_schema_manager - INFO - ✅ Schema安全刷新完成，备份 4 个工具
2025-06-28 11:37:06,581 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:37:06,581 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:37:06,582 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:37:06,582 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:37:06,582 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 11:37:06,582 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 11:37:06,582 - core.tool_schema_manager - INFO - 🔍 同步验证完成: unhealthy (0/4 工具Schema一致)
2025-06-28 11:37:06,582 - runtimes.reasoning.enhanced_runtime - ERROR - ❌ MCP服务器同步验证失败: 未知错误
2025-06-28 11:37:06,582 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔧 开始获取可用工具ID列表...
2025-06-28 11:37:06,582 - runtimes.reasoning.real_time_tool_client - DEBUG - 可用工具ID列表: ['browser_use', 'deepsearch', 'microsandbox', 'mcp-search-tool']
2025-06-28 11:37:06,582 - runtimes.reasoning.enhanced_runtime - DEBUG - 📋 获取到的工具列表: ['browser_use', 'deepsearch', 'microsandbox', 'mcp-search-tool']
2025-06-28 11:37:06,582 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 工具Schema管理器已初始化
2025-06-28 11:37:06,582 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔧 更新Guardrails和ValidationCritic工具配置...
2025-06-28 11:37:06,582 - core.llm.guardrails_middleware - INFO - 🔧 初始化输入验证Guard...
2025-06-28 11:37:06,584 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:37:06,585 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:37:06,585 - core.llm.guardrails_middleware - INFO - 🔧 初始化输出验证Guard...
2025-06-28 11:37:06,585 - core.llm.guardrails_middleware - INFO - 🔧 使用本地LLM客户端初始化Guard...
2025-06-28 11:37:06,587 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:37:06,587 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:37:06,587 - core.llm.guardrails_middleware - INFO - ✅ 使用LLM的Guard创建成功
2025-06-28 11:37:06,587 - core.llm.guardrails_middleware - INFO - ✅ Guardrails Guards初始化成功
2025-06-28 11:37:06,587 - core.llm.guardrails_middleware - INFO -    - 输入Guard: ✅
2025-06-28 11:37:06,587 - core.llm.guardrails_middleware - INFO -    - 输出Guard: ✅
2025-06-28 11:37:06,587 - core.llm.guardrails_middleware - INFO - 🔄 Guardrails工具列表已更新: 4个工具
2025-06-28 11:37:06,587 - core.agents.validation_critic - INFO - 🔄 ValidationCritic工具列表已更新: 4个工具
2025-06-28 11:37:06,587 - runtimes.reasoning.enhanced_runtime - INFO - ✅ Guardrails和ValidationCritic已配置4个工具: browser_use, deepsearch, microsandbox, mcp-search-tool
2025-06-28 11:37:06,587 - runtimes.reasoning.enhanced_runtime - INFO - ✅ Enhanced Reasoning Runtime 已成功初始化为纯推理引擎（集成Guardrails + ValidationCritic）
2025-06-28 11:37:06,588 - services.runtime_service - INFO - 启动运行时任务消费: enhanced-reasoning-1
2025-06-28 11:37:06,588 - services.runtime_service - INFO - 推理运行时服务已启动 1 个实例和 1 个任务消费协程
2025-06-28 11:37:06,588 - core.tool_schema_manager - INFO - 🔍 启动MCP服务器配置监控...
2025-06-28 11:37:06,588 - core.task_manager - INFO - Runtime enhanced-reasoning-1 starting to consume from queue: tasks:reasoning
2025-06-28 11:37:06,589 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/search_tool_server/service.json
2025-06-28 11:37:06,589 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/microsandbox_server/service.json
2025-06-28 11:37:06,589 - core.task_manager - INFO - Runtime enhanced-reasoning-1 starting consumer loop for queue tasks:reasoning
2025-06-28 11:37:06,590 - core.task_manager - DEBUG - Runtime enhanced-reasoning-1 reading from queue tasks:reasoning...
2025-06-28 11:37:06,590 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/browser_use_server/service.json
2025-06-28 11:37:06,590 - core.task_manager - INFO - Runtime enhanced-reasoning-1 received 1 message(s) from queue tasks:reasoning
2025-06-28 11:37:06,590 - core.task_manager - INFO - Runtime enhanced-reasoning-1 processing message b'1751038503472-1'
2025-06-28 11:37:06,590 - core.task_manager - INFO - Processing task 509df6d8-87fd-4204-a645-94b7dc6fb43e from queue tasks:reasoning
2025-06-28 11:37:06,590 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/deepsearch_server/service.json
2025-06-28 11:37:06,590 - core.tool_schema_manager - INFO - 🔄 MCP配置变化，强制刷新schema...
2025-06-28 11:37:06,590 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=True)，当前缓存: 0 个工具
2025-06-28 11:37:06,590 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 11:37:06,590 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
2025-06-28 11:37:06,590 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 11:37:06,590 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
2025-06-28 11:37:06,590 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
2025-06-28 11:37:06,590 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 11:37:06,590 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 11:37:06,591 - core.tool_schema_manager - INFO - 🔄 检测到 4 个工具需要更新: ['deepsearch', 'microsandbox', 'browser_use', 'mcp-search-tool']
2025-06-28 11:37:06,591 - core.tool_schema_manager - INFO - 🔄 执行增量更新: 4 个工具
2025-06-28 11:37:06,591 - core.tool_schema_manager - INFO - 🔄 缓存为空，转为全量刷新模式
2025-06-28 11:37:06,591 - core.tool_schema_manager - DEBUG - 🔄 开始增强刷新工具Schemas...
2025-06-28 11:37:06,591 - core.tool_schema_manager - DEBUG - 🔍 工具注册表状态检查: _tools 字典包含 4 个条目
2025-06-28 11:37:06,591 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: deepsearch
2025-06-28 11:37:06,591 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: microsandbox
2025-06-28 11:37:06,591 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: browser_use
2025-06-28 11:37:06,591 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: mcp-search-tool
2025-06-28 11:37:06,591 - core.tool_schema_manager - INFO - 🔧 选项1: 从工具注册表获取到 4 个工具
2025-06-28 11:37:06,591 - core.tool_schema_manager - DEBUG -   工具 0: id=deepsearch, name=网络信息研究工具, actions=3
2025-06-28 11:37:06,591 - core.tool_schema_manager - DEBUG -   工具 1: id=microsandbox, name=MicroSandbox安全代码执行器, actions=7
2025-06-28 11:37:06,591 - core.tool_schema_manager - DEBUG -   工具 2: id=browser_use, name=智能浏览器操作工具, actions=6
2025-06-28 11:37:06,591 - core.tool_schema_manager - DEBUG -   工具 3: id=mcp-search-tool, name=工具管理和项目文件搜索器, actions=4
2025-06-28 11:37:06,591 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: deepsearch
2025-06-28 11:37:06,591 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: comprehensive_research
2025-06-28 11:37:06,592 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: quick_research
2025-06-28 11:37:06,592 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: research
2025-06-28 11:37:06,592 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 deepsearch (包含 3 个动作)
2025-06-28 11:37:06,592 - core.tool_schema_manager - DEBUG -    当前缓存大小: 1 个工具
2025-06-28 11:37:06,592 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: microsandbox
2025-06-28 11:37:06,592 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_cleanup_expired
2025-06-28 11:37:06,592 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_close_session
2025-06-28 11:37:06,593 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_execute
2025-06-28 11:37:06,593 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_health_status
2025-06-28 11:37:06,593 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_performance_stats
2025-06-28 11:37:06,593 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_install_package
2025-06-28 11:37:06,593 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_list_sessions
2025-06-28 11:37:06,593 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 microsandbox (包含 7 个动作)
2025-06-28 11:37:06,593 - core.tool_schema_manager - DEBUG -    当前缓存大小: 2 个工具
2025-06-28 11:37:06,593 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: browser_use
2025-06-28 11:37:06,593 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_click_element
2025-06-28 11:37:06,593 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_use_execute_task
2025-06-28 11:37:06,594 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_extract_content
2025-06-28 11:37:06,594 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_input_text
2025-06-28 11:37:06,594 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_navigate
2025-06-28 11:37:06,594 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_search_google
2025-06-28 11:37:06,594 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 browser_use (包含 6 个动作)
2025-06-28 11:37:06,594 - core.tool_schema_manager - DEBUG -    当前缓存大小: 3 个工具
2025-06-28 11:37:06,594 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: mcp-search-tool
2025-06-28 11:37:06,594 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: analyze_tool_needs
2025-06-28 11:37:06,594 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: list_code_definitions
2025-06-28 11:37:06,594 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_and_install_tools
2025-06-28 11:37:06,595 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_file_content
2025-06-28 11:37:06,595 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 mcp-search-tool (包含 4 个动作)
2025-06-28 11:37:06,595 - core.tool_schema_manager - DEBUG -    当前缓存大小: 4 个工具
2025-06-28 11:37:06,595 - core.tool_schema_manager - INFO - 🔧 选项1: 成功处理 4/4 个工具，当前缓存 4 个工具
2025-06-28 11:37:06,595 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: mcp-search-tool
2025-06-28 11:37:06,595 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: microsandbox
2025-06-28 11:37:06,595 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-48' coro=<start.<locals>.start_all_runtimes() running at /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/services/runtime_service.py:94> wait_for=<_GatheringFuture pending cb=[Task.task_wakeup()]>>
2025-06-28 11:37:06,595 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='runtime-enhanced-reasoning-1' coro=<start_runtime_service() running at /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/core/task_manager.py:388> wait_for=<Future pending cb=[Task.task_wakeup()]> cb=[gather.<locals>._done_callback() at /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/tasks.py:764]>
2025-06-28 11:37:06,596 - core.task_manager - ERROR - ❌ Runtime enhanced-reasoning-1 crashed: coroutine ignored GeneratorExit
Traceback (most recent call last):
  File "/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/core/task_manager.py", line 388, in start_runtime_service
    await _run_service()
RuntimeError: coroutine ignored GeneratorExit
[2025-06-28 11:37:06] Exception ignored in: [2025-06-28 11:37:06] <coroutine object start_runtime_service at 0x10fed4680>
[2025-06-28 11:37:06] Traceback (most recent call last):
[2025-06-28 11:37:06]   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/decoder.py", line 353, in raw_decode
    [2025-06-28 11:37:06] obj, end = self.scan_once(s, idx)
               [2025-06-28 11:37:06] ^[2025-06-28 11:37:06] ^[2025-06-28 11:37:06] ^[2025-06-28 11:37:06] ^[2025-06-28 11:37:06] ^[2025-06-28 11:37:06] ^[2025-06-28 11:37:06] ^[2025-06-28 11:37:06] ^[2025-06-28 11:37:06] ^[2025-06-28 11:37:06] ^[2025-06-28 11:37:06] ^[2025-06-28 11:37:06] ^[2025-06-28 11:37:06] ^[2025-06-28 11:37:06] ^[2025-06-28 11:37:06] ^[2025-06-28 11:37:06] ^[2025-06-28 11:37:06] ^[2025-06-28 11:37:06] ^[2025-06-28 11:37:06] ^[2025-06-28 11:37:06] ^[2025-06-28 11:37:06] ^[2025-06-28 11:37:06] ^
[2025-06-28 11:37:06] RuntimeError[2025-06-28 11:37:06] : [2025-06-28 11:37:06] coroutine ignored GeneratorExit
2025-06-28 11:37:06,597 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: browser_use
2025-06-28 11:37:06,597 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: deepsearch
2025-06-28 11:37:06,597 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:11:37:06 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 11:37:06,597 - core.tool_schema_manager - DEBUG - 🔍 从ToolScore获取到工具列表: ['mcp-search-tool', 'microsandbox', 'browser_use', 'deepsearch']
2025-06-28 11:37:06,597 - core.tool_schema_manager - DEBUG - 🔧 映射后的工具列表: ['mcp-search-tool', 'microsandbox', 'browser_use', 'deepsearch']
2025-06-28 11:37:06,597 - core.tool_schema_manager - DEBUG - ⏭️ 工具 mcp-search-tool 已在缓存中，跳过ToolScore获取
2025-06-28 11:37:06,597 - core.tool_schema_manager - DEBUG - ⏭️ 工具 microsandbox 已在缓存中，跳过ToolScore获取
2025-06-28 11:37:06,597 - core.tool_schema_manager - DEBUG - ⏭️ 工具 browser_use 已在缓存中，跳过ToolScore获取
2025-06-28 11:37:06,597 - core.tool_schema_manager - DEBUG - ⏭️ 工具 deepsearch 已在缓存中，跳过ToolScore获取
2025-06-28 11:37:06,597 - core.tool_schema_manager - INFO - ✅ 增强刷新完成，当前可用工具: 4个
2025-06-28 11:37:06,598 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:37:06,598 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:37:06,598 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:37:06,598 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:37:06,599 - core.tool_schema_manager - INFO - ✅ Schema安全刷新完成，备份 4 个工具
2025-06-28 11:37:06,599 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:37:06,599 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:37:06,599 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:37:06,600 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:37:06,600 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 11:37:06,600 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 11:37:11,057 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第8次, 5s间隔)
2025-06-28 11:37:16,059 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第9次, 5s间隔)
2025-06-28 11:37:21,061 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第10次, 5s间隔)
2025-06-28 11:37:26,063 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第11次, 5s间隔)
2025-06-28 11:37:26,580 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:37:26,581 - websockets.client - DEBUG - > PING 36 f0 b0 ea [binary, 4 bytes]
2025-06-28 11:37:26,582 - websockets.server - DEBUG - < PING 36 f0 b0 ea [binary, 4 bytes]
2025-06-28 11:37:26,582 - websockets.server - DEBUG - > PONG 36 f0 b0 ea [binary, 4 bytes]
2025-06-28 11:37:26,582 - websockets.client - DEBUG - < PONG 36 f0 b0 ea [binary, 4 bytes]
2025-06-28 11:37:26,582 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:37:31,064 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第12次, 5s间隔)
2025-06-28 11:37:36,037 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:37:36,043 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:37:36,044 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:37:36,044 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:37:36,054 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:37:36,065 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第13次, 30s间隔)
2025-06-28 11:37:36,572 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:37:36,572 - websockets.server - DEBUG - > PING c1 56 6e 61 [binary, 4 bytes]
2025-06-28 11:37:36,573 - websockets.client - DEBUG - < PING c1 56 6e 61 [binary, 4 bytes]
2025-06-28 11:37:36,573 - websockets.client - DEBUG - > PONG c1 56 6e 61 [binary, 4 bytes]
2025-06-28 11:37:36,573 - websockets.server - DEBUG - < PONG c1 56 6e 61 [binary, 4 bytes]
2025-06-28 11:37:36,573 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:37:46,584 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:37:46,584 - websockets.client - DEBUG - > PING 68 93 da f1 [binary, 4 bytes]
2025-06-28 11:37:46,585 - websockets.server - DEBUG - < PING 68 93 da f1 [binary, 4 bytes]
2025-06-28 11:37:46,585 - websockets.server - DEBUG - > PONG 68 93 da f1 [binary, 4 bytes]
2025-06-28 11:37:46,585 - websockets.client - DEBUG - < PONG 68 93 da f1 [binary, 4 bytes]
2025-06-28 11:37:46,585 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:38:06,043 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:38:06,049 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:38:06,050 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:38:06,051 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:38:06,060 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:38:06,066 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第14次, 30s间隔)
2025-06-28 11:38:06,559 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 1m 0s
2025-06-28 11:38:06,574 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:38:06,575 - websockets.server - DEBUG - > PING d9 b2 b0 24 [binary, 4 bytes]
2025-06-28 11:38:06,575 - websockets.client - DEBUG - < PING d9 b2 b0 24 [binary, 4 bytes]
2025-06-28 11:38:06,575 - websockets.client - DEBUG - > PONG d9 b2 b0 24 [binary, 4 bytes]
2025-06-28 11:38:06,576 - websockets.server - DEBUG - < PONG d9 b2 b0 24 [binary, 4 bytes]
2025-06-28 11:38:06,576 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:38:06,586 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:38:06,587 - websockets.client - DEBUG - > PING c0 c8 90 91 [binary, 4 bytes]
2025-06-28 11:38:06,587 - websockets.server - DEBUG - < PING c0 c8 90 91 [binary, 4 bytes]
2025-06-28 11:38:06,587 - websockets.server - DEBUG - > PONG c0 c8 90 91 [binary, 4 bytes]
2025-06-28 11:38:06,587 - websockets.client - DEBUG - < PONG c0 c8 90 91 [binary, 4 bytes]
2025-06-28 11:38:06,588 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:38:26,589 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:38:26,590 - websockets.client - DEBUG - > PING 11 f5 f2 62 [binary, 4 bytes]
2025-06-28 11:38:26,590 - websockets.server - DEBUG - < PING 11 f5 f2 62 [binary, 4 bytes]
2025-06-28 11:38:26,590 - websockets.server - DEBUG - > PONG 11 f5 f2 62 [binary, 4 bytes]
2025-06-28 11:38:26,591 - websockets.client - DEBUG - < PONG 11 f5 f2 62 [binary, 4 bytes]
2025-06-28 11:38:26,591 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:38:36,049 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:38:36,055 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:38:36,055 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:38:36,055 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:38:36,066 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:38:36,066 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第15次, 30s间隔)
2025-06-28 11:38:36,577 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:38:36,577 - websockets.server - DEBUG - > PING 34 1b e6 57 [binary, 4 bytes]
2025-06-28 11:38:36,578 - websockets.client - DEBUG - < PING 34 1b e6 57 [binary, 4 bytes]
2025-06-28 11:38:36,578 - websockets.client - DEBUG - > PONG 34 1b e6 57 [binary, 4 bytes]
2025-06-28 11:38:36,579 - websockets.server - DEBUG - < PONG 34 1b e6 57 [binary, 4 bytes]
2025-06-28 11:38:36,579 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:38:46,592 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:38:46,592 - websockets.client - DEBUG - > PING 59 55 b7 9c [binary, 4 bytes]
2025-06-28 11:38:46,593 - websockets.server - DEBUG - < PING 59 55 b7 9c [binary, 4 bytes]
2025-06-28 11:38:46,593 - websockets.server - DEBUG - > PONG 59 55 b7 9c [binary, 4 bytes]
2025-06-28 11:38:46,593 - websockets.client - DEBUG - < PONG 59 55 b7 9c [binary, 4 bytes]
2025-06-28 11:38:46,593 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:39:06,055 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:39:06,060 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:39:06,063 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:39:06,063 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:39:06,067 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第16次, 30s间隔)
2025-06-28 11:39:06,068 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:39:06,560 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 2m 0s
2025-06-28 11:39:06,580 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:39:06,581 - websockets.server - DEBUG - > PING a9 9a a4 91 [binary, 4 bytes]
2025-06-28 11:39:06,582 - websockets.client - DEBUG - < PING a9 9a a4 91 [binary, 4 bytes]
2025-06-28 11:39:06,582 - websockets.client - DEBUG - > PONG a9 9a a4 91 [binary, 4 bytes]
2025-06-28 11:39:06,582 - websockets.server - DEBUG - < PONG a9 9a a4 91 [binary, 4 bytes]
2025-06-28 11:39:06,582 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:39:06,594 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:39:06,594 - websockets.client - DEBUG - > PING cf 26 f1 4f [binary, 4 bytes]
2025-06-28 11:39:06,594 - websockets.server - DEBUG - < PING cf 26 f1 4f [binary, 4 bytes]
2025-06-28 11:39:06,595 - websockets.server - DEBUG - > PONG cf 26 f1 4f [binary, 4 bytes]
2025-06-28 11:39:06,595 - websockets.client - DEBUG - < PONG cf 26 f1 4f [binary, 4 bytes]
2025-06-28 11:39:06,595 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:39:26,596 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:39:26,597 - websockets.client - DEBUG - > PING 6b bf 41 15 [binary, 4 bytes]
2025-06-28 11:39:26,598 - websockets.server - DEBUG - < PING 6b bf 41 15 [binary, 4 bytes]
2025-06-28 11:39:26,598 - websockets.server - DEBUG - > PONG 6b bf 41 15 [binary, 4 bytes]
2025-06-28 11:39:26,599 - websockets.client - DEBUG - < PONG 6b bf 41 15 [binary, 4 bytes]
2025-06-28 11:39:26,599 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:39:36,062 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:39:36,065 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:39:36,066 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:39:36,066 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:39:36,068 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第17次, 30s间隔)
2025-06-28 11:39:36,071 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:39:36,583 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:39:36,584 - websockets.server - DEBUG - > PING e9 c5 c2 46 [binary, 4 bytes]
2025-06-28 11:39:36,584 - websockets.client - DEBUG - < PING e9 c5 c2 46 [binary, 4 bytes]
2025-06-28 11:39:36,584 - websockets.client - DEBUG - > PONG e9 c5 c2 46 [binary, 4 bytes]
2025-06-28 11:39:36,585 - websockets.server - DEBUG - < PONG e9 c5 c2 46 [binary, 4 bytes]
2025-06-28 11:39:36,585 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:39:46,600 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:39:46,601 - websockets.client - DEBUG - > PING 2b fc d5 a8 [binary, 4 bytes]
2025-06-28 11:39:46,602 - websockets.server - DEBUG - < PING 2b fc d5 a8 [binary, 4 bytes]
2025-06-28 11:39:46,602 - websockets.server - DEBUG - > PONG 2b fc d5 a8 [binary, 4 bytes]
2025-06-28 11:39:46,602 - websockets.client - DEBUG - < PONG 2b fc d5 a8 [binary, 4 bytes]
2025-06-28 11:39:46,602 - websockets.client - DEBUG - % received keepalive pong

================================================================================
[系统启动] 2025-06-28 11:43:56
================================================================================
[2025-06-28 11:43:56] 🚀 Agent Data Platform 启动中... (所有日志将统一记录到 logs/System.log)
2025-06-28 11:43:56,250 - asyncio - DEBUG - Using selector: KqueueSelector
[2025-06-28 11:43:56] 🧹 开始增强端口清理...
[2025-06-28 11:43:56] 🔍 搜索并清理相关Python进程...
[2025-06-28 11:43:56] ✅ 进程清理完成
[2025-06-28 11:43:58] ✅ 端口 8088 空闲
[2025-06-28 11:43:58] ✅ 端口 8089 空闲
[2025-06-28 11:43:58] ✅ 端口 8090 空闲
[2025-06-28 11:43:58] ✅ 端口 8091 空闲
[2025-06-28 11:43:58] ✅ 端口 8092 空闲
[2025-06-28 11:43:58] ✅ 端口 5555 空闲
[2025-06-28 11:43:58] ✅ 端口 8081 空闲
[2025-06-28 11:43:58] ✅ 端口 8082 空闲
[2025-06-28 11:43:58] ✅ 端口 8080 空闲
[2025-06-28 11:43:58] ✅ 端口 8084 空闲
[2025-06-28 11:43:58] ✅ 端口 8085 空闲
[2025-06-28 11:43:58] ✅ 端口 8086 空闲
[2025-06-28 11:43:58] ✅ 端口 8087 空闲
[2025-06-28 11:43:58] ✅ 端口 8000 空闲
[2025-06-28 11:43:59] ✅ 增强端口清理完成
2025-06-28 11:43:59,747 - __main__ - INFO - === Agent Data Platform 启动中 ===
2025-06-28 11:43:59,747 - __main__ - DEBUG - 🔧 开始系统初始化流程...
2025-06-28 11:43:59,748 - __main__ - DEBUG - 📝 命令行参数: {'config_dir': 'config', 'debug': False, 'start_services': False}
2025-06-28 11:43:59,748 - __main__ - DEBUG - 🔧 步骤1: 初始化ConfigManager...
2025-06-28 11:43:59,748 - __main__ - DEBUG - ✅ ConfigManager初始化完成，配置目录: config
2025-06-28 11:43:59,748 - __main__ - DEBUG - 🔧 步骤2: 加载系统配置...
2025-06-28 11:43:59,749 - __main__ - DEBUG - 📡 Redis URL: redis://localhost:6379
2025-06-28 11:43:59,749 - __main__ - DEBUG - 📋 任务文件路径: tasks.jsonl
2025-06-28 11:43:59,751 - core.config_manager - INFO - 路由配置加载成功
2025-06-28 11:43:59,751 - __main__ - DEBUG - 🚦 路由配置加载完成，任务类型映射: {'CODE': 'tasks:reasoning', 'WEB': 'tasks:reasoning', 'REASONING': 'tasks:reasoning', 'RESEARCH': 'tasks:reasoning'}
2025-06-28 11:43:59,751 - __main__ - DEBUG - 📋 队列映射: {<TaskType.CODE: 'code'>: 'tasks:reasoning', <TaskType.WEB: 'web'>: 'tasks:reasoning', <TaskType.REASONING: 'reasoning'>: 'tasks:reasoning', <TaskType.RESEARCH: 'research'>: 'tasks:reasoning'}
2025-06-28 11:43:59,751 - __main__ - DEBUG - 🔧 步骤3: 初始化核心组件...
2025-06-28 11:43:59,751 - __main__ - DEBUG - ✅ EnhancedMetrics初始化完成
2025-06-28 11:43:59,752 - __main__ - DEBUG - ✅ RedisManager初始化完成
2025-06-28 11:43:59,752 - core.toolscore.toolscore_client - INFO - ✅ 增强的ToolScoreClient初始化完成
2025-06-28 11:43:59,752 - core.llm_client - DEBUG - Enriched config with environment variables: ['default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:43:59,857 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:43:59,860 - core.config_manager - INFO - 路由配置加载成功
2025-06-28 11:43:59,860 - core.monitoring.queue_monitor - INFO - ✅ QueueMonitor 配置加载完成
2025-06-28 11:43:59,860 - core.system_monitor - INFO - ✅ SystemMonitor 配置加载完成
2025-06-28 11:43:59,860 - __main__ - DEBUG - 🔧 开始初始化所有服务...
2025-06-28 11:43:59,860 - services.service_manager - INFO - 正在初始化所有服务...
2025-06-28 11:43:59,860 - services.service_manager - INFO - 初始化服务: redis
2025-06-28 11:43:59,860 - services.redis_service - INFO - Redis服务初始化完成，使用注入的RedisManager实例
2025-06-28 11:43:59,860 - services.service_manager - INFO - 初始化服务: toolscore
2025-06-28 11:43:59,860 - services.toolscore_service - INFO - 正在初始化ToolScore服务...
2025-06-28 11:43:59,860 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 11:43:59,860 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 11:43:59,860 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 11:43:59,860 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:43:59,861 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 11:43:59,861 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 11:43:59,861 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 11:43:59,861 - services.toolscore_service - INFO - ToolScore服务初始化完成（异步初始化将在start()中进行）
2025-06-28 11:43:59,861 - services.service_manager - INFO - 初始化服务: task_processing_coordinator
2025-06-28 11:43:59,861 - services.service_manager - INFO - 初始化服务: mcp_servers
2025-06-28 11:43:59,861 - services.mcp_server_launcher - INFO - 正在初始化MCP服务器启动器...
2025-06-28 11:43:59,861 - services.mcp_server_launcher - INFO - MCP服务器启动器初始化完成，配置了 4 个服务器: ['microsandbox_server', 'search_tool_server', 'browser_use_server', 'deepsearch_server']
2025-06-28 11:43:59,861 - services.service_manager - INFO - 初始化服务: task_api
2025-06-28 11:43:59,861 - services.task_api_service - INFO - 正在初始化任务API服务...
2025-06-28 11:43:59,861 - services.task_api_service - INFO - 任务API服务初始化完成
2025-06-28 11:43:59,861 - services.service_manager - INFO - 初始化服务: runtime
2025-06-28 11:43:59,861 - services.runtime_service - INFO - 正在初始化推理运行时服务...
2025-06-28 11:43:59,861 - services.runtime_service - INFO - 创建运行时实例: enhanced-runtime-1
2025-06-28 11:43:59,861 - core.memory_manager - INFO - MemoryManager initialized: use_redis=True, max_entries=1000
2025-06-28 11:43:59,861 - core.step_planner - INFO - StepPlanner initialized with max_steps=10
2025-06-28 11:43:59,861 - runtimes.reasoning.enhanced_runtime - INFO - DEBUG: Loaded toolscore_http_port: 8082, toolscore_mcp_port: 8081
2025-06-28 11:43:59,861 - runtimes.reasoning.enhanced_runtime - INFO - DEBUG: Configured toolscore_websocket_endpoint (using mcp_port): ws://localhost:8081/websocket
2025-06-28 11:43:59,861 - core.toolscore.mcp_client - INFO - Enhanced MCPToolClient initialized for toolscore at ws://localhost:8081/websocket
2025-06-28 11:43:59,871 - core.config.unified_mapping_manager - INFO - ✅ 统一映射配置已加载: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/config/unified_tool_mappings.yaml
2025-06-28 11:43:59,871 - core.config.unified_mapping_manager - INFO - 🔒 配置哈希: 19cc9dfe
2025-06-28 11:43:59,871 - core.llm.guardrails_middleware - INFO - 🔧 初始化输入验证Guard...
2025-06-28 11:43:59,873 - root - DEBUG - Creating HubTelemetry instance...
2025-06-28 11:43:59,873 - root - DEBUG - Initializing HubTelemetry instance...
2025-06-28 11:43:59,874 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:43:59,874 - core.llm.guardrails_middleware - INFO - 🔧 初始化输出验证Guard...
2025-06-28 11:43:59,874 - core.llm.guardrails_middleware - INFO - 🔧 使用本地LLM客户端初始化Guard...
2025-06-28 11:43:59,876 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:43:59,876 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:43:59,877 - core.llm.guardrails_middleware - INFO - ✅ 使用LLM的Guard创建成功
2025-06-28 11:43:59,877 - core.llm.guardrails_middleware - INFO - ✅ Guardrails Guards初始化成功
2025-06-28 11:43:59,877 - core.llm.guardrails_middleware - INFO -    - 输入Guard: ✅
2025-06-28 11:43:59,877 - core.llm.guardrails_middleware - INFO -    - 输出Guard: ✅
2025-06-28 11:43:59,877 - core.agents.validation_critic - INFO - 🎯 ValidationCritic Agent初始化完成
2025-06-28 11:43:59,877 - services.runtime_service - INFO - 推理运行时服务初始化完成，创建了 1 个实例
2025-06-28 11:43:59,877 - services.service_manager - INFO - 初始化服务: synthesis
2025-06-28 11:43:59,877 - services.synthesis_service - INFO - 正在初始化合成服务...
2025-06-28 11:43:59,877 - core.llm_client - DEBUG - Enriched config with environment variables: ['redis_url', 'TRAJECTORIES_DIR', 'default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:43:59,911 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:43:59,911 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 11:43:59,911 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 11:43:59,911 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 11:43:59,911 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:43:59,911 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 11:43:59,911 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 11:43:59,911 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 11:43:59,911 - core.synthesiscore.synthesis - INFO - ✅ JSON文件存储初始化完成
2025-06-28 11:43:59,911 - core.synthesiscore.synthesis - INFO - 📋 未发现已处理轨迹记录，从空白状态开始
2025-06-28 11:43:59,911 - core.llm_client - DEBUG - Enriched config with environment variables: ['redis_url', 'TRAJECTORIES_DIR', 'default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:43:59,945 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:43:59,945 - core.toolscore.mcp_client - INFO - Enhanced MCPToolClient initialized for toolscore at ws://localhost:8089/websocket
2025-06-28 11:43:59,949 - core.synthesiscore.config_loader - INFO - ✅ SynthesisCore配置加载成功: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/config/synthesiscore_config.yaml
2025-06-28 11:43:59,949 - core.synthesiscore.trajectory_monitor - INFO - 🔧 TrajectoryMonitor初始化完成
2025-06-28 11:43:59,949 - core.synthesiscore.trajectory_monitor - INFO - 📂 监控目录: output/trajectories
2025-06-28 11:43:59,949 - core.synthesiscore.trajectory_monitor - INFO - 📝 种子文件: output/trajectories/../seed_tasks.jsonl
2025-06-28 11:43:59,949 - services.synthesis_service - INFO - ✅ TrajectoryMonitor v2.0 初始化完成
2025-06-28 11:43:59,949 - services.synthesis_service - INFO - 合成服务初始化完成，轨迹目录: output/trajectories
2025-06-28 11:43:59,949 - __main__ - DEBUG - ✅ 所有服务初始化完成
2025-06-28 11:43:59,949 - __main__ - DEBUG - 🚀 开始启动所有服务...
2025-06-28 11:43:59,949 - services.service_manager - INFO - 正在启动所有服务...
2025-06-28 11:43:59,949 - services.service_manager - INFO - 启动服务: redis
2025-06-28 11:43:59,949 - services.redis_service - INFO - Redis客户端已就绪
2025-06-28 11:43:59,949 - services.service_manager - INFO - 启动服务: toolscore
2025-06-28 11:43:59,949 - services.toolscore_service - INFO - 正在启动ToolScore服务...
2025-06-28 11:43:59,949 - services.toolscore_service - INFO - 正在初始化工具库...
2025-06-28 11:43:59,949 - services.toolscore_service - INFO - 工具库初始化将在ToolScore MCP服务器线程中进行。
2025-06-28 11:43:59,949 - services.toolscore_service - INFO - 正在启动ToolScore HTTP API...
2025-06-28 11:43:59,959 - services.toolscore_service - INFO - ToolScore HTTP API已启动于端口: 8082
2025-06-28 11:43:59,959 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:43:59,959 - services.toolscore_service - INFO - ToolScore MCP 服务器不进行端口自动检测，使用配置端口: 8081
2025-06-28 11:43:59,959 - services.toolscore_service - INFO - ToolScore MCP server configured to use host: 0.0.0.0, port: 8081, path: /websocket
2025-06-28 11:43:59,959 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 11:43:59,959 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 11:43:59,959 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 11:43:59,959 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:43:59,959 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 11:43:59,959 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 11:43:59,959 - core.toolscore.monitoring_api - INFO - ToolScore monitoring API started on port 8082
2025-06-28 11:43:59,959 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 11:43:59,959 - services.toolscore_service - INFO - Starting ToolScore MCP server thread...
2025-06-28 11:43:59,959 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:43:59,959 - services.toolscore_service - INFO - ToolScore MCP server thread started, is_alive: True
2025-06-28 11:43:59,960 - services.toolscore_service - INFO - ToolScore MCP服务器启动线程已启动，等待就绪信号...
2025-06-28 11:43:59,960 - core.toolscore.mcp_server - INFO - Attempting to start toolscore MCP Server on 0.0.0.0:8081
2025-06-28 11:43:59,960 - services.service_manager - INFO - 启动服务: task_processing_coordinator
2025-06-28 11:43:59,960 - core.dispatcher_enhanced - INFO - ✅ TaskProcessingCoordinator 配置加载完成 - 队列映射: {<TaskType.CODE: 'code'>: 'tasks:reasoning', <TaskType.WEB: 'web'>: 'tasks:reasoning', <TaskType.REASONING: 'reasoning'>: 'tasks:reasoning', <TaskType.RESEARCH: 'research'>: 'tasks:reasoning'}
2025-06-28 11:43:59,960 - services.service_manager - INFO - 启动服务: mcp_servers
2025-06-28 11:43:59,960 - services.mcp_server_launcher - INFO - 正在启动MCP服务器...
2025-06-28 11:43:59,960 - services.mcp_server_launcher - INFO - 正在并行启动 4 个MCP服务器...
2025-06-28 11:43:59,960 - websockets.server - INFO - server listening on 0.0.0.0:8081
2025-06-28 11:43:59,960 - core.dispatcher_enhanced - INFO - 启动任务处理协调器...
2025-06-28 11:43:59,960 - core.toolscore.mcp_server - INFO - [toolscore] Initializing UnifiedToolLibrary...
2025-06-28 11:43:59,960 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:43:59,960 - core.toolscore.core_manager - INFO - 🚀 正在初始化增强的CoreManager...
2025-06-28 11:43:59,960 - core.toolscore.core_manager - INFO - 🔄 使用v2.0服务容器架构初始化...
2025-06-28 11:43:59,960 - core.toolscore.enhanced_core_manager_v2 - INFO - 🚀 初始化增强核心管理器 v2.0...
2025-06-28 11:43:59,960 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:43:59,960 - core.toolscore.service_container.mcp_service_container - INFO - 🚀 开始初始化MCP服务容器...
2025-06-28 11:43:59,960 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:43:59,960 - core.toolscore.service_container.mcp_service_container - INFO - 🔍 发现内置MCP服务...
2025-06-28 11:43:59,960 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:43:59,960 - core.toolscore.service_container.builtin_discovery - INFO - 🔍 开始发现内置MCP服务: mcp_servers
2025-06-28 11:43:59,960 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:43:59,960 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:43:59,960 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:43:59,960 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:43:59,960 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:43:59,960 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:43:59,960 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:43:59,960 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:43:59,960 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:43:59,960 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: Search Tool MCP Server
2025-06-28 11:43:59,963 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 76026)
2025-06-28 11:43:59,964 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: MicroSandbox MCP Server
2025-06-28 11:43:59,964 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:43:59,964 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 跳过 __pycache__: 缺少main.py文件
2025-06-28 11:43:59,964 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:43:59,964 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:43:59,964 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:43:59,964 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: Browser Use MCP Server
2025-06-28 11:43:59,964 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:43:59,964 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:43:59,964 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:43:59,964 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:43:59,964 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:43:59,964 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:43:59,964 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: DeepSearch MCP Server
2025-06-28 11:43:59,964 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:43:59,964 - core.toolscore.service_container.builtin_discovery - INFO - 🎯 内置服务发现完成，共发现 4 个服务
2025-06-28 11:43:59,964 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:43:59,964 - core.toolscore.service_container.builtin_discovery - INFO - 📝 创建服务配置文件...
2025-06-28 11:43:59,964 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/search_tool_server/service.json
2025-06-28 11:43:59,964 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:43:59,965 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/microsandbox_server/service.json
2025-06-28 11:43:59,965 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/browser_use_server/service.json
2025-06-28 11:43:59,965 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/deepsearch_server/service.json
2025-06-28 11:43:59,965 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 发现 4 个内置服务
2025-06-28 11:43:59,965 - core.toolscore.service_container.mcp_service_container - INFO - 📂 加载已安装的外部服务...
2025-06-28 11:43:59,965 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 加载 0 个外部服务
2025-06-28 11:43:59,965 - core.toolscore.service_container.mcp_service_container - INFO - 📋 构建统一服务目录...
2025-06-28 11:43:59,965 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 服务目录构建完成，共 4 个服务
2025-06-28 11:43:59,965 - core.toolscore.service_container.mcp_service_container - INFO - 📋 标记内置服务为启动中状态...
2025-06-28 11:43:59,965 - core.toolscore.service_container.mcp_service_container - INFO - 📋 已标记 4 个内置服务为启动中状态
2025-06-28 11:43:59,965 - core.toolscore.service_container.service_monitor - INFO - 🔍 启动服务监控...
2025-06-28 11:43:59,965 - core.toolscore.service_container.mcp_service_container - INFO - ✅ MCP服务容器初始化完成
2025-06-28 11:43:59,965 - core.toolscore.enhanced_core_manager_v2 - INFO - ✅ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:43:59,965 - core.toolscore.core_manager - INFO - ✅ v2.0架构初始化完成
2025-06-28 11:43:59,965 - core.toolscore.tool_registry - INFO - Tool registry initialized
2025-06-28 11:43:59,965 - core.llm_client - DEBUG - Enriched config with environment variables: ['provider', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:43:59,965 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:43:59,965 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:43:59,965 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:43:59,965 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:43:59,968 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 76027)
2025-06-28 11:43:59,968 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:43:59,979 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: browser_use_server
2025-06-28 11:43:59,979 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:43:59,980 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: browser_use_server
2025-06-28 11:43:59,980 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server
2025-06-28 11:43:59,980 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) = True
2025-06-28 11:43:59,980 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) = True
2025-06-28 11:43:59,980 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) contents: ['service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:43:59,980 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server/main.py
2025-06-28 11:43:59,980 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:43:59,980 - services.mcp_server_launcher - INFO - [MCP启动器] 为 browser_use_server 使用配置文件指定端口: 8084
2025-06-28 11:43:59,980 - services.mcp_server_launcher - INFO - [MCP启动器] 为 browser_use_server 使用配置文件指定端口: 8084
2025-06-28 11:43:59,981 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 BROWSER_USE_SERVER_PORT=8084 给 browser_use_server
2025-06-28 11:43:59,981 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.browser_use_server.main
2025-06-28 11:43:59,981 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:43:59,985 - services.mcp_server_launcher - INFO - MCP服务器已启动: browser_use_server (PID: 76028)
2025-06-28 11:43:59,985 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 browser_use_server 就绪状态...
2025-06-28 11:43:59,986 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:43:59,986 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:43:59,987 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:43:59,987 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:43:59,987 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:43:59,987 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:43:59,987 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:43:59,987 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:43:59,987 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:43:59,987 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:43:59,987 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:43:59,987 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:43:59,987 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:43:59,987 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:43:59,991 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 76029)
2025-06-28 11:43:59,991 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:43:59,992 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第1次, 5s间隔)
2025-06-28 11:43:59,992 - core.monitoring.queue_monitor - INFO - 启动队列监控器...
2025-06-28 11:43:59,995 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:43:59,995 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:43:59,995 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:43:59,995 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:43:59,995 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:43:59,995 - websockets.client - DEBUG - > Sec-WebSocket-Key: Idawx5UwJSF1M7qV/VR/uA==
2025-06-28 11:43:59,995 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:43:59,995 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:43:59,995 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:43:59,995 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:43:59,995 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:43:59,995 - websockets.client - DEBUG - > Host: localhost:8084
2025-06-28 11:43:59,995 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:43:59,995 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:43:59,995 - websockets.client - DEBUG - > Sec-WebSocket-Key: 4gF04ca6vzJEfc6cCLCxYw==
2025-06-28 11:43:59,995 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:43:59,995 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:43:59,995 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:43:59,996 - websockets.client - DEBUG - > EOF
2025-06-28 11:43:59,996 - websockets.client - DEBUG - < EOF
2025-06-28 11:43:59,996 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:43:59,996 - websockets.client - DEBUG - > EOF
2025-06-28 11:43:59,996 - websockets.client - DEBUG - < EOF
2025-06-28 11:43:59,996 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:43:59,998 - services.mcp_server_launcher - DEBUG - 📋 browser_use_server 端口 8084 尚未就绪
2025-06-28 11:43:59,998 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:43:59,999 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:44:00,015 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:44:00,015 - core.toolscore.tool_gap_detector - INFO - 智能工具缺口检测器初始化 - 统一版本
2025-06-28 11:44:00,015 - core.toolscore.dynamic_mcp_manager - INFO - Dynamic MCP Manager initialized (ProcessRunner mode)
2025-06-28 11:44:00,015 - core.toolscore.dynamic_mcp_manager - INFO - 启动动态MCP管理器...
2025-06-28 11:44:00,015 - core.toolscore.dynamic_mcp_manager - INFO - 持久化配置为空，无需恢复外部MCP服务器
2025-06-28 11:44:00,015 - core.toolscore.dynamic_mcp_manager - INFO - 动态MCP管理器启动完成
2025-06-28 11:44:00,015 - core.toolscore.mcp_search_tool - INFO - ✅ MCP Search Tool initialized - 优化版本，包含失败工具跟踪
2025-06-28 11:44:00,015 - core.toolscore.unified_tool_library - INFO - Tool library initialization completed - 核心管理器模式
2025-06-28 11:44:00,016 - core.toolscore.mcp_server - INFO - [toolscore] UnifiedToolLibrary initialized.
2025-06-28 11:44:00,016 - core.toolscore.mcp_server - INFO - [toolscore] Auto-registering MCP servers...
2025-06-28 11:44:00,016 - core.toolscore.mcp_auto_registration - INFO - 🔍 开始自动发现和注册MCP服务器...
2025-06-28 11:44:00,016 - core.toolscore.mcp_auto_registration - DEBUG - ⚠️ 服务器目录 __pycache__ 缺少 service.json
2025-06-28 11:44:00,016 - core.toolscore.mcp_auto_registration - INFO - 🎯 发现 4 个MCP服务器
2025-06-28 11:44:00,034 - core.unified_tool_manager - DEBUG - ✅ 配置验证通过
2025-06-28 11:44:00,034 - core.unified_tool_manager - INFO - 🔄 成功加载工具配置: 4 个标准工具
2025-06-28 11:44:00,034 - core.unified_tool_manager - DEBUG -    - 标准工具ID: ['browser_use', 'deepsearch', 'mcp-search-tool', 'microsandbox']
2025-06-28 11:44:00,034 - core.unified_tool_manager - DEBUG -    - 兼容映射: 13 个变体
2025-06-28 11:44:00,034 - core.unified_tool_manager - INFO - ✅ 统一工具管理器初始化完成，管理 4 个工具
2025-06-28 11:44:00,034 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: mcp-search-tool
2025-06-28 11:44:00,034 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: Search Tool MCP Server (ID: mcp-search-tool)
2025-06-28 11:44:00,034 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: Search Tool MCP Server (ID: mcp-search-tool)
2025-06-28 11:44:00,034 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: Search Tool MCP Server
2025-06-28 11:44:00,034 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8080/websocket
2025-06-28 11:44:00,034 - core.toolscore.mcp_connector - INFO - Registered MCP server mcp-search-tool at ws://localhost:8080/websocket
2025-06-28 11:44:00,034 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: mcp-search-tool -> ws://localhost:8080/websocket
2025-06-28 11:44:00,034 - core.toolscore.core_manager - INFO - 工具立即可用: mcp-search-tool
2025-06-28 11:44:00,034 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: mcp-search-tool
2025-06-28 11:44:00,034 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: microsandbox
2025-06-28 11:44:00,034 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: MicroSandbox MCP Server (ID: microsandbox)
2025-06-28 11:44:00,034 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: MicroSandbox MCP Server (ID: microsandbox)
2025-06-28 11:44:00,034 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: MicroSandbox MCP Server
2025-06-28 11:44:00,034 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8090/websocket
2025-06-28 11:44:00,034 - core.toolscore.mcp_connector - INFO - Registered MCP server microsandbox at ws://localhost:8090/websocket
2025-06-28 11:44:00,034 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: microsandbox -> ws://localhost:8090/websocket
2025-06-28 11:44:00,034 - core.toolscore.core_manager - INFO - 工具立即可用: microsandbox
2025-06-28 11:44:00,034 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: microsandbox
2025-06-28 11:44:00,034 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: browser_use
2025-06-28 11:44:00,035 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: Browser Use MCP Server (ID: browser_use)
2025-06-28 11:44:00,035 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: Browser Use MCP Server (ID: browser_use)
2025-06-28 11:44:00,035 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: Browser Use MCP Server
2025-06-28 11:44:00,035 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8084/websocket
2025-06-28 11:44:00,035 - core.toolscore.mcp_connector - INFO - Registered MCP server browser_use at ws://localhost:8084/websocket
2025-06-28 11:44:00,035 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: browser_use -> ws://localhost:8084/websocket
2025-06-28 11:44:00,035 - core.toolscore.core_manager - INFO - 工具立即可用: browser_use
2025-06-28 11:44:00,035 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: browser_use
2025-06-28 11:44:00,035 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: deepsearch
2025-06-28 11:44:00,035 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: DeepSearch MCP Server (ID: deepsearch)
2025-06-28 11:44:00,035 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: DeepSearch MCP Server (ID: deepsearch)
2025-06-28 11:44:00,035 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: DeepSearch MCP Server
2025-06-28 11:44:00,035 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8086/websocket
2025-06-28 11:44:00,035 - core.toolscore.mcp_connector - INFO - Registered MCP server deepsearch at ws://localhost:8086/websocket
2025-06-28 11:44:00,035 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: deepsearch -> ws://localhost:8086/websocket
2025-06-28 11:44:00,035 - core.toolscore.core_manager - INFO - 工具立即可用: deepsearch
2025-06-28 11:44:00,035 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: deepsearch
2025-06-28 11:44:00,035 - core.toolscore.mcp_auto_registration - INFO - 📊 MCP服务器注册完成: 4/4 成功
2025-06-28 11:44:00,035 - core.toolscore.mcp_server - INFO - [toolscore] All MCP servers registered successfully.
2025-06-28 11:44:00,035 - core.toolscore.mcp_server - INFO - toolscore MCP Server started successfully on 0.0.0.0:8081 (Original endpoint: ws://0.0.0.0:8081/websocket) with ping_interval=30, ping_timeout=60
2025-06-28 11:44:00,035 - core.toolscore.mcp_server - INFO - toolscore MCP Server started event set.
2025-06-28 11:44:00,035 - core.toolscore.service_container.service_monitor - INFO - 🔄 开始服务监控循环，检查间隔: 30秒
2025-06-28 11:44:00,038 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [browser_use] BrowserUse logging setup complete with level info
2025-06-28 11:44:00,430 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [root] Anonymized telemetry enabled. See https://docs.browser-use.com/development/telemetry for more information.
2025-06-28 11:44:00,559 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.llm_client] Initialized LLM client with provider: gemini
2025-06-28 11:44:00,559 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Browser-Use server initialized with LLM provider: gemini
2025-06-28 11:44:00,559 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 使用动态分配端口: 8084
2025-06-28 11:44:00,559 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] BrowserUseMCPServer initialized:
2025-06-28 11:44:00,559 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Server Name: browser_use_server
2025-06-28 11:44:00,559 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Server ID: browser_use
2025-06-28 11:44:00,559 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Listen Host: 0.0.0.0
2025-06-28 11:44:00,559 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Listen Port: 8084
2025-06-28 11:44:00,559 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Public Endpoint: ws://localhost:8084
2025-06-28 11:44:00,559 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:44:00,559 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Starting browser_use_server...
2025-06-28 11:44:00,559 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Attempting to start MCPServer for browser_use_server at ws://localhost:8084...
2025-06-28 11:44:00,559 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Attempting to start browser_use_server MCP Server on localhost:8084
2025-06-28 11:44:00,560 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] server listening on [::1]:8084
2025-06-28 11:44:00,560 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] server listening on 127.0.0.1:8084
2025-06-28 11:44:00,560 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] browser_use_server MCP Server started successfully on localhost:8084 (Original endpoint: ws://localhost:8084) with ping_interval=30, ping_timeout=60
2025-06-28 11:44:00,560 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:44:00,565 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:44:00,565 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:44:00,601 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:44:00,601 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:44:00,601 - websockets.client - DEBUG - > Host: localhost:8084
2025-06-28 11:44:00,601 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:44:00,601 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:44:00,601 - websockets.client - DEBUG - > Sec-WebSocket-Key: n9AOAEswBRQefG5qX+cSrQ==
2025-06-28 11:44:00,601 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:44:00,601 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:44:00,601 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:44:00,601 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:44:00,601 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:44:00,601 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:44:00,601 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:44:00,601 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:44:00,601 - websockets.client - DEBUG - > Sec-WebSocket-Key: KnQwOWQ0Ro1jyTNYUMq3jA==
2025-06-28 11:44:00,601 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:44:00,601 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:44:00,601 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:44:00,603 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection open
2025-06-28 11:44:00,603 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:44:00,603 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Client connected to browser_use_server MCP Server at path /: ('127.0.0.1', 64229)
2025-06-28 11:44:00,603 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:44:00,603 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:44:00,603 - websockets.client - DEBUG - < Sec-WebSocket-Accept: KFd0sF9Cqy53rGj40xt+jjVfBtQ=
2025-06-28 11:44:00,603 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:44:00,603 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:44:00 GMT
2025-06-28 11:44:00,603 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:44:00,603 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:44:00,603 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:44:00,603 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:44:00,603 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:44:00,603 - websockets.client - DEBUG - < Sec-WebSocket-Accept: 9/RuggEnv4kxBht+lk+XkktA/bw=
2025-06-28 11:44:00,603 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:44:00,603 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:44:00 GMT
2025-06-28 11:44:00,603 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:44:00,603 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:44:00,604 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:44:00,604 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:44:00,604 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:44:00,604 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:44:00,604 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:44:00,604 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:44:00,604 - services.mcp_server_launcher - DEBUG - [browser_use_server] WARNING  [core.toolscore.mcp_server] Unknown request type or server role mismatch: ping
2025-06-28 11:44:00,604 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:44:00,604 - websockets.client - DEBUG - < EOF
2025-06-28 11:44:00,604 - websockets.client - DEBUG - > EOF
2025-06-28 11:44:00,604 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:44:00,604 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:44:00,604 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:44:00,604 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:44:00,604 - websockets.client - DEBUG - < EOF
2025-06-28 11:44:00,604 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:44:00,604 - websockets.client - DEBUG - > EOF
2025-06-28 11:44:00,604 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:44:00,604 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:44:00,605 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:44:00,605 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:44:00,605 - services.mcp_server_launcher - DEBUG - ✅ browser_use_server 特定就绪检查通过
2025-06-28 11:44:00,605 - services.mcp_server_launcher - INFO - ✅ browser_use_server 已就绪
2025-06-28 11:44:00,605 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:44:00,605 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:44:01,286 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:44:01,287 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:44:01,606 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:44:02,151 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:44:02,151 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:44:03,189 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:44:03,189 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:44:04,435 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:44:04,435 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:44:04,993 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第2次, 5s间隔)
2025-06-28 11:44:05,929 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:44:05,929 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:44:07,722 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:44:07,722 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:44:09,874 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:44:09,874 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:44:09,994 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第3次, 5s间隔)
2025-06-28 11:44:10,126 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:44:10,127 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:44:10,127 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:44:10,127 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:44:10,127 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:44:10,127 - websockets.server - DEBUG - < Sec-WebSocket-Key: 32HHjczNrfQW+2y8g7K2NQ==
2025-06-28 11:44:10,127 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:44:10,127 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:44:10,127 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:44:10,128 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:44:10,128 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:44:10,128 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:44:10,128 - websockets.server - DEBUG - > Sec-WebSocket-Accept: yatJ8P9DPx0OfcYUE88nSgJLa20=
2025-06-28 11:44:10,128 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:44:10,128 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:44:10 GMT
2025-06-28 11:44:10,128 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:44:10,128 - websockets.server - INFO - connection open
2025-06-28 11:44:10,128 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:44:10,128 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 64248)
2025-06-28 11:44:10,129 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "bc92db...onnection_params": {}}}' [2376 bytes]
2025-06-28 11:44:10,130 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: search_tool_server (ID: mcp-search-tool)
2025-06-28 11:44:10,130 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: search_tool_server
2025-06-28 11:44:10,130 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: mcp-search-tool -> ws://localhost:8080/mcp
2025-06-28 11:44:10,130 - core.toolscore.core_manager - INFO - 工具立即可用: mcp-search-tool
2025-06-28 11:44:10,130 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 11:44:10,131 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:44:10,131 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 11:44:10,131 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:44:10,131 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 11:44:10,131 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 11:44:10,132 - websockets.server - INFO - connection closed
2025-06-28 11:44:10,234 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:44:10,235 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:44:10,235 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:44:10,235 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:44:10,235 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:44:10,235 - websockets.server - DEBUG - < Sec-WebSocket-Key: f2BpILc4PeZdCZM6YH0ANA==
2025-06-28 11:44:10,235 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:44:10,235 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:44:10,235 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:44:10,235 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:44:10,235 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:44:10,236 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:44:10,236 - websockets.server - DEBUG - > Sec-WebSocket-Accept: ZNgVsLgRJZHgO6VtKQnJ28CKbZ0=
2025-06-28 11:44:10,236 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:44:10,236 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:44:10 GMT
2025-06-28 11:44:10,236 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:44:10,236 - websockets.server - INFO - connection open
2025-06-28 11:44:10,236 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:44:10,236 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 64250)
2025-06-28 11:44:10,236 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "6608bf...onnection_params": {}}}' [3263 bytes]
2025-06-28 11:44:10,236 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: microsandbox_server (ID: microsandbox)
2025-06-28 11:44:10,236 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: microsandbox_server
2025-06-28 11:44:10,236 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: microsandbox -> ws://localhost:8090
2025-06-28 11:44:10,236 - core.toolscore.core_manager - INFO - 工具立即可用: microsandbox
2025-06-28 11:44:10,236 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 11:44:10,237 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:44:10,237 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 11:44:10,237 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:44:10,237 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 11:44:10,238 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 11:44:10,238 - websockets.server - INFO - connection closed
2025-06-28 11:44:10,290 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:44:10,290 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:44:10,290 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:44:10,290 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:44:10,290 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:44:10,290 - websockets.server - DEBUG - < Sec-WebSocket-Key: TJJIB9S/DHAjXtdbKvsZBw==
2025-06-28 11:44:10,290 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:44:10,290 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:44:10,290 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:44:10,290 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:44:10,290 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:44:10,290 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:44:10,290 - websockets.server - DEBUG - > Sec-WebSocket-Accept: 3epTwwH1o8omdZGYOHep8PaM28I=
2025-06-28 11:44:10,290 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:44:10,290 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:44:10 GMT
2025-06-28 11:44:10,290 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:44:10,290 - websockets.server - INFO - connection open
2025-06-28 11:44:10,290 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:44:10,290 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 64252)
2025-06-28 11:44:10,291 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "12ec2b...onnection_params": {}}}' [2313 bytes]
2025-06-28 11:44:10,291 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: deepsearch_server (ID: deepsearch)
2025-06-28 11:44:10,291 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: deepsearch_server
2025-06-28 11:44:10,291 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: deepsearch -> ws://localhost:8086/mcp
2025-06-28 11:44:10,291 - core.toolscore.core_manager - INFO - 工具立即可用: deepsearch
2025-06-28 11:44:10,291 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 11:44:10,291 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:44:10,291 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 11:44:10,291 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:44:10,291 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 11:44:10,292 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 11:44:10,292 - websockets.server - INFO - connection closed
2025-06-28 11:44:10,561 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 11:44:10,562 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:44:10,562 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:44:10,562 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:44:10,562 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:44:10,562 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:44:10,562 - websockets.server - DEBUG - < Sec-WebSocket-Key: LCJsEHIIMF24ae3RBDhy4g==
2025-06-28 11:44:10,562 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:44:10,562 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:44:10,562 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:44:10,562 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:44:10,562 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:44:10,562 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:44:10,562 - websockets.server - DEBUG - > Sec-WebSocket-Accept: SAqDIKNVXEC/YyAmnc09eRCI3Qo=
2025-06-28 11:44:10,562 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:44:10,562 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:44:10 GMT
2025-06-28 11:44:10,562 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:44:10,562 - websockets.server - INFO - connection open
2025-06-28 11:44:10,562 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:44:10,562 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 64254)
2025-06-28 11:44:10,563 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 11:44:10,563 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "e9fc3e30-63b1-4eae-b43f-6a266ceb3555", "tool_spec": {"tool_id": "browser_use", "name": "browser_use_server", "description": "\u57fa\u4e8eBrowser-Use\u7684AI\u6d4f\u89c8\u5668\u81ea\u52a8\u5316\u670d\u52a1\u5668\uff0c\u5b8c\u6574\u5b9e\u73b0browser-use\u7684\u6240\u6709\u529f\u80fd", "tool_type": "mcp_server", "capabilities": [{"name": "browser_use_execute_task", "description": "\u4f7f\u7528AI\u6267\u884c\u590d\u6742\u7684\u6d4f\u89c8\u5668\u4efb\u52a1\uff0c\u652f\u6301\u81ea\u7136\u8bed\u8a00\u63cf\u8ff0", "parameters": {"task": {"type": "string", "description": "\u8981\u6267\u884c\u7684\u4efb\u52a1\u63cf\u8ff0\uff0c\u4f7f\u7528\u81ea\u7136\u8bed\u8a00", "required": true}, "max_steps": {"type": "integer", "description": "\u6700\u5927\u6267\u884c\u6b65\u9aa4\u6570\uff0c\u9ed8\u8ba450", "required": false}, "use_vision": {"type": "boolean", "description": "\u662f\u5426\u4f7f\u7528\u89c6\u89c9\u7406\u89e3\uff0c\u9ed8\u8ba4true", "required": false}}, "examples": [{"task": "\u641c\u7d22Python\u6559\u7a0b\u5e76\u6253\u5f00\u7b2c\u4e00\u4e2a\u7ed3\u679c"}, {"task": "\u5728GitHub\u4e0a\u641c\u7d22browser-use\u9879\u76ee\u5e76\u67e5\u770bREADME"}, {"task": "\u767b\u5f55\u7f51\u7ad9\u5e76\u586b\u5199\u8868\u5355", "use_vision": true}], "category": "general"}, {"name": "browser_navigate", "description": "\u5bfc\u822a\u5230\u6307\u5b9a\u7f51\u5740", "parameters": {"url": {"type": "string", "description": "\u8981\u8bbf\u95ee\u7684URL\u5730\u5740", "required": true}}, "examples": [{"url": "https://www.google.com"}, {"url": "https://github.com"}], "category": "general"}, {"name": "browser_search_google", "description": "\u5728Google\u4e2d\u641c\u7d22\u6307\u5b9a\u67e5\u8be2", "parameters": {"query": {"type": "string", "description": "\u641c\u7d22\u67e5\u8be2\u8bcd", "required": true}}, "examples": [{"query": "Python machine learning tutorial"}, {"query": "browser automation tools"}], "category": "general"}, {"name": "browser_go_back", "description": "\u8fd4\u56de\u4e0a\u4e00\u9875", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_click_element", "description": "\u901a\u8fc7\u7d22\u5f15\u70b9\u51fb\u9875\u9762\u5143\u7d20", "parameters": {"index": {"type": "integer", "description": "\u8981\u70b9\u51fb\u7684\u5143\u7d20\u7d22\u5f15", "required": true}}, "examples": [{"index": 1}, {"index": 5}], "category": "general"}, {"name": "browser_input_text", "description": "\u5728\u6307\u5b9a\u5143\u7d20\u4e2d\u8f93\u5165\u6587\u672c", "parameters": {"index": {"type": "integer", "description": "\u8981\u8f93\u5165\u6587\u672c\u7684\u5143\u7d20\u7d22\u5f15", "required": true}, "text": {"type": "string", "description": "\u8981\u8f93\u5165\u7684\u6587\u672c", "required": true}}, "examples": [{"index": 2, "text": "hello world"}, {"index": 0, "text": "test@example.com"}], "category": "general"}, {"name": "browser_send_keys", "description": "\u53d1\u9001\u7279\u6b8a\u952e\u6216\u5feb\u6377\u952e", "parameters": {"keys": {"type": "string", "description": "\u8981\u53d1\u9001\u7684\u952e\uff0c\u5982Enter\u3001Escape\u3001Control+c\u7b49", "required": true}}, "examples": [{"keys": "Enter"}, {"keys": "Control+c"}, {"keys": "Escape"}], "category": "general"}, {"name": "browser_scroll_down", "description": "\u5411\u4e0b\u6eda\u52a8\u9875\u9762", "parameters": {"amount": {"type": "integer", "description": "\u6eda\u52a8\u50cf\u7d20\u6570\uff0c\u4e0d\u6307\u5b9a\u5219\u6eda\u52a8\u4e00\u9875", "required": false}}, "examples": [{}, {"amount": 500}], "category": "general"}, {"name": "browser_scroll_up", "description": "\u5411\u4e0a\u6eda\u52a8\u9875\u9762", "parameters": {"amount": {"type": "integer", "description": "\u6eda\u52a8\u50cf\u7d20\u6570\uff0c\u4e0d\u6307\u5b9a\u5219\u6eda\u52a8\u4e00\u9875", "required": false}}, "examples": [{}, {"amount": 300}], "category": "general"}, {"name": "browser_scroll_to_text", "description": "\u6eda\u52a8\u5230\u5305\u542b\u6307\u5b9a\u6587\u672c\u7684\u5143\u7d20", "parameters": {"text": {"type": "string", "description": "\u8981\u6eda\u52a8\u5230\u7684\u6587\u672c\u5185\u5bb9", "required": true}}, "examples": [{"text": "Sign up"}, {"text": "Contact us"}], "category": "general"}, {"name": "browser_switch_tab", "description": "\u5207\u6362\u5230\u6307\u5b9a\u6807\u7b7e", "parameters": {"page_id": {"type": "integer", "description": "\u8981\u5207\u6362\u5230\u7684\u6807\u7b7eID", "required": true}}, "examples": [{"page_id": 0}, {"page_id": 1}], "category": "general"}, {"name": "browser_open_tab", "description": "\u5728\u65b0\u6807\u7b7e\u4e2d\u6253\u5f00URL", "parameters": {"url": {"type": "string", "description": "\u8981\u5728\u65b0\u6807\u7b7e\u4e2d\u6253\u5f00\u7684URL", "required": true}}, "examples": [{"url": "https://www.example.com"}], "category": "general"}, {"name": "browser_close_tab", "description": "\u5173\u95ed\u6307\u5b9a\u6807\u7b7e", "parameters": {"page_id": {"type": "integer", "description": "\u8981\u5173\u95ed\u7684\u6807\u7b7eID", "required": true}}, "examples": [{"page_id": 1}], "category": "general"}, {"name": "browser_extract_content", "description": "\u4ece\u9875\u9762\u63d0\u53d6\u7279\u5b9a\u5185\u5bb9", "parameters": {"goal": {"type": "string", "description": "\u63d0\u53d6\u76ee\u6807\u63cf\u8ff0", "required": true}, "include_links": {"type": "boolean", "description": "\u662f\u5426\u5305\u542b\u94fe\u63a5\uff0c\u9ed8\u8ba4false", "required": false}}, "examples": [{"goal": "\u63d0\u53d6\u6240\u6709\u516c\u53f8\u540d\u79f0"}, {"goal": "\u83b7\u53d6\u4ea7\u54c1\u4ef7\u683c\u4fe1\u606f", "include_links": true}], "category": "general"}, {"name": "browser_get_content", "description": "\u83b7\u53d6\u9875\u9762\u5185\u5bb9", "parameters": {"selector": {"type": "string", "description": "CSS\u9009\u62e9\u5668\uff0c\u7a7a\u5219\u83b7\u53d6\u5168\u90e8\u5185\u5bb9", "required": false}}, "examples": [{"selector": "h1, p"}, {}], "category": "general"}, {"name": "browser_get_ax_tree", "description": "\u83b7\u53d6\u9875\u9762\u7684\u53ef\u8bbf\u95ee\u6027\u6811\u7ed3\u6784", "parameters": {"number_of_elements": {"type": "integer", "description": "\u8fd4\u56de\u7684\u5143\u7d20\u6570\u91cf", "required": true}}, "examples": [{"number_of_elements": 50}], "category": "general"}, {"name": "browser_get_dropdown_options", "description": "\u83b7\u53d6\u4e0b\u62c9\u83dc\u5355\u7684\u6240\u6709\u9009\u9879", "parameters": {"index": {"type": "integer", "description": "\u4e0b\u62c9\u83dc\u5355\u5143\u7d20\u7684\u7d22\u5f15", "required": true}}, "examples": [{"index": 3}], "category": "general"}, {"name": "browser_select_dropdown_option", "description": "\u9009\u62e9\u4e0b\u62c9\u83dc\u5355\u4e2d\u7684\u9009\u9879", "parameters": {"index": {"type": "integer", "description": "\u4e0b\u62c9\u83dc\u5355\u5143\u7d20\u7684\u7d22\u5f15", "required": true}, "text": {"type": "string", "description": "\u8981\u9009\u62e9\u7684\u9009\u9879\u6587\u672c", "required": true}}, "examples": [{"index": 3, "text": "Option 1"}], "category": "general"}, {"name": "browser_drag_drop", "description": "\u6267\u884c\u62d6\u62fd\u64cd\u4f5c", "parameters": {"element_source": {"type": "string", "description": "\u6e90\u5143\u7d20\u9009\u62e9\u5668", "required": false}, "element_target": {"type": "string", "description": "\u76ee\u6807\u5143\u7d20\u9009\u62e9\u5668", "required": false}, "coord_source_x": {"type": "integer", "description": "\u6e90\u5750\u6807X", "required": false}, "coord_source_y": {"type": "integer", "description": "\u6e90\u5750\u6807Y", "required": false}, "coord_target_x": {"type": "integer", "description": "\u76ee\u6807\u5750\u6807X", "required": false}, "coord_target_y": {"type": "integer", "description": "\u76ee\u6807\u5750\u6807Y", "required": false}, "steps": {"type": "integer", "description": "\u62d6\u62fd\u6b65\u9aa4\u6570\uff0c\u9ed8\u8ba410", "required": false}}, "examples": [{"element_source": ".item1", "element_target": ".dropzone"}], "category": "general"}, {"name": "browser_save_pdf", "description": "\u5c06\u5f53\u524d\u9875\u9762\u4fdd\u5b58\u4e3aPDF", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_screenshot", "description": "\u622a\u53d6\u5f53\u524d\u9875\u9762\u622a\u56fe", "parameters": {"filename": {"type": "string", "description": "\u622a\u56fe\u6587\u4ef6\u540d\uff0c\u53ef\u9009", "required": false}}, "examples": [{"filename": "current_page.png"}, {}], "category": "general"}, {"name": "browser_wait", "description": "\u7b49\u5f85\u6307\u5b9a\u79d2\u6570", "parameters": {"seconds": {"type": "number", "description": "\u7b49\u5f85\u7684\u79d2\u6570\uff0c\u9ed8\u8ba43", "required": false}}, "examples": [{"seconds": 5}, {}], "category": "general"}, {"name": "browser_done", "description": "\u6807\u8bb0\u4efb\u52a1\u5b8c\u6210", "parameters": {"text": {"type": "string", "description": "\u5b8c\u6210\u63cf\u8ff0", "required": true}, "success": {"type": "boolean", "description": "\u662f\u5426\u6210\u529f\u5b8c\u6210", "required": true}}, "examples": [{"text": "\u4efb\u52a1\u5df2\u5b8c\u6210", "success": true}], "category": "general"}, {"name": "browser_get_page_info", "description": "\u83b7\u53d6\u5f53\u524d\u9875\u9762\u4fe1\u606f", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_get_current_url", "description": "\u83b7\u53d6\u5f53\u524d\u9875\u9762URL", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_close_session", "description": "\u5173\u95ed\u6d4f\u89c8\u5668\u4f1a\u8bdd", "parameters": {}, "examples": [{}], "category": "general"}], "endpoint": "ws://localhost:8084", "connection_params": {}}}
2025-06-28 11:44:10,563 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Waiting for registration response from toolscore...
2025-06-28 11:44:10,563 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "e9fc3e...onnection_params": {}}}' [9625 bytes]
2025-06-28 11:44:10,563 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: browser_use_server (ID: browser_use)
2025-06-28 11:44:10,563 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: browser_use_server
2025-06-28 11:44:10,563 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: browser_use -> ws://localhost:8084
2025-06-28 11:44:10,563 - core.toolscore.core_manager - INFO - 工具立即可用: browser_use
2025-06-28 11:44:10,563 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 11:44:10,563 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Received registration response: {"type": "register_tool_response", "request_id": "e9fc3e30-63b1-4eae-b43f-6a266ceb3555", "success": true, "message": null}
2025-06-28 11:44:10,564 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Successfully registered with toolscore.
2025-06-28 11:44:10,564 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:44:10,564 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 11:44:10,564 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:44:10,564 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 11:44:10,564 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 11:44:10,564 - websockets.server - INFO - connection closed
2025-06-28 11:44:12,455 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:44:12,455 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:44:14,998 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第4次, 5s间隔)
2025-06-28 11:44:15,456 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:44:15,456 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:44:18,457 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:44:18,457 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:44:20,009 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第5次, 5s间隔)
2025-06-28 11:44:21,459 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:44:21,459 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:44:24,461 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:44:24,462 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:44:25,009 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第6次, 5s间隔)
2025-06-28 11:44:27,464 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:44:27,465 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:44:29,973 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:44:29,987 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:44:29,990 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:44:29,990 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:44:29,996 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:44:30,010 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第7次, 5s间隔)
2025-06-28 11:44:30,466 - services.mcp_server_launcher - DEBUG - ⏱️ microsandbox_server 就绪检测超时 (30秒)
2025-06-28 11:44:30,467 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 11:44:30,467 - services.mcp_server_launcher - INFO - ✅ 成功启动 4/4 个MCP服务器: ['microsandbox_server', 'search_tool_server', 'browser_use_server', 'deepsearch_server']
2025-06-28 11:44:30,468 - services.service_manager - INFO - 启动服务: task_api
2025-06-28 11:44:30,468 - services.task_api_service - INFO - 正在启动任务API服务...
2025-06-28 11:44:30,497 - services.task_api_service - INFO - 任务API服务已启动于 0.0.0.0:8000
2025-06-28 11:44:30,497 - services.service_manager - INFO - 启动服务: runtime
2025-06-28 11:44:30,498 - services.runtime_service - INFO - 正在启动推理运行时服务...
2025-06-28 11:44:30,498 - services.service_manager - INFO - 启动服务: synthesis
2025-06-28 11:44:30,498 - services.synthesis_service - INFO - 正在启动合成服务...
2025-06-28 11:44:30,498 - services.synthesis_service - INFO - 合成服务工作线程已启动
2025-06-28 11:44:30,498 - services.synthesis_service - INFO - SynthesisCore v2.0监控器工作线程已启动
2025-06-28 11:44:30,498 - services.synthesis_service - INFO - 开始处理轨迹数据...
2025-06-28 11:44:30,498 - services.synthesis_service - INFO - 🚀 启动SynthesisCore v2.0监控器
2025-06-28 11:44:30,498 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:44:30,498 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:44:30,499 - services.synthesis_service - INFO - 合成服务已启动
2025-06-28 11:44:30,500 - core.synthesiscore.synthesis - INFO - 🔄 Processing only unprocessed trajectories...
2025-06-28 11:44:30,500 - services.service_manager - INFO - 所有服务已启动
2025-06-28 11:44:30,500 - __main__ - DEBUG - ✅ 所有服务启动完成
2025-06-28 11:44:30,500 - __main__ - INFO - 🎉 所有服务已启动，系统运行中...
2025-06-28 11:44:30,500 - __main__ - INFO - 📊 系统状态监控已启用，按 Ctrl+C 停止
2025-06-28 11:44:30,500 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:44:30,501 - services.runtime_service - INFO - 启动运行时实例: enhanced-reasoning-1
2025-06-28 11:44:30,501 - runtimes.reasoning.enhanced_runtime - INFO - 🚀 初始化Enhanced Reasoning Runtime - 简化版本
2025-06-28 11:44:30,501 - core.llm.response_parsers.reasoning_response_parser - DEBUG - ✅ 响应解析器已连接工具Schema管理器
2025-06-28 11:44:30,501 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 工具Schema管理器已注入到响应解析器
2025-06-28 11:44:30,501 - core.synthesiscore.synthesis - INFO - 🎯 Unprocessed trajectories completed: 0 new trajectories processed
2025-06-28 11:44:30,501 - runtimes.reasoning.enhanced_runtime - INFO - ⏳ 等待ToolScore服务就绪...
2025-06-28 11:44:30,503 - services.synthesis_service - DEBUG - 等待 300 秒后再次处理...
2025-06-28 11:44:30,503 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ Redis连接初始化成功
2025-06-28 11:44:30,504 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:corpus_queue
2025-06-28 11:44:30,505 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:atomic_tasks
2025-06-28 11:44:30,506 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:11:44:30 +0800] "GET /health HTTP/1.1" 200 231 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 11:44:30,506 - runtimes.reasoning.toolscore_client - INFO - ✅ ToolScore服务已就绪
2025-06-28 11:44:30,507 - runtimes.reasoning.enhanced_runtime - INFO - ✅ ToolScore HTTP服务已就绪
2025-06-28 11:44:30,507 - runtimes.reasoning.enhanced_runtime - INFO - 🔌 正在连接WebSocket端点: ws://localhost:8081/websocket
2025-06-28 11:44:30,507 - runtimes.reasoning.real_time_tool_client - INFO - 🔌 连接到ToolScore实时更新: ws://localhost:8081/websocket
[2025-06-28 11:44:30] INFO:     Started server process [75982]
[2025-06-28 11:44:30] INFO:     Waiting for application startup.
2025-06-28 11:44:30,515 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:extended_tasks
2025-06-28 11:44:30,516 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:verification_queue
2025-06-28 11:44:30,517 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:44:30,517 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 11:44:30,517 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:training_data
2025-06-28 11:44:30,518 - websockets.client - DEBUG - > GET /websocket HTTP/1.1
2025-06-28 11:44:30,518 - websockets.client - DEBUG - > Host: localhost:8081
2025-06-28 11:44:30,518 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:44:30,518 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:44:30,518 - websockets.client - DEBUG - > Sec-WebSocket-Key: OACiSX8+BwbmMwGybJCBFA==
2025-06-28 11:44:30,518 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:44:30,518 - core.task_api - INFO - Connected to Redis: redis://localhost:6379
2025-06-28 11:44:30,518 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
[2025-06-28 11:44:30] INFO:     Application startup complete.
2025-06-28 11:44:30,518 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:quality_reports
2025-06-28 11:44:30,518 - websockets.client - DEBUG - > User-Agent: Enhanced-Reasoning-Runtime/1.0
2025-06-28 11:44:30,519 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 11:44:30,519 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 11:44:30,519 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 11:44:30,519 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ Redis配置键初始化完成
[2025-06-28 11:44:30] INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-06-28 11:44:30,519 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 11:44:30,519 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ 增强合成Redis管理器初始化完成
2025-06-28 11:44:30,519 - websockets.server - DEBUG - < Sec-WebSocket-Key: OACiSX8+BwbmMwGybJCBFA==
2025-06-28 11:44:30,519 - core.synthesiscore.enhanced_synthesis_engine - INFO - ✅ Enhanced Synthesis Engine 初始化完成
2025-06-28 11:44:30,519 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 11:44:30,519 - core.synthesiscore.enhanced_synthesis_engine - INFO - 🚀 SynthesisCore v2.0 已启动
2025-06-28 11:44:30,519 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:44:30,519 - websockets.server - DEBUG - < User-Agent: Enhanced-Reasoning-Runtime/1.0
2025-06-28 11:44:30,519 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 11:44:30,520 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 11:44:30,520 - core.synthesiscore.trajectory_monitor - INFO - 🔄 检查并处理现有轨迹...
2025-06-28 11:44:30,520 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 11:44:30,520 - core.synthesiscore.trajectory_monitor - INFO - 📝 没有现有轨迹文件
2025-06-28 11:44:30,520 - websockets.server - DEBUG - > Sec-WebSocket-Accept: P+OxwJpCknN5rKCGJgZRTj9Kkdg=
2025-06-28 11:44:30,520 - core.synthesiscore.trajectory_monitor - INFO - ✅ TrajectoryMonitor初始化完成
2025-06-28 11:44:30,520 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:44:30,520 - core.synthesiscore.trajectory_monitor - DEBUG - ✅ 获取主事件循环引用成功
2025-06-28 11:44:30,520 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 03:44:30 GMT
2025-06-28 11:44:30,520 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 11:44:30,520 - websockets.server - INFO - connection open
2025-06-28 11:44:30,520 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 11:44:30,520 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 64427)
2025-06-28 11:44:30,520 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:44:30,522 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:44:30,522 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:44:30,522 - core.synthesiscore.trajectory_monitor - INFO - 👁️ 开始监控轨迹文件变化: output/trajectories
2025-06-28 11:44:30,522 - websockets.client - DEBUG - < Sec-WebSocket-Accept: P+OxwJpCknN5rKCGJgZRTj9Kkdg=
2025-06-28 11:44:30,522 - services.synthesis_service - INFO - ✅ SynthesisCore v2.0监控器已启动
2025-06-28 11:44:30,522 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:44:30,522 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:44:30 GMT
2025-06-28 11:44:30,522 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:44:30,522 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:44:30,522 - runtimes.reasoning.real_time_tool_client - INFO - ✅ 已连接到ToolScore实时更新流
2025-06-28 11:44:30,522 - runtimes.reasoning.enhanced_runtime - INFO - ✅ WebSocket实时更新连接成功
2025-06-28 11:44:30,522 - runtimes.reasoning.real_time_tool_client - DEBUG - 已注册工具更新回调，当前回调数量: 1
2025-06-28 11:44:30,522 - runtimes.reasoning.enhanced_runtime - INFO - ⏳ 等待关键工具完全就绪...
2025-06-28 11:44:30,522 - runtimes.reasoning.enhanced_runtime - WARNING - 🚀 临时跳过详细工具等待，快速启动模式
2025-06-28 11:44:30,522 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 使用快速启动模式，工具将在后台异步就绪
2025-06-28 11:44:30,522 - runtimes.reasoning.enhanced_runtime - INFO - 🔍 开始MCP服务器同步验证...
2025-06-28 11:44:30,522 - core.tool_schema_manager - INFO - 正在执行MCP同步验证...
2025-06-28 11:44:30,523 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=False)，当前缓存: 0 个工具
2025-06-28 11:44:30,523 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 11:44:30,523 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
2025-06-28 11:44:30,523 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 11:44:30,523 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
2025-06-28 11:44:30,523 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
2025-06-28 11:44:30,523 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 11:44:30,523 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 11:44:30,523 - core.tool_schema_manager - INFO - 🔄 检测到 4 个工具需要更新: ['deepsearch', 'microsandbox', 'browser_use', 'mcp-search-tool']
2025-06-28 11:44:30,523 - core.tool_schema_manager - INFO - 🔄 执行增量更新: 4 个工具
2025-06-28 11:44:30,523 - core.tool_schema_manager - INFO - 🔄 缓存为空，转为全量刷新模式
2025-06-28 11:44:30,523 - core.tool_schema_manager - DEBUG - 🔄 开始增强刷新工具Schemas...
2025-06-28 11:44:30,523 - core.tool_schema_manager - DEBUG - 🔍 工具注册表状态检查: _tools 字典包含 4 个条目
2025-06-28 11:44:30,523 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: deepsearch
2025-06-28 11:44:30,523 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: microsandbox
2025-06-28 11:44:30,523 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: browser_use
2025-06-28 11:44:30,523 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: mcp-search-tool
2025-06-28 11:44:30,523 - core.tool_schema_manager - INFO - 🔧 选项1: 从工具注册表获取到 4 个工具
2025-06-28 11:44:30,523 - core.tool_schema_manager - DEBUG -   工具 0: id=deepsearch, name=网络信息研究工具, actions=3
2025-06-28 11:44:30,524 - core.tool_schema_manager - DEBUG -   工具 1: id=microsandbox, name=MicroSandbox安全代码执行器, actions=7
2025-06-28 11:44:30,524 - core.tool_schema_manager - DEBUG -   工具 2: id=browser_use, name=智能浏览器操作工具, actions=6
2025-06-28 11:44:30,524 - core.tool_schema_manager - DEBUG -   工具 3: id=mcp-search-tool, name=工具管理和项目文件搜索器, actions=4
2025-06-28 11:44:30,524 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: deepsearch
2025-06-28 11:44:30,525 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: comprehensive_research
2025-06-28 11:44:30,525 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: quick_research
2025-06-28 11:44:30,526 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: research
2025-06-28 11:44:30,526 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 deepsearch (包含 3 个动作)
2025-06-28 11:44:30,526 - core.tool_schema_manager - DEBUG -    当前缓存大小: 1 个工具
2025-06-28 11:44:30,526 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: microsandbox
2025-06-28 11:44:30,526 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_cleanup_expired
2025-06-28 11:44:30,527 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_close_session
2025-06-28 11:44:30,527 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_execute
2025-06-28 11:44:30,527 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_health_status
2025-06-28 11:44:30,527 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_performance_stats
2025-06-28 11:44:30,527 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_install_package
2025-06-28 11:44:30,527 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_list_sessions
2025-06-28 11:44:30,527 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 microsandbox (包含 7 个动作)
2025-06-28 11:44:30,528 - core.tool_schema_manager - DEBUG -    当前缓存大小: 2 个工具
2025-06-28 11:44:30,528 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: browser_use
2025-06-28 11:44:30,528 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_click_element
2025-06-28 11:44:30,528 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_use_execute_task
2025-06-28 11:44:30,528 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_extract_content
2025-06-28 11:44:30,528 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_input_text
2025-06-28 11:44:30,528 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_navigate
2025-06-28 11:44:30,529 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_search_google
2025-06-28 11:44:30,529 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 browser_use (包含 6 个动作)
2025-06-28 11:44:30,529 - core.tool_schema_manager - DEBUG -    当前缓存大小: 3 个工具
2025-06-28 11:44:30,529 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: mcp-search-tool
2025-06-28 11:44:30,529 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: analyze_tool_needs
2025-06-28 11:44:30,529 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: list_code_definitions
2025-06-28 11:44:30,529 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_and_install_tools
2025-06-28 11:44:30,529 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_file_content
2025-06-28 11:44:30,529 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 mcp-search-tool (包含 4 个动作)
2025-06-28 11:44:30,529 - core.tool_schema_manager - DEBUG -    当前缓存大小: 4 个工具
2025-06-28 11:44:30,529 - core.tool_schema_manager - INFO - 🔧 选项1: 成功处理 4/4 个工具，当前缓存 4 个工具
2025-06-28 11:44:30,530 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: mcp-search-tool
2025-06-28 11:44:30,530 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: microsandbox
2025-06-28 11:44:30,530 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: browser_use
2025-06-28 11:44:30,530 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: deepsearch
2025-06-28 11:44:30,530 - core.tool_schema_manager - INFO - ✅ 增强刷新完成，当前可用工具: 4个
2025-06-28 11:44:30,531 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:44:30,531 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:44:30,531 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:44:30,532 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:44:30,532 - core.tool_schema_manager - INFO - ✅ Schema安全刷新完成，备份 4 个工具
2025-06-28 11:44:30,532 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:44:30,532 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:44:30,532 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:44:30,533 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:44:30,533 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 11:44:30,533 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 11:44:30,533 - core.tool_schema_manager - INFO - 🔍 同步验证完成: unhealthy (0/4 工具Schema一致)
2025-06-28 11:44:30,533 - runtimes.reasoning.enhanced_runtime - ERROR - ❌ MCP服务器同步验证失败: 未知错误
2025-06-28 11:44:30,533 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔧 开始获取可用工具ID列表...
2025-06-28 11:44:30,533 - runtimes.reasoning.real_time_tool_client - DEBUG - 可用工具ID列表: ['deepsearch', 'microsandbox', 'browser_use', 'mcp-search-tool']
2025-06-28 11:44:30,533 - runtimes.reasoning.enhanced_runtime - DEBUG - 📋 获取到的工具列表: ['deepsearch', 'microsandbox', 'browser_use', 'mcp-search-tool']
2025-06-28 11:44:30,533 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 工具Schema管理器已初始化
2025-06-28 11:44:30,533 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔧 更新Guardrails和ValidationCritic工具配置...
2025-06-28 11:44:30,533 - core.llm.guardrails_middleware - INFO - 🔧 初始化输入验证Guard...
2025-06-28 11:44:30,535 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:44:30,536 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:44:30,536 - core.llm.guardrails_middleware - INFO - 🔧 初始化输出验证Guard...
2025-06-28 11:44:30,536 - core.llm.guardrails_middleware - INFO - 🔧 使用本地LLM客户端初始化Guard...
2025-06-28 11:44:30,538 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:44:30,538 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:44:30,538 - core.llm.guardrails_middleware - INFO - ✅ 使用LLM的Guard创建成功
2025-06-28 11:44:30,538 - core.llm.guardrails_middleware - INFO - ✅ Guardrails Guards初始化成功
2025-06-28 11:44:30,538 - core.llm.guardrails_middleware - INFO -    - 输入Guard: ✅
2025-06-28 11:44:30,538 - core.llm.guardrails_middleware - INFO -    - 输出Guard: ✅
2025-06-28 11:44:30,538 - core.llm.guardrails_middleware - INFO - 🔄 Guardrails工具列表已更新: 4个工具
2025-06-28 11:44:30,538 - core.agents.validation_critic - INFO - 🔄 ValidationCritic工具列表已更新: 4个工具
2025-06-28 11:44:30,538 - runtimes.reasoning.enhanced_runtime - INFO - ✅ Guardrails和ValidationCritic已配置4个工具: deepsearch, microsandbox, browser_use, mcp-search-tool
2025-06-28 11:44:30,538 - runtimes.reasoning.enhanced_runtime - INFO - ✅ Enhanced Reasoning Runtime 已成功初始化为纯推理引擎（集成Guardrails + ValidationCritic）
2025-06-28 11:44:30,540 - services.runtime_service - INFO - 启动运行时任务消费: enhanced-reasoning-1
2025-06-28 11:44:30,541 - services.runtime_service - INFO - 推理运行时服务已启动 1 个实例和 1 个任务消费协程
2025-06-28 11:44:30,541 - core.tool_schema_manager - INFO - 🔍 启动MCP服务器配置监控...
2025-06-28 11:44:30,541 - core.task_manager - INFO - Runtime enhanced-reasoning-1 starting to consume from queue: tasks:reasoning
2025-06-28 11:44:30,542 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/search_tool_server/service.json
2025-06-28 11:44:30,542 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/microsandbox_server/service.json
2025-06-28 11:44:30,542 - core.task_manager - INFO - Runtime enhanced-reasoning-1 starting consumer loop for queue tasks:reasoning
2025-06-28 11:44:30,542 - core.task_manager - DEBUG - Runtime enhanced-reasoning-1 reading from queue tasks:reasoning...
2025-06-28 11:44:30,542 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/browser_use_server/service.json
2025-06-28 11:44:30,543 - core.task_manager - INFO - Runtime enhanced-reasoning-1 received 1 message(s) from queue tasks:reasoning
2025-06-28 11:44:30,543 - core.task_manager - INFO - Runtime enhanced-reasoning-1 processing message b'1751038804209-0'
2025-06-28 11:44:30,543 - core.task_manager - INFO - Processing task bbb0c95d-07fc-4d21-9eda-b59cfd978440 from queue tasks:reasoning
2025-06-28 11:44:30,543 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/deepsearch_server/service.json
2025-06-28 11:44:30,543 - core.tool_schema_manager - INFO - 🔄 MCP配置变化，强制刷新schema...
2025-06-28 11:44:30,543 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=True)，当前缓存: 0 个工具
2025-06-28 11:44:30,543 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 11:44:30,543 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
2025-06-28 11:44:30,543 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 11:44:30,543 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
2025-06-28 11:44:30,543 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
2025-06-28 11:44:30,543 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 11:44:30,543 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 11:44:30,543 - core.tool_schema_manager - INFO - 🔄 检测到 4 个工具需要更新: ['deepsearch', 'microsandbox', 'browser_use', 'mcp-search-tool']
2025-06-28 11:44:30,543 - core.tool_schema_manager - INFO - 🔄 执行增量更新: 4 个工具
2025-06-28 11:44:30,543 - core.tool_schema_manager - INFO - 🔄 缓存为空，转为全量刷新模式
2025-06-28 11:44:30,543 - core.tool_schema_manager - DEBUG - 🔄 开始增强刷新工具Schemas...
2025-06-28 11:44:30,543 - core.tool_schema_manager - DEBUG - 🔍 工具注册表状态检查: _tools 字典包含 4 个条目
2025-06-28 11:44:30,543 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: deepsearch
2025-06-28 11:44:30,543 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: microsandbox
2025-06-28 11:44:30,543 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: browser_use
2025-06-28 11:44:30,543 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: mcp-search-tool
2025-06-28 11:44:30,543 - core.tool_schema_manager - INFO - 🔧 选项1: 从工具注册表获取到 4 个工具
2025-06-28 11:44:30,543 - core.tool_schema_manager - DEBUG -   工具 0: id=deepsearch, name=网络信息研究工具, actions=3
2025-06-28 11:44:30,543 - core.tool_schema_manager - DEBUG -   工具 1: id=microsandbox, name=MicroSandbox安全代码执行器, actions=7
2025-06-28 11:44:30,543 - core.tool_schema_manager - DEBUG -   工具 2: id=browser_use, name=智能浏览器操作工具, actions=6
2025-06-28 11:44:30,543 - core.tool_schema_manager - DEBUG -   工具 3: id=mcp-search-tool, name=工具管理和项目文件搜索器, actions=4
2025-06-28 11:44:30,543 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: deepsearch
2025-06-28 11:44:30,544 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: comprehensive_research
2025-06-28 11:44:30,544 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: quick_research
2025-06-28 11:44:30,545 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: research
2025-06-28 11:44:30,545 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 deepsearch (包含 3 个动作)
2025-06-28 11:44:30,545 - core.tool_schema_manager - DEBUG -    当前缓存大小: 1 个工具
2025-06-28 11:44:30,545 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: microsandbox
2025-06-28 11:44:30,545 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_cleanup_expired
2025-06-28 11:44:30,545 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_close_session
2025-06-28 11:44:30,545 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_execute
2025-06-28 11:44:30,545 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_health_status
2025-06-28 11:44:30,545 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_performance_stats
2025-06-28 11:44:30,545 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_install_package
2025-06-28 11:44:30,546 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_list_sessions
2025-06-28 11:44:30,546 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 microsandbox (包含 7 个动作)
2025-06-28 11:44:30,546 - core.tool_schema_manager - DEBUG -    当前缓存大小: 2 个工具
2025-06-28 11:44:30,546 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: browser_use
2025-06-28 11:44:30,546 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_click_element
2025-06-28 11:44:30,546 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_use_execute_task
2025-06-28 11:44:30,546 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_extract_content
2025-06-28 11:44:30,546 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_input_text
2025-06-28 11:44:30,546 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_navigate
2025-06-28 11:44:30,546 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_search_google
2025-06-28 11:44:30,546 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 browser_use (包含 6 个动作)
2025-06-28 11:44:30,546 - core.tool_schema_manager - DEBUG -    当前缓存大小: 3 个工具
2025-06-28 11:44:30,546 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: mcp-search-tool
2025-06-28 11:44:30,547 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: analyze_tool_needs
2025-06-28 11:44:30,547 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: list_code_definitions
2025-06-28 11:44:30,547 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_and_install_tools
2025-06-28 11:44:30,548 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-48' coro=<start.<locals>.start_all_runtimes() running at /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/services/runtime_service.py:95> wait_for=<_GatheringFuture pending cb=[Task.task_wakeup()]>>
2025-06-28 11:44:30,548 - services.runtime_service - INFO - 运行时服务正常停止，取消所有任务
[2025-06-28 11:44:30] Exception ignored in: [2025-06-28 11:44:30] <coroutine object start.<locals>.start_all_runtimes at 0x10b66f370>
[2025-06-28 11:44:30] Traceback (most recent call last):
[2025-06-28 11:44:30]   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/pydantic/_internal/_config.py", line 151, in __getattr__
    [2025-06-28 11:44:30] return self.config_dict[name]
           [2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ^[2025-06-28 11:44:30] ^[2025-06-28 11:44:30] ^[2025-06-28 11:44:30] ^[2025-06-28 11:44:30] ^[2025-06-28 11:44:30] ^
[2025-06-28 11:44:30] RuntimeError[2025-06-28 11:44:30] : [2025-06-28 11:44:30] coroutine ignored GeneratorExit
2025-06-28 11:44:30,548 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task cancelling name='runtime-enhanced-reasoning-1' coro=<start_runtime_service() running at /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/core/task_manager.py:388> wait_for=<Future cancelled> cb=[gather.<locals>._done_callback() at /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/tasks.py:764, gather.<locals>._done_callback() at /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/tasks.py:764]>
2025-06-28 11:44:30,548 - core.task_manager - ERROR - ❌ Runtime enhanced-reasoning-1 crashed: coroutine ignored GeneratorExit
Traceback (most recent call last):
  File "/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/core/task_manager.py", line 388, in start_runtime_service
    await _run_service()
RuntimeError: coroutine ignored GeneratorExit
[2025-06-28 11:44:30] Exception ignored in: [2025-06-28 11:44:30] <coroutine object start_runtime_service at 0x10bed4040>
[2025-06-28 11:44:30] Traceback (most recent call last):
[2025-06-28 11:44:30]   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/pydantic/_internal/_config.py", line 151, in __getattr__
    [2025-06-28 11:44:30] return self.config_dict[name]
           [2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ~[2025-06-28 11:44:30] ^[2025-06-28 11:44:30] ^[2025-06-28 11:44:30] ^[2025-06-28 11:44:30] ^[2025-06-28 11:44:30] ^[2025-06-28 11:44:30] ^
[2025-06-28 11:44:30] RuntimeError[2025-06-28 11:44:30] : [2025-06-28 11:44:30] coroutine ignored GeneratorExit
2025-06-28 11:44:30,550 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_file_content
2025-06-28 11:44:30,550 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 mcp-search-tool (包含 4 个动作)
2025-06-28 11:44:30,550 - core.tool_schema_manager - DEBUG -    当前缓存大小: 4 个工具
2025-06-28 11:44:30,550 - core.tool_schema_manager - INFO - 🔧 选项1: 成功处理 4/4 个工具，当前缓存 4 个工具
2025-06-28 11:44:30,550 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: mcp-search-tool
2025-06-28 11:44:30,550 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: microsandbox
2025-06-28 11:44:30,550 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: browser_use
2025-06-28 11:44:30,550 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: deepsearch
2025-06-28 11:44:30,551 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:11:44:30 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 11:44:30,551 - core.tool_schema_manager - DEBUG - 🔍 从ToolScore获取到工具列表: ['mcp-search-tool', 'microsandbox', 'browser_use', 'deepsearch']
2025-06-28 11:44:30,551 - core.tool_schema_manager - DEBUG - 🔧 映射后的工具列表: ['mcp-search-tool', 'microsandbox', 'browser_use', 'deepsearch']
2025-06-28 11:44:30,551 - core.tool_schema_manager - DEBUG - ⏭️ 工具 mcp-search-tool 已在缓存中，跳过ToolScore获取
2025-06-28 11:44:30,551 - core.tool_schema_manager - DEBUG - ⏭️ 工具 microsandbox 已在缓存中，跳过ToolScore获取
2025-06-28 11:44:30,551 - core.tool_schema_manager - DEBUG - ⏭️ 工具 browser_use 已在缓存中，跳过ToolScore获取
2025-06-28 11:44:30,551 - core.tool_schema_manager - DEBUG - ⏭️ 工具 deepsearch 已在缓存中，跳过ToolScore获取
2025-06-28 11:44:30,551 - core.tool_schema_manager - INFO - ✅ 增强刷新完成，当前可用工具: 4个
2025-06-28 11:44:30,551 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:44:30,552 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:44:30,552 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:44:30,552 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:44:30,552 - core.tool_schema_manager - INFO - ✅ Schema安全刷新完成，备份 4 个工具
2025-06-28 11:44:30,552 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:44:30,553 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:44:30,553 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:44:30,553 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:44:30,553 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 11:44:30,553 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 11:44:35,011 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第8次, 5s间隔)
2025-06-28 11:44:40,013 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第9次, 5s间隔)
2025-06-28 11:44:45,014 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第10次, 5s间隔)
2025-06-28 11:44:50,016 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第11次, 5s间隔)
2025-06-28 11:44:50,531 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:44:50,532 - websockets.client - DEBUG - > PING '\\UAJ' [text, 4 bytes]
2025-06-28 11:44:50,532 - websockets.server - DEBUG - < PING '\\UAJ' [text, 4 bytes]
2025-06-28 11:44:50,532 - websockets.server - DEBUG - > PONG '\\UAJ' [text, 4 bytes]
2025-06-28 11:44:50,532 - websockets.client - DEBUG - < PONG '\\UAJ' [text, 4 bytes]
2025-06-28 11:44:50,533 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:44:55,018 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第12次, 5s间隔)
2025-06-28 11:44:57,579 - core.task_api - INFO - Task e0f9babf-4032-4992-a646-849397e9d78c submitted successfully
[2025-06-28 11:44:57] INFO:     127.0.0.1:64502 - "POST /api/v1/tasks HTTP/1.1" 200 OK
2025-06-28 11:44:59,979 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:44:59,990 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:44:59,991 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:44:59,991 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:45:00,001 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:45:00,019 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第13次, 30s间隔)
2025-06-28 11:45:00,521 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:45:00,522 - websockets.server - DEBUG - > PING e5 06 74 d9 [binary, 4 bytes]
2025-06-28 11:45:00,523 - websockets.client - DEBUG - < PING e5 06 74 d9 [binary, 4 bytes]
2025-06-28 11:45:00,523 - websockets.client - DEBUG - > PONG e5 06 74 d9 [binary, 4 bytes]
2025-06-28 11:45:00,523 - websockets.server - DEBUG - < PONG e5 06 74 d9 [binary, 4 bytes]
2025-06-28 11:45:00,523 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:45:10,534 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:45:10,535 - websockets.client - DEBUG - > PING 51 ff d5 9a [binary, 4 bytes]
2025-06-28 11:45:10,535 - websockets.server - DEBUG - < PING 51 ff d5 9a [binary, 4 bytes]
2025-06-28 11:45:10,535 - websockets.server - DEBUG - > PONG 51 ff d5 9a [binary, 4 bytes]
2025-06-28 11:45:10,536 - websockets.client - DEBUG - < PONG 51 ff d5 9a [binary, 4 bytes]
2025-06-28 11:45:10,536 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:45:29,985 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:45:29,995 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:45:29,996 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:45:29,996 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:45:30,007 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:45:30,020 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第14次, 30s间隔)
2025-06-28 11:45:30,501 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 1m 0s
2025-06-28 11:45:30,524 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:45:30,525 - websockets.server - DEBUG - > PING b9 0f 56 e0 [binary, 4 bytes]
2025-06-28 11:45:30,525 - websockets.client - DEBUG - < PING b9 0f 56 e0 [binary, 4 bytes]
2025-06-28 11:45:30,525 - websockets.client - DEBUG - > PONG b9 0f 56 e0 [binary, 4 bytes]
2025-06-28 11:45:30,526 - websockets.server - DEBUG - < PONG b9 0f 56 e0 [binary, 4 bytes]
2025-06-28 11:45:30,526 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:45:30,537 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:45:30,537 - websockets.client - DEBUG - > PING 'Ֆ\x1eP' [text, 4 bytes]
2025-06-28 11:45:30,538 - websockets.server - DEBUG - < PING 'Ֆ\x1eP' [text, 4 bytes]
2025-06-28 11:45:30,538 - websockets.server - DEBUG - > PONG 'Ֆ\x1eP' [text, 4 bytes]
2025-06-28 11:45:30,538 - websockets.client - DEBUG - < PONG 'Ֆ\x1eP' [text, 4 bytes]
2025-06-28 11:45:30,539 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:45:50,540 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:45:50,541 - websockets.client - DEBUG - > PING 69 f8 35 d7 [binary, 4 bytes]
2025-06-28 11:45:50,541 - websockets.server - DEBUG - < PING 69 f8 35 d7 [binary, 4 bytes]
2025-06-28 11:45:50,541 - websockets.server - DEBUG - > PONG 69 f8 35 d7 [binary, 4 bytes]
2025-06-28 11:45:50,542 - websockets.client - DEBUG - < PONG 69 f8 35 d7 [binary, 4 bytes]
2025-06-28 11:45:50,542 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:45:59,992 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:46:00,001 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:46:00,002 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:46:00,002 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:46:00,012 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:46:00,020 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第15次, 30s间隔)
2025-06-28 11:46:00,527 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:46:00,527 - websockets.server - DEBUG - > PING 66 09 41 da [binary, 4 bytes]
2025-06-28 11:46:00,528 - websockets.client - DEBUG - < PING 66 09 41 da [binary, 4 bytes]
2025-06-28 11:46:00,528 - websockets.client - DEBUG - > PONG 66 09 41 da [binary, 4 bytes]
2025-06-28 11:46:00,528 - websockets.server - DEBUG - < PONG 66 09 41 da [binary, 4 bytes]
2025-06-28 11:46:00,529 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:46:10,543 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:46:10,543 - websockets.client - DEBUG - > PING bb cc ca 34 [binary, 4 bytes]
2025-06-28 11:46:10,544 - websockets.server - DEBUG - < PING bb cc ca 34 [binary, 4 bytes]
2025-06-28 11:46:10,544 - websockets.server - DEBUG - > PONG bb cc ca 34 [binary, 4 bytes]
2025-06-28 11:46:10,545 - websockets.client - DEBUG - < PONG bb cc ca 34 [binary, 4 bytes]
2025-06-28 11:46:10,545 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:46:29,999 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:46:30,007 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:46:30,009 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:46:30,009 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:46:30,019 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:46:30,021 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第16次, 30s间隔)
2025-06-28 11:46:30,503 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 2m 0s
2025-06-28 11:46:30,530 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:46:30,530 - websockets.server - DEBUG - > PING da b2 b8 25 [binary, 4 bytes]
2025-06-28 11:46:30,531 - websockets.client - DEBUG - < PING da b2 b8 25 [binary, 4 bytes]
2025-06-28 11:46:30,531 - websockets.client - DEBUG - > PONG da b2 b8 25 [binary, 4 bytes]
2025-06-28 11:46:30,531 - websockets.server - DEBUG - < PONG da b2 b8 25 [binary, 4 bytes]
2025-06-28 11:46:30,532 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:46:30,545 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:46:30,546 - websockets.client - DEBUG - > PING 96 9a 6f f8 [binary, 4 bytes]
2025-06-28 11:46:30,546 - websockets.server - DEBUG - < PING 96 9a 6f f8 [binary, 4 bytes]
2025-06-28 11:46:30,547 - websockets.server - DEBUG - > PONG 96 9a 6f f8 [binary, 4 bytes]
2025-06-28 11:46:30,547 - websockets.client - DEBUG - < PONG 96 9a 6f f8 [binary, 4 bytes]
2025-06-28 11:46:30,547 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:46:50,549 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:46:50,549 - websockets.client - DEBUG - > PING a3 e4 30 8e [binary, 4 bytes]
2025-06-28 11:46:50,549 - websockets.server - DEBUG - < PING a3 e4 30 8e [binary, 4 bytes]
2025-06-28 11:46:50,550 - websockets.server - DEBUG - > PONG a3 e4 30 8e [binary, 4 bytes]
2025-06-28 11:46:50,550 - websockets.client - DEBUG - < PONG a3 e4 30 8e [binary, 4 bytes]
2025-06-28 11:46:50,550 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:47:00,005 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:47:00,013 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:47:00,014 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:47:00,015 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:47:00,021 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第17次, 30s间隔)
2025-06-28 11:47:00,021 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:47:00,532 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:47:00,532 - websockets.server - DEBUG - > PING 2d 05 10 88 [binary, 4 bytes]
2025-06-28 11:47:00,533 - websockets.client - DEBUG - < PING 2d 05 10 88 [binary, 4 bytes]
2025-06-28 11:47:00,533 - websockets.client - DEBUG - > PONG 2d 05 10 88 [binary, 4 bytes]
2025-06-28 11:47:00,534 - websockets.server - DEBUG - < PONG 2d 05 10 88 [binary, 4 bytes]
2025-06-28 11:47:00,534 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:47:10,551 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:47:10,552 - websockets.client - DEBUG - > PING 28 7c 92 0b [binary, 4 bytes]
2025-06-28 11:47:10,553 - websockets.server - DEBUG - < PING 28 7c 92 0b [binary, 4 bytes]
2025-06-28 11:47:10,553 - websockets.server - DEBUG - > PONG 28 7c 92 0b [binary, 4 bytes]
2025-06-28 11:47:10,553 - websockets.client - DEBUG - < PONG 28 7c 92 0b [binary, 4 bytes]
2025-06-28 11:47:10,553 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:47:30,012 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:47:30,016 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:47:30,017 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:47:30,017 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:47:30,022 - core.task_processing.task_loader - INFO - 📋 任务文件 tasks.jsonl 不存在，等待... (第18次, 30s间隔) - 建议通过API提交任务
2025-06-28 11:47:30,027 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:47:30,504 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 3m 0s
2025-06-28 11:47:30,534 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:47:30,535 - websockets.server - DEBUG - > PING 95 9b 30 99 [binary, 4 bytes]
2025-06-28 11:47:30,535 - websockets.client - DEBUG - < PING 95 9b 30 99 [binary, 4 bytes]
2025-06-28 11:47:30,535 - websockets.client - DEBUG - > PONG 95 9b 30 99 [binary, 4 bytes]
2025-06-28 11:47:30,536 - websockets.server - DEBUG - < PONG 95 9b 30 99 [binary, 4 bytes]
2025-06-28 11:47:30,536 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:47:30,554 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:47:30,555 - websockets.client - DEBUG - > PING ff dc ad 23 [binary, 4 bytes]
2025-06-28 11:47:30,555 - websockets.server - DEBUG - < PING ff dc ad 23 [binary, 4 bytes]
2025-06-28 11:47:30,555 - websockets.server - DEBUG - > PONG ff dc ad 23 [binary, 4 bytes]
2025-06-28 11:47:30,556 - websockets.client - DEBUG - < PONG ff dc ad 23 [binary, 4 bytes]
2025-06-28 11:47:30,556 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:47:50,557 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:47:50,558 - websockets.client - DEBUG - > PING 19 97 c7 13 [binary, 4 bytes]
2025-06-28 11:47:50,558 - websockets.server - DEBUG - < PING 19 97 c7 13 [binary, 4 bytes]
2025-06-28 11:47:50,558 - websockets.server - DEBUG - > PONG 19 97 c7 13 [binary, 4 bytes]
2025-06-28 11:47:50,559 - websockets.client - DEBUG - < PONG 19 97 c7 13 [binary, 4 bytes]
2025-06-28 11:47:50,559 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:48:00,018 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:48:00,019 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:48:00,022 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:48:00,022 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:48:00,023 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第19次, 30s间隔)
2025-06-28 11:48:00,031 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:48:00,537 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:48:00,538 - websockets.server - DEBUG - > PING b6 71 57 5c [binary, 4 bytes]
2025-06-28 11:48:00,538 - websockets.client - DEBUG - < PING b6 71 57 5c [binary, 4 bytes]
2025-06-28 11:48:00,539 - websockets.client - DEBUG - > PONG b6 71 57 5c [binary, 4 bytes]
2025-06-28 11:48:00,539 - websockets.server - DEBUG - < PONG b6 71 57 5c [binary, 4 bytes]
2025-06-28 11:48:00,539 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:48:10,559 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:48:10,560 - websockets.client - DEBUG - > PING d9 fa 29 a5 [binary, 4 bytes]
2025-06-28 11:48:10,561 - websockets.server - DEBUG - < PING d9 fa 29 a5 [binary, 4 bytes]
2025-06-28 11:48:10,561 - websockets.server - DEBUG - > PONG d9 fa 29 a5 [binary, 4 bytes]
2025-06-28 11:48:10,561 - websockets.client - DEBUG - < PONG d9 fa 29 a5 [binary, 4 bytes]
2025-06-28 11:48:10,561 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:48:30,024 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第20次, 30s间隔)
2025-06-28 11:48:30,025 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:48:30,025 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:48:30,026 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:48:30,027 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:48:30,032 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:48:30,505 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 4m 0s
2025-06-28 11:48:30,540 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:48:30,540 - websockets.server - DEBUG - > PING 1a 08 95 a2 [binary, 4 bytes]
2025-06-28 11:48:30,541 - websockets.client - DEBUG - < PING 1a 08 95 a2 [binary, 4 bytes]
2025-06-28 11:48:30,541 - websockets.client - DEBUG - > PONG 1a 08 95 a2 [binary, 4 bytes]
2025-06-28 11:48:30,541 - websockets.server - DEBUG - < PONG 1a 08 95 a2 [binary, 4 bytes]
2025-06-28 11:48:30,541 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:48:30,562 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:48:30,562 - websockets.client - DEBUG - > PING 31 a6 7f 0f [binary, 4 bytes]
2025-06-28 11:48:30,563 - websockets.server - DEBUG - < PING 31 a6 7f 0f [binary, 4 bytes]
2025-06-28 11:48:30,563 - websockets.server - DEBUG - > PONG 31 a6 7f 0f [binary, 4 bytes]
2025-06-28 11:48:30,563 - websockets.client - DEBUG - < PONG 31 a6 7f 0f [binary, 4 bytes]
2025-06-28 11:48:30,563 - websockets.client - DEBUG - % received keepalive pong
[2025-06-28 11:48:42] INFO:     127.0.0.1:64837 - "GET /api/v1/tasks/e0f9babf-4032-4992-a646-849397e9d78c HTTP/1.1" 200 OK
2025-06-28 11:48:50,564 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:48:50,565 - websockets.client - DEBUG - > PING 87 fe 62 97 [binary, 4 bytes]
2025-06-28 11:48:50,565 - websockets.server - DEBUG - < PING 87 fe 62 97 [binary, 4 bytes]
2025-06-28 11:48:50,565 - websockets.server - DEBUG - > PONG 87 fe 62 97 [binary, 4 bytes]
2025-06-28 11:48:50,565 - websockets.client - DEBUG - < PONG 87 fe 62 97 [binary, 4 bytes]
2025-06-28 11:48:50,565 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:49:00,026 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第21次, 30s间隔)
2025-06-28 11:49:00,030 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:49:00,030 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:49:00,032 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:49:00,032 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:49:00,038 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:49:00,542 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:49:00,542 - websockets.server - DEBUG - > PING 35 e9 1f de [binary, 4 bytes]
2025-06-28 11:49:00,542 - websockets.client - DEBUG - < PING 35 e9 1f de [binary, 4 bytes]
2025-06-28 11:49:00,542 - websockets.client - DEBUG - > PONG 35 e9 1f de [binary, 4 bytes]
2025-06-28 11:49:00,543 - websockets.server - DEBUG - < PONG 35 e9 1f de [binary, 4 bytes]
2025-06-28 11:49:00,543 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:49:10,566 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:49:10,567 - websockets.client - DEBUG - > PING d2 e5 72 54 [binary, 4 bytes]
2025-06-28 11:49:10,567 - websockets.server - DEBUG - < PING d2 e5 72 54 [binary, 4 bytes]
2025-06-28 11:49:10,567 - websockets.server - DEBUG - > PONG d2 e5 72 54 [binary, 4 bytes]
2025-06-28 11:49:10,568 - websockets.client - DEBUG - < PONG d2 e5 72 54 [binary, 4 bytes]
2025-06-28 11:49:10,568 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:49:30,029 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第22次, 30s间隔)
2025-06-28 11:49:30,036 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:49:30,037 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:49:30,042 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:49:30,042 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:49:30,043 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:49:30,506 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 5m 0s
2025-06-28 11:49:30,540 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔍 执行定期MCP同步验证...
2025-06-28 11:49:30,540 - core.tool_schema_manager - INFO - 正在执行MCP同步验证...
2025-06-28 11:49:30,540 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=False)，当前缓存: 4 个工具
2025-06-28 11:49:30,541 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 11:49:30,541 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
2025-06-28 11:49:30,542 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 11:49:30,542 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
2025-06-28 11:49:30,542 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
2025-06-28 11:49:30,542 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 11:49:30,542 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 11:49:30,543 - core.tool_schema_manager - DEBUG - 📊 Schema版本无变化，跳过更新
2025-06-28 11:49:30,544 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:49:30,544 - websockets.server - DEBUG - > PING 4f c1 3b 58 [binary, 4 bytes]
2025-06-28 11:49:30,546 - websockets.client - DEBUG - < PING 4f c1 3b 58 [binary, 4 bytes]
2025-06-28 11:49:30,546 - websockets.client - DEBUG - > PONG 4f c1 3b 58 [binary, 4 bytes]
2025-06-28 11:49:30,547 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:49:30,547 - websockets.server - DEBUG - < PONG 4f c1 3b 58 [binary, 4 bytes]
2025-06-28 11:49:30,547 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:49:30,548 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:49:30,550 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:49:30,551 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:49:30,552 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 11:49:30,552 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 11:49:30,552 - core.tool_schema_manager - INFO - 🔍 同步验证完成: unhealthy (0/4 工具Schema一致)
2025-06-28 11:49:30,552 - runtimes.reasoning.enhanced_runtime - WARNING - ⚠️ MCP同步验证发现问题: {'total_tools': 4, 'connected_tools': 0, 'schema_consistent_tools': 0, 'failed_tools': 0}
2025-06-28 11:49:30,569 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:49:30,569 - websockets.client - DEBUG - > PING e6 c5 73 8d [binary, 4 bytes]
2025-06-28 11:49:30,569 - websockets.server - DEBUG - < PING e6 c5 73 8d [binary, 4 bytes]
2025-06-28 11:49:30,570 - websockets.server - DEBUG - > PONG e6 c5 73 8d [binary, 4 bytes]
2025-06-28 11:49:30,570 - websockets.client - DEBUG - < PONG e6 c5 73 8d [binary, 4 bytes]
2025-06-28 11:49:30,570 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:49:31,637 - services.synthesis_service - INFO - 开始处理轨迹数据...
2025-06-28 11:49:31,637 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:49:31,638 - core.synthesiscore.synthesis - INFO - 🔄 Processing only unprocessed trajectories...
2025-06-28 11:49:31,638 - core.synthesiscore.synthesis - INFO - 🎯 Unprocessed trajectories completed: 0 new trajectories processed
2025-06-28 11:49:31,639 - services.synthesis_service - DEBUG - 等待 300 秒后再次处理...
2025-06-28 11:49:50,571 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:49:50,572 - websockets.client - DEBUG - > PING cd 32 0a 8c [binary, 4 bytes]
2025-06-28 11:49:50,572 - websockets.server - DEBUG - < PING cd 32 0a 8c [binary, 4 bytes]
2025-06-28 11:49:50,572 - websockets.server - DEBUG - > PONG cd 32 0a 8c [binary, 4 bytes]
2025-06-28 11:49:50,572 - websockets.client - DEBUG - < PONG cd 32 0a 8c [binary, 4 bytes]
2025-06-28 11:49:50,573 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:50:00,031 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第23次, 30s间隔)
2025-06-28 11:50:00,041 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:50:00,042 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:50:00,042 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:50:00,043 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:50:00,048 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:50:00,548 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:50:00,549 - websockets.server - DEBUG - > PING '\x0eGJ\x13' [text, 4 bytes]
2025-06-28 11:50:00,549 - websockets.client - DEBUG - < PING '\x0eGJ\x13' [text, 4 bytes]
2025-06-28 11:50:00,549 - websockets.client - DEBUG - > PONG '\x0eGJ\x13' [text, 4 bytes]
2025-06-28 11:50:00,550 - websockets.server - DEBUG - < PONG '\x0eGJ\x13' [text, 4 bytes]
2025-06-28 11:50:00,550 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:50:10,574 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:50:10,574 - websockets.client - DEBUG - > PING 52 8f 06 f1 [binary, 4 bytes]
2025-06-28 11:50:10,575 - websockets.server - DEBUG - < PING 52 8f 06 f1 [binary, 4 bytes]
2025-06-28 11:50:10,575 - websockets.server - DEBUG - > PONG 52 8f 06 f1 [binary, 4 bytes]
2025-06-28 11:50:10,575 - websockets.client - DEBUG - < PONG 52 8f 06 f1 [binary, 4 bytes]
2025-06-28 11:50:10,576 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:50:25,242 - core.task_api - INFO - Task c1571359-f06a-403f-9cea-bdd952e76d45 submitted successfully
[2025-06-28 11:50:25] INFO:     127.0.0.1:65341 - "POST /api/v1/tasks HTTP/1.1" 200 OK
[2025-06-28 11:50:25] INFO:     127.0.0.1:65341 - "GET /api/v1/tasks/c1571359-f06a-403f-9cea-bdd952e76d45 HTTP/1.1" 200 OK
[2025-06-28 11:50:27] INFO:     127.0.0.1:65341 - "GET /api/v1/tasks/c1571359-f06a-403f-9cea-bdd952e76d45 HTTP/1.1" 200 OK
[2025-06-28 11:50:29] INFO:     127.0.0.1:65341 - "GET /api/v1/tasks/c1571359-f06a-403f-9cea-bdd952e76d45 HTTP/1.1" 200 OK
2025-06-28 11:50:30,033 - core.task_processing.task_loader - INFO - 📋 任务文件 tasks.jsonl 不存在，等待... (第24次, 30s间隔) - 建议通过API提交任务
2025-06-28 11:50:30,046 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:50:30,046 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:50:30,047 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:50:30,047 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:50:30,053 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:50:30,508 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 6m 0s
2025-06-28 11:50:30,551 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:50:30,552 - websockets.server - DEBUG - > PING 85 27 fb 55 [binary, 4 bytes]
2025-06-28 11:50:30,552 - websockets.client - DEBUG - < PING 85 27 fb 55 [binary, 4 bytes]
2025-06-28 11:50:30,552 - websockets.client - DEBUG - > PONG 85 27 fb 55 [binary, 4 bytes]
2025-06-28 11:50:30,553 - websockets.server - DEBUG - < PONG 85 27 fb 55 [binary, 4 bytes]
2025-06-28 11:50:30,553 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:50:30,577 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:50:30,577 - websockets.client - DEBUG - > PING f3 4d e4 62 [binary, 4 bytes]
2025-06-28 11:50:30,578 - websockets.server - DEBUG - < PING f3 4d e4 62 [binary, 4 bytes]
2025-06-28 11:50:30,578 - websockets.server - DEBUG - > PONG f3 4d e4 62 [binary, 4 bytes]
2025-06-28 11:50:30,578 - websockets.client - DEBUG - < PONG f3 4d e4 62 [binary, 4 bytes]
2025-06-28 11:50:30,578 - websockets.client - DEBUG - % received keepalive pong
[2025-06-28 11:50:31] INFO:     127.0.0.1:65341 - "GET /api/v1/tasks/c1571359-f06a-403f-9cea-bdd952e76d45 HTTP/1.1" 200 OK
[2025-06-28 11:50:33] INFO:     127.0.0.1:65341 - "GET /api/v1/tasks/c1571359-f06a-403f-9cea-bdd952e76d45 HTTP/1.1" 200 OK
[2025-06-28 11:50:35] INFO:     127.0.0.1:65341 - "GET /api/v1/tasks/c1571359-f06a-403f-9cea-bdd952e76d45 HTTP/1.1" 200 OK
[2025-06-28 11:50:37] INFO:     127.0.0.1:65341 - "GET /api/v1/tasks/c1571359-f06a-403f-9cea-bdd952e76d45 HTTP/1.1" 200 OK
[2025-06-28 11:50:39] INFO:     127.0.0.1:65341 - "GET /api/v1/tasks/c1571359-f06a-403f-9cea-bdd952e76d45 HTTP/1.1" 200 OK
[2025-06-28 11:50:41] INFO:     127.0.0.1:65341 - "GET /api/v1/tasks/c1571359-f06a-403f-9cea-bdd952e76d45 HTTP/1.1" 200 OK
[2025-06-28 11:50:43] INFO:     127.0.0.1:65341 - "GET /api/v1/tasks/c1571359-f06a-403f-9cea-bdd952e76d45 HTTP/1.1" 200 OK
2025-06-28 11:50:50,579 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:50:50,580 - websockets.client - DEBUG - > PING 9b a3 47 e1 [binary, 4 bytes]
2025-06-28 11:50:50,580 - websockets.server - DEBUG - < PING 9b a3 47 e1 [binary, 4 bytes]
2025-06-28 11:50:50,580 - websockets.server - DEBUG - > PONG 9b a3 47 e1 [binary, 4 bytes]
2025-06-28 11:50:50,580 - websockets.client - DEBUG - < PONG 9b a3 47 e1 [binary, 4 bytes]
2025-06-28 11:50:50,581 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:51:00,034 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第25次, 30s间隔)
2025-06-28 11:51:00,051 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:51:00,052 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:51:00,052 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:51:00,052 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:51:00,053 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:51:00,554 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:51:00,554 - websockets.server - DEBUG - > PING 93 30 ae 12 [binary, 4 bytes]
2025-06-28 11:51:00,555 - websockets.client - DEBUG - < PING 93 30 ae 12 [binary, 4 bytes]
2025-06-28 11:51:00,555 - websockets.client - DEBUG - > PONG 93 30 ae 12 [binary, 4 bytes]
2025-06-28 11:51:00,555 - websockets.server - DEBUG - < PONG 93 30 ae 12 [binary, 4 bytes]
2025-06-28 11:51:00,555 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:51:10,581 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:51:10,582 - websockets.client - DEBUG - > PING '^6Ȓ' [text, 4 bytes]
2025-06-28 11:51:10,583 - websockets.server - DEBUG - < PING '^6Ȓ' [text, 4 bytes]
2025-06-28 11:51:10,583 - websockets.server - DEBUG - > PONG '^6Ȓ' [text, 4 bytes]
2025-06-28 11:51:10,583 - websockets.client - DEBUG - < PONG '^6Ȓ' [text, 4 bytes]
2025-06-28 11:51:10,583 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:51:30,035 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第26次, 30s间隔)
2025-06-28 11:51:30,053 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:51:30,053 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:51:30,054 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:51:30,054 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:51:30,054 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:51:30,509 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 7m 0s
2025-06-28 11:51:30,556 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:51:30,557 - websockets.server - DEBUG - > PING 34 df cd 8e [binary, 4 bytes]
2025-06-28 11:51:30,557 - websockets.client - DEBUG - < PING 34 df cd 8e [binary, 4 bytes]
2025-06-28 11:51:30,557 - websockets.client - DEBUG - > PONG 34 df cd 8e [binary, 4 bytes]
2025-06-28 11:51:30,557 - websockets.server - DEBUG - < PONG 34 df cd 8e [binary, 4 bytes]
2025-06-28 11:51:30,558 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:51:30,584 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:51:30,585 - websockets.client - DEBUG - > PING 43 24 88 e0 [binary, 4 bytes]
2025-06-28 11:51:30,585 - websockets.server - DEBUG - < PING 43 24 88 e0 [binary, 4 bytes]
2025-06-28 11:51:30,585 - websockets.server - DEBUG - > PONG 43 24 88 e0 [binary, 4 bytes]
2025-06-28 11:51:30,585 - websockets.client - DEBUG - < PONG 43 24 88 e0 [binary, 4 bytes]
2025-06-28 11:51:30,585 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:51:50,587 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:51:50,589 - websockets.client - DEBUG - > PING 5e c4 f9 37 [binary, 4 bytes]
2025-06-28 11:51:50,591 - websockets.server - DEBUG - < PING 5e c4 f9 37 [binary, 4 bytes]
2025-06-28 11:51:50,591 - websockets.server - DEBUG - > PONG 5e c4 f9 37 [binary, 4 bytes]
2025-06-28 11:51:50,592 - websockets.client - DEBUG - < PONG 5e c4 f9 37 [binary, 4 bytes]
2025-06-28 11:51:50,592 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:52:00,037 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第27次, 30s间隔)
2025-06-28 11:52:00,059 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:52:00,059 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:52:00,059 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:52:00,066 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:52:00,066 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:52:00,559 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:52:00,559 - websockets.server - DEBUG - > PING a7 9f 6e 40 [binary, 4 bytes]
2025-06-28 11:52:00,560 - websockets.client - DEBUG - < PING a7 9f 6e 40 [binary, 4 bytes]
2025-06-28 11:52:00,560 - websockets.client - DEBUG - > PONG a7 9f 6e 40 [binary, 4 bytes]
2025-06-28 11:52:00,561 - websockets.server - DEBUG - < PONG a7 9f 6e 40 [binary, 4 bytes]
2025-06-28 11:52:00,561 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:52:10,593 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:52:10,593 - websockets.client - DEBUG - > PING b3 f4 25 53 [binary, 4 bytes]
2025-06-28 11:52:10,594 - websockets.server - DEBUG - < PING b3 f4 25 53 [binary, 4 bytes]
2025-06-28 11:52:10,594 - websockets.server - DEBUG - > PONG b3 f4 25 53 [binary, 4 bytes]
2025-06-28 11:52:10,594 - websockets.client - DEBUG - < PONG b3 f4 25 53 [binary, 4 bytes]
2025-06-28 11:52:10,595 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:52:30,039 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第28次, 30s间隔)
2025-06-28 11:52:30,064 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:52:30,065 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:52:30,064 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:52:30,066 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:52:30,066 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:52:30,510 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 8m 0s
2025-06-28 11:52:30,562 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:52:30,562 - websockets.server - DEBUG - > PING '\x1d&\x10\x13' [text, 4 bytes]
2025-06-28 11:52:30,563 - websockets.client - DEBUG - < PING '\x1d&\x10\x13' [text, 4 bytes]
2025-06-28 11:52:30,563 - websockets.client - DEBUG - > PONG '\x1d&\x10\x13' [text, 4 bytes]
2025-06-28 11:52:30,563 - websockets.server - DEBUG - < PONG '\x1d&\x10\x13' [text, 4 bytes]
2025-06-28 11:52:30,563 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:52:30,596 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:52:30,596 - websockets.client - DEBUG - > PING bb 0e ba f4 [binary, 4 bytes]
2025-06-28 11:52:30,597 - websockets.server - DEBUG - < PING bb 0e ba f4 [binary, 4 bytes]
2025-06-28 11:52:30,597 - websockets.server - DEBUG - > PONG bb 0e ba f4 [binary, 4 bytes]
2025-06-28 11:52:30,597 - websockets.client - DEBUG - < PONG bb 0e ba f4 [binary, 4 bytes]
2025-06-28 11:52:30,597 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:52:40,046 - fsevents - DEBUG - NativeEvent(path="/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/output/trajectories", inode=None, flags=20, id=0): is_root_changed
2025-06-28 11:52:40,046 - fsevents - DEBUG - drop event DirDeletedEvent(src_path='output/trajectories', dest_path='', event_type='deleted', is_directory=True, is_synthetic=False)
2025-06-28 11:52:40,047 - fsevents - DEBUG - Stopping because root path was changed
2025-06-28 11:52:50,598 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:52:50,600 - websockets.client - DEBUG - > PING ee 6d 47 ac [binary, 4 bytes]
2025-06-28 11:52:50,600 - websockets.server - DEBUG - < PING ee 6d 47 ac [binary, 4 bytes]
2025-06-28 11:52:50,600 - websockets.server - DEBUG - > PONG ee 6d 47 ac [binary, 4 bytes]
2025-06-28 11:52:50,600 - websockets.client - DEBUG - < PONG ee 6d 47 ac [binary, 4 bytes]
2025-06-28 11:52:50,600 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:53:00,040 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第29次, 30s间隔)
2025-06-28 11:53:00,069 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:53:00,071 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:53:00,071 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:53:00,072 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:53:00,073 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:53:00,564 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:53:00,564 - websockets.server - DEBUG - > PING 17 9d ff 68 [binary, 4 bytes]
2025-06-28 11:53:00,565 - websockets.client - DEBUG - < PING 17 9d ff 68 [binary, 4 bytes]
2025-06-28 11:53:00,565 - websockets.client - DEBUG - > PONG 17 9d ff 68 [binary, 4 bytes]
2025-06-28 11:53:00,565 - websockets.server - DEBUG - < PONG 17 9d ff 68 [binary, 4 bytes]
2025-06-28 11:53:00,565 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:53:10,601 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:53:10,602 - websockets.client - DEBUG - > PING 93 03 2e 37 [binary, 4 bytes]
2025-06-28 11:53:10,603 - websockets.server - DEBUG - < PING 93 03 2e 37 [binary, 4 bytes]
2025-06-28 11:53:10,603 - websockets.server - DEBUG - > PONG 93 03 2e 37 [binary, 4 bytes]
2025-06-28 11:53:10,603 - websockets.client - DEBUG - < PONG 93 03 2e 37 [binary, 4 bytes]
2025-06-28 11:53:10,603 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:53:30,041 - core.task_processing.task_loader - INFO - 📋 任务文件 tasks.jsonl 不存在，等待... (第30次, 30s间隔) - 建议通过API提交任务
2025-06-28 11:53:30,072 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:53:30,078 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:53:30,078 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:53:30,079 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:53:30,079 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:53:30,511 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 9m 0s
2025-06-28 11:53:30,565 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:53:30,566 - websockets.server - DEBUG - > PING 62 e6 7e cc [binary, 4 bytes]
2025-06-28 11:53:30,566 - websockets.client - DEBUG - < PING 62 e6 7e cc [binary, 4 bytes]
2025-06-28 11:53:30,567 - websockets.client - DEBUG - > PONG 62 e6 7e cc [binary, 4 bytes]
2025-06-28 11:53:30,567 - websockets.server - DEBUG - < PONG 62 e6 7e cc [binary, 4 bytes]
2025-06-28 11:53:30,567 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:53:30,604 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:53:30,604 - websockets.client - DEBUG - > PING 14 24 63 b7 [binary, 4 bytes]
2025-06-28 11:53:30,605 - websockets.server - DEBUG - < PING 14 24 63 b7 [binary, 4 bytes]
2025-06-28 11:53:30,605 - websockets.server - DEBUG - > PONG 14 24 63 b7 [binary, 4 bytes]
2025-06-28 11:53:30,605 - websockets.client - DEBUG - < PONG 14 24 63 b7 [binary, 4 bytes]
2025-06-28 11:53:30,606 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:53:50,607 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:53:50,607 - websockets.client - DEBUG - > PING 96 0a c8 00 [binary, 4 bytes]
2025-06-28 11:53:50,608 - websockets.server - DEBUG - < PING 96 0a c8 00 [binary, 4 bytes]
2025-06-28 11:53:50,608 - websockets.server - DEBUG - > PONG 96 0a c8 00 [binary, 4 bytes]
2025-06-28 11:53:50,608 - websockets.client - DEBUG - < PONG 96 0a c8 00 [binary, 4 bytes]
2025-06-28 11:53:50,608 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:54:00,042 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第31次, 30s间隔)
2025-06-28 11:54:00,078 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:54:00,079 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:54:00,082 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:54:00,082 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:54:00,082 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:54:00,568 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:54:00,569 - websockets.server - DEBUG - > PING dc d4 d4 55 [binary, 4 bytes]
2025-06-28 11:54:00,569 - websockets.client - DEBUG - < PING dc d4 d4 55 [binary, 4 bytes]
2025-06-28 11:54:00,569 - websockets.client - DEBUG - > PONG dc d4 d4 55 [binary, 4 bytes]
2025-06-28 11:54:00,570 - websockets.server - DEBUG - < PONG dc d4 d4 55 [binary, 4 bytes]
2025-06-28 11:54:00,570 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:54:10,609 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:54:10,609 - websockets.client - DEBUG - > PING 'Cj\x15\x1d' [text, 4 bytes]
2025-06-28 11:54:10,609 - websockets.server - DEBUG - < PING 'Cj\x15\x1d' [text, 4 bytes]
2025-06-28 11:54:10,609 - websockets.server - DEBUG - > PONG 'Cj\x15\x1d' [text, 4 bytes]
2025-06-28 11:54:10,610 - websockets.client - DEBUG - < PONG 'Cj\x15\x1d' [text, 4 bytes]
2025-06-28 11:54:10,610 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:54:30,043 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第32次, 30s间隔)
2025-06-28 11:54:30,080 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:54:30,080 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:54:30,087 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:54:30,087 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:54:30,087 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:54:30,512 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 10m 0s
2025-06-28 11:54:30,551 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔍 执行定期MCP同步验证...
2025-06-28 11:54:30,551 - core.tool_schema_manager - INFO - 正在执行MCP同步验证...
2025-06-28 11:54:30,551 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=False)，当前缓存: 4 个工具
2025-06-28 11:54:30,551 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 11:54:30,552 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
2025-06-28 11:54:30,552 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 11:54:30,552 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
2025-06-28 11:54:30,552 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
2025-06-28 11:54:30,552 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 11:54:30,552 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 11:54:30,552 - core.tool_schema_manager - DEBUG - 📊 Schema版本无变化，跳过更新
2025-06-28 11:54:30,553 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:54:30,553 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:54:30,554 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:54:30,554 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:54:30,555 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 11:54:30,555 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 11:54:30,555 - core.tool_schema_manager - INFO - 🔍 同步验证完成: unhealthy (0/4 工具Schema一致)
2025-06-28 11:54:30,555 - runtimes.reasoning.enhanced_runtime - WARNING - ⚠️ MCP同步验证发现问题: {'total_tools': 4, 'connected_tools': 0, 'schema_consistent_tools': 0, 'failed_tools': 0}
2025-06-28 11:54:30,571 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:54:30,571 - websockets.server - DEBUG - > PING 21 f6 31 97 [binary, 4 bytes]
2025-06-28 11:54:30,571 - websockets.client - DEBUG - < PING 21 f6 31 97 [binary, 4 bytes]
2025-06-28 11:54:30,571 - websockets.client - DEBUG - > PONG 21 f6 31 97 [binary, 4 bytes]
2025-06-28 11:54:30,571 - websockets.server - DEBUG - < PONG 21 f6 31 97 [binary, 4 bytes]
2025-06-28 11:54:30,571 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:54:30,610 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:54:30,610 - websockets.client - DEBUG - > PING a3 e2 44 76 [binary, 4 bytes]
2025-06-28 11:54:30,610 - websockets.server - DEBUG - < PING a3 e2 44 76 [binary, 4 bytes]
2025-06-28 11:54:30,610 - websockets.server - DEBUG - > PONG a3 e2 44 76 [binary, 4 bytes]
2025-06-28 11:54:30,610 - websockets.client - DEBUG - < PONG a3 e2 44 76 [binary, 4 bytes]
2025-06-28 11:54:30,610 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:54:32,779 - services.synthesis_service - INFO - 开始处理轨迹数据...
2025-06-28 11:54:32,780 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:54:32,780 - core.synthesiscore.synthesis - INFO - 🔄 Processing only unprocessed trajectories...
2025-06-28 11:54:32,780 - core.synthesiscore.synthesis - INFO - 🎯 Unprocessed trajectories completed: 0 new trajectories processed
2025-06-28 11:54:32,780 - services.synthesis_service - DEBUG - 等待 300 秒后再次处理...
2025-06-28 11:54:50,611 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:54:50,612 - websockets.client - DEBUG - > PING 57 58 f0 2b [binary, 4 bytes]
2025-06-28 11:54:50,612 - websockets.server - DEBUG - < PING 57 58 f0 2b [binary, 4 bytes]
2025-06-28 11:54:50,612 - websockets.server - DEBUG - > PONG 57 58 f0 2b [binary, 4 bytes]
2025-06-28 11:54:50,612 - websockets.client - DEBUG - < PONG 57 58 f0 2b [binary, 4 bytes]
2025-06-28 11:54:50,612 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:55:00,044 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第33次, 30s间隔)
2025-06-28 11:55:00,085 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:55:00,086 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:55:00,088 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:55:00,088 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:55:00,088 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:55:00,572 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:55:00,572 - websockets.server - DEBUG - > PING af 02 42 7c [binary, 4 bytes]
2025-06-28 11:55:00,572 - websockets.client - DEBUG - < PING af 02 42 7c [binary, 4 bytes]
2025-06-28 11:55:00,572 - websockets.client - DEBUG - > PONG af 02 42 7c [binary, 4 bytes]
2025-06-28 11:55:00,573 - websockets.server - DEBUG - < PONG af 02 42 7c [binary, 4 bytes]
2025-06-28 11:55:00,573 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:55:10,613 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:55:10,614 - websockets.client - DEBUG - > PING 01 fb 56 4f [binary, 4 bytes]
2025-06-28 11:55:10,614 - websockets.server - DEBUG - < PING 01 fb 56 4f [binary, 4 bytes]
2025-06-28 11:55:10,614 - websockets.server - DEBUG - > PONG 01 fb 56 4f [binary, 4 bytes]
2025-06-28 11:55:10,614 - websockets.client - DEBUG - < PONG 01 fb 56 4f [binary, 4 bytes]
2025-06-28 11:55:10,614 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:55:30,045 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第34次, 30s间隔)
2025-06-28 11:55:30,087 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:55:30,087 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:55:30,093 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:55:30,094 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:55:30,094 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:55:30,512 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 11m 0s
2025-06-28 11:55:30,573 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:55:30,573 - websockets.server - DEBUG - > PING ae 99 51 1e [binary, 4 bytes]
2025-06-28 11:55:30,573 - websockets.client - DEBUG - < PING ae 99 51 1e [binary, 4 bytes]
2025-06-28 11:55:30,573 - websockets.client - DEBUG - > PONG ae 99 51 1e [binary, 4 bytes]
2025-06-28 11:55:30,573 - websockets.server - DEBUG - < PONG ae 99 51 1e [binary, 4 bytes]
2025-06-28 11:55:30,574 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:55:30,615 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:55:30,615 - websockets.client - DEBUG - > PING 21 91 6c 53 [binary, 4 bytes]
2025-06-28 11:55:30,615 - websockets.server - DEBUG - < PING 21 91 6c 53 [binary, 4 bytes]
2025-06-28 11:55:30,615 - websockets.server - DEBUG - > PONG 21 91 6c 53 [binary, 4 bytes]
2025-06-28 11:55:30,615 - websockets.client - DEBUG - < PONG 21 91 6c 53 [binary, 4 bytes]
2025-06-28 11:55:30,615 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:55:50,616 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:55:50,617 - websockets.client - DEBUG - > PING 56 db 39 e2 [binary, 4 bytes]
2025-06-28 11:55:50,618 - websockets.server - DEBUG - < PING 56 db 39 e2 [binary, 4 bytes]
2025-06-28 11:55:50,618 - websockets.server - DEBUG - > PONG 56 db 39 e2 [binary, 4 bytes]
2025-06-28 11:55:50,618 - websockets.client - DEBUG - < PONG 56 db 39 e2 [binary, 4 bytes]
2025-06-28 11:55:50,618 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:56:00,046 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第35次, 30s间隔)
2025-06-28 11:56:00,091 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:56:00,092 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:56:00,097 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:56:00,097 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:56:00,097 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:56:00,574 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:56:00,575 - websockets.server - DEBUG - > PING 18 88 f5 af [binary, 4 bytes]
2025-06-28 11:56:00,575 - websockets.client - DEBUG - < PING 18 88 f5 af [binary, 4 bytes]
2025-06-28 11:56:00,575 - websockets.client - DEBUG - > PONG 18 88 f5 af [binary, 4 bytes]
2025-06-28 11:56:00,575 - websockets.server - DEBUG - < PONG 18 88 f5 af [binary, 4 bytes]
2025-06-28 11:56:00,575 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:56:10,619 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:56:10,619 - websockets.client - DEBUG - > PING c0 ed 39 31 [binary, 4 bytes]
2025-06-28 11:56:10,619 - websockets.server - DEBUG - < PING c0 ed 39 31 [binary, 4 bytes]
2025-06-28 11:56:10,619 - websockets.server - DEBUG - > PONG c0 ed 39 31 [binary, 4 bytes]
2025-06-28 11:56:10,620 - websockets.client - DEBUG - < PONG c0 ed 39 31 [binary, 4 bytes]
2025-06-28 11:56:10,620 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:56:30,048 - core.task_processing.task_loader - INFO - 📋 任务文件 tasks.jsonl 不存在，等待... (第36次, 30s间隔) - 建议通过API提交任务
2025-06-28 11:56:30,109 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:56:30,110 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:56:30,111 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:56:30,117 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:56:30,118 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:56:30,513 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 12m 0s
2025-06-28 11:56:30,575 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:56:30,576 - websockets.server - DEBUG - > PING 6c b0 df 89 [binary, 4 bytes]
2025-06-28 11:56:30,576 - websockets.client - DEBUG - < PING 6c b0 df 89 [binary, 4 bytes]
2025-06-28 11:56:30,576 - websockets.client - DEBUG - > PONG 6c b0 df 89 [binary, 4 bytes]
2025-06-28 11:56:30,576 - websockets.server - DEBUG - < PONG 6c b0 df 89 [binary, 4 bytes]
2025-06-28 11:56:30,576 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:56:30,621 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:56:30,621 - websockets.client - DEBUG - > PING d7 b6 91 f3 [binary, 4 bytes]
2025-06-28 11:56:30,621 - websockets.server - DEBUG - < PING d7 b6 91 f3 [binary, 4 bytes]
2025-06-28 11:56:30,621 - websockets.server - DEBUG - > PONG d7 b6 91 f3 [binary, 4 bytes]
2025-06-28 11:56:30,621 - websockets.client - DEBUG - < PONG d7 b6 91 f3 [binary, 4 bytes]
2025-06-28 11:56:30,621 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:56:50,622 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:56:50,623 - websockets.client - DEBUG - > PING c5 36 ef 77 [binary, 4 bytes]
2025-06-28 11:56:50,623 - websockets.server - DEBUG - < PING c5 36 ef 77 [binary, 4 bytes]
2025-06-28 11:56:50,623 - websockets.server - DEBUG - > PONG c5 36 ef 77 [binary, 4 bytes]
2025-06-28 11:56:50,623 - websockets.client - DEBUG - < PONG c5 36 ef 77 [binary, 4 bytes]
2025-06-28 11:56:50,623 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:57:00,050 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第37次, 30s间隔)
2025-06-28 11:57:00,110 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:57:00,112 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:57:00,112 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:57:00,112 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:57:00,115 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:57:00,577 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:57:00,577 - websockets.server - DEBUG - > PING 9f 23 8a 42 [binary, 4 bytes]
2025-06-28 11:57:00,577 - websockets.client - DEBUG - < PING 9f 23 8a 42 [binary, 4 bytes]
2025-06-28 11:57:00,577 - websockets.client - DEBUG - > PONG 9f 23 8a 42 [binary, 4 bytes]
2025-06-28 11:57:00,577 - websockets.server - DEBUG - < PONG 9f 23 8a 42 [binary, 4 bytes]
2025-06-28 11:57:00,578 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:57:10,624 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:57:10,625 - websockets.client - DEBUG - > PING d9 8a f9 3d [binary, 4 bytes]
2025-06-28 11:57:10,625 - websockets.server - DEBUG - < PING d9 8a f9 3d [binary, 4 bytes]
2025-06-28 11:57:10,625 - websockets.server - DEBUG - > PONG d9 8a f9 3d [binary, 4 bytes]
2025-06-28 11:57:10,625 - websockets.client - DEBUG - < PONG d9 8a f9 3d [binary, 4 bytes]
2025-06-28 11:57:10,625 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:57:30,051 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第38次, 30s间隔)
2025-06-28 11:57:30,113 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:57:30,117 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:57:30,118 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:57:30,118 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:57:30,119 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:57:30,514 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 13m 0s
2025-06-28 11:57:30,578 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:57:30,578 - websockets.server - DEBUG - > PING 8f 97 b5 de [binary, 4 bytes]
2025-06-28 11:57:30,578 - websockets.client - DEBUG - < PING 8f 97 b5 de [binary, 4 bytes]
2025-06-28 11:57:30,578 - websockets.client - DEBUG - > PONG 8f 97 b5 de [binary, 4 bytes]
2025-06-28 11:57:30,579 - websockets.server - DEBUG - < PONG 8f 97 b5 de [binary, 4 bytes]
2025-06-28 11:57:30,579 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:57:30,626 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:57:30,626 - websockets.client - DEBUG - > PING ed 91 ba 98 [binary, 4 bytes]
2025-06-28 11:57:30,626 - websockets.server - DEBUG - < PING ed 91 ba 98 [binary, 4 bytes]
2025-06-28 11:57:30,626 - websockets.server - DEBUG - > PONG ed 91 ba 98 [binary, 4 bytes]
2025-06-28 11:57:30,626 - websockets.client - DEBUG - < PONG ed 91 ba 98 [binary, 4 bytes]
2025-06-28 11:57:30,626 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:57:50,627 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:57:50,628 - websockets.client - DEBUG - > PING e7 88 72 32 [binary, 4 bytes]
2025-06-28 11:57:50,628 - websockets.server - DEBUG - < PING e7 88 72 32 [binary, 4 bytes]
2025-06-28 11:57:50,629 - websockets.server - DEBUG - > PONG e7 88 72 32 [binary, 4 bytes]
2025-06-28 11:57:50,629 - websockets.client - DEBUG - < PONG e7 88 72 32 [binary, 4 bytes]
2025-06-28 11:57:50,629 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:58:00,052 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第39次, 30s间隔)
2025-06-28 11:58:00,115 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:58:00,123 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:58:00,123 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:58:00,123 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:58:00,124 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:58:00,579 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:58:00,580 - websockets.server - DEBUG - > PING 'W6&\x11' [text, 4 bytes]
2025-06-28 11:58:00,580 - websockets.client - DEBUG - < PING 'W6&\x11' [text, 4 bytes]
2025-06-28 11:58:00,580 - websockets.client - DEBUG - > PONG 'W6&\x11' [text, 4 bytes]
2025-06-28 11:58:00,580 - websockets.server - DEBUG - < PONG 'W6&\x11' [text, 4 bytes]
2025-06-28 11:58:00,580 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:58:10,630 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:58:10,630 - websockets.client - DEBUG - > PING d0 21 92 cb [binary, 4 bytes]
2025-06-28 11:58:10,630 - websockets.server - DEBUG - < PING d0 21 92 cb [binary, 4 bytes]
2025-06-28 11:58:10,630 - websockets.server - DEBUG - > PONG d0 21 92 cb [binary, 4 bytes]
2025-06-28 11:58:10,630 - websockets.client - DEBUG - < PONG d0 21 92 cb [binary, 4 bytes]
2025-06-28 11:58:10,630 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:58:30,053 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第40次, 30s间隔)
2025-06-28 11:58:30,121 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:58:30,128 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:58:30,128 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:58:30,128 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:58:30,128 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:58:30,515 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 14m 0s
2025-06-28 11:58:30,581 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:58:30,581 - websockets.server - DEBUG - > PING d7 e0 6f 80 [binary, 4 bytes]
2025-06-28 11:58:30,581 - websockets.client - DEBUG - < PING d7 e0 6f 80 [binary, 4 bytes]
2025-06-28 11:58:30,581 - websockets.client - DEBUG - > PONG d7 e0 6f 80 [binary, 4 bytes]
2025-06-28 11:58:30,581 - websockets.server - DEBUG - < PONG d7 e0 6f 80 [binary, 4 bytes]
2025-06-28 11:58:30,581 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:58:30,631 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:58:30,631 - websockets.client - DEBUG - > PING 23 28 19 b0 [binary, 4 bytes]
2025-06-28 11:58:30,631 - websockets.server - DEBUG - < PING 23 28 19 b0 [binary, 4 bytes]
2025-06-28 11:58:30,631 - websockets.server - DEBUG - > PONG 23 28 19 b0 [binary, 4 bytes]
2025-06-28 11:58:30,632 - websockets.client - DEBUG - < PONG 23 28 19 b0 [binary, 4 bytes]
2025-06-28 11:58:30,632 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:58:50,633 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:58:50,633 - websockets.client - DEBUG - > PING 9e fd b9 bb [binary, 4 bytes]
2025-06-28 11:58:50,634 - websockets.server - DEBUG - < PING 9e fd b9 bb [binary, 4 bytes]
2025-06-28 11:58:50,634 - websockets.server - DEBUG - > PONG 9e fd b9 bb [binary, 4 bytes]
2025-06-28 11:58:50,634 - websockets.client - DEBUG - < PONG 9e fd b9 bb [binary, 4 bytes]
2025-06-28 11:58:50,634 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:59:00,054 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第41次, 30s间隔)
2025-06-28 11:59:00,124 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:59:00,129 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:59:00,129 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:59:00,130 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:59:00,130 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:59:00,582 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:59:00,582 - websockets.server - DEBUG - > PING 19 d9 39 07 [binary, 4 bytes]
2025-06-28 11:59:00,582 - websockets.client - DEBUG - < PING 19 d9 39 07 [binary, 4 bytes]
2025-06-28 11:59:00,583 - websockets.client - DEBUG - > PONG 19 d9 39 07 [binary, 4 bytes]
2025-06-28 11:59:00,583 - websockets.server - DEBUG - < PONG 19 d9 39 07 [binary, 4 bytes]
2025-06-28 11:59:00,583 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:59:10,635 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:59:10,635 - websockets.client - DEBUG - > PING 4f fc 34 09 [binary, 4 bytes]
2025-06-28 11:59:10,635 - websockets.server - DEBUG - < PING 4f fc 34 09 [binary, 4 bytes]
2025-06-28 11:59:10,635 - websockets.server - DEBUG - > PONG 4f fc 34 09 [binary, 4 bytes]
2025-06-28 11:59:10,635 - websockets.client - DEBUG - < PONG 4f fc 34 09 [binary, 4 bytes]
2025-06-28 11:59:10,635 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:59:30,055 - core.task_processing.task_loader - INFO - 📋 任务文件 tasks.jsonl 不存在，等待... (第42次, 30s间隔) - 建议通过API提交任务
2025-06-28 11:59:30,126 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 11:59:30,131 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 11:59:30,131 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 11:59:30,132 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 11:59:30,132 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:59:30,516 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 15m 0s
2025-06-28 11:59:30,553 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔍 执行定期MCP同步验证...
2025-06-28 11:59:30,553 - core.tool_schema_manager - INFO - 正在执行MCP同步验证...
2025-06-28 11:59:30,553 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=False)，当前缓存: 4 个工具
2025-06-28 11:59:30,553 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 11:59:30,554 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
2025-06-28 11:59:30,554 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 11:59:30,554 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
2025-06-28 11:59:30,554 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
2025-06-28 11:59:30,554 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 11:59:30,554 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 11:59:30,554 - core.tool_schema_manager - DEBUG - 📊 Schema版本无变化，跳过更新
2025-06-28 11:59:30,556 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 11:59:30,556 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 11:59:30,557 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 11:59:30,557 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 11:59:30,558 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 11:59:30,558 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 11:59:30,558 - core.tool_schema_manager - INFO - 🔍 同步验证完成: unhealthy (0/4 工具Schema一致)
2025-06-28 11:59:30,558 - runtimes.reasoning.enhanced_runtime - WARNING - ⚠️ MCP同步验证发现问题: {'total_tools': 4, 'connected_tools': 0, 'schema_consistent_tools': 0, 'failed_tools': 0}
2025-06-28 11:59:30,583 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 11:59:30,583 - websockets.server - DEBUG - > PING 17 a4 50 0a [binary, 4 bytes]
2025-06-28 11:59:30,584 - websockets.client - DEBUG - < PING 17 a4 50 0a [binary, 4 bytes]
2025-06-28 11:59:30,584 - websockets.client - DEBUG - > PONG 17 a4 50 0a [binary, 4 bytes]
2025-06-28 11:59:30,584 - websockets.server - DEBUG - < PONG 17 a4 50 0a [binary, 4 bytes]
2025-06-28 11:59:30,584 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 11:59:30,636 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 11:59:30,636 - websockets.client - DEBUG - > PING f5 f1 90 3a [binary, 4 bytes]
2025-06-28 11:59:30,636 - websockets.server - DEBUG - < PING f5 f1 90 3a [binary, 4 bytes]
2025-06-28 11:59:30,636 - websockets.server - DEBUG - > PONG f5 f1 90 3a [binary, 4 bytes]
2025-06-28 11:59:30,636 - websockets.client - DEBUG - < PONG f5 f1 90 3a [binary, 4 bytes]
2025-06-28 11:59:30,637 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 11:59:33,891 - services.synthesis_service - INFO - 开始处理轨迹数据...
2025-06-28 11:59:33,891 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:59:33,891 - core.synthesiscore.synthesis - INFO - 🔄 Processing only unprocessed trajectories...
2025-06-28 11:59:33,892 - core.synthesiscore.synthesis - INFO - 🎯 Unprocessed trajectories completed: 0 new trajectories processed
2025-06-28 11:59:33,893 - services.synthesis_service - DEBUG - 等待 300 秒后再次处理...
2025-06-28 11:59:49,553 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:59:49,553 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:59:49,553 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:59:49,553 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:59:49,553 - services.synthesis_service - INFO - 🛑 SynthesisCore v2.0监控器已停止
2025-06-28 11:59:49,553 - services.synthesis_service - INFO - 等待合成服务线程结束...
2025-06-28 11:59:49,965 - services.synthesis_service - INFO - 合成服务工作线程已停止
2025-06-28 11:59:49,970 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:59:49,970 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:59:49,970 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:59:49,970 - services.runtime_service - INFO - 停止运行时实例: enhanced-reasoning-1
2025-06-28 11:59:49,970 - services.runtime_service - WARNING - 运行时清理失败: asyncio.run() cannot be called from a running event loop
[2025-06-28 11:59:49] /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/services/runtime_service.py:126: RuntimeWarning: coroutine 'EnhancedReasoningRuntime.cleanup' was never awaited
  logger.warning(f"运行时清理失败: {e}")
RuntimeWarning: Enable tracemalloc to get the object allocation traceback
2025-06-28 11:59:49,972 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:59:49,973 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:59:49,973 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:59:49,973 - services.task_api_service - INFO - 已发送停止信号给任务API服务器
[2025-06-28 11:59:50] INFO:     Shutting down
[2025-06-28 11:59:50] INFO:     Waiting for application shutdown.
[2025-06-28 11:59:50] INFO:     Application shutdown complete.
[2025-06-28 11:59:50] INFO:     Finished server process [75982]
2025-06-28 11:59:50,151 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:59:50,151 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:59:50,151 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:59:50,152 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:59:50,154 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: microsandbox_server (退出码: -15)
2025-06-28 11:59:50,154 - services.mcp_server_launcher - ERROR - [microsandbox_server] 错误输出: <frozen runpy>:128: RuntimeWarning: 'mcp_servers.microsandbox_server.main' found in sys.modules after import of package 'mcp_servers.microsandbox_server', but prior to execution of 'mcp_servers.microsandbox_server.main'; this may result in unpredictable behaviour
2025-06-28 11:44:00,229 - mcp_servers.microsandbox_server.token_manager - INFO - Loaded existing token, expires: 2025-06-28 12:11:46
2025-06-28 11:44:00,229 - __main__ - INFO - MicroSandboxMCPServer initialized (Production Mode):
2025-06-28 11:44:00,229 - __main__ - INFO -   Server Name: microsandbox_server
2025-06-28 11:44:00,229 - __main__ - INFO -   Server ID: microsandbox
2025-06-28 11:44:00,229 - __main__ - INFO -   API Version: 0.2.6
2025-06-28 11:44:00,229 - __main__ - INFO -   Storage Path: /Users/zhaoxiang/.microsandbox
2025-06-28 11:44:00,229 - __main__ - INFO -   MicroSandbox Server: 127.0.0.1:5555
2025-06-28 11:44:00,229 - __main__ - INFO -   Listen Host: 0.0.0.0
2025-06-28 11:44:00,229 - __main__ - INFO -   Listen Port: 8090
2025-06-28 11:44:00,229 - __main__ - INFO -   Public Endpoint: ws://localhost:8090
2025-06-28 11:44:00,229 - __main__ - INFO -   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:44:00,229 - __main__ - INFO - Starting microsandbox_server...
2025-06-28 11:44:00,229 - __main__ - INFO - Attempting to start MCPServer for microsandbox_server at ws://localhost:8090...
2025-06-28 11:44:00,229 - core.toolscore.mcp_server - INFO - Attempting to start microsandbox_server MCP Server on localhost:8090
2025-06-28 11:44:00,232 - websockets.server - INFO - server listening on [::1]:8090
2025-06-28 11:44:00,232 - websockets.server - INFO - server listening on 127.0.0.1:8090
2025-06-28 11:44:00,232 - core.toolscore.mcp_server - INFO - microsandbox_server MCP Server started successfully on localhost:8090 (Original endpoint: ws://localhost:8090) with ping_interval=30, ping_timeout=60
2025-06-28 11:44:00,232 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:44:10,233 - core.toolscore.mcp_server - INFO - [microsandbox_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 11:44:10,236 - core.toolscore.mcp_server - INFO - [microsandbox_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 11:44:10,236 - core.toolscore.mcp_server - INFO - [microsandbox_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "6608bfe3-5eed-4352-a80f-2898e8743e05", "tool_spec": {"tool_id": "microsandbox", "name": "microsandbox_server", "description": "\u57fa\u4e8eMicroSandbox\u7684\u5b89\u5168Python\u4ee3\u7801\u6267\u884c\u670d\u52a1\u5668", "tool_type": "mcp_server", "capabilities": [{"name": "microsandbox_execute", "description": "\u5728MicroSandbox\u5b89\u5168\u73af\u5883\u4e2d\u6267\u884cPython\u4ee3\u7801", "parameters": {"code": {"type": "string", "description": "\u8981\u6267\u884c\u7684Python\u4ee3\u7801", "required": true}, "session_id": {"type": "string", "description": "\u4f1a\u8bddID\uff0c\u7528\u4e8e\u591a\u8f6e\u6267\u884c\u548c\u72b6\u6001\u4fdd\u6301", "required": false}, "timeout": {"type": "integer", "description": "\u6267\u884c\u8d85\u65f6\u65f6\u95f4\uff08\u79d2\uff09\uff0c\u9ed8\u8ba430\u79d2\uff0c\u6700\u5927300\u79d2\u3002\u6ce8\u610f\uff1aMicroSandbox\u5185\u90e8\u6709\u81ea\u5df1\u7684\u8d85\u65f6\u673a\u5236\uff0c\u6b64\u53c2\u6570\u4e3b\u8981\u7528\u4e8e\u6587\u6863\u8bf4\u660e", "required": false}}, "examples": [{"code": "print('Hello from MicroSandbox!')"}, {"code": "import math\\nresult = math.sqrt(16)\\nprint(f'\u5e73\u65b9\u6839: {result}')", "timeout": 10}, {"code": "x = 42", "session_id": "my-session"}, {"code": "print(f'x = {x}')", "session_id": "my-session"}], "category": "general"}, {"name": "microsandbox_install_package", "description": "\u5728MicroSandbox\u73af\u5883\u4e2d\u5b89\u88c5Python\u5305", "parameters": {"package_name": {"type": "string", "description": "\u8981\u5b89\u88c5\u7684\u5305\u540d", "required": true}, "version": {"type": "string", "description": "\u6307\u5b9a\u7248\u672c\u53f7", "required": false}, "session_id": {"type": "string", "description": "\u4f1a\u8bddID", "required": false}}, "examples": [{"package_name": "requests"}, {"package_name": "numpy", "version": "1.21.0"}, {"package_name": "pandas", "session_id": "data-analysis"}], "category": "general"}, {"name": "microsandbox_list_sessions", "description": "\u5217\u51fa\u5f53\u524d\u6d3b\u8dc3\u7684\u6c99\u7bb1\u4f1a\u8bdd", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "microsandbox_close_session", "description": "\u5173\u95ed\u6307\u5b9a\u7684\u6c99\u7bb1\u4f1a\u8bdd", "parameters": {"session_id": {"type": "string", "description": "\u8981\u5173\u95ed\u7684\u4f1a\u8bddID", "required": true}}, "examples": [{"session_id": "my-session"}], "category": "general"}, {"name": "microsandbox_cleanup_expired", "description": "\u6e05\u7406\u8fc7\u671f\u7684\u6c99\u7bb1\u4f1a\u8bdd", "parameters": {"max_age": {"type": "integer", "description": "\u6700\u5927\u4f1a\u8bdd\u5e74\u9f84\uff08\u79d2\uff09\uff0c\u9ed8\u8ba4\u4e3a\u914d\u7f6e\u7684\u8d85\u65f6\u65f6\u95f4", "required": false}}, "examples": [{}, {"max_age": 1800}], "category": "general"}, {"name": "microsandbox_get_performance_stats", "description": "\u83b7\u53d6\u670d\u52a1\u5668\u6027\u80fd\u7edf\u8ba1\u4fe1\u606f", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "microsandbox_get_health_status", "description": "\u83b7\u53d6\u670d\u52a1\u5668\u5065\u5eb7\u72b6\u6001", "parameters": {}, "examples": [{}], "category": "general"}], "endpoint": "ws://localhost:8090", "connection_params": {}}}
2025-06-28 11:44:10,236 - core.toolscore.mcp_server - INFO - [microsandbox_server] Waiting for registration response from toolscore...
2025-06-28 11:44:10,237 - core.toolscore.mcp_server - INFO - [microsandbox_server] Received registration response: {"type": "register_tool_response", "request_id": "6608bfe3-5eed-4352-a80f-2898e8743e05", "success": true, "message": null}
2025-06-28 11:44:10,237 - core.toolscore.mcp_server - INFO - [microsandbox_server] Successfully registered with toolscore.

2025-06-28 11:59:50,154 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 microsandbox_server (第 1 次)
2025-06-28 11:59:50,155 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: microsandbox_server
2025-06-28 11:59:50,155 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:59:50,157 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: search_tool_server (退出码: -15)
2025-06-28 11:59:50,157 - services.mcp_server_launcher - ERROR - [search_tool_server] 错误输出: 2025-06-28 11:44:00,119 - mcp_servers.search_tool_server.search_tool - INFO - SearchTool 初始化完成。
2025-06-28 11:44:00,120 - __main__ - INFO - 使用动态分配端口: 8080
2025-06-28 11:44:00,120 - __main__ - INFO - Starting search_tool_server...
2025-06-28 11:44:00,120 - core.toolscore.mcp_server - INFO - Attempting to start search_tool_server MCP Server on localhost:8080
2025-06-28 11:44:00,124 - websockets.server - INFO - server listening on 127.0.0.1:8080
2025-06-28 11:44:00,124 - websockets.server - INFO - server listening on [::1]:8080
2025-06-28 11:44:00,124 - core.toolscore.mcp_server - INFO - search_tool_server MCP Server started successfully on localhost:8080 (Original endpoint: ws://localhost:8080/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:44:00,124 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:44:00,602 - websockets.server - INFO - connection open
2025-06-28 11:44:00,602 - core.toolscore.mcp_server - INFO - Client connected to search_tool_server MCP Server at path /: ('127.0.0.1', 64230)
2025-06-28 11:44:00,604 - core.toolscore.mcp_server - WARNING - Unknown request type or server role mismatch: ping
2025-06-28 11:44:00,604 - websockets.server - INFO - connection closed
2025-06-28 11:44:10,125 - core.toolscore.mcp_server - INFO - [search_tool_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 11:44:10,128 - core.toolscore.mcp_server - INFO - [search_tool_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 11:44:10,128 - core.toolscore.mcp_server - INFO - [search_tool_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "bc92db13-4de1-40f9-9c39-d58b0f152b4b", "tool_spec": {"tool_id": "mcp-search-tool", "name": "search_tool_server", "description": "\u6587\u4ef6\u5185\u5bb9\u641c\u7d22\u548c\u4ee3\u7801\u5b9a\u4e49\u641c\u7d22\u5de5\u5177\u670d\u52a1\u5668", "tool_type": "mcp_server", "capabilities": [{"name": "search_file_content", "description": "\u5728\u6307\u5b9a\u6587\u4ef6\u4e2d\u641c\u7d22\u5339\u914d\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5185\u5bb9", "parameters": {"file_path": {"type": "string", "description": "\u8981\u641c\u7d22\u7684\u6587\u4ef6\u8def\u5f84", "required": true}, "regex_pattern": {"type": "string", "description": "\u8981\u5339\u914d\u7684\u6b63\u5219\u8868\u8fbe\u5f0f", "required": true}}, "examples": [{"file_path": "src/main.py", "regex_pattern": "def\\s+\\w+"}], "category": "general"}, {"name": "list_code_definitions", "description": "\u5217\u51fa\u6307\u5b9a\u6587\u4ef6\u6216\u76ee\u5f55\u4e2dPython\u4ee3\u7801\u7684\u7c7b\u3001\u51fd\u6570\u548c\u65b9\u6cd5\u5b9a\u4e49", "parameters": {"file_path": {"type": "string", "description": "\u8981\u89e3\u6790\u7684Python\u6587\u4ef6\u8def\u5f84", "required": false}, "directory_path": {"type": "string", "description": "\u8981\u89e3\u6790\u7684\u76ee\u5f55\u8def\u5f84", "required": false}}, "examples": [{"file_path": "src/utils.py"}, {"directory_path": "src/models"}], "category": "general"}, {"name": "analyze_tool_needs", "description": "\u5206\u6790\u4efb\u52a1\u9700\u6c42\uff0c\u786e\u5b9a\u662f\u5426\u9700\u8981\u989d\u5916\u7684\u5de5\u5177", "parameters": {"task_description": {"type": "string", "description": "\u8981\u5206\u6790\u7684\u4efb\u52a1\u63cf\u8ff0", "required": true}}, "examples": [{"task_description": "Create a chart showing sales data trends"}], "category": "general"}, {"name": "search_and_install_tools", "description": "\u641c\u7d22\u5e76\u5b89\u88c5\u65b0\u7684\u5de5\u5177\u4ee5\u6ee1\u8db3\u4efb\u52a1\u9700\u6c42", "parameters": {"task_description": {"type": "string", "description": "\u4efb\u52a1\u63cf\u8ff0", "required": true}, "reason": {"type": "string", "description": "\u9700\u8981\u65b0\u5de5\u5177\u7684\u539f\u56e0", "required": false}}, "examples": [{"task_description": "Create a chart", "reason": "Need charting capabilities"}], "category": "general"}], "endpoint": "ws://localhost:8080/mcp", "connection_params": {}}}
2025-06-28 11:44:10,129 - core.toolscore.mcp_server - INFO - [search_tool_server] Waiting for registration response from toolscore...
2025-06-28 11:44:10,131 - core.toolscore.mcp_server - INFO - [search_tool_server] Received registration response: {"type": "register_tool_response", "request_id": "bc92db13-4de1-40f9-9c39-d58b0f152b4b", "success": true, "message": null}
2025-06-28 11:44:10,131 - core.toolscore.mcp_server - INFO - [search_tool_server] Successfully registered with toolscore.
2025-06-28 11:44:29,977 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:44:29,978 - websockets.server - INFO - connection closed
2025-06-28 11:44:59,982 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:44:59,983 - websockets.server - INFO - connection closed
2025-06-28 11:45:29,986 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:45:29,986 - websockets.server - INFO - connection closed
2025-06-28 11:45:59,993 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:45:59,993 - websockets.server - INFO - connection closed
2025-06-28 11:46:30,000 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:46:30,001 - websockets.server - INFO - connection closed
2025-06-28 11:47:00,006 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:47:00,006 - websockets.server - INFO - connection closed
2025-06-28 11:47:30,013 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:47:30,014 - websockets.server - INFO - connection closed
2025-06-28 11:48:00,023 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:48:00,024 - websockets.server - INFO - connection closed
2025-06-28 11:48:30,026 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:48:30,027 - websockets.server - INFO - connection closed
2025-06-28 11:49:00,030 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:49:00,031 - websockets.server - INFO - connection closed
2025-06-28 11:49:30,041 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:49:30,042 - websockets.server - INFO - connection closed
2025-06-28 11:50:00,044 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:50:00,044 - websockets.server - INFO - connection closed
2025-06-28 11:50:30,047 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:50:30,047 - websockets.server - INFO - connection closed
2025-06-28 11:51:00,052 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:51:00,052 - websockets.server - INFO - connection closed
2025-06-28 11:51:30,054 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:51:30,054 - websockets.server - INFO - connection closed
2025-06-28 11:52:00,064 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:52:00,065 - websockets.server - INFO - connection closed
2025-06-28 11:52:30,066 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:52:30,066 - websockets.server - INFO - connection closed
2025-06-28 11:53:00,072 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:53:00,073 - websockets.server - INFO - connection closed
2025-06-28 11:53:30,079 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:53:30,079 - websockets.server - INFO - connection closed
2025-06-28 11:54:00,079 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:54:00,079 - websockets.server - INFO - connection closed
2025-06-28 11:54:30,080 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:54:30,080 - websockets.server - INFO - connection closed
2025-06-28 11:55:00,086 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:55:00,086 - websockets.server - INFO - connection closed
2025-06-28 11:55:30,088 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:55:30,088 - websockets.server - INFO - connection closed
2025-06-28 11:56:00,093 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:56:00,093 - websockets.server - INFO - connection closed
2025-06-28 11:56:30,118 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:56:30,118 - websockets.server - INFO - connection closed
2025-06-28 11:57:00,110 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:57:00,110 - websockets.server - INFO - connection closed
2025-06-28 11:57:30,113 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:57:30,114 - websockets.server - INFO - connection closed
2025-06-28 11:58:00,116 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:58:00,116 - websockets.server - INFO - connection closed
2025-06-28 11:58:30,121 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:58:30,121 - websockets.server - INFO - connection closed
2025-06-28 11:59:00,124 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:59:00,124 - websockets.server - INFO - connection closed
2025-06-28 11:59:30,127 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:59:30,127 - websockets.server - INFO - connection closed

2025-06-28 11:59:50,157 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 search_tool_server (第 1 次)
2025-06-28 11:59:50,159 - services.mcp_server_launcher - INFO - MCP服务器已正常停止: search_tool_server
2025-06-28 11:59:50,159 - services.mcp_server_launcher - INFO - 停止MCP服务器: browser_use_server
2025-06-28 11:59:50,159 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 收到停止信号，正在清理资源...
2025-06-28 11:59:50,489 - services.synthesis_service - ERROR - ❌ SynthesisCore v2.0监控器启动失败: 'NoneType' object has no attribute 'stop_monitoring'
2025-06-28 11:59:50,489 - services.synthesis_service - INFO - SynthesisCore v2.0监控器工作线程已停止

================================================================================
[系统启动] 2025-06-28 11:59:50
================================================================================
[2025-06-28 11:59:50] 🚀 Agent Data Platform 启动中... (所有日志将统一记录到 logs/System.log)
2025-06-28 11:59:50,589 - asyncio - DEBUG - Using selector: KqueueSelector
[2025-06-28 11:59:50] 🧹 开始增强端口清理...
[2025-06-28 11:59:50] 🔍 搜索并清理相关Python进程...
2025-06-28 11:59:50,601 - __main__ - INFO - 收到信号 15，正在强制关闭所有服务...
2025-06-28 11:59:50,601 - services.service_manager - INFO - 执行强制停止所有服务...
2025-06-28 11:59:50,601 - services.service_manager - INFO - 强制停止服务: synthesis
2025-06-28 11:59:50,601 - services.synthesis_service - INFO - 正在停止合成服务...
2025-06-28 11:59:50,601 - services.synthesis_service - INFO - 合成服务已停止
2025-06-28 11:59:50,601 - services.service_manager - INFO - 强制停止服务: runtime
2025-06-28 11:59:50,601 - services.runtime_service - INFO - 正在停止推理运行时服务...
2025-06-28 11:59:50,601 - services.runtime_service - INFO - 推理运行时服务已停止
2025-06-28 11:59:50,601 - services.service_manager - INFO - 强制停止服务: task_api
2025-06-28 11:59:50,601 - services.task_api_service - INFO - 正在停止任务API服务...
2025-06-28 11:59:50,601 - services.task_api_service - INFO - 任务API服务已停止
2025-06-28 11:59:50,601 - services.service_manager - INFO - 强制停止服务: mcp_servers
2025-06-28 11:59:50,601 - services.mcp_server_launcher - INFO - 正在停止MCP服务器...
2025-06-28 11:59:50,601 - services.mcp_server_launcher - INFO - 停止MCP服务器: microsandbox_server
2025-06-28 11:59:50,601 - services.mcp_server_launcher - INFO - MCP服务器已经停止: microsandbox_server
2025-06-28 11:59:50,601 - services.mcp_server_launcher - INFO - 停止MCP服务器: search_tool_server
2025-06-28 11:59:50,601 - services.mcp_server_launcher - INFO - MCP服务器已经停止: search_tool_server
2025-06-28 11:59:50,601 - services.mcp_server_launcher - INFO - 停止MCP服务器: browser_use_server
2025-06-28 11:59:50,601 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 收到停止信号，正在清理资源...
2025-06-28 11:59:50,621 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 收到停止信号，正在清理资源...
2025-06-28 11:59:50,623 - services.mcp_server_launcher - WARNING - ❌ MCP服务器异常退出: deepsearch_server (退出码: -15)
2025-06-28 11:59:50,623 - services.mcp_server_launcher - ERROR - [deepsearch_server] 错误输出: 2025-06-28 11:44:00,286 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:44:00,286 - mcp_servers.deepsearch_server.deepsearch_tool_unified - INFO - DeepSearch tool initialized with unified LLM client
2025-06-28 11:44:00,286 - __main__ - INFO - 使用动态分配端口: 8086
2025-06-28 11:44:00,286 - __main__ - INFO - Starting deepsearch_server...
2025-06-28 11:44:00,286 - core.toolscore.mcp_server - INFO - Attempting to start deepsearch_server MCP Server on localhost:8086
2025-06-28 11:44:00,287 - mcp_servers.deepsearch_server.intelligent_cache - INFO - Loaded 5 cache entries from persistent storage
2025-06-28 11:44:00,288 - websockets.server - INFO - server listening on 127.0.0.1:8086
2025-06-28 11:44:00,288 - websockets.server - INFO - server listening on [::1]:8086
2025-06-28 11:44:00,288 - core.toolscore.mcp_server - INFO - deepsearch_server MCP Server started successfully on localhost:8086 (Original endpoint: ws://localhost:8086/mcp) with ping_interval=30, ping_timeout=60
2025-06-28 11:44:00,288 - core.toolscore.mcp_server - INFO - Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:44:00,603 - websockets.server - INFO - connection rejected (426 Upgrade Required)
2025-06-28 11:44:00,603 - websockets.server - INFO - connection closed
2025-06-28 11:44:00,605 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:44:00,605 - websockets.server - INFO - connection closed
2025-06-28 11:44:10,289 - core.toolscore.mcp_server - INFO - [deepsearch_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 11:44:10,291 - core.toolscore.mcp_server - INFO - [deepsearch_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 11:44:10,291 - core.toolscore.mcp_server - INFO - [deepsearch_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "12ec2b81-4c08-4e2d-b708-20b3f2150663", "tool_spec": {"tool_id": "deepsearch", "name": "deepsearch_server", "description": "\u4e13\u4e1a\u7ea7\u6df1\u5ea6\u641c\u7d22\u548c\u7814\u7a76\u5de5\u5177\u670d\u52a1\u5668\uff0c\u57fa\u4e8eLangGraph\u5b9e\u73b0\u7684\u591a\u8f6e\u8fed\u4ee3\u641c\u7d22\u4ee3\u7406", "tool_type": "mcp_server", "capabilities": [{"name": "research", "description": "\u6267\u884c\u4e13\u4e1a\u7ea7\u6df1\u5ea6\u7814\u7a76\uff0c\u83b7\u53d6\u8be6\u7ec6\u8c03\u7814\u4fe1\u606f", "parameters": {"question": {"type": "string", "description": "\u8981\u7814\u7a76\u7684\u95ee\u9898\u6216\u4e3b\u9898", "required": true}, "research_depth": {"type": "string", "description": "\u7814\u7a76\u6df1\u5ea6: quick/standard/comprehensive", "required": false}, "max_iterations": {"type": "integer", "description": "\u6700\u5927\u8fed\u4ee3\u6b21\u6570", "required": false}}, "examples": [], "category": "general"}, {"name": "quick_research", "description": "\u6267\u884c\u5feb\u901f\u7814\u7a76\uff0c\u9002\u7528\u4e8e\u9700\u8981\u5feb\u901f\u83b7\u53d6\u57fa\u7840\u4fe1\u606f\u7684\u573a\u666f", "parameters": {"question": {"type": "string", "description": "\u8981\u7814\u7a76\u7684\u95ee\u9898\u6216\u4e3b\u9898", "required": true}}, "examples": [], "category": "general"}, {"name": "comprehensive_research", "description": "\u6267\u884c\u5168\u9762\u6df1\u5ea6\u7814\u7a76\uff0c\u9002\u7528\u4e8e\u9700\u8981\u8be6\u7ec6\u3001\u4e13\u4e1a\u7ea7\u8c03\u7814\u4fe1\u606f\u7684\u573a\u666f", "parameters": {"question": {"type": "string", "description": "\u8981\u7814\u7a76\u7684\u95ee\u9898\u6216\u4e3b\u9898", "required": true}, "topic_focus": {"type": "string", "description": "\u53ef\u9009\u7684\u4e3b\u9898\u7126\u70b9\uff0c\u7528\u4e8e\u5f15\u5bfc\u7814\u7a76\u65b9\u5411", "required": false}}, "examples": [], "category": "general"}, {"name": "get_health_status", "description": "\u83b7\u53d6\u7cfb\u7edf\u5065\u5eb7\u72b6\u6001\u548c\u6027\u80fd\u6307\u6807", "parameters": {}, "examples": [], "category": "general"}, {"name": "get_optimization_stats", "description": "\u83b7\u53d6\u8bf7\u6c42\u4f18\u5316\u7edf\u8ba1\u4fe1\u606f", "parameters": {}, "examples": [], "category": "general"}], "endpoint": "ws://localhost:8086/mcp", "connection_params": {}}}
2025-06-28 11:44:10,291 - core.toolscore.mcp_server - INFO - [deepsearch_server] Waiting for registration response from toolscore...
2025-06-28 11:44:10,291 - core.toolscore.mcp_server - INFO - [deepsearch_server] Received registration response: {"type": "register_tool_response", "request_id": "12ec2b81-4c08-4e2d-b708-20b3f2150663", "success": true, "message": null}
2025-06-28 11:44:10,291 - core.toolscore.mcp_server - INFO - [deepsearch_server] Successfully registered with toolscore.
2025-06-28 11:44:30,002 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:44:30,003 - websockets.server - INFO - connection closed
2025-06-28 11:45:00,002 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:45:00,003 - websockets.server - INFO - connection closed
2025-06-28 11:45:30,007 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:45:30,008 - websockets.server - INFO - connection closed
2025-06-28 11:46:00,013 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:46:00,013 - websockets.server - INFO - connection closed
2025-06-28 11:46:30,020 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:46:30,020 - websockets.server - INFO - connection closed
2025-06-28 11:47:00,022 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:47:00,022 - websockets.server - INFO - connection closed
2025-06-28 11:47:30,028 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:47:30,028 - websockets.server - INFO - connection closed
2025-06-28 11:48:00,032 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:48:00,032 - websockets.server - INFO - connection closed
2025-06-28 11:48:30,034 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:48:30,034 - websockets.server - INFO - connection closed
2025-06-28 11:49:00,039 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:49:00,039 - websockets.server - INFO - connection closed
2025-06-28 11:49:30,048 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:49:30,049 - websockets.server - INFO - connection closed
2025-06-28 11:50:00,049 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:50:00,049 - websockets.server - INFO - connection closed
2025-06-28 11:50:30,054 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:50:30,055 - websockets.server - INFO - connection closed
2025-06-28 11:51:00,054 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:51:00,054 - websockets.server - INFO - connection closed
2025-06-28 11:51:30,055 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:51:30,055 - websockets.server - INFO - connection closed
2025-06-28 11:52:00,064 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:52:00,065 - websockets.server - INFO - connection closed
2025-06-28 11:52:30,066 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:52:30,066 - websockets.server - INFO - connection closed
2025-06-28 11:53:00,071 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:53:00,071 - websockets.server - INFO - connection closed
2025-06-28 11:53:30,074 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:53:30,074 - websockets.server - INFO - connection closed
2025-06-28 11:54:00,079 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:54:00,079 - websockets.server - INFO - connection closed
2025-06-28 11:54:30,080 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:54:30,080 - websockets.server - INFO - connection closed
2025-06-28 11:55:00,086 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:55:00,086 - websockets.server - INFO - connection closed
2025-06-28 11:55:30,088 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:55:30,088 - websockets.server - INFO - connection closed
2025-06-28 11:56:00,091 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:56:00,091 - websockets.server - INFO - connection closed
2025-06-28 11:56:30,115 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:56:30,116 - websockets.server - INFO - connection closed
2025-06-28 11:57:00,115 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:57:00,115 - websockets.server - INFO - connection closed
2025-06-28 11:57:30,119 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:57:30,119 - websockets.server - INFO - connection closed
2025-06-28 11:58:00,125 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:58:00,125 - websockets.server - INFO - connection closed
2025-06-28 11:58:30,128 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:58:30,128 - websockets.server - INFO - connection closed
2025-06-28 11:59:00,130 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:59:00,130 - websockets.server - INFO - connection closed
2025-06-28 11:59:30,132 - websockets.server - INFO - connection rejected (400 Bad Request)
2025-06-28 11:59:30,132 - websockets.server - INFO - connection closed

2025-06-28 11:59:50,624 - services.mcp_server_launcher - INFO - 🔄 计划在 10s 后自动重启 deepsearch_server (第 1 次)
2025-06-28 11:59:50,652 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 收到停止信号，正在清理资源...
[2025-06-28 11:59:50] ✅ 进程清理完成
[2025-06-28 11:59:52] ✅ 端口 8088 空闲
[2025-06-28 11:59:52] ✅ 端口 8089 空闲
[2025-06-28 11:59:52] ✅ 端口 8090 空闲
[2025-06-28 11:59:52] ✅ 端口 8091 空闲
[2025-06-28 11:59:52] ✅ 端口 8092 空闲
[2025-06-28 11:59:52] ✅ 端口 5555 空闲
[2025-06-28 11:59:52] 🔥 强制清理端口 8081 的进程 75982
[2025-06-28 11:59:52] ✅ 端口 8082 空闲
[2025-06-28 11:59:52] ✅ 端口 8080 空闲
[2025-06-28 11:59:52] 🔥 强制清理端口 8084 的进程 76028
[2025-06-28 11:59:53] ✅ 端口 8085 空闲
[2025-06-28 11:59:53] ✅ 端口 8086 空闲
[2025-06-28 11:59:53] ✅ 端口 8087 空闲
[2025-06-28 11:59:53] ✅ 端口 8000 空闲
[2025-06-28 11:59:54] ✅ 增强端口清理完成
2025-06-28 11:59:54,077 - __main__ - INFO - === Agent Data Platform 启动中 ===
2025-06-28 11:59:54,078 - __main__ - DEBUG - 🔧 开始系统初始化流程...
2025-06-28 11:59:54,078 - __main__ - DEBUG - 📝 命令行参数: {'config_dir': 'config', 'debug': False, 'start_services': False}
2025-06-28 11:59:54,078 - __main__ - DEBUG - 🔧 步骤1: 初始化ConfigManager...
2025-06-28 11:59:54,078 - __main__ - DEBUG - ✅ ConfigManager初始化完成，配置目录: config
2025-06-28 11:59:54,078 - __main__ - DEBUG - 🔧 步骤2: 加载系统配置...
2025-06-28 11:59:54,079 - __main__ - DEBUG - 📡 Redis URL: redis://localhost:6379
2025-06-28 11:59:54,079 - __main__ - DEBUG - 📋 任务文件路径: tasks.jsonl
2025-06-28 11:59:54,081 - core.config_manager - INFO - 路由配置加载成功
2025-06-28 11:59:54,081 - __main__ - DEBUG - 🚦 路由配置加载完成，任务类型映射: {'CODE': 'tasks:reasoning', 'WEB': 'tasks:reasoning', 'REASONING': 'tasks:reasoning', 'RESEARCH': 'tasks:reasoning'}
2025-06-28 11:59:54,081 - __main__ - DEBUG - 📋 队列映射: {<TaskType.CODE: 'code'>: 'tasks:reasoning', <TaskType.WEB: 'web'>: 'tasks:reasoning', <TaskType.REASONING: 'reasoning'>: 'tasks:reasoning', <TaskType.RESEARCH: 'research'>: 'tasks:reasoning'}
2025-06-28 11:59:54,081 - __main__ - DEBUG - 🔧 步骤3: 初始化核心组件...
2025-06-28 11:59:54,081 - __main__ - DEBUG - ✅ EnhancedMetrics初始化完成
2025-06-28 11:59:54,082 - __main__ - DEBUG - ✅ RedisManager初始化完成
2025-06-28 11:59:54,082 - core.toolscore.toolscore_client - INFO - ✅ 增强的ToolScoreClient初始化完成
2025-06-28 11:59:54,082 - core.llm_client - DEBUG - Enriched config with environment variables: ['default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:59:54,196 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:59:54,198 - core.config_manager - INFO - 路由配置加载成功
2025-06-28 11:59:54,198 - core.monitoring.queue_monitor - INFO - ✅ QueueMonitor 配置加载完成
2025-06-28 11:59:54,198 - core.system_monitor - INFO - ✅ SystemMonitor 配置加载完成
2025-06-28 11:59:54,198 - __main__ - DEBUG - 🔧 开始初始化所有服务...
2025-06-28 11:59:54,198 - services.service_manager - INFO - 正在初始化所有服务...
2025-06-28 11:59:54,198 - services.service_manager - INFO - 初始化服务: redis
2025-06-28 11:59:54,199 - services.redis_service - INFO - Redis服务初始化完成，使用注入的RedisManager实例
2025-06-28 11:59:54,199 - services.service_manager - INFO - 初始化服务: toolscore
2025-06-28 11:59:54,199 - services.toolscore_service - INFO - 正在初始化ToolScore服务...
2025-06-28 11:59:54,199 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 11:59:54,199 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 11:59:54,199 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 11:59:54,199 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:59:54,199 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 11:59:54,199 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 11:59:54,199 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 11:59:54,199 - services.toolscore_service - INFO - ToolScore服务初始化完成（异步初始化将在start()中进行）
2025-06-28 11:59:54,199 - services.service_manager - INFO - 初始化服务: task_processing_coordinator
2025-06-28 11:59:54,199 - services.service_manager - INFO - 初始化服务: mcp_servers
2025-06-28 11:59:54,199 - services.mcp_server_launcher - INFO - 正在初始化MCP服务器启动器...
2025-06-28 11:59:54,199 - services.mcp_server_launcher - INFO - MCP服务器启动器初始化完成，配置了 4 个服务器: ['microsandbox_server', 'search_tool_server', 'browser_use_server', 'deepsearch_server']
2025-06-28 11:59:54,199 - services.service_manager - INFO - 初始化服务: task_api
2025-06-28 11:59:54,199 - services.task_api_service - INFO - 正在初始化任务API服务...
2025-06-28 11:59:54,199 - services.task_api_service - INFO - 任务API服务初始化完成
2025-06-28 11:59:54,199 - services.service_manager - INFO - 初始化服务: runtime
2025-06-28 11:59:54,199 - services.runtime_service - INFO - 正在初始化推理运行时服务...
2025-06-28 11:59:54,199 - services.runtime_service - INFO - 创建运行时实例: enhanced-runtime-1
2025-06-28 11:59:54,199 - core.memory_manager - INFO - MemoryManager initialized: use_redis=True, max_entries=1000
2025-06-28 11:59:54,199 - core.step_planner - INFO - StepPlanner initialized with max_steps=10
2025-06-28 11:59:54,199 - runtimes.reasoning.enhanced_runtime - INFO - DEBUG: Loaded toolscore_http_port: 8082, toolscore_mcp_port: 8081
2025-06-28 11:59:54,199 - runtimes.reasoning.enhanced_runtime - INFO - DEBUG: Configured toolscore_websocket_endpoint (using mcp_port): ws://localhost:8081/websocket
2025-06-28 11:59:54,199 - core.toolscore.mcp_client - INFO - Enhanced MCPToolClient initialized for toolscore at ws://localhost:8081/websocket
2025-06-28 11:59:54,209 - core.config.unified_mapping_manager - INFO - ✅ 统一映射配置已加载: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/config/unified_tool_mappings.yaml
2025-06-28 11:59:54,209 - core.config.unified_mapping_manager - INFO - 🔒 配置哈希: 19cc9dfe
2025-06-28 11:59:54,209 - core.llm.guardrails_middleware - INFO - 🔧 初始化输入验证Guard...
2025-06-28 11:59:54,210 - root - DEBUG - Creating HubTelemetry instance...
2025-06-28 11:59:54,210 - root - DEBUG - Initializing HubTelemetry instance...
2025-06-28 11:59:54,212 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:59:54,212 - core.llm.guardrails_middleware - INFO - 🔧 初始化输出验证Guard...
2025-06-28 11:59:54,212 - core.llm.guardrails_middleware - INFO - 🔧 使用本地LLM客户端初始化Guard...
2025-06-28 11:59:54,213 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:59:54,213 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 11:59:54,213 - core.llm.guardrails_middleware - INFO - ✅ 使用LLM的Guard创建成功
2025-06-28 11:59:54,213 - core.llm.guardrails_middleware - INFO - ✅ Guardrails Guards初始化成功
2025-06-28 11:59:54,213 - core.llm.guardrails_middleware - INFO -    - 输入Guard: ✅
2025-06-28 11:59:54,213 - core.llm.guardrails_middleware - INFO -    - 输出Guard: ✅
2025-06-28 11:59:54,213 - core.agents.validation_critic - INFO - 🎯 ValidationCritic Agent初始化完成
2025-06-28 11:59:54,213 - core.toolscore.async_tool_state_manager - INFO - AsyncToolStateManager initialized with 4 essential tools
2025-06-28 11:59:54,213 - services.runtime_service - INFO - 推理运行时服务初始化完成，创建了 1 个实例
2025-06-28 11:59:54,213 - services.service_manager - INFO - 初始化服务: synthesis
2025-06-28 11:59:54,213 - services.synthesis_service - INFO - 正在初始化合成服务...
2025-06-28 11:59:54,213 - core.llm_client - DEBUG - Enriched config with environment variables: ['redis_url', 'TRAJECTORIES_DIR', 'default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:59:54,247 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:59:54,247 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 11:59:54,247 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 11:59:54,247 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 11:59:54,247 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:59:54,247 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 11:59:54,247 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 11:59:54,247 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 11:59:54,247 - core.synthesiscore.synthesis - INFO - ✅ 初始化任务本质文件: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/output/task_essences.json
2025-06-28 11:59:54,247 - core.synthesiscore.synthesis - INFO - ✅ 初始化种子任务文件: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/output/seed_tasks.jsonl
2025-06-28 11:59:54,248 - core.synthesiscore.synthesis - INFO - ✅ 初始化已处理轨迹记录文件: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/output/processed_trajectories.json
2025-06-28 11:59:54,248 - core.synthesiscore.synthesis - INFO - ✅ JSON文件存储初始化完成
2025-06-28 11:59:54,248 - core.synthesiscore.synthesis - INFO - 📋 未发现已处理轨迹记录，从空白状态开始
2025-06-28 11:59:54,248 - core.llm_client - DEBUG - Enriched config with environment variables: ['redis_url', 'TRAJECTORIES_DIR', 'default_provider', 'providers', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:59:54,281 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:59:54,281 - core.toolscore.mcp_client - INFO - Enhanced MCPToolClient initialized for toolscore at ws://localhost:8089/websocket
2025-06-28 11:59:54,284 - core.synthesiscore.config_loader - INFO - ✅ SynthesisCore配置加载成功: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/config/synthesiscore_config.yaml
2025-06-28 11:59:54,284 - core.synthesiscore.trajectory_monitor - INFO - 🔧 TrajectoryMonitor初始化完成
2025-06-28 11:59:54,284 - core.synthesiscore.trajectory_monitor - INFO - 📂 监控目录: output/trajectories
2025-06-28 11:59:54,284 - core.synthesiscore.trajectory_monitor - INFO - 📝 种子文件: output/trajectories/../seed_tasks.jsonl
2025-06-28 11:59:54,284 - services.synthesis_service - INFO - ✅ TrajectoryMonitor v2.0 初始化完成
2025-06-28 11:59:54,284 - services.synthesis_service - INFO - 合成服务初始化完成，轨迹目录: output/trajectories
2025-06-28 11:59:54,284 - __main__ - DEBUG - ✅ 所有服务初始化完成
2025-06-28 11:59:54,284 - __main__ - DEBUG - 🚀 开始启动所有服务...
2025-06-28 11:59:54,284 - services.service_manager - INFO - 正在启动所有服务...
2025-06-28 11:59:54,284 - services.service_manager - INFO - 启动服务: redis
2025-06-28 11:59:54,284 - services.redis_service - INFO - Redis客户端已就绪
2025-06-28 11:59:54,284 - services.service_manager - INFO - 启动服务: toolscore
2025-06-28 11:59:54,284 - services.toolscore_service - INFO - 正在启动ToolScore服务...
2025-06-28 11:59:54,284 - services.toolscore_service - INFO - 正在初始化工具库...
2025-06-28 11:59:54,284 - services.toolscore_service - INFO - 工具库初始化将在ToolScore MCP服务器线程中进行。
2025-06-28 11:59:54,284 - services.toolscore_service - INFO - 正在启动ToolScore HTTP API...
2025-06-28 11:59:54,293 - services.toolscore_service - INFO - ToolScore HTTP API已启动于端口: 8082
2025-06-28 11:59:54,293 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:59:54,294 - services.toolscore_service - INFO - ToolScore MCP 服务器不进行端口自动检测，使用配置端口: 8081
2025-06-28 11:59:54,294 - services.toolscore_service - INFO - ToolScore MCP server configured to use host: 0.0.0.0, port: 8081, path: /websocket
2025-06-28 11:59:54,294 - core.toolscore.core_manager - INFO - ✅ CoreManager 使用增强的ProcessRunner
2025-06-28 11:59:54,294 - core.toolscore.core_manager - INFO - 🚀 使用v2.0服务容器架构
2025-06-28 11:59:54,294 - core.toolscore.service_container.mcp_service_container - INFO - 🏗️ MCP服务容器初始化完成
2025-06-28 11:59:54,294 - core.toolscore.enhanced_core_manager_v2 - INFO - 🏗️ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:59:54,294 - core.toolscore.core_manager - INFO - ✅ 增强的核心管理器初始化完成
2025-06-28 11:59:54,294 - core.toolscore.mcp_connector - INFO - MCPServerRegistry initialized
2025-06-28 11:59:54,294 - core.toolscore.unified_tool_library - INFO - Unified Tool Library initialized - 使用核心管理器整合模式
2025-06-28 11:59:54,294 - services.toolscore_service - INFO - Starting ToolScore MCP server thread...
2025-06-28 11:59:54,294 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 11:59:54,294 - services.toolscore_service - INFO - ToolScore MCP server thread started, is_alive: True
2025-06-28 11:59:54,294 - services.toolscore_service - INFO - ToolScore MCP服务器启动线程已启动，等待就绪信号...
2025-06-28 11:59:54,294 - core.toolscore.monitoring_api - INFO - ToolScore monitoring API started on port 8082
2025-06-28 11:59:54,294 - services.service_manager - INFO - 启动服务: task_processing_coordinator
2025-06-28 11:59:54,294 - core.toolscore.mcp_server - INFO - Attempting to start toolscore MCP Server on 0.0.0.0:8081
2025-06-28 11:59:54,294 - core.dispatcher_enhanced - INFO - ✅ TaskProcessingCoordinator 配置加载完成 - 队列映射: {<TaskType.CODE: 'code'>: 'tasks:reasoning', <TaskType.WEB: 'web'>: 'tasks:reasoning', <TaskType.REASONING: 'reasoning'>: 'tasks:reasoning', <TaskType.RESEARCH: 'research'>: 'tasks:reasoning'}
2025-06-28 11:59:54,294 - services.service_manager - INFO - 启动服务: mcp_servers
2025-06-28 11:59:54,295 - services.mcp_server_launcher - INFO - 正在启动MCP服务器...
2025-06-28 11:59:54,295 - services.mcp_server_launcher - INFO - 正在并行启动 4 个MCP服务器...
2025-06-28 11:59:54,295 - core.dispatcher_enhanced - INFO - 启动任务处理协调器...
2025-06-28 11:59:54,295 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: microsandbox_server
2025-06-28 11:59:54,295 - websockets.server - INFO - server listening on 0.0.0.0:8081
2025-06-28 11:59:54,295 - core.toolscore.mcp_server - INFO - [toolscore] Initializing UnifiedToolLibrary...
2025-06-28 11:59:54,295 - core.toolscore.core_manager - INFO - 🚀 正在初始化增强的CoreManager...
2025-06-28 11:59:54,295 - core.toolscore.core_manager - INFO - 🔄 使用v2.0服务容器架构初始化...
2025-06-28 11:59:54,295 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:59:54,295 - core.toolscore.enhanced_core_manager_v2 - INFO - 🚀 初始化增强核心管理器 v2.0...
2025-06-28 11:59:54,295 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: microsandbox_server
2025-06-28 11:59:54,295 - core.toolscore.service_container.mcp_service_container - INFO - 🚀 开始初始化MCP服务容器...
2025-06-28 11:59:54,295 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server
2025-06-28 11:59:54,295 - core.toolscore.service_container.mcp_service_container - INFO - 🔍 发现内置MCP服务...
2025-06-28 11:59:54,295 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:59:54,295 - core.toolscore.service_container.builtin_discovery - INFO - 🔍 开始发现内置MCP服务: mcp_servers
2025-06-28 11:59:54,295 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) = True
2025-06-28 11:59:54,295 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server) contents: ['production_mode_validator.py', 'token_manager.py', 'service.json', '__init__.py', '__pycache__']
2025-06-28 11:59:54,295 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/microsandbox_server/main.py
2025-06-28 11:59:54,295 - services.mcp_server_launcher - INFO - [MCP启动器] 为microsandbox_server设置AGENT_RUNTIME_DIR: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/agent_runtime
2025-06-28 11:59:54,295 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:59:54,295 - services.mcp_server_launcher - INFO - [MCP启动器] microsandbox_server 未配置 auto_start 或 auto_start 为 false，跳过端口分配。
2025-06-28 11:59:54,295 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: Search Tool MCP Server
2025-06-28 11:59:54,295 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.microsandbox_server.main
2025-06-28 11:59:54,295 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:59:54,298 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: MicroSandbox MCP Server
2025-06-28 11:59:54,299 - services.mcp_server_launcher - INFO - MCP服务器已启动: microsandbox_server (PID: 77039)
2025-06-28 11:59:54,299 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 microsandbox_server 就绪状态...
2025-06-28 11:59:54,299 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 跳过 __pycache__: 缺少main.py文件
2025-06-28 11:59:54,299 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:59:54,299 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:59:54,299 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: search_tool_server
2025-06-28 11:59:54,299 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: Browser Use MCP Server
2025-06-28 11:59:54,299 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:59:54,299 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: search_tool_server
2025-06-28 11:59:54,299 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server
2025-06-28 11:59:54,299 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:59:54,299 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) = True
2025-06-28 11:59:54,299 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server) contents: ['search_tool.py', 'service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:59:54,299 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/search_tool_server/main.py
2025-06-28 11:59:54,299 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:59:54,299 - core.toolscore.service_container.builtin_discovery - INFO - ✅ 发现内置服务: DeepSearch MCP Server
2025-06-28 11:59:54,299 - core.toolscore.service_container.builtin_discovery - INFO - 🎯 内置服务发现完成，共发现 4 个服务
2025-06-28 11:59:54,300 - core.toolscore.service_container.builtin_discovery - INFO - 📝 创建服务配置文件...
2025-06-28 11:59:54,300 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:59:54,300 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/search_tool_server/service.json
2025-06-28 11:59:54,300 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/microsandbox_server/service.json
2025-06-28 11:59:54,300 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/browser_use_server/service.json
2025-06-28 11:59:54,300 - core.toolscore.service_container.builtin_discovery - DEBUG - ⏭️ 配置文件已存在: mcp_servers/deepsearch_server/service.json
2025-06-28 11:59:54,300 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 发现 4 个内置服务
2025-06-28 11:59:54,300 - core.toolscore.service_container.mcp_service_container - INFO - 📂 加载已安装的外部服务...
2025-06-28 11:59:54,300 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 加载 0 个外部服务
2025-06-28 11:59:54,300 - core.toolscore.service_container.mcp_service_container - INFO - 📋 构建统一服务目录...
2025-06-28 11:59:54,300 - core.toolscore.service_container.mcp_service_container - INFO - ✅ 服务目录构建完成，共 4 个服务
2025-06-28 11:59:54,300 - core.toolscore.service_container.mcp_service_container - INFO - 📋 标记内置服务为启动中状态...
2025-06-28 11:59:54,300 - core.toolscore.service_container.mcp_service_container - INFO - 📋 已标记 4 个内置服务为启动中状态
2025-06-28 11:59:54,300 - core.toolscore.service_container.service_monitor - INFO - 🔍 启动服务监控...
2025-06-28 11:59:54,300 - core.toolscore.service_container.mcp_service_container - INFO - ✅ MCP服务容器初始化完成
2025-06-28 11:59:54,300 - core.toolscore.enhanced_core_manager_v2 - INFO - ✅ 增强核心管理器 v2.0 初始化完成
2025-06-28 11:59:54,300 - services.mcp_server_launcher - INFO - [MCP启动器] 为 search_tool_server 使用配置文件指定端口: 8080
2025-06-28 11:59:54,300 - core.toolscore.core_manager - INFO - ✅ v2.0架构初始化完成
2025-06-28 11:59:54,300 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 SEARCH_TOOL_SERVER_PORT=8080 给 search_tool_server
2025-06-28 11:59:54,300 - core.toolscore.tool_registry - INFO - Tool registry initialized
2025-06-28 11:59:54,300 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.search_tool_server.main
2025-06-28 11:59:54,300 - core.llm_client - DEBUG - Enriched config with environment variables: ['provider', 'gemini_api_key', 'gemini_api_url']
2025-06-28 11:59:54,300 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:59:54,303 - services.mcp_server_launcher - INFO - MCP服务器已启动: search_tool_server (PID: 77040)
2025-06-28 11:59:54,303 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 search_tool_server 就绪状态...
2025-06-28 11:59:54,317 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: browser_use_server
2025-06-28 11:59:54,317 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:59:54,317 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: browser_use_server
2025-06-28 11:59:54,317 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server
2025-06-28 11:59:54,317 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) = True
2025-06-28 11:59:54,317 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) = True
2025-06-28 11:59:54,317 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server) contents: ['service.json', '__init__.py', '__pycache__', 'main.py']
2025-06-28 11:59:54,317 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/browser_use_server/main.py
2025-06-28 11:59:54,317 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:59:54,318 - services.mcp_server_launcher - INFO - [MCP启动器] 为 browser_use_server 使用配置文件指定端口: 8084
2025-06-28 11:59:54,318 - services.mcp_server_launcher - INFO - [MCP启动器] 为 browser_use_server 使用配置文件指定端口: 8084
2025-06-28 11:59:54,318 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 BROWSER_USE_SERVER_PORT=8084 给 browser_use_server
2025-06-28 11:59:54,318 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.browser_use_server.main
2025-06-28 11:59:54,318 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:59:54,322 - services.mcp_server_launcher - INFO - MCP服务器已启动: browser_use_server (PID: 77042)
2025-06-28 11:59:54,322 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 browser_use_server 就绪状态...
2025-06-28 11:59:54,323 - services.mcp_server_launcher - INFO - 正在启动MCP服务器: deepsearch_server
2025-06-28 11:59:54,323 - services.mcp_server_launcher - DEBUG - [MCP启动器] 当前工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:59:54,323 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_name: deepsearch_server
2025-06-28 11:59:54,323 - services.mcp_server_launcher - DEBUG - [MCP启动器] server_dir (绝对用于操作): /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server
2025-06-28 11:59:54,323 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.exists(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:59:54,323 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.path.isdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) = True
2025-06-28 11:59:54,324 - services.mcp_server_launcher - DEBUG - [MCP启动器] os.listdir(/Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server) contents: ['config.py', 'deepsearch_tool.py', 'intelligent_cache.py', 'service.json', '__init__.py']
2025-06-28 11:59:54,324 - services.mcp_server_launcher - INFO - [MCP启动器] 找到启动脚本: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/mcp_servers/deepsearch_server/main.py
2025-06-28 11:59:54,324 - services.mcp_server_launcher - DEBUG - [MCP启动器] Setting PYTHONPATH for subprocess to: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:59:54,324 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:59:54,324 - services.mcp_server_launcher - INFO - [MCP启动器] 为 deepsearch_server 使用配置文件指定端口: 8086
2025-06-28 11:59:54,324 - services.mcp_server_launcher - DEBUG - [MCP启动器] 设置环境变量 DEEPSEARCH_SERVER_PORT=8086 给 deepsearch_server
2025-06-28 11:59:54,324 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用模块格式启动: python -m mcp_servers.deepsearch_server.main
2025-06-28 11:59:54,324 - services.mcp_server_launcher - DEBUG - [MCP启动器] 使用工作目录: /Users/zhaoxiang/Documents/Datapresso/agent-data-platform
2025-06-28 11:59:54,328 - services.mcp_server_launcher - INFO - MCP服务器已启动: deepsearch_server (PID: 77044)
2025-06-28 11:59:54,329 - services.mcp_server_launcher - DEBUG - 🔍 开始检测 deepsearch_server 就绪状态...
2025-06-28 11:59:54,329 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第1次, 5s间隔)
2025-06-28 11:59:54,329 - core.monitoring.queue_monitor - INFO - 启动队列监控器...
2025-06-28 11:59:54,332 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:59:54,332 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:59:54,332 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:59:54,333 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:59:54,333 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:59:54,333 - websockets.client - DEBUG - > Sec-WebSocket-Key: pYIion8xZaOQSbOTsimIRg==
2025-06-28 11:59:54,333 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:59:54,333 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:59:54,333 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:59:54,333 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:59:54,333 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:59:54,333 - websockets.client - DEBUG - > Host: localhost:8084
2025-06-28 11:59:54,333 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:59:54,333 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:59:54,333 - websockets.client - DEBUG - > Sec-WebSocket-Key: tq4u3AgnzxFe8SeedZOapQ==
2025-06-28 11:59:54,333 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:59:54,333 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:59:54,333 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:59:54,333 - websockets.client - DEBUG - > EOF
2025-06-28 11:59:54,333 - websockets.client - DEBUG - < EOF
2025-06-28 11:59:54,333 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:59:54,333 - websockets.client - DEBUG - > EOF
2025-06-28 11:59:54,333 - websockets.client - DEBUG - < EOF
2025-06-28 11:59:54,333 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:59:54,335 - services.mcp_server_launcher - DEBUG - 📋 browser_use_server 端口 8084 尚未就绪
2025-06-28 11:59:54,336 - services.mcp_server_launcher - DEBUG - 📋 search_tool_server 端口 8080 尚未就绪
2025-06-28 11:59:54,337 - services.mcp_server_launcher - DEBUG - 📋 deepsearch_server 端口 8086 尚未就绪
2025-06-28 11:59:54,350 - core.llm_client - INFO - Initialized LLM client with provider: gemini
2025-06-28 11:59:54,350 - core.toolscore.tool_gap_detector - INFO - 智能工具缺口检测器初始化 - 统一版本
2025-06-28 11:59:54,350 - core.toolscore.dynamic_mcp_manager - INFO - Dynamic MCP Manager initialized (ProcessRunner mode)
2025-06-28 11:59:54,350 - core.toolscore.dynamic_mcp_manager - INFO - 启动动态MCP管理器...
2025-06-28 11:59:54,351 - core.toolscore.dynamic_mcp_manager - INFO - 持久化配置为空，无需恢复外部MCP服务器
2025-06-28 11:59:54,351 - core.toolscore.dynamic_mcp_manager - INFO - 动态MCP管理器启动完成
2025-06-28 11:59:54,351 - core.toolscore.mcp_search_tool - INFO - ✅ MCP Search Tool initialized - 优化版本，包含失败工具跟踪
2025-06-28 11:59:54,351 - core.toolscore.unified_tool_library - INFO - Tool library initialization completed - 核心管理器模式
2025-06-28 11:59:54,351 - core.toolscore.mcp_server - INFO - [toolscore] UnifiedToolLibrary initialized.
2025-06-28 11:59:54,351 - core.toolscore.mcp_server - INFO - [toolscore] Auto-registering MCP servers...
2025-06-28 11:59:54,351 - core.toolscore.mcp_auto_registration - INFO - 🔍 开始自动发现和注册MCP服务器...
2025-06-28 11:59:54,351 - core.toolscore.mcp_auto_registration - DEBUG - ⚠️ 服务器目录 __pycache__ 缺少 service.json
2025-06-28 11:59:54,351 - core.toolscore.mcp_auto_registration - INFO - 🎯 发现 4 个MCP服务器
2025-06-28 11:59:54,368 - core.unified_tool_manager - DEBUG - ✅ 配置验证通过
2025-06-28 11:59:54,368 - core.unified_tool_manager - INFO - 🔄 成功加载工具配置: 4 个标准工具
2025-06-28 11:59:54,368 - core.unified_tool_manager - DEBUG -    - 标准工具ID: ['browser_use', 'deepsearch', 'mcp-search-tool', 'microsandbox']
2025-06-28 11:59:54,368 - core.unified_tool_manager - DEBUG -    - 兼容映射: 13 个变体
2025-06-28 11:59:54,368 - core.unified_tool_manager - INFO - ✅ 统一工具管理器初始化完成，管理 4 个工具
2025-06-28 11:59:54,368 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: mcp-search-tool
2025-06-28 11:59:54,368 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: Search Tool MCP Server (ID: mcp-search-tool)
2025-06-28 11:59:54,368 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: Search Tool MCP Server (ID: mcp-search-tool)
2025-06-28 11:59:54,368 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: Search Tool MCP Server
2025-06-28 11:59:54,368 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8080/websocket
2025-06-28 11:59:54,368 - core.toolscore.mcp_connector - INFO - Registered MCP server mcp-search-tool at ws://localhost:8080/websocket
2025-06-28 11:59:54,368 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: mcp-search-tool -> ws://localhost:8080/websocket
2025-06-28 11:59:54,368 - core.toolscore.core_manager - INFO - 工具立即可用: mcp-search-tool
2025-06-28 11:59:54,368 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: mcp-search-tool
2025-06-28 11:59:54,368 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: microsandbox
2025-06-28 11:59:54,368 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: MicroSandbox MCP Server (ID: microsandbox)
2025-06-28 11:59:54,368 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: MicroSandbox MCP Server (ID: microsandbox)
2025-06-28 11:59:54,368 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: MicroSandbox MCP Server
2025-06-28 11:59:54,368 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8090/websocket
2025-06-28 11:59:54,368 - core.toolscore.mcp_connector - INFO - Registered MCP server microsandbox at ws://localhost:8090/websocket
2025-06-28 11:59:54,368 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: microsandbox -> ws://localhost:8090/websocket
2025-06-28 11:59:54,368 - core.toolscore.core_manager - INFO - 工具立即可用: microsandbox
2025-06-28 11:59:54,368 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: microsandbox
2025-06-28 11:59:54,368 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: browser_use
2025-06-28 11:59:54,368 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: Browser Use MCP Server (ID: browser_use)
2025-06-28 11:59:54,369 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: Browser Use MCP Server (ID: browser_use)
2025-06-28 11:59:54,369 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: Browser Use MCP Server
2025-06-28 11:59:54,369 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8084/websocket
2025-06-28 11:59:54,369 - core.toolscore.mcp_connector - INFO - Registered MCP server browser_use at ws://localhost:8084/websocket
2025-06-28 11:59:54,369 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: browser_use -> ws://localhost:8084/websocket
2025-06-28 11:59:54,369 - core.toolscore.core_manager - INFO - 工具立即可用: browser_use
2025-06-28 11:59:54,369 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: browser_use
2025-06-28 11:59:54,369 - core.unified_tool_manager - DEBUG - 🎯 工具ID已是标准格式: deepsearch
2025-06-28 11:59:54,369 - core.toolscore.unified_tool_library - INFO - Registering external MCP server: DeepSearch MCP Server (ID: deepsearch)
2025-06-28 11:59:54,369 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: DeepSearch MCP Server (ID: deepsearch)
2025-06-28 11:59:54,369 - core.toolscore.unified_tool_library - INFO - Successfully registered external MCP server: DeepSearch MCP Server
2025-06-28 11:59:54,369 - core.toolscore.mcp_connector - INFO - MCPServerConnector initialized for ws://localhost:8086/websocket
2025-06-28 11:59:54,369 - core.toolscore.mcp_connector - INFO - Registered MCP server deepsearch at ws://localhost:8086/websocket
2025-06-28 11:59:54,369 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: deepsearch -> ws://localhost:8086/websocket
2025-06-28 11:59:54,369 - core.toolscore.core_manager - INFO - 工具立即可用: deepsearch
2025-06-28 11:59:54,369 - core.toolscore.mcp_auto_registration - INFO - ✅ 成功注册MCP服务器: deepsearch
2025-06-28 11:59:54,369 - core.toolscore.mcp_auto_registration - INFO - 📊 MCP服务器注册完成: 4/4 成功
2025-06-28 11:59:54,369 - core.toolscore.mcp_server - INFO - [toolscore] All MCP servers registered successfully.
2025-06-28 11:59:54,369 - core.toolscore.mcp_server - INFO - toolscore MCP Server started successfully on 0.0.0.0:8081 (Original endpoint: ws://0.0.0.0:8081/websocket) with ping_interval=30, ping_timeout=60
2025-06-28 11:59:54,369 - core.toolscore.mcp_server - INFO - toolscore MCP Server started event set.
2025-06-28 11:59:54,369 - core.toolscore.service_container.service_monitor - INFO - 🔄 开始服务监控循环，检查间隔: 30秒
2025-06-28 11:59:54,387 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [browser_use] BrowserUse logging setup complete with level info
2025-06-28 11:59:54,835 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [root] Anonymized telemetry enabled. See https://docs.browser-use.com/development/telemetry for more information.
2025-06-28 11:59:54,900 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:59:54,900 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:59:54,938 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:59:54,938 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:59:54,938 - websockets.client - DEBUG - > Host: localhost:8084
2025-06-28 11:59:54,938 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:59:54,938 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:59:54,938 - websockets.client - DEBUG - > Sec-WebSocket-Key: TOQuUukortiHCRxCvWA+wQ==
2025-06-28 11:59:54,938 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:59:54,938 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:59:54,938 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:59:54,939 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:59:54,939 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:59:54,939 - websockets.client - DEBUG - > Host: localhost:8080
2025-06-28 11:59:54,939 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:59:54,939 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:59:54,939 - websockets.client - DEBUG - > Sec-WebSocket-Key: aImWk6CQYQebpzmkc9ibGg==
2025-06-28 11:59:54,939 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:59:54,939 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:59:54,939 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:59:54,939 - websockets.client - DEBUG - > EOF
2025-06-28 11:59:54,939 - websockets.client - DEBUG - < EOF
2025-06-28 11:59:54,939 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:59:54,939 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:59:54,939 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:59:54,939 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:59:54,939 - websockets.client - DEBUG - < Sec-WebSocket-Accept: +M/Le7xbuELPZJljqGJoVVdkxk8=
2025-06-28 11:59:54,939 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:59:54,939 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:59:54 GMT
2025-06-28 11:59:54,939 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:59:54,939 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:59:54,939 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:59:54,940 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:59:54,940 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:59:54,940 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:59:54,940 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:59:54,940 - websockets.client - DEBUG - < EOF
2025-06-28 11:59:54,940 - websockets.client - DEBUG - > EOF
2025-06-28 11:59:54,940 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:59:54,940 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:59:54,941 - services.mcp_server_launcher - DEBUG - ✅ search_tool_server 特定就绪检查通过
2025-06-28 11:59:54,941 - services.mcp_server_launcher - INFO - ✅ search_tool_server 已就绪
2025-06-28 11:59:54,941 - services.mcp_server_launcher - DEBUG - 📋 browser_use_server 端口 8084 尚未就绪
2025-06-28 11:59:54,941 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口 8086 可连接
2025-06-28 11:59:54,941 - services.mcp_server_launcher - DEBUG - ✅ deepsearch_server 端口就绪检查通过
2025-06-28 11:59:54,967 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.llm_client] Initialized LLM client with provider: gemini
2025-06-28 11:59:54,968 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Browser-Use server initialized with LLM provider: gemini
2025-06-28 11:59:54,968 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] 使用动态分配端口: 8084
2025-06-28 11:59:54,968 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] BrowserUseMCPServer initialized:
2025-06-28 11:59:54,968 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Server Name: browser_use_server
2025-06-28 11:59:54,968 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Server ID: browser_use
2025-06-28 11:59:54,968 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Listen Host: 0.0.0.0
2025-06-28 11:59:54,968 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Listen Port: 8084
2025-06-28 11:59:54,968 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   Public Endpoint: ws://localhost:8084
2025-06-28 11:59:54,968 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__]   ToolScore Endpoint: ws://localhost:8081/websocket
2025-06-28 11:59:54,968 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Starting browser_use_server...
2025-06-28 11:59:54,968 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [__main__] Attempting to start MCPServer for browser_use_server at ws://localhost:8084...
2025-06-28 11:59:54,968 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Attempting to start browser_use_server MCP Server on localhost:8084
2025-06-28 11:59:54,969 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] server listening on 127.0.0.1:8084
2025-06-28 11:59:54,969 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] server listening on [::1]:8084
2025-06-28 11:59:54,969 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] browser_use_server MCP Server started successfully on localhost:8084 (Original endpoint: ws://localhost:8084) with ping_interval=30, ping_timeout=60
2025-06-28 11:59:54,969 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Waiting 10 seconds for ToolScore server to fully start...
2025-06-28 11:59:55,621 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:59:55,622 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:59:55,663 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 11:59:55,663 - websockets.client - DEBUG - > GET / HTTP/1.1
2025-06-28 11:59:55,663 - websockets.client - DEBUG - > Host: localhost:8084
2025-06-28 11:59:55,663 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 11:59:55,663 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 11:59:55,663 - websockets.client - DEBUG - > Sec-WebSocket-Key: xUUjgG6yb0TaY8qH3SZnxw==
2025-06-28 11:59:55,663 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 11:59:55,663 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 11:59:55,663 - websockets.client - DEBUG - > User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 11:59:55,663 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection open
2025-06-28 11:59:55,663 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] Client connected to browser_use_server MCP Server at path /: ('127.0.0.1', 50154)
2025-06-28 11:59:55,663 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 11:59:55,663 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 11:59:55,663 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 11:59:55,663 - websockets.client - DEBUG - < Sec-WebSocket-Accept: mn++tsIs56csUetTErZxIteZpms=
2025-06-28 11:59:55,664 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 11:59:55,664 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 03:59:55 GMT
2025-06-28 11:59:55,664 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 11:59:55,664 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 11:59:55,664 - websockets.client - DEBUG - > TEXT '{"type": "ping"}' [16 bytes]
2025-06-28 11:59:55,664 - websockets.client - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:59:55,664 - websockets.client - DEBUG - = connection is CLOSING
2025-06-28 11:59:55,664 - services.mcp_server_launcher - DEBUG - [browser_use_server] WARNING  [core.toolscore.mcp_server] Unknown request type or server role mismatch: ping
2025-06-28 11:59:55,664 - websockets.client - DEBUG - < TEXT '{"type": "error", "request_id": null, "message"...r role mismatch: ping"}' [102 bytes]
2025-06-28 11:59:55,664 - websockets.client - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 11:59:55,664 - websockets.client - DEBUG - < EOF
2025-06-28 11:59:55,664 - websockets.client - DEBUG - > EOF
2025-06-28 11:59:55,664 - websockets.client - DEBUG - = connection is CLOSED
2025-06-28 11:59:55,664 - websockets.client - DEBUG - x half-closing TCP connection
2025-06-28 11:59:55,664 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 11:59:55,664 - services.mcp_server_launcher - DEBUG - ✅ browser_use_server 特定就绪检查通过
2025-06-28 11:59:55,664 - services.mcp_server_launcher - INFO - ✅ browser_use_server 已就绪
2025-06-28 11:59:55,942 - services.mcp_server_launcher - INFO - ✅ deepsearch_server 已就绪
2025-06-28 11:59:56,487 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:59:56,487 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:59:57,525 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:59:57,525 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:59:58,771 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 11:59:58,771 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 11:59:59,330 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第2次, 5s间隔)
2025-06-28 12:00:00,265 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 12:00:00,265 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 12:00:02,058 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 12:00:02,058 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 12:00:04,210 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 12:00:04,210 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 12:00:04,332 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第3次, 5s间隔)
2025-06-28 12:00:04,490 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 12:00:04,491 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 12:00:04,491 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 12:00:04,491 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 12:00:04,491 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 12:00:04,491 - websockets.server - DEBUG - < Sec-WebSocket-Key: mAL5s/N8PrHPdxKlY26ScQ==
2025-06-28 12:00:04,491 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 12:00:04,491 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 12:00:04,491 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 12:00:04,491 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 12:00:04,491 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 12:00:04,491 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 12:00:04,491 - websockets.server - DEBUG - > Sec-WebSocket-Accept: dtFUYEsCxIOnbRxPZAB+UXHHxnw=
2025-06-28 12:00:04,491 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 12:00:04,491 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 04:00:04 GMT
2025-06-28 12:00:04,491 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 12:00:04,491 - websockets.server - INFO - connection open
2025-06-28 12:00:04,491 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 12:00:04,491 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 50184)
2025-06-28 12:00:04,491 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "1d979a...onnection_params": {}}}' [2376 bytes]
2025-06-28 12:00:04,492 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: search_tool_server (ID: mcp-search-tool)
2025-06-28 12:00:04,492 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: search_tool_server
2025-06-28 12:00:04,492 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: mcp-search-tool -> ws://localhost:8080/mcp
2025-06-28 12:00:04,492 - core.toolscore.core_manager - INFO - 工具立即可用: mcp-search-tool
2025-06-28 12:00:04,492 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 12:00:04,492 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 12:00:04,492 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 12:00:04,492 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 12:00:04,492 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 12:00:04,493 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 12:00:04,493 - websockets.server - INFO - connection closed
2025-06-28 12:00:04,603 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 12:00:04,603 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 12:00:04,603 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 12:00:04,603 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 12:00:04,603 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 12:00:04,603 - websockets.server - DEBUG - < Sec-WebSocket-Key: AVnvI1+ScAapbR1VQqg5BA==
2025-06-28 12:00:04,603 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 12:00:04,603 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 12:00:04,603 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 12:00:04,603 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 12:00:04,604 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 12:00:04,604 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 12:00:04,604 - websockets.server - DEBUG - > Sec-WebSocket-Accept: p0PdiSn2JHCMnfJ928eGtLtFH9Q=
2025-06-28 12:00:04,604 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 12:00:04,604 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 04:00:04 GMT
2025-06-28 12:00:04,604 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 12:00:04,604 - websockets.server - INFO - connection open
2025-06-28 12:00:04,604 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 12:00:04,604 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 50186)
2025-06-28 12:00:04,604 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "013fdc...onnection_params": {}}}' [3263 bytes]
2025-06-28 12:00:04,604 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: microsandbox_server (ID: microsandbox)
2025-06-28 12:00:04,604 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: microsandbox_server
2025-06-28 12:00:04,604 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: microsandbox -> ws://localhost:8090
2025-06-28 12:00:04,604 - core.toolscore.core_manager - INFO - 工具立即可用: microsandbox
2025-06-28 12:00:04,604 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 12:00:04,605 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 12:00:04,605 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 12:00:04,605 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 12:00:04,605 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 12:00:04,605 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 12:00:04,605 - websockets.server - INFO - connection closed
2025-06-28 12:00:04,662 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 12:00:04,662 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 12:00:04,662 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 12:00:04,662 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 12:00:04,662 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 12:00:04,662 - websockets.server - DEBUG - < Sec-WebSocket-Key: 6/ABSd6lZz0sFkjAVWSX0A==
2025-06-28 12:00:04,662 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 12:00:04,662 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 12:00:04,662 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 12:00:04,662 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 12:00:04,662 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 12:00:04,662 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 12:00:04,662 - websockets.server - DEBUG - > Sec-WebSocket-Accept: pK0Wv9hiepkrY2eJ77JxTZE52vU=
2025-06-28 12:00:04,662 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 12:00:04,662 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 04:00:04 GMT
2025-06-28 12:00:04,662 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 12:00:04,662 - websockets.server - INFO - connection open
2025-06-28 12:00:04,662 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 12:00:04,662 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 50188)
2025-06-28 12:00:04,663 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "efa4a8...onnection_params": {}}}' [2313 bytes]
2025-06-28 12:00:04,663 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: deepsearch_server (ID: deepsearch)
2025-06-28 12:00:04,663 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: deepsearch_server
2025-06-28 12:00:04,663 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: deepsearch -> ws://localhost:8086/mcp
2025-06-28 12:00:04,663 - core.toolscore.core_manager - INFO - 工具立即可用: deepsearch
2025-06-28 12:00:04,663 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 12:00:04,663 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 12:00:04,663 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 12:00:04,663 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 12:00:04,663 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 12:00:04,664 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 12:00:04,664 - websockets.server - INFO - connection closed
2025-06-28 12:00:04,970 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Attempting to connect to toolscore at ws://localhost:8081/websocket for registration...
2025-06-28 12:00:04,971 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 12:00:04,971 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 12:00:04,971 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 12:00:04,971 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 12:00:04,971 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 12:00:04,971 - websockets.server - DEBUG - < Sec-WebSocket-Key: sv2GNGoyL1RFV6NFgKlB9Q==
2025-06-28 12:00:04,972 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 12:00:04,972 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 12:00:04,972 - websockets.server - DEBUG - < User-Agent: Python/3.11 websockets/15.0.1
2025-06-28 12:00:04,972 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 12:00:04,972 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 12:00:04,972 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 12:00:04,972 - websockets.server - DEBUG - > Sec-WebSocket-Accept: o4DYEvHUZTrqUKbjw7MvTYg6FIw=
2025-06-28 12:00:04,972 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 12:00:04,972 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 04:00:04 GMT
2025-06-28 12:00:04,972 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 12:00:04,972 - websockets.server - INFO - connection open
2025-06-28 12:00:04,972 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 12:00:04,972 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 50190)
2025-06-28 12:00:04,972 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Connected to toolscore at ws://localhost:8081/websocket
2025-06-28 12:00:04,972 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Sending registration request to toolscore: {"type": "register_tool", "request_id": "d456b4d3-c493-4c74-b831-951a83752542", "tool_spec": {"tool_id": "browser_use", "name": "browser_use_server", "description": "\u57fa\u4e8eBrowser-Use\u7684AI\u6d4f\u89c8\u5668\u81ea\u52a8\u5316\u670d\u52a1\u5668\uff0c\u5b8c\u6574\u5b9e\u73b0browser-use\u7684\u6240\u6709\u529f\u80fd", "tool_type": "mcp_server", "capabilities": [{"name": "browser_use_execute_task", "description": "\u4f7f\u7528AI\u6267\u884c\u590d\u6742\u7684\u6d4f\u89c8\u5668\u4efb\u52a1\uff0c\u652f\u6301\u81ea\u7136\u8bed\u8a00\u63cf\u8ff0", "parameters": {"task": {"type": "string", "description": "\u8981\u6267\u884c\u7684\u4efb\u52a1\u63cf\u8ff0\uff0c\u4f7f\u7528\u81ea\u7136\u8bed\u8a00", "required": true}, "max_steps": {"type": "integer", "description": "\u6700\u5927\u6267\u884c\u6b65\u9aa4\u6570\uff0c\u9ed8\u8ba450", "required": false}, "use_vision": {"type": "boolean", "description": "\u662f\u5426\u4f7f\u7528\u89c6\u89c9\u7406\u89e3\uff0c\u9ed8\u8ba4true", "required": false}}, "examples": [{"task": "\u641c\u7d22Python\u6559\u7a0b\u5e76\u6253\u5f00\u7b2c\u4e00\u4e2a\u7ed3\u679c"}, {"task": "\u5728GitHub\u4e0a\u641c\u7d22browser-use\u9879\u76ee\u5e76\u67e5\u770bREADME"}, {"task": "\u767b\u5f55\u7f51\u7ad9\u5e76\u586b\u5199\u8868\u5355", "use_vision": true}], "category": "general"}, {"name": "browser_navigate", "description": "\u5bfc\u822a\u5230\u6307\u5b9a\u7f51\u5740", "parameters": {"url": {"type": "string", "description": "\u8981\u8bbf\u95ee\u7684URL\u5730\u5740", "required": true}}, "examples": [{"url": "https://www.google.com"}, {"url": "https://github.com"}], "category": "general"}, {"name": "browser_search_google", "description": "\u5728Google\u4e2d\u641c\u7d22\u6307\u5b9a\u67e5\u8be2", "parameters": {"query": {"type": "string", "description": "\u641c\u7d22\u67e5\u8be2\u8bcd", "required": true}}, "examples": [{"query": "Python machine learning tutorial"}, {"query": "browser automation tools"}], "category": "general"}, {"name": "browser_go_back", "description": "\u8fd4\u56de\u4e0a\u4e00\u9875", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_click_element", "description": "\u901a\u8fc7\u7d22\u5f15\u70b9\u51fb\u9875\u9762\u5143\u7d20", "parameters": {"index": {"type": "integer", "description": "\u8981\u70b9\u51fb\u7684\u5143\u7d20\u7d22\u5f15", "required": true}}, "examples": [{"index": 1}, {"index": 5}], "category": "general"}, {"name": "browser_input_text", "description": "\u5728\u6307\u5b9a\u5143\u7d20\u4e2d\u8f93\u5165\u6587\u672c", "parameters": {"index": {"type": "integer", "description": "\u8981\u8f93\u5165\u6587\u672c\u7684\u5143\u7d20\u7d22\u5f15", "required": true}, "text": {"type": "string", "description": "\u8981\u8f93\u5165\u7684\u6587\u672c", "required": true}}, "examples": [{"index": 2, "text": "hello world"}, {"index": 0, "text": "test@example.com"}], "category": "general"}, {"name": "browser_send_keys", "description": "\u53d1\u9001\u7279\u6b8a\u952e\u6216\u5feb\u6377\u952e", "parameters": {"keys": {"type": "string", "description": "\u8981\u53d1\u9001\u7684\u952e\uff0c\u5982Enter\u3001Escape\u3001Control+c\u7b49", "required": true}}, "examples": [{"keys": "Enter"}, {"keys": "Control+c"}, {"keys": "Escape"}], "category": "general"}, {"name": "browser_scroll_down", "description": "\u5411\u4e0b\u6eda\u52a8\u9875\u9762", "parameters": {"amount": {"type": "integer", "description": "\u6eda\u52a8\u50cf\u7d20\u6570\uff0c\u4e0d\u6307\u5b9a\u5219\u6eda\u52a8\u4e00\u9875", "required": false}}, "examples": [{}, {"amount": 500}], "category": "general"}, {"name": "browser_scroll_up", "description": "\u5411\u4e0a\u6eda\u52a8\u9875\u9762", "parameters": {"amount": {"type": "integer", "description": "\u6eda\u52a8\u50cf\u7d20\u6570\uff0c\u4e0d\u6307\u5b9a\u5219\u6eda\u52a8\u4e00\u9875", "required": false}}, "examples": [{}, {"amount": 300}], "category": "general"}, {"name": "browser_scroll_to_text", "description": "\u6eda\u52a8\u5230\u5305\u542b\u6307\u5b9a\u6587\u672c\u7684\u5143\u7d20", "parameters": {"text": {"type": "string", "description": "\u8981\u6eda\u52a8\u5230\u7684\u6587\u672c\u5185\u5bb9", "required": true}}, "examples": [{"text": "Sign up"}, {"text": "Contact us"}], "category": "general"}, {"name": "browser_switch_tab", "description": "\u5207\u6362\u5230\u6307\u5b9a\u6807\u7b7e", "parameters": {"page_id": {"type": "integer", "description": "\u8981\u5207\u6362\u5230\u7684\u6807\u7b7eID", "required": true}}, "examples": [{"page_id": 0}, {"page_id": 1}], "category": "general"}, {"name": "browser_open_tab", "description": "\u5728\u65b0\u6807\u7b7e\u4e2d\u6253\u5f00URL", "parameters": {"url": {"type": "string", "description": "\u8981\u5728\u65b0\u6807\u7b7e\u4e2d\u6253\u5f00\u7684URL", "required": true}}, "examples": [{"url": "https://www.example.com"}], "category": "general"}, {"name": "browser_close_tab", "description": "\u5173\u95ed\u6307\u5b9a\u6807\u7b7e", "parameters": {"page_id": {"type": "integer", "description": "\u8981\u5173\u95ed\u7684\u6807\u7b7eID", "required": true}}, "examples": [{"page_id": 1}], "category": "general"}, {"name": "browser_extract_content", "description": "\u4ece\u9875\u9762\u63d0\u53d6\u7279\u5b9a\u5185\u5bb9", "parameters": {"goal": {"type": "string", "description": "\u63d0\u53d6\u76ee\u6807\u63cf\u8ff0", "required": true}, "include_links": {"type": "boolean", "description": "\u662f\u5426\u5305\u542b\u94fe\u63a5\uff0c\u9ed8\u8ba4false", "required": false}}, "examples": [{"goal": "\u63d0\u53d6\u6240\u6709\u516c\u53f8\u540d\u79f0"}, {"goal": "\u83b7\u53d6\u4ea7\u54c1\u4ef7\u683c\u4fe1\u606f", "include_links": true}], "category": "general"}, {"name": "browser_get_content", "description": "\u83b7\u53d6\u9875\u9762\u5185\u5bb9", "parameters": {"selector": {"type": "string", "description": "CSS\u9009\u62e9\u5668\uff0c\u7a7a\u5219\u83b7\u53d6\u5168\u90e8\u5185\u5bb9", "required": false}}, "examples": [{"selector": "h1, p"}, {}], "category": "general"}, {"name": "browser_get_ax_tree", "description": "\u83b7\u53d6\u9875\u9762\u7684\u53ef\u8bbf\u95ee\u6027\u6811\u7ed3\u6784", "parameters": {"number_of_elements": {"type": "integer", "description": "\u8fd4\u56de\u7684\u5143\u7d20\u6570\u91cf", "required": true}}, "examples": [{"number_of_elements": 50}], "category": "general"}, {"name": "browser_get_dropdown_options", "description": "\u83b7\u53d6\u4e0b\u62c9\u83dc\u5355\u7684\u6240\u6709\u9009\u9879", "parameters": {"index": {"type": "integer", "description": "\u4e0b\u62c9\u83dc\u5355\u5143\u7d20\u7684\u7d22\u5f15", "required": true}}, "examples": [{"index": 3}], "category": "general"}, {"name": "browser_select_dropdown_option", "description": "\u9009\u62e9\u4e0b\u62c9\u83dc\u5355\u4e2d\u7684\u9009\u9879", "parameters": {"index": {"type": "integer", "description": "\u4e0b\u62c9\u83dc\u5355\u5143\u7d20\u7684\u7d22\u5f15", "required": true}, "text": {"type": "string", "description": "\u8981\u9009\u62e9\u7684\u9009\u9879\u6587\u672c", "required": true}}, "examples": [{"index": 3, "text": "Option 1"}], "category": "general"}, {"name": "browser_drag_drop", "description": "\u6267\u884c\u62d6\u62fd\u64cd\u4f5c", "parameters": {"element_source": {"type": "string", "description": "\u6e90\u5143\u7d20\u9009\u62e9\u5668", "required": false}, "element_target": {"type": "string", "description": "\u76ee\u6807\u5143\u7d20\u9009\u62e9\u5668", "required": false}, "coord_source_x": {"type": "integer", "description": "\u6e90\u5750\u6807X", "required": false}, "coord_source_y": {"type": "integer", "description": "\u6e90\u5750\u6807Y", "required": false}, "coord_target_x": {"type": "integer", "description": "\u76ee\u6807\u5750\u6807X", "required": false}, "coord_target_y": {"type": "integer", "description": "\u76ee\u6807\u5750\u6807Y", "required": false}, "steps": {"type": "integer", "description": "\u62d6\u62fd\u6b65\u9aa4\u6570\uff0c\u9ed8\u8ba410", "required": false}}, "examples": [{"element_source": ".item1", "element_target": ".dropzone"}], "category": "general"}, {"name": "browser_save_pdf", "description": "\u5c06\u5f53\u524d\u9875\u9762\u4fdd\u5b58\u4e3aPDF", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_screenshot", "description": "\u622a\u53d6\u5f53\u524d\u9875\u9762\u622a\u56fe", "parameters": {"filename": {"type": "string", "description": "\u622a\u56fe\u6587\u4ef6\u540d\uff0c\u53ef\u9009", "required": false}}, "examples": [{"filename": "current_page.png"}, {}], "category": "general"}, {"name": "browser_wait", "description": "\u7b49\u5f85\u6307\u5b9a\u79d2\u6570", "parameters": {"seconds": {"type": "number", "description": "\u7b49\u5f85\u7684\u79d2\u6570\uff0c\u9ed8\u8ba43", "required": false}}, "examples": [{"seconds": 5}, {}], "category": "general"}, {"name": "browser_done", "description": "\u6807\u8bb0\u4efb\u52a1\u5b8c\u6210", "parameters": {"text": {"type": "string", "description": "\u5b8c\u6210\u63cf\u8ff0", "required": true}, "success": {"type": "boolean", "description": "\u662f\u5426\u6210\u529f\u5b8c\u6210", "required": true}}, "examples": [{"text": "\u4efb\u52a1\u5df2\u5b8c\u6210", "success": true}], "category": "general"}, {"name": "browser_get_page_info", "description": "\u83b7\u53d6\u5f53\u524d\u9875\u9762\u4fe1\u606f", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_get_current_url", "description": "\u83b7\u53d6\u5f53\u524d\u9875\u9762URL", "parameters": {}, "examples": [{}], "category": "general"}, {"name": "browser_close_session", "description": "\u5173\u95ed\u6d4f\u89c8\u5668\u4f1a\u8bdd", "parameters": {}, "examples": [{}], "category": "general"}], "endpoint": "ws://localhost:8084", "connection_params": {}}}
2025-06-28 12:00:04,972 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Waiting for registration response from toolscore...
2025-06-28 12:00:04,972 - websockets.server - DEBUG - < TEXT '{"type": "register_tool", "request_id": "d456b4...onnection_params": {}}}' [9625 bytes]
2025-06-28 12:00:04,973 - core.toolscore.tool_registry - INFO - Successfully registered MCP Server: browser_use_server (ID: browser_use)
2025-06-28 12:00:04,973 - core.toolscore.unified_tool_library - INFO - Successfully registered MCP server to tool registry: browser_use_server
2025-06-28 12:00:04,973 - core.toolscore.unified_tool_library - INFO - Registered MCP server connection: browser_use -> ws://localhost:8084
2025-06-28 12:00:04,973 - core.toolscore.core_manager - INFO - 工具立即可用: browser_use
2025-06-28 12:00:04,973 - websockets.server - DEBUG - > TEXT '{"type": "register_tool_response", "request_id"... true, "message": null}' [122 bytes]
2025-06-28 12:00:04,973 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Received registration response: {"type": "register_tool_response", "request_id": "d456b4d3-c493-4c74-b831-951a83752542", "success": true, "message": null}
2025-06-28 12:00:04,973 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [core.toolscore.mcp_server] [browser_use_server] Successfully registered with toolscore.
2025-06-28 12:00:04,973 - websockets.server - DEBUG - < CLOSE 1000 (OK) [2 bytes]
2025-06-28 12:00:04,973 - websockets.server - DEBUG - = connection is CLOSING
2025-06-28 12:00:04,973 - websockets.server - DEBUG - > CLOSE 1000 (OK) [2 bytes]
2025-06-28 12:00:04,973 - websockets.server - DEBUG - x half-closing TCP connection
2025-06-28 12:00:04,973 - websockets.server - DEBUG - = connection is CLOSED
2025-06-28 12:00:04,973 - websockets.server - INFO - connection closed
2025-06-28 12:00:06,791 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 12:00:06,791 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 12:00:09,333 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第4次, 5s间隔)
2025-06-28 12:00:09,793 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 12:00:09,793 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 12:00:12,794 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 12:00:12,794 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 12:00:14,334 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第5次, 5s间隔)
2025-06-28 12:00:15,795 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 12:00:15,795 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 12:00:18,796 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 12:00:18,797 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 12:00:19,335 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第6次, 5s间隔)
2025-06-28 12:00:21,798 - services.mcp_server_launcher - DEBUG - `microsandbox_server` a un `port` manquant dans la configuration, sautant la vérification de préparation spécifique.
2025-06-28 12:00:21,798 - services.mcp_server_launcher - DEBUG - 📋 microsandbox_server 没有配置端口，跳过端口检查
2025-06-28 12:00:24,308 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:00:24,324 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:00:24,324 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:00:24,324 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:00:24,332 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:00:24,337 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第7次, 5s间隔)
2025-06-28 12:00:24,799 - services.mcp_server_launcher - DEBUG - ⏱️ microsandbox_server 就绪检测超时 (30秒)
2025-06-28 12:00:24,800 - services.mcp_server_launcher - WARNING - ⚠️ microsandbox_server 启动超时，但进程仍在运行，可能需要更多时间
2025-06-28 12:00:24,800 - services.mcp_server_launcher - INFO - ✅ 成功启动 4/4 个MCP服务器: ['microsandbox_server', 'search_tool_server', 'browser_use_server', 'deepsearch_server']
2025-06-28 12:00:24,800 - services.service_manager - INFO - 启动服务: task_api
2025-06-28 12:00:24,800 - services.task_api_service - INFO - 正在启动任务API服务...
2025-06-28 12:00:24,810 - services.task_api_service - INFO - 任务API服务已启动于 0.0.0.0:8000
2025-06-28 12:00:24,810 - services.service_manager - INFO - 启动服务: runtime
2025-06-28 12:00:24,810 - services.runtime_service - INFO - 正在启动推理运行时服务...
2025-06-28 12:00:24,810 - services.service_manager - INFO - 启动服务: synthesis
2025-06-28 12:00:24,811 - services.synthesis_service - INFO - 正在启动合成服务...
2025-06-28 12:00:24,811 - services.synthesis_service - INFO - 合成服务工作线程已启动
2025-06-28 12:00:24,811 - services.synthesis_service - INFO - SynthesisCore v2.0监控器工作线程已启动
2025-06-28 12:00:24,811 - services.synthesis_service - INFO - 开始处理轨迹数据...
2025-06-28 12:00:24,811 - services.synthesis_service - INFO - 🚀 启动SynthesisCore v2.0监控器
2025-06-28 12:00:24,811 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 12:00:24,811 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 12:00:24,811 - services.synthesis_service - INFO - 合成服务已启动
2025-06-28 12:00:24,811 - services.service_manager - INFO - 所有服务已启动
2025-06-28 12:00:24,811 - __main__ - DEBUG - ✅ 所有服务启动完成
2025-06-28 12:00:24,811 - core.synthesiscore.synthesis - INFO - 🔄 Processing only unprocessed trajectories...
2025-06-28 12:00:24,811 - __main__ - INFO - 🎉 所有服务已启动，系统运行中...
2025-06-28 12:00:24,811 - __main__ - INFO - 📊 系统状态监控已启用，按 Ctrl+C 停止
2025-06-28 12:00:24,811 - services.runtime_service - INFO - 启动运行时实例: enhanced-reasoning-1
2025-06-28 12:00:24,812 - runtimes.reasoning.enhanced_runtime - INFO - 🚀 初始化Enhanced Reasoning Runtime - 简化版本
2025-06-28 12:00:24,812 - core.llm.response_parsers.reasoning_response_parser - DEBUG - ✅ 响应解析器已连接工具Schema管理器
2025-06-28 12:00:24,812 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 工具Schema管理器已注入到响应解析器
2025-06-28 12:00:24,812 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 12:00:24,812 - runtimes.reasoning.enhanced_runtime - INFO - ⏳ 等待ToolScore服务就绪...
2025-06-28 12:00:24,812 - core.synthesiscore.synthesis - INFO - 🎯 Unprocessed trajectories completed: 0 new trajectories processed
2025-06-28 12:00:24,812 - services.synthesis_service - DEBUG - 等待 300 秒后再次处理...
2025-06-28 12:00:24,813 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ Redis连接初始化成功
2025-06-28 12:00:24,813 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:corpus_queue
2025-06-28 12:00:24,813 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:00:24 +0800] "GET /health HTTP/1.1" 200 231 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:00:24,813 - runtimes.reasoning.toolscore_client - INFO - ✅ ToolScore服务已就绪
2025-06-28 12:00:24,814 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:atomic_tasks
2025-06-28 12:00:24,814 - runtimes.reasoning.enhanced_runtime - INFO - ✅ ToolScore HTTP服务已就绪
2025-06-28 12:00:24,814 - runtimes.reasoning.enhanced_runtime - INFO - 🔌 正在连接WebSocket端点: ws://localhost:8081/websocket
2025-06-28 12:00:24,814 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:extended_tasks
2025-06-28 12:00:24,814 - runtimes.reasoning.real_time_tool_client - INFO - 🔌 连接到ToolScore实时更新: ws://localhost:8081/websocket
2025-06-28 12:00:24,814 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:verification_queue
2025-06-28 12:00:24,815 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:training_data
2025-06-28 12:00:24,815 - websockets.client - DEBUG - = connection is CONNECTING
2025-06-28 12:00:24,815 - core.synthesiscore.enhanced_redis_manager - DEBUG - ⚠️ 消费者组已存在: synthesis:v2:quality_reports
2025-06-28 12:00:24,815 - websockets.server - DEBUG - = connection is CONNECTING
2025-06-28 12:00:24,815 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ Redis配置键初始化完成
2025-06-28 12:00:24,815 - websockets.client - DEBUG - > GET /websocket HTTP/1.1
2025-06-28 12:00:24,815 - core.synthesiscore.enhanced_redis_manager - INFO - ✅ 增强合成Redis管理器初始化完成
2025-06-28 12:00:24,815 - websockets.client - DEBUG - > Host: localhost:8081
2025-06-28 12:00:24,815 - core.synthesiscore.enhanced_synthesis_engine - INFO - ✅ Enhanced Synthesis Engine 初始化完成
2025-06-28 12:00:24,815 - websockets.client - DEBUG - > Upgrade: websocket
2025-06-28 12:00:24,815 - core.synthesiscore.enhanced_synthesis_engine - INFO - 🚀 SynthesisCore v2.0 已启动
2025-06-28 12:00:24,815 - websockets.client - DEBUG - > Connection: Upgrade
2025-06-28 12:00:24,815 - websockets.client - DEBUG - > Sec-WebSocket-Key: uQmQ/ehszedRNIpXuh6Yzg==
2025-06-28 12:00:24,815 - websockets.client - DEBUG - > Sec-WebSocket-Version: 13
2025-06-28 12:00:24,815 - websockets.client - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 12:00:24,816 - websockets.client - DEBUG - > User-Agent: Enhanced-Reasoning-Runtime/1.0
2025-06-28 12:00:24,816 - core.synthesiscore.trajectory_monitor - INFO - 🔄 检查并处理现有轨迹...
2025-06-28 12:00:24,816 - core.synthesiscore.trajectory_monitor - INFO - 📝 没有现有轨迹文件
2025-06-28 12:00:24,816 - websockets.server - DEBUG - < GET /websocket HTTP/1.1
2025-06-28 12:00:24,816 - core.synthesiscore.trajectory_monitor - INFO - ✅ TrajectoryMonitor初始化完成
2025-06-28 12:00:24,816 - websockets.server - DEBUG - < Host: localhost:8081
2025-06-28 12:00:24,816 - core.synthesiscore.trajectory_monitor - DEBUG - ✅ 获取主事件循环引用成功
2025-06-28 12:00:24,816 - websockets.server - DEBUG - < Upgrade: websocket
2025-06-28 12:00:24,816 - websockets.server - DEBUG - < Connection: Upgrade
2025-06-28 12:00:24,816 - websockets.server - DEBUG - < Sec-WebSocket-Key: uQmQ/ehszedRNIpXuh6Yzg==
2025-06-28 12:00:24,818 - websockets.server - DEBUG - < Sec-WebSocket-Version: 13
2025-06-28 12:00:24,818 - websockets.server - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
2025-06-28 12:00:24,818 - core.synthesiscore.trajectory_monitor - INFO - 👁️ 开始监控轨迹文件变化: output/trajectories
2025-06-28 12:00:24,818 - websockets.server - DEBUG - < User-Agent: Enhanced-Reasoning-Runtime/1.0
2025-06-28 12:00:24,818 - services.synthesis_service - INFO - ✅ SynthesisCore v2.0监控器已启动
2025-06-28 12:00:24,818 - websockets.server - DEBUG - > HTTP/1.1 101 Switching Protocols
2025-06-28 12:00:24,818 - websockets.server - DEBUG - > Upgrade: websocket
2025-06-28 12:00:24,818 - websockets.server - DEBUG - > Connection: Upgrade
2025-06-28 12:00:24,818 - websockets.server - DEBUG - > Sec-WebSocket-Accept: P5ksiyMPQBBhTjWHsxTcui9Ou2w=
2025-06-28 12:00:24,818 - websockets.server - DEBUG - > Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
[2025-06-28 12:00:24] INFO:     Started server process [76995]
2025-06-28 12:00:24,818 - websockets.server - DEBUG - > Date: Sat, 28 Jun 2025 04:00:24 GMT
[2025-06-28 12:00:24] INFO:     Waiting for application startup.
2025-06-28 12:00:24,818 - websockets.server - DEBUG - > Server: Python/3.11 websockets/15.0.1
2025-06-28 12:00:24,818 - websockets.server - INFO - connection open
2025-06-28 12:00:24,818 - websockets.client - DEBUG - < HTTP/1.1 101 Switching Protocols
2025-06-28 12:00:24,818 - websockets.server - DEBUG - = connection is OPEN
2025-06-28 12:00:24,818 - websockets.client - DEBUG - < Upgrade: websocket
2025-06-28 12:00:24,819 - core.toolscore.mcp_server - INFO - Client connected to toolscore MCP Server at path /websocket: ('127.0.0.1', 50214)
2025-06-28 12:00:24,819 - websockets.client - DEBUG - < Connection: Upgrade
2025-06-28 12:00:24,819 - websockets.client - DEBUG - < Sec-WebSocket-Accept: P5ksiyMPQBBhTjWHsxTcui9Ou2w=
2025-06-28 12:00:24,819 - websockets.client - DEBUG - < Sec-WebSocket-Extensions: permessage-deflate; server_max_window_bits=12; client_max_window_bits=12
2025-06-28 12:00:24,819 - websockets.client - DEBUG - < Date: Sat, 28 Jun 2025 04:00:24 GMT
2025-06-28 12:00:24,819 - websockets.client - DEBUG - < Server: Python/3.11 websockets/15.0.1
2025-06-28 12:00:24,819 - websockets.client - DEBUG - = connection is OPEN
2025-06-28 12:00:24,819 - runtimes.reasoning.real_time_tool_client - INFO - ✅ 已连接到ToolScore实时更新流
2025-06-28 12:00:24,819 - runtimes.reasoning.enhanced_runtime - INFO - ✅ WebSocket实时更新连接成功
2025-06-28 12:00:24,819 - runtimes.reasoning.real_time_tool_client - DEBUG - 已注册工具更新回调，当前回调数量: 1
2025-06-28 12:00:24,819 - runtimes.reasoning.enhanced_runtime - INFO - 🚀 启动背景工具健康监控...
2025-06-28 12:00:24,819 - core.toolscore.async_tool_state_manager - INFO - Started background tool health monitoring
2025-06-28 12:00:24,819 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 工具状态管理器已启动，将在后台持续监控工具健康状态
2025-06-28 12:00:24,819 - runtimes.reasoning.enhanced_runtime - INFO - 🔍 开始MCP服务器同步验证...
2025-06-28 12:00:24,819 - core.tool_schema_manager - INFO - 正在执行MCP同步验证...
2025-06-28 12:00:24,819 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=False)，当前缓存: 0 个工具
2025-06-28 12:00:24,819 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 12:00:24,819 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
2025-06-28 12:00:24,819 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 12:00:24,819 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
2025-06-28 12:00:24,819 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
2025-06-28 12:00:24,819 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 12:00:24,819 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 12:00:24,819 - core.tool_schema_manager - INFO - 🔄 检测到 4 个工具需要更新: ['deepsearch', 'microsandbox', 'browser_use', 'mcp-search-tool']
2025-06-28 12:00:24,819 - core.tool_schema_manager - INFO - 🔄 执行增量更新: 4 个工具
2025-06-28 12:00:24,819 - core.tool_schema_manager - INFO - 🔄 缓存为空，转为全量刷新模式
2025-06-28 12:00:24,819 - core.tool_schema_manager - DEBUG - 🔄 开始增强刷新工具Schemas...
2025-06-28 12:00:24,819 - core.tool_schema_manager - DEBUG - 🔍 工具注册表状态检查: _tools 字典包含 4 个条目
2025-06-28 12:00:24,819 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: deepsearch
2025-06-28 12:00:24,819 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: microsandbox
2025-06-28 12:00:24,819 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: browser_use
2025-06-28 12:00:24,819 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: mcp-search-tool
2025-06-28 12:00:24,819 - core.tool_schema_manager - INFO - 🔧 选项1: 从工具注册表获取到 4 个工具
2025-06-28 12:00:24,819 - core.tool_schema_manager - DEBUG -   工具 0: id=deepsearch, name=网络信息研究工具, actions=3
2025-06-28 12:00:24,819 - core.tool_schema_manager - DEBUG -   工具 1: id=microsandbox, name=MicroSandbox安全代码执行器, actions=7
2025-06-28 12:00:24,819 - core.tool_schema_manager - DEBUG -   工具 2: id=browser_use, name=智能浏览器操作工具, actions=6
2025-06-28 12:00:24,820 - core.tool_schema_manager - DEBUG -   工具 3: id=mcp-search-tool, name=工具管理和项目文件搜索器, actions=4
2025-06-28 12:00:24,820 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: deepsearch
2025-06-28 12:00:24,820 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: comprehensive_research
2025-06-28 12:00:24,821 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: quick_research
2025-06-28 12:00:24,821 - core.task_api - INFO - Connected to Redis: redis://localhost:6379
2025-06-28 12:00:24,821 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: research
[2025-06-28 12:00:24] INFO:     Application startup complete.
2025-06-28 12:00:24,821 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 deepsearch (包含 3 个动作)
2025-06-28 12:00:24,821 - core.tool_schema_manager - DEBUG -    当前缓存大小: 1 个工具
2025-06-28 12:00:24,821 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: microsandbox
2025-06-28 12:00:24,821 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_cleanup_expired
2025-06-28 12:00:24,821 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_close_session
2025-06-28 12:00:24,821 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_execute
2025-06-28 12:00:24,822 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_health_status
[2025-06-28 12:00:24] INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
2025-06-28 12:00:24,822 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_performance_stats
2025-06-28 12:00:24,822 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_install_package
2025-06-28 12:00:24,822 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_list_sessions
2025-06-28 12:00:24,822 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 microsandbox (包含 7 个动作)
2025-06-28 12:00:24,822 - core.tool_schema_manager - DEBUG -    当前缓存大小: 2 个工具
2025-06-28 12:00:24,822 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: browser_use
2025-06-28 12:00:24,822 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_click_element
2025-06-28 12:00:24,822 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_use_execute_task
2025-06-28 12:00:24,822 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_extract_content
2025-06-28 12:00:24,822 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_input_text
2025-06-28 12:00:24,823 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_navigate
2025-06-28 12:00:24,823 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_search_google
2025-06-28 12:00:24,823 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 browser_use (包含 6 个动作)
2025-06-28 12:00:24,823 - core.tool_schema_manager - DEBUG -    当前缓存大小: 3 个工具
2025-06-28 12:00:24,823 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: mcp-search-tool
2025-06-28 12:00:24,823 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: analyze_tool_needs
2025-06-28 12:00:24,823 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: list_code_definitions
2025-06-28 12:00:24,823 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_and_install_tools
2025-06-28 12:00:24,823 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_file_content
2025-06-28 12:00:24,823 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 mcp-search-tool (包含 4 个动作)
2025-06-28 12:00:24,823 - core.tool_schema_manager - DEBUG -    当前缓存大小: 4 个工具
2025-06-28 12:00:24,823 - core.tool_schema_manager - INFO - 🔧 选项1: 成功处理 4/4 个工具，当前缓存 4 个工具
2025-06-28 12:00:24,824 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: mcp-search-tool
2025-06-28 12:00:24,824 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: microsandbox
2025-06-28 12:00:24,824 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: browser_use
2025-06-28 12:00:24,824 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: deepsearch
2025-06-28 12:00:24,824 - core.tool_schema_manager - INFO - ✅ 增强刷新完成，当前可用工具: 4个
2025-06-28 12:00:24,824 - core.toolscore.async_tool_state_manager - INFO - Starting background tool health monitoring loop
2025-06-28 12:00:24,825 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 12:00:24,825 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:00:24 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:00:24,825 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 12:00:24,826 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 12:00:24,826 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 12:00:24,826 - core.tool_schema_manager - INFO - ✅ Schema安全刷新完成，备份 4 个工具
2025-06-28 12:00:24,826 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 12:00:24,826 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 12:00:24,826 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 12:00:24,827 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 12:00:24,827 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 12:00:24,827 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 12:00:24,827 - core.tool_schema_manager - INFO - 🔍 同步验证完成: unhealthy (0/4 工具Schema一致)
2025-06-28 12:00:24,827 - runtimes.reasoning.enhanced_runtime - ERROR - ❌ MCP服务器同步验证失败: 未知错误
2025-06-28 12:00:24,827 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔧 开始获取可用工具ID列表...
2025-06-28 12:00:24,827 - runtimes.reasoning.real_time_tool_client - DEBUG - 可用工具ID列表: ['deepsearch', 'browser_use', 'mcp-search-tool', 'microsandbox']
2025-06-28 12:00:24,827 - runtimes.reasoning.enhanced_runtime - DEBUG - 📋 获取到的工具列表: ['deepsearch', 'browser_use', 'mcp-search-tool', 'microsandbox']
2025-06-28 12:00:24,827 - runtimes.reasoning.enhanced_runtime - INFO - ✅ 工具Schema管理器已初始化
2025-06-28 12:00:24,827 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔧 更新Guardrails和ValidationCritic工具配置...
2025-06-28 12:00:24,827 - core.llm.guardrails_middleware - INFO - 🔧 初始化输入验证Guard...
2025-06-28 12:00:24,828 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 12:00:24,829 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 12:00:24,829 - core.llm.guardrails_middleware - INFO - 🔧 初始化输出验证Guard...
2025-06-28 12:00:24,829 - core.llm.guardrails_middleware - INFO - 🔧 使用本地LLM客户端初始化Guard...
2025-06-28 12:00:24,830 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 12:00:24,831 - root - DEBUG - Returning existing HubTelemetry instance...
2025-06-28 12:00:24,831 - core.llm.guardrails_middleware - INFO - ✅ 使用LLM的Guard创建成功
2025-06-28 12:00:24,831 - core.llm.guardrails_middleware - INFO - ✅ Guardrails Guards初始化成功
2025-06-28 12:00:24,831 - core.llm.guardrails_middleware - INFO -    - 输入Guard: ✅
2025-06-28 12:00:24,831 - core.llm.guardrails_middleware - INFO -    - 输出Guard: ✅
2025-06-28 12:00:24,831 - core.llm.guardrails_middleware - INFO - 🔄 Guardrails工具列表已更新: 4个工具
2025-06-28 12:00:24,831 - core.agents.validation_critic - INFO - 🔄 ValidationCritic工具列表已更新: 4个工具
2025-06-28 12:00:24,831 - runtimes.reasoning.enhanced_runtime - INFO - ✅ Guardrails和ValidationCritic已配置4个工具: deepsearch, browser_use, mcp-search-tool, microsandbox
2025-06-28 12:00:24,831 - runtimes.reasoning.enhanced_runtime - INFO - ✅ Enhanced Reasoning Runtime 已成功初始化为纯推理引擎（集成Guardrails + ValidationCritic）
2025-06-28 12:00:24,833 - services.runtime_service - INFO - 启动运行时任务消费: enhanced-reasoning-1
2025-06-28 12:00:24,833 - services.runtime_service - INFO - 推理运行时服务已启动 1 个实例和 1 个任务消费协程
2025-06-28 12:00:24,833 - core.tool_schema_manager - INFO - 🔍 启动MCP服务器配置监控...
2025-06-28 12:00:24,833 - core.task_manager - INFO - Runtime enhanced-reasoning-1 starting to consume from queue: tasks:reasoning
2025-06-28 12:00:24,834 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/search_tool_server/service.json
2025-06-28 12:00:24,834 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/microsandbox_server/service.json
2025-06-28 12:00:24,834 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/browser_use_server/service.json
2025-06-28 12:00:24,834 - core.tool_schema_manager - INFO - 📋 检测到MCP配置变化: mcp_servers/deepsearch_server/service.json
2025-06-28 12:00:24,835 - core.tool_schema_manager - INFO - 🔄 MCP配置变化，强制刷新schema...
2025-06-28 12:00:24,835 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=True)，当前缓存: 0 个工具
2025-06-28 12:00:24,835 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 12:00:24,835 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
2025-06-28 12:00:24,835 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 12:00:24,835 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
2025-06-28 12:00:24,835 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
2025-06-28 12:00:24,835 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 12:00:24,835 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 12:00:24,835 - core.tool_schema_manager - INFO - 🔄 检测到 4 个工具需要更新: ['deepsearch', 'microsandbox', 'browser_use', 'mcp-search-tool']
2025-06-28 12:00:24,835 - core.tool_schema_manager - INFO - 🔄 执行增量更新: 4 个工具
2025-06-28 12:00:24,835 - core.tool_schema_manager - INFO - 🔄 缓存为空，转为全量刷新模式
2025-06-28 12:00:24,835 - core.tool_schema_manager - DEBUG - 🔄 开始增强刷新工具Schemas...
2025-06-28 12:00:24,835 - core.tool_schema_manager - DEBUG - 🔍 工具注册表状态检查: _tools 字典包含 4 个条目
2025-06-28 12:00:24,835 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: deepsearch
2025-06-28 12:00:24,835 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: microsandbox
2025-06-28 12:00:24,835 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: browser_use
2025-06-28 12:00:24,835 - core.tool_schema_manager - DEBUG -   - 注册表中的工具: mcp-search-tool
2025-06-28 12:00:24,835 - core.tool_schema_manager - INFO - 🔧 选项1: 从工具注册表获取到 4 个工具
2025-06-28 12:00:24,835 - core.tool_schema_manager - DEBUG -   工具 0: id=deepsearch, name=网络信息研究工具, actions=3
2025-06-28 12:00:24,835 - core.tool_schema_manager - DEBUG -   工具 1: id=microsandbox, name=MicroSandbox安全代码执行器, actions=7
2025-06-28 12:00:24,835 - core.tool_schema_manager - DEBUG -   工具 2: id=browser_use, name=智能浏览器操作工具, actions=6
2025-06-28 12:00:24,835 - core.tool_schema_manager - DEBUG -   工具 3: id=mcp-search-tool, name=工具管理和项目文件搜索器, actions=4
2025-06-28 12:00:24,835 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: deepsearch
2025-06-28 12:00:24,835 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: comprehensive_research
2025-06-28 12:00:24,836 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: quick_research
2025-06-28 12:00:24,836 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: research
2025-06-28 12:00:24,836 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 deepsearch (包含 3 个动作)
2025-06-28 12:00:24,836 - core.tool_schema_manager - DEBUG -    当前缓存大小: 1 个工具
2025-06-28 12:00:24,836 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: microsandbox
2025-06-28 12:00:24,836 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_cleanup_expired
2025-06-28 12:00:24,836 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_close_session
2025-06-28 12:00:24,837 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_execute
2025-06-28 12:00:24,837 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_health_status
2025-06-28 12:00:24,837 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_get_performance_stats
2025-06-28 12:00:24,837 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_install_package
2025-06-28 12:00:24,837 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: microsandbox_list_sessions
2025-06-28 12:00:24,837 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 microsandbox (包含 7 个动作)
2025-06-28 12:00:24,837 - core.tool_schema_manager - DEBUG -    当前缓存大小: 2 个工具
2025-06-28 12:00:24,837 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: browser_use
2025-06-28 12:00:24,837 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-49' coro=<start.<locals>.start_all_runtimes() running at /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/services/runtime_service.py:95> wait_for=<_GatheringFuture pending cb=[Task.task_wakeup()]>>
2025-06-28 12:00:24,838 - services.runtime_service - INFO - 运行时服务正常停止，取消所有任务
[2025-06-28 12:00:24] Exception ignored in: [2025-06-28 12:00:24] <coroutine object start.<locals>.start_all_runtimes at 0x134577610>
[2025-06-28 12:00:24] Traceback (most recent call last):
[2025-06-28 12:00:24]   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/pydantic/json_schema.py", line 319, in build_schema_type_to_method
    [2025-06-28 12:00:24] mapping[key] = getattr(self, method_name)
                   [2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^[2025-06-28 12:00:24] ^
[2025-06-28 12:00:24] RuntimeError[2025-06-28 12:00:24] : [2025-06-28 12:00:24] coroutine ignored GeneratorExit
2025-06-28 12:00:24,838 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task cancelling name='runtime-enhanced-reasoning-1' coro=<start_runtime_service() running at /Users/zhaoxiang/Documents/Datapresso/agent-data-platform/core/task_manager.py:424> wait_for=<Future cancelled> cb=[gather.<locals>._done_callback() at /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/tasks.py:764, gather.<locals>._done_callback() at /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/tasks.py:764]>
2025-06-28 12:00:24,838 - core.task_manager - INFO - Runtime enhanced-reasoning-1 service stopped normally
2025-06-28 12:00:24,838 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_click_element
2025-06-28 12:00:24,839 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_use_execute_task
2025-06-28 12:00:24,839 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_extract_content
2025-06-28 12:00:24,839 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_input_text
2025-06-28 12:00:24,839 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_navigate
2025-06-28 12:00:24,839 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: browser_search_google
2025-06-28 12:00:24,839 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 browser_use (包含 6 个动作)
2025-06-28 12:00:24,839 - core.tool_schema_manager - DEBUG -    当前缓存大小: 3 个工具
2025-06-28 12:00:24,839 - core.tool_schema_manager - DEBUG - 🔧 处理工具定义: mcp-search-tool
2025-06-28 12:00:24,839 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: analyze_tool_needs
2025-06-28 12:00:24,839 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: list_code_definitions
2025-06-28 12:00:24,839 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_and_install_tools
2025-06-28 12:00:24,839 - core.tool_schema_manager - DEBUG -   ✅ 处理动作: search_file_content
2025-06-28 12:00:24,840 - core.tool_schema_manager - DEBUG - ✅ 选项1: 成功缓存工具 mcp-search-tool (包含 4 个动作)
2025-06-28 12:00:24,840 - core.tool_schema_manager - DEBUG -    当前缓存大小: 4 个工具
2025-06-28 12:00:24,840 - core.tool_schema_manager - INFO - 🔧 选项1: 成功处理 4/4 个工具，当前缓存 4 个工具
2025-06-28 12:00:24,840 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: mcp-search-tool
2025-06-28 12:00:24,840 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: microsandbox
2025-06-28 12:00:24,840 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: browser_use
2025-06-28 12:00:24,840 - core.tool_schema_manager - DEBUG - ✅ 从 service.json 加载工具: deepsearch
2025-06-28 12:00:24,840 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:00:24 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:00:24,840 - core.tool_schema_manager - DEBUG - 🔍 从ToolScore获取到工具列表: ['mcp-search-tool', 'microsandbox', 'browser_use', 'deepsearch']
2025-06-28 12:00:24,840 - core.tool_schema_manager - DEBUG - 🔧 映射后的工具列表: ['mcp-search-tool', 'microsandbox', 'browser_use', 'deepsearch']
2025-06-28 12:00:24,840 - core.tool_schema_manager - DEBUG - ⏭️ 工具 mcp-search-tool 已在缓存中，跳过ToolScore获取
2025-06-28 12:00:24,840 - core.tool_schema_manager - DEBUG - ⏭️ 工具 microsandbox 已在缓存中，跳过ToolScore获取
2025-06-28 12:00:24,840 - core.tool_schema_manager - DEBUG - ⏭️ 工具 browser_use 已在缓存中，跳过ToolScore获取
2025-06-28 12:00:24,841 - core.tool_schema_manager - DEBUG - ⏭️ 工具 deepsearch 已在缓存中，跳过ToolScore获取
2025-06-28 12:00:24,841 - core.tool_schema_manager - INFO - ✅ 增强刷新完成，当前可用工具: 4个
2025-06-28 12:00:24,841 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 12:00:24,841 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 12:00:24,841 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 12:00:24,842 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 12:00:24,842 - core.tool_schema_manager - INFO - ✅ Schema安全刷新完成，备份 4 个工具
2025-06-28 12:00:24,842 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 12:00:24,842 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 12:00:24,842 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 12:00:24,843 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 12:00:24,843 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 12:00:24,843 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 12:00:29,338 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第8次, 5s间隔)
2025-06-28 12:00:29,828 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:00:29 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:00:34,339 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第9次, 5s间隔)
2025-06-28 12:00:34,830 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:00:34 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:00:34,830 - core.toolscore.async_tool_state_manager - INFO - Tool deepsearch state changed: initializing -> unhealthy
2025-06-28 12:00:34,830 - core.toolscore.async_tool_state_manager - INFO - Tool browser_use state changed: initializing -> unhealthy
2025-06-28 12:00:34,830 - core.toolscore.async_tool_state_manager - INFO - Tool mcp-search-tool state changed: initializing -> unhealthy
2025-06-28 12:00:34,831 - core.toolscore.async_tool_state_manager - INFO - Tool microsandbox state changed: initializing -> unhealthy
2025-06-28 12:00:39,341 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第10次, 5s间隔)
2025-06-28 12:00:39,832 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:00:39 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:00:44,342 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第11次, 5s间隔)
2025-06-28 12:00:44,825 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:00:44,825 - websockets.client - DEBUG - > PING ec e9 41 9e [binary, 4 bytes]
2025-06-28 12:00:44,826 - websockets.server - DEBUG - < PING ec e9 41 9e [binary, 4 bytes]
2025-06-28 12:00:44,826 - websockets.server - DEBUG - > PONG ec e9 41 9e [binary, 4 bytes]
2025-06-28 12:00:44,826 - websockets.client - DEBUG - < PONG ec e9 41 9e [binary, 4 bytes]
2025-06-28 12:00:44,826 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:00:44,834 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:00:44 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13991 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:00:49,343 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第12次, 5s间隔)
2025-06-28 12:00:49,835 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:00:49 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:00:54,314 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:00:54,329 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:00:54,330 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:00:54,330 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:00:54,337 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:00:54,344 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第13次, 30s间隔)
2025-06-28 12:00:54,820 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:00:54,820 - websockets.server - DEBUG - > PING 28 d0 a1 8a [binary, 4 bytes]
2025-06-28 12:00:54,821 - websockets.client - DEBUG - < PING 28 d0 a1 8a [binary, 4 bytes]
2025-06-28 12:00:54,821 - websockets.client - DEBUG - > PONG 28 d0 a1 8a [binary, 4 bytes]
2025-06-28 12:00:54,822 - websockets.server - DEBUG - < PONG 28 d0 a1 8a [binary, 4 bytes]
2025-06-28 12:00:54,822 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:00:54,838 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:00:54 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:00:59,842 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:00:59 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:01:00,357 - core.task_api - INFO - Task ab35a556-8bce-4f7a-b0f7-5be35d2c842a submitted successfully
[2025-06-28 12:01:00] INFO:     127.0.0.1:50281 - "POST /api/v1/tasks HTTP/1.1" 200 OK
2025-06-28 12:01:04,827 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:01:04,827 - websockets.client - DEBUG - > PING f1 83 ce 83 [binary, 4 bytes]
2025-06-28 12:01:04,828 - websockets.server - DEBUG - < PING f1 83 ce 83 [binary, 4 bytes]
2025-06-28 12:01:04,828 - websockets.server - DEBUG - > PONG f1 83 ce 83 [binary, 4 bytes]
2025-06-28 12:01:04,828 - websockets.client - DEBUG - < PONG f1 83 ce 83 [binary, 4 bytes]
2025-06-28 12:01:04,828 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:01:04,846 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:01:04 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:01:09,851 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:01:09 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:01:14,853 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:01:14 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:01:19,857 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:01:19 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:01:24,318 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:01:24,335 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:01:24,335 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:01:24,336 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:01:24,343 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:01:24,344 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第14次, 30s间隔)
2025-06-28 12:01:24,812 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 1m 0s
2025-06-28 12:01:24,822 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:01:24,823 - websockets.server - DEBUG - > PING 15 c1 97 f4 [binary, 4 bytes]
2025-06-28 12:01:24,823 - websockets.client - DEBUG - < PING 15 c1 97 f4 [binary, 4 bytes]
2025-06-28 12:01:24,823 - websockets.client - DEBUG - > PONG 15 c1 97 f4 [binary, 4 bytes]
2025-06-28 12:01:24,824 - websockets.server - DEBUG - < PONG 15 c1 97 f4 [binary, 4 bytes]
2025-06-28 12:01:24,824 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:01:24,828 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:01:24,829 - websockets.client - DEBUG - > PING 3a 14 90 63 [binary, 4 bytes]
2025-06-28 12:01:24,829 - websockets.server - DEBUG - < PING 3a 14 90 63 [binary, 4 bytes]
2025-06-28 12:01:24,829 - websockets.server - DEBUG - > PONG 3a 14 90 63 [binary, 4 bytes]
2025-06-28 12:01:24,829 - websockets.client - DEBUG - < PONG 3a 14 90 63 [binary, 4 bytes]
2025-06-28 12:01:24,829 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:01:24,859 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:01:24 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:01:29,860 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:01:29 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
[2025-06-28 12:01:32] INFO:     127.0.0.1:50395 - "GET /api/v1/tasks/ab35a556-8bce-4f7a-b0f7-5be35d2c842a HTTP/1.1" 200 OK
2025-06-28 12:01:34,864 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:01:34 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:01:39,867 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:01:39 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:01:44,830 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:01:44,831 - websockets.client - DEBUG - > PING cb a1 69 eb [binary, 4 bytes]
2025-06-28 12:01:44,831 - websockets.server - DEBUG - < PING cb a1 69 eb [binary, 4 bytes]
2025-06-28 12:01:44,831 - websockets.server - DEBUG - > PONG cb a1 69 eb [binary, 4 bytes]
2025-06-28 12:01:44,831 - websockets.client - DEBUG - < PONG cb a1 69 eb [binary, 4 bytes]
2025-06-28 12:01:44,832 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:01:44,870 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:01:44 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:01:49,872 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:01:49 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:01:54,323 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:01:54,337 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:01:54,338 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:01:54,338 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:01:54,345 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第15次, 30s间隔)
2025-06-28 12:01:54,348 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:01:54,825 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:01:54,825 - websockets.server - DEBUG - > PING '\x02Dv\x1c' [text, 4 bytes]
2025-06-28 12:01:54,826 - websockets.client - DEBUG - < PING '\x02Dv\x1c' [text, 4 bytes]
2025-06-28 12:01:54,826 - websockets.client - DEBUG - > PONG '\x02Dv\x1c' [text, 4 bytes]
2025-06-28 12:01:54,826 - websockets.server - DEBUG - < PONG '\x02Dv\x1c' [text, 4 bytes]
2025-06-28 12:01:54,826 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:01:54,875 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:01:54 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:01:59,878 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:01:59 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:02:04,833 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:02:04,833 - websockets.client - DEBUG - > PING 'rF˦' [text, 4 bytes]
2025-06-28 12:02:04,834 - websockets.server - DEBUG - < PING 'rF˦' [text, 4 bytes]
2025-06-28 12:02:04,834 - websockets.server - DEBUG - > PONG 'rF˦' [text, 4 bytes]
2025-06-28 12:02:04,835 - websockets.client - DEBUG - < PONG 'rF˦' [text, 4 bytes]
2025-06-28 12:02:04,835 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:02:04,881 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:02:04 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:02:09,882 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:02:09 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:02:14,885 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:02:14 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:02:19,887 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:02:19 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:02:24,329 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:02:24,340 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:02:24,342 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:02:24,342 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:02:24,346 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第16次, 30s间隔)
2025-06-28 12:02:24,354 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:02:24,813 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 2m 0s
2025-06-28 12:02:24,827 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:02:24,828 - websockets.server - DEBUG - > PING 39 9e ca 71 [binary, 4 bytes]
2025-06-28 12:02:24,828 - websockets.client - DEBUG - < PING 39 9e ca 71 [binary, 4 bytes]
2025-06-28 12:02:24,829 - websockets.client - DEBUG - > PONG 39 9e ca 71 [binary, 4 bytes]
2025-06-28 12:02:24,829 - websockets.server - DEBUG - < PONG 39 9e ca 71 [binary, 4 bytes]
2025-06-28 12:02:24,829 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:02:24,836 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:02:24,836 - websockets.client - DEBUG - > PING a8 05 4b bd [binary, 4 bytes]
2025-06-28 12:02:24,836 - websockets.server - DEBUG - < PING a8 05 4b bd [binary, 4 bytes]
2025-06-28 12:02:24,836 - websockets.server - DEBUG - > PONG a8 05 4b bd [binary, 4 bytes]
2025-06-28 12:02:24,837 - websockets.client - DEBUG - < PONG a8 05 4b bd [binary, 4 bytes]
2025-06-28 12:02:24,837 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:02:24,890 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:02:24 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:02:29,893 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:02:29 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:02:34,896 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:02:34 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:02:39,899 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:02:39 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:02:44,838 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:02:44,838 - websockets.client - DEBUG - > PING da dd 7c 37 [binary, 4 bytes]
2025-06-28 12:02:44,839 - websockets.server - DEBUG - < PING da dd 7c 37 [binary, 4 bytes]
2025-06-28 12:02:44,839 - websockets.server - DEBUG - > PONG da dd 7c 37 [binary, 4 bytes]
2025-06-28 12:02:44,840 - websockets.client - DEBUG - < PONG da dd 7c 37 [binary, 4 bytes]
2025-06-28 12:02:44,840 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:02:44,902 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:02:44 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:02:49,905 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:02:49 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:02:54,334 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:02:54,344 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:02:54,345 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:02:54,346 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:02:54,347 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第17次, 30s间隔)
2025-06-28 12:02:54,359 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:02:54,830 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:02:54,830 - websockets.server - DEBUG - > PING f4 01 c7 d6 [binary, 4 bytes]
2025-06-28 12:02:54,830 - websockets.client - DEBUG - < PING f4 01 c7 d6 [binary, 4 bytes]
2025-06-28 12:02:54,830 - websockets.client - DEBUG - > PONG f4 01 c7 d6 [binary, 4 bytes]
2025-06-28 12:02:54,830 - websockets.server - DEBUG - < PONG f4 01 c7 d6 [binary, 4 bytes]
2025-06-28 12:02:54,830 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:02:54,908 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:02:54 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:02:59,915 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:02:59 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:03:04,841 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:03:04,842 - websockets.client - DEBUG - > PING 'sH҄' [text, 4 bytes]
2025-06-28 12:03:04,842 - websockets.server - DEBUG - < PING 'sH҄' [text, 4 bytes]
2025-06-28 12:03:04,842 - websockets.server - DEBUG - > PONG 'sH҄' [text, 4 bytes]
2025-06-28 12:03:04,843 - websockets.client - DEBUG - < PONG 'sH҄' [text, 4 bytes]
2025-06-28 12:03:04,843 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:03:04,919 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:03:04 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:03:09,922 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:03:09 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:03:14,925 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:03:14 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:03:19,929 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:03:19 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13991 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:03:24,339 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:03:24,348 - core.task_processing.task_loader - INFO - 📋 任务文件 tasks.jsonl 不存在，等待... (第18次, 30s间隔) - 建议通过API提交任务
2025-06-28 12:03:24,349 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:03:24,351 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:03:24,351 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:03:24,363 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:03:24,814 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 3m 0s
2025-06-28 12:03:24,832 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:03:24,832 - websockets.server - DEBUG - > PING ca 44 78 f7 [binary, 4 bytes]
2025-06-28 12:03:24,833 - websockets.client - DEBUG - < PING ca 44 78 f7 [binary, 4 bytes]
2025-06-28 12:03:24,833 - websockets.client - DEBUG - > PONG ca 44 78 f7 [binary, 4 bytes]
2025-06-28 12:03:24,833 - websockets.server - DEBUG - < PONG ca 44 78 f7 [binary, 4 bytes]
2025-06-28 12:03:24,834 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:03:24,844 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:03:24,844 - websockets.client - DEBUG - > PING a7 92 e7 64 [binary, 4 bytes]
2025-06-28 12:03:24,845 - websockets.server - DEBUG - < PING a7 92 e7 64 [binary, 4 bytes]
2025-06-28 12:03:24,845 - websockets.server - DEBUG - > PONG a7 92 e7 64 [binary, 4 bytes]
2025-06-28 12:03:24,845 - websockets.client - DEBUG - < PONG a7 92 e7 64 [binary, 4 bytes]
2025-06-28 12:03:24,845 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:03:24,933 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:03:24 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:03:29,937 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:03:29 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:03:34,939 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:03:34 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:03:39,943 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:03:39 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:03:44,847 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:03:44,847 - websockets.client - DEBUG - > PING 38 0d cd 71 [binary, 4 bytes]
2025-06-28 12:03:44,848 - websockets.server - DEBUG - < PING 38 0d cd 71 [binary, 4 bytes]
2025-06-28 12:03:44,848 - websockets.server - DEBUG - > PONG 38 0d cd 71 [binary, 4 bytes]
2025-06-28 12:03:44,848 - websockets.client - DEBUG - < PONG 38 0d cd 71 [binary, 4 bytes]
2025-06-28 12:03:44,848 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:03:44,945 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:03:44 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:03:49,949 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:03:49 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:03:51,571 - core.task_api - INFO - Task 5ca93a0c-50d0-4cd3-a4cb-8285d686629c submitted successfully
[2025-06-28 12:03:51] INFO:     127.0.0.1:50688 - "POST /api/v1/tasks HTTP/1.1" 200 OK
2025-06-28 12:03:54,345 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:03:54,349 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第19次, 30s间隔)
2025-06-28 12:03:54,353 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:03:54,353 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:03:54,354 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:03:54,367 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:03:54,835 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:03:54,835 - websockets.server - DEBUG - > PING 8f 6b cc 78 [binary, 4 bytes]
2025-06-28 12:03:54,835 - websockets.client - DEBUG - < PING 8f 6b cc 78 [binary, 4 bytes]
2025-06-28 12:03:54,835 - websockets.client - DEBUG - > PONG 8f 6b cc 78 [binary, 4 bytes]
2025-06-28 12:03:54,835 - websockets.server - DEBUG - < PONG 8f 6b cc 78 [binary, 4 bytes]
2025-06-28 12:03:54,835 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:03:54,952 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:03:54 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:03:59,955 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:03:59 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:04:04,849 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:04:04,850 - websockets.client - DEBUG - > PING f2 b3 3c 07 [binary, 4 bytes]
2025-06-28 12:04:04,851 - websockets.server - DEBUG - < PING f2 b3 3c 07 [binary, 4 bytes]
2025-06-28 12:04:04,851 - websockets.server - DEBUG - > PONG f2 b3 3c 07 [binary, 4 bytes]
2025-06-28 12:04:04,851 - websockets.client - DEBUG - < PONG f2 b3 3c 07 [binary, 4 bytes]
2025-06-28 12:04:04,852 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:04:04,959 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:04:04 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:04:09,962 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:04:09 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:04:14,966 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:04:14 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13990 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:04:19,969 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:04:19 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
[2025-06-28 12:04:20] INFO:     127.0.0.1:50759 - "GET /api/v1/tasks/5ca93a0c-50d0-4cd3-a4cb-8285d686629c HTTP/1.1" 200 OK
2025-06-28 12:04:24,346 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:04:24,350 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第20次, 30s间隔)
2025-06-28 12:04:24,355 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:04:24,356 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:04:24,356 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:04:24,369 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:04:24,816 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 4m 0s
2025-06-28 12:04:24,836 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:04:24,836 - websockets.server - DEBUG - > PING 75 db cb 50 [binary, 4 bytes]
2025-06-28 12:04:24,837 - websockets.client - DEBUG - < PING 75 db cb 50 [binary, 4 bytes]
2025-06-28 12:04:24,837 - websockets.client - DEBUG - > PONG 75 db cb 50 [binary, 4 bytes]
2025-06-28 12:04:24,837 - websockets.server - DEBUG - < PONG 75 db cb 50 [binary, 4 bytes]
2025-06-28 12:04:24,838 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:04:24,853 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:04:24,853 - websockets.client - DEBUG - > PING b6 ae ba c9 [binary, 4 bytes]
2025-06-28 12:04:24,854 - websockets.server - DEBUG - < PING b6 ae ba c9 [binary, 4 bytes]
2025-06-28 12:04:24,854 - websockets.server - DEBUG - > PONG b6 ae ba c9 [binary, 4 bytes]
2025-06-28 12:04:24,854 - websockets.client - DEBUG - < PONG b6 ae ba c9 [binary, 4 bytes]
2025-06-28 12:04:24,854 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:04:24,972 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:04:24 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:04:29,976 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:04:29 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:04:34,979 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:04:34 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:04:39,981 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:04:39 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:04:44,856 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:04:44,856 - websockets.client - DEBUG - > PING f1 4a 6c 4d [binary, 4 bytes]
2025-06-28 12:04:44,857 - websockets.server - DEBUG - < PING f1 4a 6c 4d [binary, 4 bytes]
2025-06-28 12:04:44,857 - websockets.server - DEBUG - > PONG f1 4a 6c 4d [binary, 4 bytes]
2025-06-28 12:04:44,857 - websockets.client - DEBUG - < PONG f1 4a 6c 4d [binary, 4 bytes]
2025-06-28 12:04:44,858 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:04:44,985 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:04:44 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:04:49,988 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:04:49 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:04:54,351 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第21次, 30s间隔)
2025-06-28 12:04:54,352 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:04:54,358 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:04:54,358 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:04:54,359 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:04:54,371 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:04:54,839 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:04:54,839 - websockets.server - DEBUG - > PING 06 08 b2 df [binary, 4 bytes]
2025-06-28 12:04:54,840 - websockets.client - DEBUG - < PING 06 08 b2 df [binary, 4 bytes]
2025-06-28 12:04:54,840 - websockets.client - DEBUG - > PONG 06 08 b2 df [binary, 4 bytes]
2025-06-28 12:04:54,840 - websockets.server - DEBUG - < PONG 06 08 b2 df [binary, 4 bytes]
2025-06-28 12:04:54,841 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:04:54,992 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:04:54 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:04:59,995 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:04:59 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:05:01,950 - core.task_api - INFO - Task 949d6122-f705-4e7b-bc66-28f3809771cf submitted successfully
[2025-06-28 12:05:01] INFO:     127.0.0.1:50880 - "POST /api/v1/tasks HTTP/1.1" 200 OK
[2025-06-28 12:05:01] INFO:     127.0.0.1:50880 - "GET /api/v1/tasks/949d6122-f705-4e7b-bc66-28f3809771cf HTTP/1.1" 200 OK
[2025-06-28 12:05:03] INFO:     127.0.0.1:50880 - "GET /api/v1/tasks/949d6122-f705-4e7b-bc66-28f3809771cf HTTP/1.1" 200 OK
2025-06-28 12:05:04,859 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:05:04,859 - websockets.client - DEBUG - > PING '\x0fnVg' [text, 4 bytes]
2025-06-28 12:05:04,859 - websockets.server - DEBUG - < PING '\x0fnVg' [text, 4 bytes]
2025-06-28 12:05:04,860 - websockets.server - DEBUG - > PONG '\x0fnVg' [text, 4 bytes]
2025-06-28 12:05:04,860 - websockets.client - DEBUG - < PONG '\x0fnVg' [text, 4 bytes]
2025-06-28 12:05:04,860 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:05:04,999 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:05:04 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
[2025-06-28 12:05:05] INFO:     127.0.0.1:50880 - "GET /api/v1/tasks/949d6122-f705-4e7b-bc66-28f3809771cf HTTP/1.1" 200 OK
[2025-06-28 12:05:07] INFO:     127.0.0.1:50880 - "GET /api/v1/tasks/949d6122-f705-4e7b-bc66-28f3809771cf HTTP/1.1" 200 OK
[2025-06-28 12:05:09] INFO:     127.0.0.1:50880 - "GET /api/v1/tasks/949d6122-f705-4e7b-bc66-28f3809771cf HTTP/1.1" 200 OK
2025-06-28 12:05:10,001 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:05:10 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
[2025-06-28 12:05:11] INFO:     127.0.0.1:50880 - "GET /api/v1/tasks/949d6122-f705-4e7b-bc66-28f3809771cf HTTP/1.1" 200 OK
[2025-06-28 12:05:13] INFO:     127.0.0.1:50880 - "GET /api/v1/tasks/949d6122-f705-4e7b-bc66-28f3809771cf HTTP/1.1" 200 OK
2025-06-28 12:05:15,003 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:05:15 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
[2025-06-28 12:05:15] INFO:     127.0.0.1:50880 - "GET /api/v1/tasks/949d6122-f705-4e7b-bc66-28f3809771cf HTTP/1.1" 200 OK
[2025-06-28 12:05:17] INFO:     127.0.0.1:50880 - "GET /api/v1/tasks/949d6122-f705-4e7b-bc66-28f3809771cf HTTP/1.1" 200 OK
[2025-06-28 12:05:19] INFO:     127.0.0.1:50880 - "GET /api/v1/tasks/949d6122-f705-4e7b-bc66-28f3809771cf HTTP/1.1" 200 OK
2025-06-28 12:05:20,007 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:05:20 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
[2025-06-28 12:05:22] INFO:     127.0.0.1:50880 - "GET /api/v1/tasks/949d6122-f705-4e7b-bc66-28f3809771cf HTTP/1.1" 200 OK
[2025-06-28 12:05:24] INFO:     127.0.0.1:50880 - "GET /api/v1/tasks/949d6122-f705-4e7b-bc66-28f3809771cf HTTP/1.1" 200 OK
2025-06-28 12:05:24,353 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第22次, 30s间隔)
2025-06-28 12:05:24,356 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:05:24,359 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:05:24,360 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:05:24,360 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:05:24,374 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:05:24,817 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 5m 0s
2025-06-28 12:05:24,832 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔍 执行定期MCP同步验证...
2025-06-28 12:05:24,833 - core.tool_schema_manager - INFO - 正在执行MCP同步验证...
2025-06-28 12:05:24,833 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=False)，当前缓存: 4 个工具
2025-06-28 12:05:24,833 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 12:05:24,833 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
2025-06-28 12:05:24,834 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 12:05:24,834 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
2025-06-28 12:05:24,834 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
2025-06-28 12:05:24,834 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 12:05:24,834 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 12:05:24,834 - core.tool_schema_manager - DEBUG - 📊 Schema版本无变化，跳过更新
2025-06-28 12:05:24,836 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 12:05:24,836 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 12:05:24,837 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 12:05:24,838 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 12:05:24,839 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 12:05:24,839 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 12:05:24,839 - core.tool_schema_manager - INFO - 🔍 同步验证完成: unhealthy (0/4 工具Schema一致)
2025-06-28 12:05:24,839 - runtimes.reasoning.enhanced_runtime - WARNING - ⚠️ MCP同步验证发现问题: {'total_tools': 4, 'connected_tools': 0, 'schema_consistent_tools': 0, 'failed_tools': 0}
2025-06-28 12:05:24,842 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:05:24,842 - websockets.server - DEBUG - > PING b7 fe d4 84 [binary, 4 bytes]
2025-06-28 12:05:24,842 - websockets.client - DEBUG - < PING b7 fe d4 84 [binary, 4 bytes]
2025-06-28 12:05:24,842 - websockets.client - DEBUG - > PONG b7 fe d4 84 [binary, 4 bytes]
2025-06-28 12:05:24,842 - websockets.server - DEBUG - < PONG b7 fe d4 84 [binary, 4 bytes]
2025-06-28 12:05:24,843 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:05:24,861 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:05:24,861 - websockets.client - DEBUG - > PING 40 b7 6e b0 [binary, 4 bytes]
2025-06-28 12:05:24,862 - websockets.server - DEBUG - < PING 40 b7 6e b0 [binary, 4 bytes]
2025-06-28 12:05:24,862 - websockets.server - DEBUG - > PONG 40 b7 6e b0 [binary, 4 bytes]
2025-06-28 12:05:24,862 - websockets.client - DEBUG - < PONG 40 b7 6e b0 [binary, 4 bytes]
2025-06-28 12:05:24,862 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:05:25,011 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:05:25 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:05:25,956 - services.synthesis_service - INFO - 开始处理轨迹数据...
2025-06-28 12:05:25,957 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 12:05:25,957 - core.synthesiscore.synthesis - INFO - 🔄 Processing only unprocessed trajectories...
2025-06-28 12:05:25,958 - core.synthesiscore.synthesis - INFO - 🎯 Unprocessed trajectories completed: 0 new trajectories processed
2025-06-28 12:05:25,959 - services.synthesis_service - DEBUG - 等待 300 秒后再次处理...
[2025-06-28 12:05:26] INFO:     127.0.0.1:50880 - "GET /api/v1/tasks/949d6122-f705-4e7b-bc66-28f3809771cf HTTP/1.1" 200 OK
[2025-06-28 12:05:28] INFO:     127.0.0.1:50880 - "GET /api/v1/tasks/949d6122-f705-4e7b-bc66-28f3809771cf HTTP/1.1" 200 OK
2025-06-28 12:05:30,014 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:05:30 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
[2025-06-28 12:05:30] INFO:     127.0.0.1:50880 - "GET /api/v1/tasks/949d6122-f705-4e7b-bc66-28f3809771cf HTTP/1.1" 200 OK
2025-06-28 12:05:35,016 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:05:35 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:05:40,019 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:05:40 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13991 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:05:44,862 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:05:44,863 - websockets.client - DEBUG - > PING f2 72 50 48 [binary, 4 bytes]
2025-06-28 12:05:44,863 - websockets.server - DEBUG - < PING f2 72 50 48 [binary, 4 bytes]
2025-06-28 12:05:44,863 - websockets.server - DEBUG - > PONG f2 72 50 48 [binary, 4 bytes]
2025-06-28 12:05:44,863 - websockets.client - DEBUG - < PONG f2 72 50 48 [binary, 4 bytes]
2025-06-28 12:05:44,863 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:05:45,022 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:05:45 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:05:50,026 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:05:50 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:05:54,354 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第23次, 30s间隔)
2025-06-28 12:05:54,362 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:05:54,364 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:05:54,365 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:05:54,365 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:05:54,380 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:05:54,844 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:05:54,844 - websockets.server - DEBUG - > PING 19 b4 9d 79 [binary, 4 bytes]
2025-06-28 12:05:54,844 - websockets.client - DEBUG - < PING 19 b4 9d 79 [binary, 4 bytes]
2025-06-28 12:05:54,844 - websockets.client - DEBUG - > PONG 19 b4 9d 79 [binary, 4 bytes]
2025-06-28 12:05:54,844 - websockets.server - DEBUG - < PONG 19 b4 9d 79 [binary, 4 bytes]
2025-06-28 12:05:54,845 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:05:55,029 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:05:55 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:06:00,030 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:06:00 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:06:04,865 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:06:04,865 - websockets.client - DEBUG - > PING 7e a3 a7 cf [binary, 4 bytes]
2025-06-28 12:06:04,865 - websockets.server - DEBUG - < PING 7e a3 a7 cf [binary, 4 bytes]
2025-06-28 12:06:04,865 - websockets.server - DEBUG - > PONG 7e a3 a7 cf [binary, 4 bytes]
2025-06-28 12:06:04,865 - websockets.client - DEBUG - < PONG 7e a3 a7 cf [binary, 4 bytes]
2025-06-28 12:06:04,865 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:06:05,033 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:06:05 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:06:10,036 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:06:10 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:06:15,040 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:06:15 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:06:20,044 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:06:20 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:06:24,356 - core.task_processing.task_loader - INFO - 📋 任务文件 tasks.jsonl 不存在，等待... (第24次, 30s间隔) - 建议通过API提交任务
2025-06-28 12:06:24,368 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:06:24,370 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:06:24,371 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:06:24,371 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:06:24,383 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:06:24,818 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 6m 0s
2025-06-28 12:06:24,846 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:06:24,846 - websockets.server - DEBUG - > PING 03 3a f0 3e [binary, 4 bytes]
2025-06-28 12:06:24,846 - websockets.client - DEBUG - < PING 03 3a f0 3e [binary, 4 bytes]
2025-06-28 12:06:24,846 - websockets.client - DEBUG - > PONG 03 3a f0 3e [binary, 4 bytes]
2025-06-28 12:06:24,846 - websockets.server - DEBUG - < PONG 03 3a f0 3e [binary, 4 bytes]
2025-06-28 12:06:24,847 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:06:24,866 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:06:24,867 - websockets.client - DEBUG - > PING 'BU\x1cP' [text, 4 bytes]
2025-06-28 12:06:24,867 - websockets.server - DEBUG - < PING 'BU\x1cP' [text, 4 bytes]
2025-06-28 12:06:24,867 - websockets.server - DEBUG - > PONG 'BU\x1cP' [text, 4 bytes]
2025-06-28 12:06:24,867 - websockets.client - DEBUG - < PONG 'BU\x1cP' [text, 4 bytes]
2025-06-28 12:06:24,867 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:06:25,047 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:06:25 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:06:30,050 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:06:30 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:06:35,053 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:06:35 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:06:40,062 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:06:40 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:06:44,874 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:06:44,874 - websockets.client - DEBUG - > PING fd a3 b9 c0 [binary, 4 bytes]
2025-06-28 12:06:44,875 - websockets.server - DEBUG - < PING fd a3 b9 c0 [binary, 4 bytes]
2025-06-28 12:06:44,875 - websockets.server - DEBUG - > PONG fd a3 b9 c0 [binary, 4 bytes]
2025-06-28 12:06:44,876 - websockets.client - DEBUG - < PONG fd a3 b9 c0 [binary, 4 bytes]
2025-06-28 12:06:44,876 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:06:45,066 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:06:45 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:06:50,070 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:06:50 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:06:54,357 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第25次, 30s间隔)
2025-06-28 12:06:54,371 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:06:54,374 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:06:54,375 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:06:54,375 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:06:54,388 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:06:54,848 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:06:54,848 - websockets.server - DEBUG - > PING e3 0e c3 30 [binary, 4 bytes]
2025-06-28 12:06:54,849 - websockets.client - DEBUG - < PING e3 0e c3 30 [binary, 4 bytes]
2025-06-28 12:06:54,849 - websockets.client - DEBUG - > PONG e3 0e c3 30 [binary, 4 bytes]
2025-06-28 12:06:54,849 - websockets.server - DEBUG - < PONG e3 0e c3 30 [binary, 4 bytes]
2025-06-28 12:06:54,849 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:06:55,073 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:06:55 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:07:00,077 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:07:00 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13991 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:07:04,877 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:07:04,877 - websockets.client - DEBUG - > PING fd 83 d9 df [binary, 4 bytes]
2025-06-28 12:07:04,878 - websockets.server - DEBUG - < PING fd 83 d9 df [binary, 4 bytes]
2025-06-28 12:07:04,878 - websockets.server - DEBUG - > PONG fd 83 d9 df [binary, 4 bytes]
2025-06-28 12:07:04,878 - websockets.client - DEBUG - < PONG fd 83 d9 df [binary, 4 bytes]
2025-06-28 12:07:04,879 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:07:05,080 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:07:05 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:07:10,083 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:07:10 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:07:15,086 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:07:15 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13991 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:07:20,090 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:07:20 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:07:24,358 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第26次, 30s间隔)
2025-06-28 12:07:24,377 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:07:24,377 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:07:24,378 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:07:24,378 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:07:24,394 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:07:24,818 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 7m 0s
2025-06-28 12:07:24,850 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:07:24,851 - websockets.server - DEBUG - > PING a4 66 27 06 [binary, 4 bytes]
2025-06-28 12:07:24,851 - websockets.client - DEBUG - < PING a4 66 27 06 [binary, 4 bytes]
2025-06-28 12:07:24,851 - websockets.client - DEBUG - > PONG a4 66 27 06 [binary, 4 bytes]
2025-06-28 12:07:24,851 - websockets.server - DEBUG - < PONG a4 66 27 06 [binary, 4 bytes]
2025-06-28 12:07:24,851 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:07:24,880 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:07:24,880 - websockets.client - DEBUG - > PING f8 87 83 62 [binary, 4 bytes]
2025-06-28 12:07:24,880 - websockets.server - DEBUG - < PING f8 87 83 62 [binary, 4 bytes]
2025-06-28 12:07:24,881 - websockets.server - DEBUG - > PONG f8 87 83 62 [binary, 4 bytes]
2025-06-28 12:07:24,881 - websockets.client - DEBUG - < PONG f8 87 83 62 [binary, 4 bytes]
2025-06-28 12:07:24,881 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:07:25,094 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:07:25 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:07:30,097 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:07:30 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:07:35,101 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:07:35 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:07:40,105 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:07:40 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:07:44,882 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:07:44,883 - websockets.client - DEBUG - > PING 53 ea 4f a5 [binary, 4 bytes]
2025-06-28 12:07:44,883 - websockets.server - DEBUG - < PING 53 ea 4f a5 [binary, 4 bytes]
2025-06-28 12:07:44,883 - websockets.server - DEBUG - > PONG 53 ea 4f a5 [binary, 4 bytes]
2025-06-28 12:07:44,884 - websockets.client - DEBUG - < PONG 53 ea 4f a5 [binary, 4 bytes]
2025-06-28 12:07:44,884 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:07:45,109 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:07:45 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:07:50,113 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:07:50 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:07:54,360 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第27次, 30s间隔)
2025-06-28 12:07:54,383 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:07:54,383 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:07:54,385 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:07:54,385 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:07:54,400 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:07:54,853 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:07:54,853 - websockets.server - DEBUG - > PING 13 fd f5 c2 [binary, 4 bytes]
2025-06-28 12:07:54,854 - websockets.client - DEBUG - < PING 13 fd f5 c2 [binary, 4 bytes]
2025-06-28 12:07:54,854 - websockets.client - DEBUG - > PONG 13 fd f5 c2 [binary, 4 bytes]
2025-06-28 12:07:54,854 - websockets.server - DEBUG - < PONG 13 fd f5 c2 [binary, 4 bytes]
2025-06-28 12:07:54,854 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:07:55,116 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:07:55 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:08:00,119 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:08:00 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:08:04,885 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:08:04,886 - websockets.client - DEBUG - > PING 24 58 ab e2 [binary, 4 bytes]
2025-06-28 12:08:04,886 - websockets.server - DEBUG - < PING 24 58 ab e2 [binary, 4 bytes]
2025-06-28 12:08:04,886 - websockets.server - DEBUG - > PONG 24 58 ab e2 [binary, 4 bytes]
2025-06-28 12:08:04,887 - websockets.client - DEBUG - < PONG 24 58 ab e2 [binary, 4 bytes]
2025-06-28 12:08:04,887 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:08:05,122 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:08:05 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:08:10,126 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:08:10 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:08:15,129 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:08:15 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:08:20,133 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:08:20 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:08:24,361 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第28次, 30s间隔)
2025-06-28 12:08:24,386 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:08:24,389 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:08:24,390 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:08:24,390 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:08:24,406 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:08:24,819 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 8m 0s
2025-06-28 12:08:24,855 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:08:24,856 - websockets.server - DEBUG - > PING 09 2d cb c0 [binary, 4 bytes]
2025-06-28 12:08:24,856 - websockets.client - DEBUG - < PING 09 2d cb c0 [binary, 4 bytes]
2025-06-28 12:08:24,856 - websockets.client - DEBUG - > PONG 09 2d cb c0 [binary, 4 bytes]
2025-06-28 12:08:24,857 - websockets.server - DEBUG - < PONG 09 2d cb c0 [binary, 4 bytes]
2025-06-28 12:08:24,857 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:08:24,888 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:08:24,888 - websockets.client - DEBUG - > PING 04 7b a3 ee [binary, 4 bytes]
2025-06-28 12:08:24,889 - websockets.server - DEBUG - < PING 04 7b a3 ee [binary, 4 bytes]
2025-06-28 12:08:24,889 - websockets.server - DEBUG - > PONG 04 7b a3 ee [binary, 4 bytes]
2025-06-28 12:08:24,889 - websockets.client - DEBUG - < PONG 04 7b a3 ee [binary, 4 bytes]
2025-06-28 12:08:24,889 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:08:25,137 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:08:25 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13991 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:08:30,140 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:08:30 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:08:35,143 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:08:35 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:08:40,147 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:08:40 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:08:44,889 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:08:44,890 - websockets.client - DEBUG - > PING b7 2b 95 38 [binary, 4 bytes]
2025-06-28 12:08:44,891 - websockets.server - DEBUG - < PING b7 2b 95 38 [binary, 4 bytes]
2025-06-28 12:08:44,891 - websockets.server - DEBUG - > PONG b7 2b 95 38 [binary, 4 bytes]
2025-06-28 12:08:44,891 - websockets.client - DEBUG - < PONG b7 2b 95 38 [binary, 4 bytes]
2025-06-28 12:08:44,891 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:08:45,151 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:08:45 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:08:50,154 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:08:50 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:08:54,362 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第29次, 30s间隔)
2025-06-28 12:08:54,392 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:08:54,392 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:08:54,393 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:08:54,393 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:08:54,407 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:08:54,858 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:08:54,858 - websockets.server - DEBUG - > PING '2,\x08F' [text, 4 bytes]
2025-06-28 12:08:54,859 - websockets.client - DEBUG - < PING '2,\x08F' [text, 4 bytes]
2025-06-28 12:08:54,859 - websockets.client - DEBUG - > PONG '2,\x08F' [text, 4 bytes]
2025-06-28 12:08:54,859 - websockets.server - DEBUG - < PONG '2,\x08F' [text, 4 bytes]
2025-06-28 12:08:54,859 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:08:55,158 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:08:55 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:09:00,161 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:09:00 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13991 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:09:04,892 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:09:04,893 - websockets.client - DEBUG - > PING d8 9c e5 b4 [binary, 4 bytes]
2025-06-28 12:09:04,893 - websockets.server - DEBUG - < PING d8 9c e5 b4 [binary, 4 bytes]
2025-06-28 12:09:04,893 - websockets.server - DEBUG - > PONG d8 9c e5 b4 [binary, 4 bytes]
2025-06-28 12:09:04,893 - websockets.client - DEBUG - < PONG d8 9c e5 b4 [binary, 4 bytes]
2025-06-28 12:09:04,894 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:09:05,165 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:09:05 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:09:10,169 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:09:10 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:09:15,172 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:09:15 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:09:20,175 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:09:20 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:09:24,364 - core.task_processing.task_loader - INFO - 📋 任务文件 tasks.jsonl 不存在，等待... (第30次, 30s间隔) - 建议通过API提交任务
2025-06-28 12:09:24,395 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:09:24,396 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:09:24,398 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:09:24,398 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:09:24,413 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:09:24,821 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 9m 0s
2025-06-28 12:09:24,860 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:09:24,860 - websockets.server - DEBUG - > PING e6 62 a8 65 [binary, 4 bytes]
2025-06-28 12:09:24,861 - websockets.client - DEBUG - < PING e6 62 a8 65 [binary, 4 bytes]
2025-06-28 12:09:24,861 - websockets.client - DEBUG - > PONG e6 62 a8 65 [binary, 4 bytes]
2025-06-28 12:09:24,861 - websockets.server - DEBUG - < PONG e6 62 a8 65 [binary, 4 bytes]
2025-06-28 12:09:24,862 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:09:24,895 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:09:24,895 - websockets.client - DEBUG - > PING 59 93 dd 1c [binary, 4 bytes]
2025-06-28 12:09:24,896 - websockets.server - DEBUG - < PING 59 93 dd 1c [binary, 4 bytes]
2025-06-28 12:09:24,896 - websockets.server - DEBUG - > PONG 59 93 dd 1c [binary, 4 bytes]
2025-06-28 12:09:24,896 - websockets.client - DEBUG - < PONG 59 93 dd 1c [binary, 4 bytes]
2025-06-28 12:09:24,897 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:09:25,178 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:09:25 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:09:30,182 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:09:30 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:09:35,185 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:09:35 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:09:40,187 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:09:40 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:09:44,898 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:09:44,898 - websockets.client - DEBUG - > PING ca 19 6f 97 [binary, 4 bytes]
2025-06-28 12:09:44,899 - websockets.server - DEBUG - < PING ca 19 6f 97 [binary, 4 bytes]
2025-06-28 12:09:44,899 - websockets.server - DEBUG - > PONG ca 19 6f 97 [binary, 4 bytes]
2025-06-28 12:09:44,900 - websockets.client - DEBUG - < PONG ca 19 6f 97 [binary, 4 bytes]
2025-06-28 12:09:44,900 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:09:45,191 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:09:45 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:09:50,194 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:09:50 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:09:54,366 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第31次, 30s间隔)
2025-06-28 12:09:54,398 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:09:54,400 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:09:54,401 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:09:54,402 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:09:54,414 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:09:54,863 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:09:54,863 - websockets.server - DEBUG - > PING cd e2 42 74 [binary, 4 bytes]
2025-06-28 12:09:54,864 - websockets.client - DEBUG - < PING cd e2 42 74 [binary, 4 bytes]
2025-06-28 12:09:54,864 - websockets.client - DEBUG - > PONG cd e2 42 74 [binary, 4 bytes]
2025-06-28 12:09:54,865 - websockets.server - DEBUG - < PONG cd e2 42 74 [binary, 4 bytes]
2025-06-28 12:09:54,865 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:09:55,197 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:09:55 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13991 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:10:00,200 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:10:00 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13987 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:10:04,901 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:10:04,902 - websockets.client - DEBUG - > PING 70 45 08 f4 [binary, 4 bytes]
2025-06-28 12:10:04,903 - websockets.server - DEBUG - < PING 70 45 08 f4 [binary, 4 bytes]
2025-06-28 12:10:04,903 - websockets.server - DEBUG - > PONG 70 45 08 f4 [binary, 4 bytes]
2025-06-28 12:10:04,903 - websockets.client - DEBUG - < PONG 70 45 08 f4 [binary, 4 bytes]
2025-06-28 12:10:04,903 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:10:05,204 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:10:05 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:10:10,207 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:10:10 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:10:15,210 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:10:15 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:10:20,213 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:10:20 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:10:24,368 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第32次, 30s间隔)
2025-06-28 12:10:24,402 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:10:24,406 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:10:24,408 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:10:24,408 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:10:24,420 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:10:24,822 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 10m 0s
2025-06-28 12:10:24,838 - runtimes.reasoning.enhanced_runtime - DEBUG - 🔍 执行定期MCP同步验证...
2025-06-28 12:10:24,838 - core.tool_schema_manager - INFO - 正在执行MCP同步验证...
2025-06-28 12:10:24,838 - core.tool_schema_manager - DEBUG - 🔄 开始刷新Schema缓存 (force=False)，当前缓存: 4 个工具
2025-06-28 12:10:24,838 - core.tool_schema_manager - DEBUG - 🔍 开始安全Schema刷新...
2025-06-28 12:10:24,839 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具注册表中发现 4 个工具
2025-06-28 12:10:24,839 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 deepsearch 版本 8174ce27
2025-06-28 12:10:24,839 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 microsandbox 版本 33c2a85a
2025-06-28 12:10:24,839 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 browser_use 版本 998559b7
2025-06-28 12:10:24,840 - core.tool_schema_manager - DEBUG - 🔧 选项1: 工具 mcp-search-tool 版本 4f907873
2025-06-28 12:10:24,840 - core.tool_schema_manager - DEBUG - 📋 获取到 4 个工具版本信息
2025-06-28 12:10:24,840 - core.tool_schema_manager - DEBUG - 📊 Schema版本无变化，跳过更新
2025-06-28 12:10:24,842 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/search_tool_server/service.json
2025-06-28 12:10:24,843 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/microsandbox_server/service.json
2025-06-28 12:10:24,844 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/browser_use_server/service.json
2025-06-28 12:10:24,846 - core.tool_schema_manager - DEBUG - ✅ 加载MCP服务配置: mcp_servers/deepsearch_server/service.json
2025-06-28 12:10:24,847 - core.tool_schema_manager - DEBUG - 🔍 结构验证完成: 4/4 个Schema有效
2025-06-28 12:10:24,847 - core.tool_schema_manager - INFO - ✅ Schema刷新成功，缓存 4 个工具
2025-06-28 12:10:24,847 - core.tool_schema_manager - INFO - 🔍 同步验证完成: unhealthy (0/4 工具Schema一致)
2025-06-28 12:10:24,847 - runtimes.reasoning.enhanced_runtime - WARNING - ⚠️ MCP同步验证发现问题: {'total_tools': 4, 'connected_tools': 0, 'schema_consistent_tools': 0, 'failed_tools': 0}
2025-06-28 12:10:24,866 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:10:24,866 - websockets.server - DEBUG - > PING a9 62 02 ff [binary, 4 bytes]
2025-06-28 12:10:24,867 - websockets.client - DEBUG - < PING a9 62 02 ff [binary, 4 bytes]
2025-06-28 12:10:24,867 - websockets.client - DEBUG - > PONG a9 62 02 ff [binary, 4 bytes]
2025-06-28 12:10:24,867 - websockets.server - DEBUG - < PONG a9 62 02 ff [binary, 4 bytes]
2025-06-28 12:10:24,867 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:10:24,904 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:10:24,904 - websockets.client - DEBUG - > PING 77 e6 cd 24 [binary, 4 bytes]
2025-06-28 12:10:24,905 - websockets.server - DEBUG - < PING 77 e6 cd 24 [binary, 4 bytes]
2025-06-28 12:10:24,905 - websockets.server - DEBUG - > PONG 77 e6 cd 24 [binary, 4 bytes]
2025-06-28 12:10:24,905 - websockets.client - DEBUG - < PONG 77 e6 cd 24 [binary, 4 bytes]
2025-06-28 12:10:24,905 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:10:25,216 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:10:25 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:10:27,096 - services.synthesis_service - INFO - 开始处理轨迹数据...
2025-06-28 12:10:27,097 - asyncio - DEBUG - Using selector: KqueueSelector
2025-06-28 12:10:27,097 - core.synthesiscore.synthesis - INFO - 🔄 Processing only unprocessed trajectories...
2025-06-28 12:10:27,098 - core.synthesiscore.synthesis - INFO - 🎯 Unprocessed trajectories completed: 0 new trajectories processed
2025-06-28 12:10:27,099 - services.synthesis_service - DEBUG - 等待 300 秒后再次处理...
2025-06-28 12:10:30,219 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:10:30 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:10:35,223 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:10:35 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:10:40,227 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:10:40 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:10:44,905 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:10:44,906 - websockets.client - DEBUG - > PING 45 99 cd 27 [binary, 4 bytes]
2025-06-28 12:10:44,906 - websockets.server - DEBUG - < PING 45 99 cd 27 [binary, 4 bytes]
2025-06-28 12:10:44,907 - websockets.server - DEBUG - > PONG 45 99 cd 27 [binary, 4 bytes]
2025-06-28 12:10:44,907 - websockets.client - DEBUG - < PONG 45 99 cd 27 [binary, 4 bytes]
2025-06-28 12:10:44,908 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:10:45,229 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:10:45 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:10:50,233 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:10:50 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:10:54,369 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第33次, 30s间隔)
2025-06-28 12:10:54,408 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:10:54,410 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:10:54,411 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:10:54,411 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:10:54,422 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:10:54,868 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:10:54,868 - websockets.server - DEBUG - > PING a2 ff 56 e6 [binary, 4 bytes]
2025-06-28 12:10:54,869 - websockets.client - DEBUG - < PING a2 ff 56 e6 [binary, 4 bytes]
2025-06-28 12:10:54,869 - websockets.client - DEBUG - > PONG a2 ff 56 e6 [binary, 4 bytes]
2025-06-28 12:10:54,870 - websockets.server - DEBUG - < PONG a2 ff 56 e6 [binary, 4 bytes]
2025-06-28 12:10:54,870 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:10:55,236 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:10:55 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:11:00,240 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:11:00 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:11:04,909 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:11:04,909 - websockets.client - DEBUG - > PING f2 f5 4a ca [binary, 4 bytes]
2025-06-28 12:11:04,910 - websockets.server - DEBUG - < PING f2 f5 4a ca [binary, 4 bytes]
2025-06-28 12:11:04,910 - websockets.server - DEBUG - > PONG f2 f5 4a ca [binary, 4 bytes]
2025-06-28 12:11:04,910 - websockets.client - DEBUG - < PONG f2 f5 4a ca [binary, 4 bytes]
2025-06-28 12:11:04,911 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:11:05,244 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:11:05 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:11:10,247 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:11:10 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:11:15,250 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:11:15 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13991 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:11:20,254 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:11:20 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:11:24,370 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第34次, 30s间隔)
2025-06-28 12:11:24,413 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:11:24,416 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:11:24,417 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:11:24,417 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:11:24,428 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:11:24,823 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 11m 0s
2025-06-28 12:11:24,871 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:11:24,871 - websockets.server - DEBUG - > PING 89 c9 57 2c [binary, 4 bytes]
2025-06-28 12:11:24,872 - websockets.client - DEBUG - < PING 89 c9 57 2c [binary, 4 bytes]
2025-06-28 12:11:24,872 - websockets.client - DEBUG - > PONG 89 c9 57 2c [binary, 4 bytes]
2025-06-28 12:11:24,872 - websockets.server - DEBUG - < PONG 89 c9 57 2c [binary, 4 bytes]
2025-06-28 12:11:24,873 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:11:24,912 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:11:24,912 - websockets.client - DEBUG - > PING cc 6d 72 c8 [binary, 4 bytes]
2025-06-28 12:11:24,912 - websockets.server - DEBUG - < PING cc 6d 72 c8 [binary, 4 bytes]
2025-06-28 12:11:24,913 - websockets.server - DEBUG - > PONG cc 6d 72 c8 [binary, 4 bytes]
2025-06-28 12:11:24,913 - websockets.client - DEBUG - < PONG cc 6d 72 c8 [binary, 4 bytes]
2025-06-28 12:11:24,913 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:11:25,258 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:11:25 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:11:30,261 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:11:30 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:11:35,264 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:11:35 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:11:40,268 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:11:40 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:11:44,914 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:11:44,914 - websockets.client - DEBUG - > PING 2c 6c 1f ae [binary, 4 bytes]
2025-06-28 12:11:44,915 - websockets.server - DEBUG - < PING 2c 6c 1f ae [binary, 4 bytes]
2025-06-28 12:11:44,915 - websockets.server - DEBUG - > PONG 2c 6c 1f ae [binary, 4 bytes]
2025-06-28 12:11:44,915 - websockets.client - DEBUG - < PONG 2c 6c 1f ae [binary, 4 bytes]
2025-06-28 12:11:44,915 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:11:45,272 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:11:45 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13991 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:11:50,276 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:11:50 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:11:54,371 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第35次, 30s间隔)
2025-06-28 12:11:54,420 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:11:54,422 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:11:54,423 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:11:54,423 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:11:54,434 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:11:54,874 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:11:54,874 - websockets.server - DEBUG - > PING a2 e6 15 b3 [binary, 4 bytes]
2025-06-28 12:11:54,875 - websockets.client - DEBUG - < PING a2 e6 15 b3 [binary, 4 bytes]
2025-06-28 12:11:54,875 - websockets.client - DEBUG - > PONG a2 e6 15 b3 [binary, 4 bytes]
2025-06-28 12:11:54,875 - websockets.server - DEBUG - < PONG a2 e6 15 b3 [binary, 4 bytes]
2025-06-28 12:11:54,875 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:11:55,279 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:11:55 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:12:00,282 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:12:00 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:12:04,916 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:12:04,917 - websockets.client - DEBUG - > PING ac 98 08 26 [binary, 4 bytes]
2025-06-28 12:12:04,918 - websockets.server - DEBUG - < PING ac 98 08 26 [binary, 4 bytes]
2025-06-28 12:12:04,918 - websockets.server - DEBUG - > PONG ac 98 08 26 [binary, 4 bytes]
2025-06-28 12:12:04,919 - websockets.client - DEBUG - < PONG ac 98 08 26 [binary, 4 bytes]
2025-06-28 12:12:04,919 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:12:05,286 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:12:05 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:12:10,289 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:12:10 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:12:15,293 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:12:15 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:12:20,296 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:12:20 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13991 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:12:24,373 - core.task_processing.task_loader - INFO - 📋 任务文件 tasks.jsonl 不存在，等待... (第36次, 30s间隔) - 建议通过API提交任务
2025-06-28 12:12:24,424 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:12:24,424 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:12:24,426 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:12:24,426 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:12:24,438 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:12:24,824 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 12m 0s
2025-06-28 12:12:24,876 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:12:24,877 - websockets.server - DEBUG - > PING 2a 32 fb e9 [binary, 4 bytes]
2025-06-28 12:12:24,877 - websockets.client - DEBUG - < PING 2a 32 fb e9 [binary, 4 bytes]
2025-06-28 12:12:24,878 - websockets.client - DEBUG - > PONG 2a 32 fb e9 [binary, 4 bytes]
2025-06-28 12:12:24,878 - websockets.server - DEBUG - < PONG 2a 32 fb e9 [binary, 4 bytes]
2025-06-28 12:12:24,878 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:12:24,920 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:12:24,920 - websockets.client - DEBUG - > PING 20 84 14 20 [binary, 4 bytes]
2025-06-28 12:12:24,921 - websockets.server - DEBUG - < PING 20 84 14 20 [binary, 4 bytes]
2025-06-28 12:12:24,921 - websockets.server - DEBUG - > PONG 20 84 14 20 [binary, 4 bytes]
2025-06-28 12:12:24,921 - websockets.client - DEBUG - < PONG 20 84 14 20 [binary, 4 bytes]
2025-06-28 12:12:24,921 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:12:25,299 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:12:25 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:12:30,303 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:12:30 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:12:35,306 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:12:35 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:12:40,308 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:12:40 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:12:44,923 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:12:44,923 - websockets.client - DEBUG - > PING 35 e1 7e 10 [binary, 4 bytes]
2025-06-28 12:12:44,923 - websockets.server - DEBUG - < PING 35 e1 7e 10 [binary, 4 bytes]
2025-06-28 12:12:44,924 - websockets.server - DEBUG - > PONG 35 e1 7e 10 [binary, 4 bytes]
2025-06-28 12:12:44,924 - websockets.client - DEBUG - < PONG 35 e1 7e 10 [binary, 4 bytes]
2025-06-28 12:12:44,924 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:12:45,310 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:12:45 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:12:50,314 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:12:50 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:12:54,374 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第37次, 30s间隔)
2025-06-28 12:12:54,429 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:12:54,429 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:12:54,430 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:12:54,430 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:12:54,443 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:12:54,879 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:12:54,880 - websockets.server - DEBUG - > PING 7d d5 c0 ac [binary, 4 bytes]
2025-06-28 12:12:54,881 - websockets.client - DEBUG - < PING 7d d5 c0 ac [binary, 4 bytes]
2025-06-28 12:12:54,881 - websockets.client - DEBUG - > PONG 7d d5 c0 ac [binary, 4 bytes]
2025-06-28 12:12:54,881 - websockets.server - DEBUG - < PONG 7d d5 c0 ac [binary, 4 bytes]
2025-06-28 12:12:54,881 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:12:55,316 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:12:55 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:13:00,318 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:13:00 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:13:04,925 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:13:04,925 - websockets.client - DEBUG - > PING 22 20 cd 61 [binary, 4 bytes]
2025-06-28 12:13:04,926 - websockets.server - DEBUG - < PING 22 20 cd 61 [binary, 4 bytes]
2025-06-28 12:13:04,926 - websockets.server - DEBUG - > PONG 22 20 cd 61 [binary, 4 bytes]
2025-06-28 12:13:04,927 - websockets.client - DEBUG - < PONG 22 20 cd 61 [binary, 4 bytes]
2025-06-28 12:13:04,927 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:13:05,321 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:13:05 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:13:10,324 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:13:10 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:13:15,327 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:13:15 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:13:20,331 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:13:20 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:13:24,376 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第38次, 30s间隔)
2025-06-28 12:13:24,433 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:13:24,435 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:13:24,435 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:13:24,436 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:13:24,449 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:13:24,826 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 13m 0s
2025-06-28 12:13:24,883 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:13:24,883 - websockets.server - DEBUG - > PING 4d f8 c2 92 [binary, 4 bytes]
2025-06-28 12:13:24,884 - websockets.client - DEBUG - < PING 4d f8 c2 92 [binary, 4 bytes]
2025-06-28 12:13:24,884 - websockets.client - DEBUG - > PONG 4d f8 c2 92 [binary, 4 bytes]
2025-06-28 12:13:24,884 - websockets.server - DEBUG - < PONG 4d f8 c2 92 [binary, 4 bytes]
2025-06-28 12:13:24,885 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:13:24,928 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:13:24,929 - websockets.client - DEBUG - > PING d4 51 65 45 [binary, 4 bytes]
2025-06-28 12:13:24,929 - websockets.server - DEBUG - < PING d4 51 65 45 [binary, 4 bytes]
2025-06-28 12:13:24,929 - websockets.server - DEBUG - > PONG d4 51 65 45 [binary, 4 bytes]
2025-06-28 12:13:24,930 - websockets.client - DEBUG - < PONG d4 51 65 45 [binary, 4 bytes]
2025-06-28 12:13:24,930 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:13:25,335 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:13:25 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:13:30,339 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:13:30 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:13:35,343 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:13:35 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:13:40,346 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:13:40 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:13:44,931 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:13:44,932 - websockets.client - DEBUG - > PING 74 58 3c f4 [binary, 4 bytes]
2025-06-28 12:13:44,932 - websockets.server - DEBUG - < PING 74 58 3c f4 [binary, 4 bytes]
2025-06-28 12:13:44,932 - websockets.server - DEBUG - > PONG 74 58 3c f4 [binary, 4 bytes]
2025-06-28 12:13:44,932 - websockets.client - DEBUG - < PONG 74 58 3c f4 [binary, 4 bytes]
2025-06-28 12:13:44,932 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:13:45,349 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:13:45 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:13:50,353 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:13:50 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:13:54,377 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第39次, 30s间隔)
2025-06-28 12:13:54,437 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:13:54,441 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:13:54,442 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:13:54,442 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:13:54,455 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:13:54,886 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:13:54,886 - websockets.server - DEBUG - > PING 3c c6 79 c0 [binary, 4 bytes]
2025-06-28 12:13:54,887 - websockets.client - DEBUG - < PING 3c c6 79 c0 [binary, 4 bytes]
2025-06-28 12:13:54,887 - websockets.client - DEBUG - > PONG 3c c6 79 c0 [binary, 4 bytes]
2025-06-28 12:13:54,888 - websockets.server - DEBUG - < PONG 3c c6 79 c0 [binary, 4 bytes]
2025-06-28 12:13:54,888 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:13:55,356 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:13:55 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:14:00,360 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:14:00 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13991 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:14:04,934 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:14:04,934 - websockets.client - DEBUG - > PING 23 eb 0e db [binary, 4 bytes]
2025-06-28 12:14:04,935 - websockets.server - DEBUG - < PING 23 eb 0e db [binary, 4 bytes]
2025-06-28 12:14:04,935 - websockets.server - DEBUG - > PONG 23 eb 0e db [binary, 4 bytes]
2025-06-28 12:14:04,935 - websockets.client - DEBUG - < PONG 23 eb 0e db [binary, 4 bytes]
2025-06-28 12:14:04,935 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:14:05,364 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:14:05 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:14:10,367 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:14:10 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13991 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:14:15,369 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:14:15 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:14:20,372 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:14:20 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:14:24,379 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第40次, 30s间隔)
2025-06-28 12:14:24,445 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:14:24,446 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:14:24,447 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:14:24,448 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:14:24,456 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:14:24,827 - __main__ - DEBUG - ⏰ 系统运行时间: 0h 14m 0s
2025-06-28 12:14:24,889 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:14:24,889 - websockets.server - DEBUG - > PING b5 f3 92 43 [binary, 4 bytes]
2025-06-28 12:14:24,890 - websockets.client - DEBUG - < PING b5 f3 92 43 [binary, 4 bytes]
2025-06-28 12:14:24,890 - websockets.client - DEBUG - > PONG b5 f3 92 43 [binary, 4 bytes]
2025-06-28 12:14:24,890 - websockets.server - DEBUG - < PONG b5 f3 92 43 [binary, 4 bytes]
2025-06-28 12:14:24,890 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:14:24,937 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:14:24,937 - websockets.client - DEBUG - > PING 79 c7 07 fa [binary, 4 bytes]
2025-06-28 12:14:24,937 - websockets.server - DEBUG - < PING 79 c7 07 fa [binary, 4 bytes]
2025-06-28 12:14:24,938 - websockets.server - DEBUG - > PONG 79 c7 07 fa [binary, 4 bytes]
2025-06-28 12:14:24,938 - websockets.client - DEBUG - < PONG 79 c7 07 fa [binary, 4 bytes]
2025-06-28 12:14:24,938 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:14:25,376 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:14:25 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:14:30,380 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:14:30 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:14:35,384 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:14:35 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13991 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:14:40,387 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:14:40 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:14:44,940 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:14:44,940 - websockets.client - DEBUG - > PING 07 00 d6 06 [binary, 4 bytes]
2025-06-28 12:14:44,941 - websockets.server - DEBUG - < PING 07 00 d6 06 [binary, 4 bytes]
2025-06-28 12:14:44,941 - websockets.server - DEBUG - > PONG 07 00 d6 06 [binary, 4 bytes]
2025-06-28 12:14:44,941 - websockets.client - DEBUG - < PONG 07 00 d6 06 [binary, 4 bytes]
2025-06-28 12:14:44,942 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:14:45,388 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:14:45 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:14:50,391 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:14:50 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:14:54,380 - core.task_processing.task_loader - DEBUG - 任务文件 tasks.jsonl 不存在，等待... (第41次, 30s间隔)
2025-06-28 12:14:54,452 - services.mcp_server_launcher - DEBUG - 💚 browser_use_server 健康检查通过 (端口 8084)
2025-06-28 12:14:54,452 - services.mcp_server_launcher - DEBUG - 💚 search_tool_server 健康检查通过 (端口 8080)
2025-06-28 12:14:54,453 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection rejected (400 Bad Request)
2025-06-28 12:14:54,454 - services.mcp_server_launcher - DEBUG - [browser_use_server] INFO     [websockets.server] connection closed
2025-06-28 12:14:54,462 - services.mcp_server_launcher - DEBUG - 💚 deepsearch_server 健康检查通过 (端口 8086)
2025-06-28 12:14:54,891 - websockets.server - DEBUG - % sending keepalive ping
2025-06-28 12:14:54,892 - websockets.server - DEBUG - > PING 75 7a a4 66 [binary, 4 bytes]
2025-06-28 12:14:54,893 - websockets.client - DEBUG - < PING 75 7a a4 66 [binary, 4 bytes]
2025-06-28 12:14:54,893 - websockets.client - DEBUG - > PONG 75 7a a4 66 [binary, 4 bytes]
2025-06-28 12:14:54,893 - websockets.server - DEBUG - < PONG 75 7a a4 66 [binary, 4 bytes]
2025-06-28 12:14:54,894 - websockets.server - DEBUG - % received keepalive pong
2025-06-28 12:14:55,395 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:14:55 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:15:00,397 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:15:00 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:15:04,943 - websockets.client - DEBUG - % sending keepalive ping
2025-06-28 12:15:04,943 - websockets.client - DEBUG - > PING b8 f2 d1 72 [binary, 4 bytes]
2025-06-28 12:15:04,943 - websockets.server - DEBUG - < PING b8 f2 d1 72 [binary, 4 bytes]
2025-06-28 12:15:04,943 - websockets.server - DEBUG - > PONG b8 f2 d1 72 [binary, 4 bytes]
2025-06-28 12:15:04,944 - websockets.client - DEBUG - < PONG b8 f2 d1 72 [binary, 4 bytes]
2025-06-28 12:15:04,944 - websockets.client - DEBUG - % received keepalive pong
2025-06-28 12:15:05,401 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:15:05 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13992 "-" "Python/3.11 aiohttp/3.10.11"
2025-06-28 12:15:10,404 - aiohttp.access - INFO - 127.0.0.1 [28/Jun/2025:12:15:10 +0800] "GET /api/v1/tools/available HTTP/1.1" 200 13993 "-" "Python/3.11 aiohttp/3.10.11"
